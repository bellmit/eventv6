!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n=window.GiswayEngineWebpackJsonp;window.GiswayEngineWebpackJsonp=function(c,o){for(var i,s,p=0,l=[];p<c.length;p++)s=c[p],r[s]&&l.push.apply(l,r[s]),r[s]=0;for(i in o){var u=o[i];switch(typeof u){case"object":e[i]=function(t){var n=t.slice(1),a=t[0];return function(t,r,c){e[a].apply(this,[t,r,c].concat(n))}}(u);break;case"function":e[i]=u;break;default:e[i]=e[u]}}for(n&&n(c,o);l.length;)l.shift().call(null,t);if(o[0])return a[0]=0,t(0)};var a={},r={0:0};t.e=function(e,n){if(0===r[e])return n.call(null,t);if(void 0!==r[e])r[e].push(n);else{r[e]=[n];var a=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.async=!0,c.src=t.p+""+({1:"index"}[e]||e)+".js",a.appendChild(c)}},t.m=e,t.c=a,t.p=""}(function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(typeof e[t]){case"function":break;case"object":e[t]=function(t){var n=t.slice(1),a=e[t[0]];return function(e,t,r){a.apply(this,[e,t,r].concat(n))}}(e[t]);break;default:e[t]=e[e[t]]}return e}([]));


GiswayEngineWebpackJsonp([1,0],[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var r=i(155),a=n(r),o=i(574),s=n(o);window.Earth=a["default"],window.MapGis=s["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(627),a=n(r),o=i(624),s=n(o),u=i(86),l=n(u);e["default"]=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":(0,l["default"])(e)));t.prototype=(0,s["default"])(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(a["default"]?(0,a["default"])(t,e):t.__proto__=e)}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(86),a=n(r);e["default"]=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":(0,a["default"])(e))&&"function"!=typeof e?t:e}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=i(14),l=n(u),h=i(60),d=n(h),f=i(5),c=n(f),p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,a["default"])(this,t),this.x=e,this.y=i,this.z=n}return t.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},t.prototype.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.setZ=function(t){return this.z=t,this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},t.prototype.add=function(t,e){return void 0!=e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},t.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},t.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},t.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},t.prototype.sub=function(t,e){return void 0!=e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},t.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},t.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},t.prototype.multiply=function(t,e){return void 0!=e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},t.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.multiplyVectors=function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},t.prototype.applyEuler=function(t){return this.applyEulerQuaternion||(this.applyEulerQuaternion=new d["default"]),this.applyQuaternion(this.applyEulerQuaternion.setFromEuler(t))},t.prototype.applyAxisAngle=function(t,e){return this.applyAxisAngleQuaternion||(this.applyAxisAngleQuaternion=new d["default"]),this.applyQuaternion(this.applyAxisAngleQuaternion.setFromAxisAngle(t,e))},t.prototype.applyMatrix3=function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},t.prototype.applyMatrix4=function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,a=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*a,this},t.prototype.applyQuaternion=function(t){var e=this.x,i=this.y,n=this.z,r=t._x,a=t._y,o=t._z,s=t._w,u=s*e+a*n-o*i,l=s*i+o*e-r*n,h=s*n+r*i-a*e,d=-r*e-a*i-o*n;return this.x=u*s+d*-r+l*-o-h*-a,this.y=l*s+d*-a+h*-r-u*-o,this.z=h*s+d*-o+u*-a-l*-r,this},t.prototype.project=function(t){var e=new l["default"];return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)},t.prototype.projectToScreen=function(t,e,i){var n=this.project(t),r=(n.x+1)/2*e,a=-(n.y-1)/2*i;return new c["default"](r,a)},t.prototype.unproject=function(t){return this.unprojectMatrix4||(this.unprojectMatrix4=new l["default"]),this.unprojectMatrix4.multiplyMatrices(t.matrixWorld,this.unprojectMatrix4.getInverse(t.projectionMatrix)),this.applyMatrix4(this.unprojectMatrix4)},t.prototype.transformDirection=function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},t.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},t.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},t.prototype.clampScalar=function(e,i){var n=new t,r=new t;return n.set(e,e,e),r.set(i,i,i),this.clamp(n,r)},t.prototype.clampLength=function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},t.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.prototype.normalize=function(){return this.divideScalar(this.length()||1)},t.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},t.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},t.prototype.lerpVectors=function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},t.prototype.cross=function(t,e){return void 0!=e?this.crossVectors(t,e):this.crossVectors(this,t)},t.prototype.crossVectors=function(t,e){var i=t.x,n=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this},t.prototype.projectOnVector=function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},t.prototype.projectOnPlane=function(e){var i=new t;return i.copy(this).projectOnVector(e),this.sub(i)},t.prototype.reflect=function(e){var i=new t;return this.sub(i.copy(e).multiplyScalar(2*this.dot(e)))},t.prototype.angleTo=function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(s["default"].clamp(e,-1,1))},t.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},t.prototype.distanceToSquared=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},t.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},t.prototype.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},t.prototype.setFromSphericalCoords=function(t,e,i){var n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this},t.prototype.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},t.prototype.setFromCylindricalCoords=function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this},t.prototype.setFromMatrixPosition=function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},t.prototype.setFromMatrixScale=function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},t.prototype.setFromMatrixColumn=function(t,e){return this.fromArray(t.elements,4*e)},t.prototype.equals=function(t){return t.x==this.x&&t.y==this.y&&t.z==this.z},t.prototype.fromArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},t.prototype.fromBufferAttribute=function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},t}();e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a["default"])(this,t),this.x=e,this.y=i}return t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.setScalar=function(t){return this.x=t,this.y=t,this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.add=function(t,e){return void 0!=e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},t.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},t.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},t.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},t.prototype.sub=function(t,e){return void 0!=e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},t.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this},t.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.applyMatrix3=function(t){var e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},t.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},t.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},t.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},t.prototype.clampScalar=function(e,i){return this.clampScalarMin||(this.clampScalarMin=new t,this.clampScalarMax=new t),this.clampScalarMin.set(e,e),this.clampScalarMax.set(i,i),this.clamp(this.clampScalarMin,this.clampScalarMax)},t.prototype.clampLength=function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},t.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},t.prototype.normalize=function(){return this.divideScalar(this.length()||1)},t.prototype.angle=function e(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},t.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},t.prototype.distanceToSquared=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},t.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},t.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},t.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},t.prototype.lerpVectors=function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},t.prototype.equals=function(t){return t.x==this.x&&t.y==this.y},t.prototype.fromArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t},t.prototype.fromBufferAttribute=function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this},t.prototype.rotateAround=function(t,e){var i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*i-a*n+t.x,this.y=r*n+a*i+t.y,this},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.listSplice=function(t,e){if(e instanceof Function)t.forEach(function(i,n){i.toString()==e.toString()&&t.splice(n,1)});else{var i=t.indexOf(e);i>=0&&t.splice(i,1)}},t.startWith=function(t,e){var i=new RegExp("^"+e);return i.test(t)},t.endWith=function(t,e){var i=new RegExp(e+"$");return i.test(t)},t.isEmpty=function(t){return null==t||0==t.length||void 0==t},t.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):""},t.isSuccess=function(t){return!!t.success||(console.log(t.message),!1)},t.isPC=function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],i=!0,n=0;n<e.length;n++)if(t.indexOf(e[n])>0){i=!1;break}return i},t.stopEvents=function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},t.warn=function(t){var e=document.createElement("div");e.innerHTML=t,document.body.appendChild(e),e.style.cssText="\n        pointer-events: none;\n        position: absolute;\n        top: -100px;\n        background: rgba(39, 50, 56, .8);\n        color: rgb(255, 255, 255);\n        padding: 10px 40px;\n        letter-spacing: 1px;\n        font-size: 15px;\n        border-radius: 5px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        z-index:999;\n        ",e.style.left="calc(50vw - "+e.offsetWidth/2+"px)",e.style.transition="top 250ms ease-out",e.style.top="20px",window.setTimeout(function(){document.body.removeChild(e)},3e3)},t.getTileGrids=function(t){for(var e=[],i=0;i<=t;i++)if(0==i)e.push([0,0]);else{for(var n=i,r=-i,a=0,o=0;o<=i;o++)a=o,e.push([a,n]);for(var s=0;s<2*i;s++)e.push([a,n-s-1]);for(var u=0,l=1;l<2*i+1;l++)l<i?e.push([i-l,r]):(u=0-(l-i),e.push([u,r]));for(var h=1;h<2*i;h++)e.push([u,r+h]);for(var d=i;d>0;d--)e.push([0-d,n])}return e},t.getDevicePixelRatio=function(){return window.devicePixelRatio||1},t.isNumber=function(t){return"NaN"!=parseFloat(t).toString()},t.getDefaultNumber=function(t,e){return t==Number.NaN||null==t||void 0==t?e:t},t.getDefaultString=function(t,e){return void 0==t||null==t||0==t.length?e:t},t.debounce=function(t,e,i,n){this.timerSet[n]&&clearTimeout(this.timerSet[n]),this.timerSet[n]=setTimeout(function(){t.apply(e)},i)},t}();e["default"]=o,o.timerSet={},t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.getUUID=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:11,e=16,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[],r=void 0;if(e=e||i.length,t)for(r=0;r<t;r++)n[r]=i[0|Math.random()*e];else{var a=void 0;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",r=0;r<36;r++)n[r]||(a=0|16*Math.random(),n[r]=i[19==r?3&a|8:a])}return"U"+n.join("")},t.clamp=function(t,e,i){return Math.max(e,Math.min(i,t))},t.euclideanModulo=function(t,e){return(t%e+e)%e},t.mapLinear=function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},t.lerp=function(t,e,i){return(1-i)*t+i*e},t.smoothstep=function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},t.smootherstep=function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},t.randInt=function(t,e){return t+Math.floor(Math.random()*(e-t+1))},t.randFloat=function(t,e){return t+Math.random()*(e-t)},t.randFloatSpread=function(t){return t*(.5-Math.random())},t.degToRad=function(e){return e*t.Deg2Rad},t.radToDeg=function(e){return e*t.Rad2Deg},t.isPowerOfTwo=function(t){return 0==(t&t-1)&&0!=t},t.ceilPowerOfTwo=function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.floorPowerOfTwo=function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.arrayMin=function(t){if(0==t.length)return 1/0;for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]<e&&(e=t[i]);return e},t.arrayMax=function(t){if(0==t.length)return-(1/0);for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e},t.sign=function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},t}();e["default"]=o,o.Deg2Rad=Math.PI/180,o.Rad2Deg=180/Math.PI,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Const={EPSGType:{EPSG84:"4326",EPSGWeb:"3857"},LayerName:{Tile:"\u5207\u7247",Elements:"\u5bf9\u8c61",Select:"\u9009\u4e2d",Draw:"\u7ed8\u5236",Overlay:"\u8986\u76d6\u7269",Plus:"\u63d2\u4ef6",Traffic:"\u4ea4\u901a\u8def\u51b5",Hot:"\u70ed\u529b\u56fe",HotMap:"GIS\u70ed\u529b\u56fe"},LayerZindex:{Traffic:"40",HotMap:"30",Diy:"1000"},LayerMask:{Zero:0,Two:2,Three:3,Four:4},LineType:{FULL:[1,0],DOTTED:[1,1],DOT_DASH:[2.5,1,.5,1],CENTER:[3,1,1.5,1],DASH:[2,1],DOUBLE_DOT_DASH:[2.5,.5,.5,.5,.5,.5],TRI_DOT_DASH:[2.5,.5,.5,.5,.5,.5,.5,.5],ARROW:[5,0],NAVARROW:[7,0]}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=0,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.FrontSide=0,e.BackSide=1,e.DoubleSide=2,e.FlatShading=1,e.SmoothShading=2,e.NoColors=0,e.FaceColors=1,e.VertexColors=2,e.NoBlending=0,e.NormalBlending=1,e.AdditiveBlending=2,e.SubtractiveBlending=3,e.MultiplyBlending=4,e.CustomBlending=5,e.AddEquation=100,e.SubtractEquation=101,e.ReverseSubtractEquation=102,e.MinEquation=103,e.MaxEquation=104,e.ZeroFactor=200,e.OneFactor=201,e.SrcColorFactor=202,e.OneMinusSrcColorFactor=203,e.SrcAlphaFactor=204,e.OneMinusSrcAlphaFactor=205,e.DstAlphaFactor=206,e.OneMinusDstAlphaFactor=207,e.DstColorFactor=208,e.OneMinusDstColorFactor=209,e.SrcAlphaSaturateFactor=210,e.NeverDepth=0,e.AlwaysDepth=1,e.LessDepth=2,e.LessEqualDepth=3,e.EqualDepth=4,e.GreaterEqualDepth=5,e.GreaterDepth=6,e.NotEqualDepth=7,e.MultiplyOperation=0,e.MixOperation=1,e.AddOperation=2,e.NoToneMapping=0,e.LinearToneMapping=1,e.ReinhardToneMapping=2,e.Uncharted2ToneMapping=3,e.CineonToneMapping=4,e.ACESFilmicToneMapping=5,e.UVMapping=300,e.CubeReflectionMapping=301,e.CubeRefractionMapping=302,e.EquirectangularReflectionMapping=303,e.EquirectangularRefractionMapping=304,e.SphericalReflectionMapping=305,e.CubeUVReflectionMapping=306,e.CubeUVRefractionMapping=307,e.RepeatWrapping=1e3,e.ClampToEdgeWrapping=1001,e.MirroredRepeatWrapping=1002,e.NearestFilter=1003,e.NearestMipMapNearestFilter=1004,e.NearestMipMapLinearFilter=1005,e.LinearFilter=1006,e.LinearMipMapNearestFilter=1007,e.LinearMipMapLinearFilter=1008,e.UnsignedByteType=1009,e.ByteType=1010,e.ShortType=1011,e.UnsignedShortType=1012,e.IntType=1013,e.UnsignedIntType=1014,e.FloatType=1015,e.HalfFloatType=1016,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedInt248Type=1020,e.AlphaFormat=1021,e.RGBFormat=1022,e.RGBAFormat=1023),n=(e.LuminanceFormat=1024,e.LuminanceAlphaFormat=1025,e.RGBEFormat=i,e.DepthFormat=1026,e.DepthStencilFormat=1027,e.RedFormat=1028,e.RGB_S3TC_DXT1_Format=33776,e.RGBA_S3TC_DXT1_Format=33777,e.RGBA_S3TC_DXT3_Format=33778,e.RGBA_S3TC_DXT5_Format=33779,e.RGB_PVRTC_4BPPV1_Format=35840,e.RGB_PVRTC_2BPPV1_Format=35841,e.RGBA_PVRTC_4BPPV1_Format=35842,e.RGBA_PVRTC_2BPPV1_Format=35843,e.RGB_ETC1_Format=36196,e.RGBA_ASTC_4x4_Format=37808,e.RGBA_ASTC_5x4_Format=37809,e.RGBA_ASTC_5x5_Format=37810,e.RGBA_ASTC_6x5_Format=37811,e.RGBA_ASTC_6x6_Format=37812,e.RGBA_ASTC_8x5_Format=37813,e.RGBA_ASTC_8x6_Format=37814,e.RGBA_ASTC_8x8_Format=37815,e.RGBA_ASTC_10x5_Format=37816,e.RGBA_ASTC_10x6_Format=37817,e.RGBA_ASTC_10x8_Format=37818,e.RGBA_ASTC_10x10_Format=37819,e.RGBA_ASTC_12x10_Format=37820,e.RGBA_ASTC_12x12_Format=37821,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolationModes=void 0);!function(t){}(n||(e.InterpolationModes=n={}));e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=2400,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=0,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=3e3,e.sRGBEncoding=3001,e.GammaEncoding=3007,e.RGBEEncoding=3002,e.LogLuvEncoding=3003,e.RGBM7Encoding=3004,e.RGBM16Encoding=3005,e.RGBDEncoding=3006,e.BasicDepthPacking=3200,e.RGBADepthPacking=3201,e.TangentSpaceNormalMap=0,e.ObjectSpaceNormalMap=1},function(t,e,i){t.exports={"default":i(637),__esModule:!0}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(4),d=n(h),f=i(8),c=i(25),p=n(c),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f.Const.EPSGType.EPSG84;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this,i,n,r));return u.EPSGType=o,u}return(0,l["default"])(e,t),e.prototype.set=function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f.Const.EPSGType.EPSG84;return t.prototype.set.call(this,e,i,n),this.EPSGType=r,this},e.prototype.getXYZ=function(){return{x:this.x,y:this.y,z:this.z}},e.prototype.changeEPSGType=function(t){return this.EPSGType!=t&&(t==f.Const.EPSGType.EPSG84?(this.y=p["default"].WebtoP84_Y(this.y),this.x=p["default"].WebtoP84_X(this.x),this.z=this.z):t==f.Const.EPSGType.EPSGWeb?(this.y=p["default"].P84ToWeb_Y(this.y),this.x=p["default"].P84ToWeb_X(this.x),this.z=this.z):console.log("\u672a\u77e5\u7c7b\u578b\u8f6c\u6362:"+this.EPSGType+"=>"+t),this.EPSGType=t),this},e.prototype.clone=function(){return new e(this.x,this.y,this.z,this.EPSGType)},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=function(){function t(e,i,n){return(0,a["default"])(this,t),this.lerpHSLA={h:0,s:0,l:0},this.lerpHSLB={h:0,s:0,l:0},this.r=this.b=this.g=1,void 0==i&&void 0==n?this.set(e):this.setRGB(e,i,n)}return t.prototype.set=function(e){return"number"==typeof e?this.setHex(e):"string"==typeof e?this.setStyle(e):e instanceof t&&this.copy(e),this},t.prototype.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},t.prototype.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},t.prototype.setRGB=function(t,e,i){return this.r=t,this.g=e,this.b=i,this},t.prototype.hue2rgb=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t},t.prototype.setHSL=function(t,e,i){if(t=s["default"].euclideanModulo(t,1),e=s["default"].clamp(e,0,1),i=s["default"].clamp(i,0,1),0==e)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+e):i+e-i*e,r=2*i-n;this.r=this.hue2rgb(r,n,t+1/3),this.g=this.hue2rgb(r,n,t),this.b=this.hue2rgb(r,n,t-1/3)}return this},t.prototype.setStyle=function(e){var i=void 0;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n=void 0,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,u=parseInt(n[3],10)/100;return this.setHSL(o,s,u)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l=i[1],h=l.length;if(3==h)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6==h)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}if(e&&e.length>0){var d=t.ColorKeywords[e];void 0!=d&&this.setHex(d)}return this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},t.prototype.copyGammaToLinear=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},t.prototype.copyLinearToGamma=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},t.prototype.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},t.prototype.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},t.prototype.SRGBToLinear=function(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)},t.prototype.copySRGBToLinear=function(t){return this.r=this.SRGBToLinear(t.r),this.g=this.SRGBToLinear(t.g),this.b=this.SRGBToLinear(t.b),this},t.prototype.LinearToSRGB=function(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055},t.prototype.copyLinearToSRGB=function(t){return this.r=this.LinearToSRGB(t.r),this.g=this.LinearToSRGB(t.g),this.b=this.LinearToSRGB(t.b),this},t.prototype.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.prototype.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.prototype.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},t.prototype.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.prototype.getHSL=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{h:0,s:0,l:0},e=this.r,i=this.g,n=this.b,r=Math.max(e,i,n),a=Math.min(e,i,n),o=void 0,s=void 0,u=(a+r)/2;if(a==r)o=0,s=0;else{var l=r-a;switch(s=u<=.5?l/(r+a):l/(2-r-a),r){case e:o=(i-n)/l+(i<n?6:0);break;case i:o=(n-e)/l+2;break;case n:o=(e-i)/l+4}o/=6}return t.h=o,t.s=s,t.l=u,t},t.prototype.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},t.prototype.offsetHSL=function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},t.prototype.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},t.prototype.addColors=function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},t.prototype.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},t.prototype.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},t.prototype.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},t.prototype.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},t.prototype.lerp=function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},t.prototype.lerpHSL=function(t,e){this.getHSL(this.lerpHSLA),t.getHSL(this.lerpHSLB);var i=s["default"].lerp(this.lerpHSLA.h,this.lerpHSLB.h,e),n=s["default"].lerp(this.lerpHSLA.s,this.lerpHSLB.s,e),r=s["default"].lerp(this.lerpHSLA.l,this.lerpHSLB.l,e);return this.setHSL(i,n,r),this},t.prototype.equals=function(t){return t.r==this.r&&t.g==this.g&&t.b==this.b},t.prototype.fromArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},t}();e["default"]=u,u.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,
lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Events={Earth:{Resize:"EarthResize",HandlerChange:"EarthHandlerChange",Renderer:"EarthRenderer",ScaleChange:"EarthScaleChange",CenterChange:"EarthCenterChange",ZoomChange:"EarthZoomChange",AngleChange:"EarthAngleChange",Finish:"EarthFinish",CameraChange:"CameraChange",ChangeFloor:"EarthChangeFloor",CloseBuild:"EarthCloseBuild",FloorLoad:"EarthFloorLoad",OpenedBuild:"EarthOpenedBuild",OpenBuild:"EarthOpenBuild"},Mouse:{KeyDown:"KeyDown",KeyUp:"KeyUp",Wheel:"MouseWheel",Rotate:"MouseRotate",Drag:"MouseDrag",Move:"MouseMove",Down:"MouseDown",Up:"MouseUp",RightClick:"MouseRightClick",RotateEnd:"MouseRotateEnd",DragEnd:"MouseDragEnd",Click:"MouseClick",DBClick:"MouseDBClick"},Mesh:{Click:"MeshClick",UnClick:"MeshUnClick",Hover:"MeshHover",UnHover:"MeshUnHover",SaveState:"MeshSaveState"},Fly:{Start:"FlyStart",Pause:"FlyPause",Finish:"FlyFinish",FlyIng:"FlyIngUpdate"}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=function(){function t(){(0,a["default"])(this,t),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return t.prototype.set=function(t,e,i,n,r,a,o,s,u,l,h,d,f,c,p,v){var m=this.elements;return m[0]=t,m[4]=e,m[8]=i,m[12]=n,m[1]=r,m[5]=a,m[9]=o,m[13]=s,m[2]=u,m[6]=l,m[10]=h,m[14]=d,m[3]=f,m[7]=c,m[11]=p,m[15]=v,this},t.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.prototype.clone=function(){return(new t).fromArray(this.elements)},t.prototype.copy=function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},t.prototype.copyPosition=function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},t.prototype.extractBasis=function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},t.prototype.makeBasis=function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},t.prototype.extractRotation=function(t){this.extractRotationVector3||(this.extractRotationVector3=new s["default"]);var e=this.elements,i=t.elements,n=1/this.extractRotationVector3.setFromMatrixColumn(t,0).length(),r=1/this.extractRotationVector3.setFromMatrixColumn(t,1).length(),a=1/this.extractRotationVector3.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},t.prototype.makeRotationFromEuler=function(t){var e=this.elements,i=t._x,n=t._y,r=t._z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),u=Math.sin(n),l=Math.cos(r),h=Math.sin(r);if("XYZ"==t._order){var d=a*l,f=a*h,c=o*l,p=o*h;e[0]=s*l,e[4]=-s*h,e[8]=u,e[1]=f+c*u,e[5]=d-p*u,e[9]=-o*s,e[2]=p-d*u,e[6]=c+f*u,e[10]=a*s}else if("YXZ"==t._order){var v=s*l,m=s*h,g=u*l,y=u*h;e[0]=v+y*o,e[4]=g*o-m,e[8]=a*u,e[1]=a*h,e[5]=a*l,e[9]=-o,e[2]=m*o-g,e[6]=y+v*o,e[10]=a*s}else if("ZXY"==t._order){var _=s*l,x=s*h,b=u*l,M=u*h;e[0]=_-M*o,e[4]=-a*h,e[8]=b+x*o,e[1]=x+b*o,e[5]=a*l,e[9]=M-_*o,e[2]=-a*u,e[6]=o,e[10]=a*s}else if("ZYX"==t._order){var w=a*l,S=a*h,P=o*l,A=o*h;e[0]=s*l,e[4]=P*u-S,e[8]=w*u+A,e[1]=s*h,e[5]=A*u+w,e[9]=S*u-P,e[2]=-u,e[6]=o*s,e[10]=a*s}else if("YZX"==t._order){var C=a*s,T=a*u,E=o*s,D=o*u;e[0]=s*l,e[4]=D-C*h,e[8]=E*h+T,e[1]=h,e[5]=a*l,e[9]=-o*l,e[2]=-u*l,e[6]=T*h+E,e[10]=C-D*h}else if("XZY"==t._order){var L=a*s,F=a*u,k=o*s,I=o*u;e[0]=s*l,e[4]=-h,e[8]=u*l,e[1]=L*h+I,e[5]=a*l,e[9]=F*h-k,e[2]=k*h-F,e[6]=o*l,e[10]=I*h+L}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},t.prototype.makeRotationFromQuaternion=function(t){return this.makeRotationFromQuaternionZero||(this.makeRotationFromQuaternionZero=new s["default"](0,0,0),this.makeRotationFromQuaternionOne=new s["default"](1,1,1)),this.compose(this.makeRotationFromQuaternionZero,t,this.makeRotationFromQuaternionOne)},t.prototype.lookAt=function(t,e,i){this.lookAtX||(this.lookAtX=new s["default"],this.lookAtY=new s["default"],this.lookAtZ=new s["default"]);var n=this.elements;return this.lookAtZ.subVectors(t,e),0==this.lookAtZ.lengthSq()&&(this.lookAtZ.z=1),this.lookAtZ.normalize(),this.lookAtX.crossVectors(i,this.lookAtZ),0==this.lookAtX.lengthSq()&&(1==Math.abs(i.z)?this.lookAtZ.x+=1e-4:this.lookAtZ.z+=1e-4,this.lookAtZ.normalize(),this.lookAtX.crossVectors(i,this.lookAtZ)),this.lookAtX.normalize(),this.lookAtY.crossVectors(this.lookAtZ,this.lookAtX),n[0]=this.lookAtX.x,n[4]=this.lookAtY.x,n[8]=this.lookAtZ.x,n[1]=this.lookAtX.y,n[5]=this.lookAtY.y,n[9]=this.lookAtZ.y,n[2]=this.lookAtX.z,n[6]=this.lookAtY.z,n[10]=this.lookAtZ.z,this},t.prototype.multiply=function(t,e){return void 0!=e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},t.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},t.prototype.multiplyMatrices=function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[4],s=i[8],u=i[12],l=i[1],h=i[5],d=i[9],f=i[13],c=i[2],p=i[6],v=i[10],m=i[14],g=i[3],y=i[7],_=i[11],x=i[15],b=n[0],M=n[4],w=n[8],S=n[12],P=n[1],A=n[5],C=n[9],T=n[13],E=n[2],D=n[6],L=n[10],F=n[14],k=n[3],I=n[7],O=n[11],N=n[15];return r[0]=a*b+o*P+s*E+u*k,r[4]=a*M+o*A+s*D+u*I,r[8]=a*w+o*C+s*L+u*O,r[12]=a*S+o*T+s*F+u*N,r[1]=l*b+h*P+d*E+f*k,r[5]=l*M+h*A+d*D+f*I,r[9]=l*w+h*C+d*L+f*O,r[13]=l*S+h*T+d*F+f*N,r[2]=c*b+p*P+v*E+m*k,r[6]=c*M+p*A+v*D+m*I,r[10]=c*w+p*C+v*L+m*O,r[14]=c*S+p*T+v*F+m*N,r[3]=g*b+y*P+_*E+x*k,r[7]=g*M+y*A+_*D+x*I,r[11]=g*w+y*C+_*L+x*O,r[15]=g*S+y*T+_*F+x*N,this},t.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},t.prototype.applyToBufferAttribute=function(t){this.applyToBufferAttributeVector3||(this.applyToBufferAttributeVector3=new s["default"]);for(var e=0,i=t.count;e<i;e++)this.applyToBufferAttributeVector3.x=t.getX(e),this.applyToBufferAttributeVector3.y=t.getY(e),this.applyToBufferAttributeVector3.z=t.getZ(e),this.applyToBufferAttributeVector3.applyMatrix4(this),t.setXYZ(e,this.applyToBufferAttributeVector3.x,this.applyToBufferAttributeVector3.y,this.applyToBufferAttributeVector3.z);return t},t.prototype.determinant=function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],a=t[1],o=t[5],s=t[9],u=t[13],l=t[2],h=t[6],d=t[10],f=t[14],c=t[3],p=t[7],v=t[11],m=t[15];return c*(+r*s*h-n*u*h-r*o*d+i*u*d+n*o*f-i*s*f)+p*(+e*s*f-e*u*d+r*a*d-n*a*f+n*u*l-r*s*l)+v*(+e*u*h-e*o*f-r*a*h+i*a*f+r*o*l-i*u*l)+m*(-n*o*l-e*s*h+e*o*d+n*a*h-i*a*d+i*s*l)},t.prototype.transpose=function(){var t=this.elements,e=void 0;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},t.prototype.setPosition=function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},t.prototype.getInverse=function(t){var e=this.elements,i=t.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],u=i[5],l=i[6],h=i[7],d=i[8],f=i[9],c=i[10],p=i[11],v=i[12],m=i[13],g=i[14],y=i[15],_=f*g*h-m*c*h+m*l*p-u*g*p-f*l*y+u*c*y,x=v*c*h-d*g*h-v*l*p+s*g*p+d*l*y-s*c*y,b=d*m*h-v*f*h+v*u*p-s*m*p-d*u*y+s*f*y,M=v*f*l-d*m*l-v*u*c+s*m*c+d*u*g-s*f*g,w=n*_+r*x+a*b+o*M;if(0==w)return this.identity();var S=1/w;return e[0]=_*S,e[1]=(m*c*o-f*g*o-m*a*p+r*g*p+f*a*y-r*c*y)*S,e[2]=(u*g*o-m*l*o+m*a*h-r*g*h-u*a*y+r*l*y)*S,e[3]=(f*l*o-u*c*o-f*a*h+r*c*h+u*a*p-r*l*p)*S,e[4]=x*S,e[5]=(d*g*o-v*c*o+v*a*p-n*g*p-d*a*y+n*c*y)*S,e[6]=(v*l*o-s*g*o-v*a*h+n*g*h+s*a*y-n*l*y)*S,e[7]=(s*c*o-d*l*o+d*a*h-n*c*h-s*a*p+n*l*p)*S,e[8]=b*S,e[9]=(v*f*o-d*m*o-v*r*p+n*m*p+d*r*y-n*f*y)*S,e[10]=(s*m*o-v*u*o+v*r*h-n*m*h-s*r*y+n*u*y)*S,e[11]=(d*u*o-s*f*o-d*r*h+n*f*h+s*r*p-n*u*p)*S,e[12]=M*S,e[13]=(d*m*a-v*f*a+v*r*c-n*m*c-d*r*g+n*f*g)*S,e[14]=(v*u*a-s*m*a-v*r*l+n*m*l+s*r*g-n*u*g)*S,e[15]=(s*f*a-d*u*a+d*r*l-n*f*l-s*r*c+n*u*c)*S,this},t.prototype.scale=function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},t.prototype.getMaxScaleOnAxis=function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},t.prototype.makeTranslation=function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},t.prototype.makeRotationX=function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},t.prototype.makeRotationY=function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},t.prototype.makeRotationZ=function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},t.prototype.makeRotationAxis=function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,a=t.x,o=t.y,s=t.z,u=r*a,l=r*o;return this.set(u*a+i,u*o-n*s,u*s+n*o,0,u*o+n*s,l*o+i,l*s-n*a,0,u*s-n*o,l*s+n*a,r*s*s+i,0,0,0,0,1),this},t.prototype.makeScale=function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},t.prototype.makeShear=function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},t.prototype.compose=function(t,e,i){var n=this.elements,r=e._x,a=e._y,o=e._z,s=e._w,u=r+r,l=a+a,h=o+o,d=r*u,f=r*l,c=r*h,p=a*l,v=a*h,m=o*h,g=s*u,y=s*l,_=s*h,x=i.x,b=i.y,M=i.z;return n[0]=(1-(p+m))*x,n[1]=(f+_)*x,n[2]=(c-y)*x,n[3]=0,n[4]=(f-_)*b,n[5]=(1-(d+m))*b,n[6]=(v+g)*b,n[7]=0,n[8]=(c+y)*M,n[9]=(v-g)*M,n[10]=(1-(d+p))*M,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},t.prototype.decompose=function(e,i,n){this.decomposeVector3||(this.decomposeVector3=new s["default"],this.decomposeMatrix4=new t);var r=this.elements,a=this.decomposeVector3.set(r[0],r[1],r[2]).length(),o=this.decomposeVector3.set(r[4],r[5],r[6]).length(),u=this.decomposeVector3.set(r[8],r[9],r[10]).length(),l=this.determinant();l<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],this.decomposeMatrix4.copy(this);var h=1/a,d=1/o,f=1/u;return this.decomposeMatrix4.elements[0]*=h,this.decomposeMatrix4.elements[1]*=h,this.decomposeMatrix4.elements[2]*=h,this.decomposeMatrix4.elements[4]*=d,this.decomposeMatrix4.elements[5]*=d,this.decomposeMatrix4.elements[6]*=d,this.decomposeMatrix4.elements[8]*=f,this.decomposeMatrix4.elements[9]*=f,this.decomposeMatrix4.elements[10]*=f,i.setFromRotationMatrix(this.decomposeMatrix4),n.x=a,n.y=o,n.z=u,this},t.prototype.makePerspective=function(t,e,i,n,r,a){var o=this.elements,s=2*r/(e-t),u=2*r/(i-n),l=(e+t)/(e-t),h=(i+n)/(i-n),d=-(a+r)/(a-r),f=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},t.prototype.makeOrthographic=function(t,e,i,n,r,a){var o=this.elements,s=1/(e-t),u=1/(i-n),l=1/(a-r),h=(e+t)*s,d=(i+n)*u,f=(a+r)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},t.prototype.equals=function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!=i[n])return!1;return!0},t.prototype.fromArray=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;i<16;i++)this.elements[i]=t[i+e];return this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(69),d=n(h),f=i(7),c=n(f),p=i(37),v=n(p),m=i(14),g=n(m),y=i(50),_=n(y),x=i(4),b=n(x),M=i(18),w=i(22),S=n(w),P=i(20),A=n(P),C=i(364),T=n(C),E=i(66),D=n(E),L=i(24),F=n(L),k=i(23),I=n(k),O=i(123),N=n(O),R=i(61),U=n(R),B=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.type="BufferGeometry"},e.prototype.getIndex=function(){return this.index},e.prototype.setIndex=function(t){Array.isArray(t)?this.index=new(c["default"].arrayMax(t)>65535?M.Uint32BufferAttribute:M.Uint16BufferAttribute)(t,1):this.index=t},e.prototype.addAttribute=function(t,e){return e instanceof M.BufferAttribute||e instanceof D["default"]?"index"==t?(this.setIndex(e),this):(this.attributes[t]=e,this):this.addAttribute(t,new M.BufferAttribute(arguments[1],arguments[2]))},e.prototype.getAttribute=function(t){return this.attributes[t]},e.prototype.removeAttribute=function(t){return delete this.attributes[t],this},e.prototype.addGroup=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:t,count:e,materialIndex:i})},e.prototype.clearGroups=function(){this.groups=[]},e.prototype.setDrawRange=function(t,e){this.drawRange.start=t,this.drawRange.count=e},e.prototype.applyMatrix=function(t){var e=this.attributes.position;void 0!=e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!=i){var n=(new v["default"]).getNormalMatrix(t);n.applyToBufferAttribute(i),i.needsUpdate=!0}return null!=this.boundingBox&&this.computeBoundingBox(),null!=this.boundingSphere&&this.computeBoundingSphere(),this},e.prototype.rotateX=function(t){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeRotationX(t),this.applyMatrix(this.rotateMatrix4),this},e.prototype.rotateY=function(t){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeRotationY(t),this.applyMatrix(this.rotateMatrix4),this},e.prototype.rotateZ=function(t){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeRotationZ(t),this.applyMatrix(this.rotateMatrix4),this},e.prototype.translate=function(t,e,i){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeTranslation(t,e,i),this.applyMatrix(this.rotateMatrix4),this},e.prototype.scale=function(t,e,i){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeScale(t,e,i),this.applyMatrix(this.rotateMatrix4),this},e.prototype.lookAt=function(t){this.lookAtObject||(this.lookAtObject=new A["default"]),this.lookAtObject.lookAt(t),this.lookAtObject.updateMatrix(),this.applyMatrix(this.lookAtObject.matrix)},e.prototype.center=function(){return this.centerOffset||(this.centerOffset=new b["default"]),this.computeBoundingBox(),this.boundingBox.getCenter(this.centerOffset).negate(),this.translate(this.centerOffset.x,this.centerOffset.y,this.centerOffset.z),this},e.prototype.setFromObject=function(t){var e=t.geometry;if(t instanceof N["default"]||t instanceof U["default"]){var i=new M.Float32BufferAttribute(3*e.vertices.length,3),n=new M.Float32BufferAttribute(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length==e.vertices.length){var r=new M.Float32BufferAttribute(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!=e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!=e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t instanceof F["default"]&&e instanceof I["default"]&&this.fromGeometry(e);return this},e.prototype.setFromPoints=function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new M.Float32BufferAttribute(e,3)),this},e.prototype.updateFromObject=function(t){var e=t.geometry;if(t instanceof F["default"]){var i=e.__directGeometry;if(1==e.elementsNeedUpdate&&(i=void 0,e.elementsNeedUpdate=!1),!i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}var n=void 0;return e.verticesNeedUpdate&&(n=this.attributes.position,void 0!=n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),e.normalsNeedUpdate&&(n=this.attributes.normal,void 0!=n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),e.colorsNeedUpdate&&(n=this.attributes.color,void 0!=n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!=n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!=n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},e.prototype.fromGeometry=function(t){return t.__directGeometry=(new T["default"]).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},e.prototype.fromDirectGeometry=function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new M.BufferAttribute(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new M.BufferAttribute(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new M.BufferAttribute(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new M.BufferAttribute(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new M.BufferAttribute(a,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(var o in t.morphTargets){for(var s=[],u=t.morphTargets[o],l=0,h=u.length;l<h;l++){var d=u[l],f=new M.Float32BufferAttribute(3*d.length,3);s.push(f.copyVector3sArray(d))}this.morphAttributes[o]=s}if(t.skinIndices.length>0){var c=new M.Float32BufferAttribute(4*t.skinIndices.length,4);this.addAttribute("skinIndex",c.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new M.Float32BufferAttribute(4*t.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!=t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!=t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},e.prototype.computeBoundingBox=function(){this.boundingBox||(this.boundingBox=new d["default"]);var t=this.attributes.position;t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty()},e.prototype.computeBoundingSphere=function(){this.computeBoundingSphereBox||(this.computeBoundingSphereBox=new d["default"],this.computeBoundingSphereVector=new b["default"]),this.boundingSphere||(this.boundingSphere=new _["default"]);var t=this.attributes.position;if(t){var e=this.boundingSphere.center;this.computeBoundingSphereBox.setFromBufferAttribute(t),this.computeBoundingSphereBox.getCenter(e);for(var i=0,n=0,r=t.count;n<r;n++)this.computeBoundingSphereVector.x=t.getX(n),this.computeBoundingSphereVector.y=t.getY(n),this.computeBoundingSphereVector.z=t.getZ(n),i=Math.max(i,e.distanceToSquared(this.computeBoundingSphereVector));this.boundingSphere.radius=Math.sqrt(i)}},e.prototype.computeFaceNormals=function(){},e.prototype.computeVertexNormals=function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;e.normal&&0!=e.normal.array.length||this.addAttribute("normal",new M.BufferAttribute(new Float32Array(n.length),3));var r=e.normal.array,a=void 0,o=void 0,s=void 0,u=new b["default"],l=new b["default"],h=new b["default"],d=new b["default"],f=new b["default"];if(t){var c=t.array;0==i.length&&this.addGroup(0,c.length);for(var p=0,v=i.length;p<v;++p)for(var m=i[p],g=m.start,y=m.count,_=g,x=g+y;_<x;_+=3)a=3*c[_+0],o=3*c[_+1],s=3*c[_+2],u.fromArray(n,a),l.fromArray(n,o),h.fromArray(n,s),d.subVectors(h,l),f.subVectors(u,l),d.cross(f),r[a]+=d.x,r[a+1]+=d.y,r[a+2]+=d.z,r[o]+=d.x,r[o+1]+=d.y,r[o+2]+=d.z,r[s]+=d.x,r[s+1]+=d.y,r[s+2]+=d.z}else for(var w=0,S=n.length;w<S;w+=9)u.fromArray(n,w),l.fromArray(n,w+3),h.fromArray(n,w+6),d.subVectors(h,l),f.subVectors(u,l),d.cross(f),r[w]=d.x,r[w+1]=d.y,r[w+2]=d.z,r[w+3]=d.x,r[w+4]=d.y,r[w+5]=d.z,r[w+6]=d.x,r[w+7]=d.y,r[w+8]=d.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},e.prototype.merge=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.attributes;for(var n in i)if(t.attributes[n])for(var r=i[n],a=r.array,o=t.attributes[n],s=o.array,u=o.itemSize,l=0,h=u*e;l<s.length;l++,h++)a[h]=s[l];return this},e.prototype.normalizeNormals=function(){this.normalizeNormalsVector||(this.normalizeNormalsVector=new b["default"]);for(var t=this.attributes.normal,e=0,i=t.count;e<i;e++)this.normalizeNormalsVector.x=t.getX(e),this.normalizeNormalsVector.y=t.getY(e),this.normalizeNormalsVector.z=t.getZ(e),this.normalizeNormalsVector.normalize(),t.setXYZ(e,this.normalizeNormalsVector.x,this.normalizeNormalsVector.y,this.normalizeNormalsVector.z)},e.prototype.toNonIndexed=function(){if(!this.index)return this;var t=new e,i=this.index.array,n=this.attributes;for(var r in n){for(var a=n[r],o=a.array,s=a.itemSize,u=new o.constructor(i.length*s),l=0,h=0,d=0,f=i.length;d<f;d++){l=i[d]*s;for(var c=0;c<s;c++)u[h++]=o[l++]}t.addAttribute(r,new M.BufferAttribute(u,s))}for(var p=this.groups,v=0,m=p.length;v<m;v++){var g=p[v];t.addGroup(g.start,g.count,g.materialIndex)}return t},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){var e=void 0,i=void 0;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var n=t.index;null!=n&&this.setIndex(n.clone());var r=t.attributes;for(var a in r){var o=r[a];this.addAttribute(a,o.clone())}var s=t.morphAttributes;for(var u in s){var l=[],h=s[u];for(e=0,i=h.length;e<i;e++)l.push(h[e].clone());this.morphAttributes[u]=l}var d=t.groups;for(e=0,i=d.length;e<i;e++){var f=d[e];this.addGroup(f.start,f.count,f.materialIndex)}var c=t.boundingBox;null!=c&&(this.boundingBox=c.clone());var p=t.boundingSphere;return null!=p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},e}(S["default"]);e["default"]=B,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Const={EventType:{RCData:"RCData",RC2DData:"RC2DData",DBData:"DBData",InnerData:"InnerData",InnerBusinessData:"InnerBusinessData",FloorData:"FloorData",GdeFloorData:"GdeFloorData",EarthConfig:"EarthConfig",EarthLayers:"EarthLayers",PlaceMarker:"PlaceMarker",FlyData:"FlyData",Marker:"Marker",SynMarker:"SynMarker",SynCamera:"SynCamera",File:"File",Osgb:"Osgb",MapConfig:"MapConfig",MapLayers:"MapLayers",PoiData:"PoiData",WorkerLayer:"WorkerLayer",Road:"Traffic",NavData:"FloorNavDatas",ClusterParam:"ClusterParam"},DrawEventType:{WorkerRoadInit:"WorkerRoadInit",WorkerRoadSizeChange:"WorkerRoadSizeChange",WorkerHotInit:"WorkerHotInit",WorkerHotSizeChange:"WorkerHotSizeChange",WorkerRoadAdd:"WorkerRoadAdd",WorkerRoadDel:"WorkerRoadDel",WorkerRoadDraw:"WorkerRoadDraw",WorkerHotDraw:"WorkerHotDraw",WorkerHotAdd:"WorkerHotAdd",WorkerHotDel:"WorkerHotDel",WorkerColorAdd:"WorkerColorAdd"}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(623),a=n(r);e["default"]=a["default"]||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.BufferAttribute=e.Int8BufferAttribute=e.Uint8BufferAttribute=e.Uint8ClampedBufferAttribute=e.Int16BufferAttribute=e.Uint16BufferAttribute=e.Int32BufferAttribute=e.Uint32BufferAttribute=e.Float32BufferAttribute=e.Float64BufferAttribute=void 0;var r=i(3),a=n(r),o=i(2),s=n(o),u=i(1),l=n(u),h=i(12),d=n(h),f=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments[2];(0,l["default"])(this,t),this.array=e,this.itemSize=i,this.count=void 0!=e?e.length/i:0,this.normalized=1==n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}return t.prototype.onUploadCallback=function(){},t.prototype.setArray=function(t){return this.count=void 0!=t?t.length/this.itemSize:0,this.array=t,this},t.prototype.setDynamic=function(t){return this.dynamic=t,this},t.prototype.copy=function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},t.prototype.copyAt=function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},t.prototype.copyArray=function(t){return this.array.set(t),this},t.prototype.copyColorsArray=function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];a||(a=new d["default"]),e[i++]=a.r,e[i++]=a.g,e[i++]=a.b}return this},t.prototype.copyVector2sArray=function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];e[i++]=a.x,e[i++]=a.y}return this},t.prototype.copyVector3sArray=function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];e[i++]=a.x,e[i++]=a.y,e[i++]=a.z}return this},t.prototype.copyVector4sArray=function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];e[i++]=a.x,e[i++]=a.y,e[i++]=a.z,e[i++]=a.w}return this},t.prototype.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this},t.prototype.getX=function(t){return this.array[t*this.itemSize]},t.prototype.setX=function(t,e){return this.array[t*this.itemSize]=e,this},t.prototype.getY=function(t){return this.array[t*this.itemSize+1]},t.prototype.setY=function(t,e){return this.array[t*this.itemSize+1]=e,this},t.prototype.getZ=function(t){return this.array[t*this.itemSize+2]},t.prototype.setZ=function(t,e){return this.array[t*this.itemSize+2]=e,this},t.prototype.getW=function(t){return this.array[t*this.itemSize+3]},t.prototype.setW=function(t,e){return this.array[t*this.itemSize+3]=e,this},t.prototype.setXY=function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},t.prototype.setXYZ=function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},t.prototype.setXYZW=function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},t.prototype.onUpload=function(t){return this.onUploadCallback=t,this},t.prototype.clone=function(){return new t(this.array,this.itemSize).copy(this)},t}(),c=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Int8Array(i),n,r))}return(0,s["default"])(e,t),e}(f),p=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Uint8Array(i),n,r))}return(0,s["default"])(e,t),e}(f),v=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Uint8ClampedArray(i),n,r))}return(0,s["default"])(e,t),e}(f),m=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Int16Array(i),n,r))}return(0,s["default"])(e,t),e}(f),g=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Uint16Array(i),n,r))}return(0,s["default"])(e,t),e}(f),y=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Int32Array(i),n,r))}return(0,s["default"])(e,t),e}(f),_=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Uint32Array(i),n,r))}return(0,s["default"])(e,t),e}(f),x=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Float32Array(i),n,r))}return(0,s["default"])(e,t),e}(f),b=function(t){function e(i,n,r){return(0,l["default"])(this,e),(0,a["default"])(this,t.call(this,new Float64Array(i),n,r))}return(0,s["default"])(e,t),e}(f);e.Float64BufferAttribute=b,e.Float32BufferAttribute=x,e.Uint32BufferAttribute=_,e.Int32BufferAttribute=y,e.Uint16BufferAttribute=g,e.Int16BufferAttribute=m,e.Uint8ClampedBufferAttribute=v,e.Uint8BufferAttribute=p,e.Int8BufferAttribute=c,e.BufferAttribute=f},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.earth=e,this.init()}return t.prototype.init=function(){},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(22),c=n(f),p=i(4),v=n(p),m=i(119),g=n(m),y=i(60),_=n(y),x=i(14),b=n(x),M=i(37),w=n(M),S=i(366),P=n(S),A=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.onBeforeRender=function(t,e,i,n){},e.prototype.onAfterRender=function(t,e,i){},e.prototype.applyMatrix=function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},e.prototype.applyQuaternion=function(t){return this.quaternion.premultiply(t),this},e.prototype.setRotationFromAxisAngle=function(t,e){this.quaternion.setFromAxisAngle(t,e)},e.prototype.setRotationFromEuler=function(t){this.quaternion.setFromEuler(t,!0)},e.prototype.setRotationFromMatrix=function(t){
this.quaternion.setFromRotationMatrix(t)},e.prototype.setRotationFromQuaternion=function(t){this.quaternion.copy(t)},e.prototype.rotateOnAxis=function(t,e){return this.rotateQuaternion||(this.rotateQuaternion=new _["default"]),this.rotateQuaternion.setFromAxisAngle(t,e),this.quaternion.multiply(this.rotateQuaternion),this},e.prototype.rotateOnWorldAxis=function(t,e){return this.rotateQuaternion||(this.rotateQuaternion=new _["default"]),this.rotateQuaternion.setFromAxisAngle(t,e),this.quaternion.premultiply(this.rotateQuaternion),this},e.prototype.rotateX=function(t){return this.rotateXVector3||(this.rotateXVector3=new v["default"](1,0,0)),this.rotateOnAxis(this.rotateXVector3,t)},e.prototype.rotateY=function(t){return this.rotateYVector3||(this.rotateYVector3=new v["default"](0,1,0)),this.rotateOnAxis(this.rotateYVector3,t)},e.prototype.rotateZ=function(t){return this.rotateZVector3||(this.rotateZVector3=new v["default"](0,0,1)),this.rotateOnAxis(this.rotateZVector3,t)},e.prototype.translateOnAxis=function(t,e){return this.translateOnAxisVector3||(this.translateOnAxisVector3=new v["default"]),this.translateOnAxisVector3.copy(t).applyQuaternion(this.quaternion),this.position.add(this.translateOnAxisVector3.multiplyScalar(e)),this},e.prototype.translateX=function(t){return this.translateXVector3||(this.translateXVector3=new v["default"](1,0,0)),this.translateOnAxis(this.translateXVector3,t)},e.prototype.translateY=function(t){return this.translateYVector3||(this.translateYVector3=new v["default"](0,1,0)),this.translateOnAxis(this.translateYVector3,t)},e.prototype.translateZ=function(t){return this.translateZVector3||(this.translateZVector3=new v["default"](0,0,1)),this.translateOnAxis(this.translateZVector3,t)},e.prototype.localToWorld=function(t){return t.applyMatrix4(this.matrixWorld)},e.prototype.worldToLocal=function(t){return this.worldToLocalMatrix4||(this.worldToLocalMatrix4=new b["default"]),t.applyMatrix4(this.worldToLocalMatrix4.getInverse(this.matrixWorld))},e.prototype.lookAt=function(t,e,i){this.lookAtQuaternion||(this.lookAtQuaternion=new _["default"],this.lookAtMatrix4=new b["default"],this.lookAtTarget=new v["default"],this.lookAtPosition=new v["default"]),t instanceof v["default"]?this.lookAtTarget.copy(t):this.lookAtTarget.set(t,e,i);var n=this.parent;this.updateWorldMatrix(!0,!1),this.lookAtPosition.setFromMatrixPosition(this.matrixWorld),this.isCamera?this.lookAtMatrix4.lookAt(this.lookAtPosition,this.lookAtTarget,this.up):this.lookAtMatrix4.lookAt(this.lookAtTarget,this.lookAtPosition,this.up),this.quaternion.setFromRotationMatrix(this.lookAtMatrix4),n&&(this.lookAtMatrix4.extractRotation(n.matrixWorld),this.lookAtQuaternion.setFromRotationMatrix(this.lookAtMatrix4),this.quaternion.premultiply(this.lookAtQuaternion.inverse()))},e.prototype.updateWorldMatrix=function(t,e){var i=this.parent;if(t&&i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),e)for(var n=this.children,r=0,a=n.length;r<a;r++)n[r].updateWorldMatrix(!1,!0)},e.prototype.add=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t==this?this:(t.parent&&t.parent.remove(t),t.parent=this,t.fireEvent("added",this),this.children.push(t),this)},e.prototype.remove=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return i!=-1&&(t.dispose(),t.parent=null,t.fireEvent("removed",this),this.children.splice(i,1)),this},e.prototype.getWorldPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new v["default"];return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},e.prototype.getWorldQuaternion=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _["default"];return this.quaternionPos||(this.quaternionPos=new v["default"]),this.quaternionScale||(this.quaternionScale=new v["default"]),this.updateMatrixWorld(!0),this.matrixWorld.decompose(this.quaternionPos,t,this.quaternionScale),t},e.prototype.getWorldScale=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new v["default"],e=new v["default"],i=new _["default"];return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,i,t),t},e.prototype.getWorldDirection=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new v["default"];return this.wordDirectionQuaternion||(this.wordDirectionQuaternion=new _["default"]),this.getWorldQuaternion(this.wordDirectionQuaternion),t.set(0,1,0).applyQuaternion(this.wordDirectionQuaternion)},e.prototype.raycast=function(t,e){},e.prototype.traverse=function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},e.prototype.traverseVisible=function(t){if(this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},e.prototype.traverseAncestors=function(t){var e=this.parent;null!=e&&(t(e),e.traverseAncestors(t))},e.prototype.updateMatrixWorld=function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},e.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},e.prototype.clone=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(new e).copy(this,t)},e.prototype.copy=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse((0,a["default"])(t.userData)),e)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Object3D",this.children=new Array,this.up=new v["default"](0,1,0),this.position=new v["default"],this.rotation=new g["default"],this.quaternion=new _["default"],this.scale=new v["default"](1,1,1),this.modelViewMatrix=new b["default"],this.normalMatrix=new w["default"],this.matrix=new b["default"],this.matrixWorld=new b["default"],this.matrixAutoUpdate=e.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new P["default"],this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.initChangeEvents()},e.prototype.initChangeEvents=function(){var t=this;this.rotation.onChange(function(){t.quaternion.setFromEuler(t.rotation,!1)}),this.quaternion.onChange(function(){t.rotation.setFromQuaternion(t.quaternion,void 0,!1)})},e.prototype.dispose=function(){this.geometry&&this.geometry.dispose(),this.material&&(Array.isArray(this.material)?this.material.forEach(function(t){t.dispose()}):this.material.dispose(),t.prototype.dispose.call(this))},e}(c["default"]);e["default"]=A,A.DefaultMatrixAutoUpdate=!0,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(18),c=i(15),p=n(c),v=i(68),m=n(v),g=i(5),y=n(g),_=i(24),x=n(_),b=i(11),M=n(b),w=i(8),S=i(13),P=i(6),A=n(P),C=i(31),T=function(t){function e(i,n){return(0,s["default"])(this,e),(0,l["default"])(this,t.call(this,null,null,i,n))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Model"},e.prototype.init=function(t,e){var i=this;this.earth=e,this.geometry=new p["default"],this.material=new m["default"](this.getMaterialCfg()),(0,a["default"])(t.shapes).map(function(e){i.geometry.addAttribute(e,(new f.BufferAttribute).copy(t.shapes[e]))}),this.transPosition(t),this.initShadow()},e.prototype.initShadow=function(){this.castShadow="1"==this.userData.cast_shadow,this.receiveShadow="1"==this.userData.receive_shadow},e.prototype.initDefaultGeo=function(t,e){},e.prototype.transPosition=function(t){t.position&&this.position.set(t.position.x,t.position.y,t.position.z)},e.prototype.getMaterialCfg=function(){var t={transparent:1!=(this.userData.opacity||1),opacity:1*(this.userData.opacity||1)};return A["default"].isEmpty(this.userData.color)||(t.color="#"+this.userData.color),t},e.prototype.changeColor=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=this.material),Array.isArray(e)?e.forEach(function(e){i||(e.oldColor=e.oldColor||e.color.clone()),e.color.set(t),e.needsUpdate=!0}):(i||(e.oldColor=e.oldColor||e.color.clone()),e.color.set(t),e.needsUpdate=!0)},e.prototype.changeOpacity=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this,r=arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3;r||(r=this.material);var o={s:t},s={s:e};this.tween&&this.tween.stop(),this.tween=new C.Tween(o).to(s,a).onUpdate(function(){n.setOpacity(o.s,r)}).onComplete(function(){n.tween.stop(),n.tween=null,i&&n.changeOpacity(e,t,i,r,a)}),this.tween.start()},e.prototype.setOpacity=function(t,e){Array.isArray(e)?e.forEach(function(e){e.oldOpacity=void 0==e.oldOpacity?e.opacity:e.oldOpacity,e.opacity=t,e.transparent=!0,e.needsUpdate=!0}):(e.oldOpacity=void 0==e.oldOpacity?e.opacity:e.oldOpacity,e.opacity=t,e.transparent=!0,e.needsUpdate=!0)},e.prototype.resetOpacity=function(t){t||(t=this.material),this.tween&&this.tween.stop(),Array.isArray(t)?t.forEach(function(t){t.opacity=t.oldOpacity,t.transparent=t.opacity<1,t.needsUpdate=!0}):(t.opacity=t.oldOpacity,t.transparent=t.opacity<1,t.needsUpdate=!0)},e.prototype.resetColor=function(t){t||(t=this.material),Array.isArray(t)?t.forEach(function(t){t.oldColor&&t.color.set(t.oldColor.clone()),t.oldColor=null,t.needsUpdate=!0}):(t.oldColor&&t.color.set(t.oldColor.clone()),t.oldColor=null,t.needsUpdate=!0)},e.prototype.click=function(t){this.changeColor("#"+this.earth.confg.ClickColor),this.fireEvent(S.Events.Mesh.Click,this,t),this.earth.fireEvent(S.Events.Mesh.Click,this,t),"1"==this.userData.is_inner&&this.earth.fireEvent(S.Events.Earth.OpenBuild,this,this.userData.id,"",!1,!1)},e.prototype.unClick=function(){this.resetColor(),this.fireEvent(S.Events.Mesh.UnClick,this),this.earth.fireEvent(S.Events.Mesh.UnClick,this)},e.prototype.rightClick=function(t){this.changeColor("#"+this.earth.confg.ClickColor)},e.prototype.saveState=function(){this.earth.fireEvent(S.Events.Mesh.SaveState,this)},e.prototype.hover=function(){this.fireEvent(S.Events.Mesh.Hover,this),this.earth.fireEvent(S.Events.Mesh.Hover,this)},e.prototype.unHover=function(){this.fireEvent(S.Events.Mesh.UnHover,this),this.earth.fireEvent(S.Events.Mesh.UnHover,this)},e.prototype.getInfo=function(t){var e=(new M["default"]).copy(this.position);e.EPSGType=w.Const.EPSGType.EPSGWeb;var i={objType:this.parent?this.parent.userData.objType:t,position:e,userData:this.userData,gtype:3001};return i},e.prototype.update=function(t){this.fireEvent("update",t,this)},e.prototype.removeAll=function(){for(var t=this.children.length-1;t>=0;t--){var e=this.children[t];this.remove(e)}},e.prototype.setPosition=function(t){this.position.copy(t)},e.prototype.getMouseOffset=function(t){return new y["default"](0,0)},e}(x["default"]);e["default"]=T,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(7),c=n(f),p=i(90),v=n(p),m=0,g=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this));return n.initAttributes(),n.toAssign(i),n.initComponent(),n}return(0,d["default"])(e,t),e.prototype.toAssign=function(t){(0,a["default"])(this.userData,t)},e.prototype.initAttributes=function(){this.userData={},this.uuid=c["default"].getUUID(),this.type="Fn",this.id=m++},e.prototype.updateID=function(){this.id=m++},e.prototype.initComponent=function(){},e.prototype.dispose=function(){this.fireEvent("dispose",this)},e}(v["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(69),d=n(h),f=i(12),c=n(f),p=i(37),v=n(p),m=i(14),g=n(m),y=i(50),_=n(y),x=i(5),b=n(x),M=i(4),w=n(M),S=i(91),P=n(S),A=i(22),C=n(A),T=i(20),E=n(T),D=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.applyMatrix=function(t){for(var e=(new v["default"]).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++){var r=this.vertices[i];r.applyMatrix4(t)}for(var a=0,o=this.faces.length;a<o;a++){var s=this.faces[a];s.normal.applyMatrix3(e).normalize();for(var u=0,l=s.vertexNormals.length;u<l;u++)s.vertexNormals[u].applyMatrix3(e).normalize()}return null!=this.boundingBox&&this.computeBoundingBox(),null!=this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},e.prototype.rotateX=function(t){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeRotationX(t),this.applyMatrix(this.rotateMatrix4),this},e.prototype.rotateY=function(t){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeRotationY(t),this.applyMatrix(this.rotateMatrix4),this},e.prototype.rotateZ=function(t){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeRotationZ(t),this.applyMatrix(this.rotateMatrix4),this},e.prototype.translate=function(t,e,i){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeTranslation(t,e,i),this.applyMatrix(this.rotateMatrix4),this},e.prototype.scale=function(t,e,i){return this.rotateMatrix4||(this.rotateMatrix4=new g["default"]),this.rotateMatrix4.makeScale(t,e,i),this.applyMatrix(this.rotateMatrix4),this},e.prototype.lookAt=function(t){this.lookAtObject3D||(this.lookAtObject3D=new E["default"]),this.lookAtObject3D.lookAt(t),this.lookAtObject3D.updateMatrix(),this.applyMatrix(this.lookAtObject3D.matrix)},e.prototype.fromBufferGeometry=function(t){function e(t,e,n,r){var a=void 0==s?[]:[i.colors[t].clone(),i.colors[e].clone(),i.colors[n].clone()],h=void 0==o?[]:[(new w["default"]).fromArray(o,3*t),(new w["default"]).fromArray(o,3*e),(new w["default"]).fromArray(o,3*n)],d=new P["default"](t,e,n,h,a,r);i.faces.push(d),void 0!=u&&i.faceVertexUvs[0].push([(new b["default"]).fromArray(u,2*t),(new b["default"]).fromArray(u,2*e),(new b["default"]).fromArray(u,2*n)]),void 0!=l&&i.faceVertexUvs[1].push([(new b["default"]).fromArray(l,2*t),(new b["default"]).fromArray(l,2*e),(new b["default"]).fromArray(l,2*n)])}var i=this,n=null!=t.index?t.index.array:void 0,r=t.attributes,a=r.position.array,o=void 0!=r.normal?r.normal.array:void 0,s=void 0!=r.color?r.color.array:void 0,u=void 0!=r.uv?r.uv.array:void 0,l=void 0!=r.uv2?r.uv2.array:void 0;void 0!=l&&(this.faceVertexUvs[1]=[]);for(var h=0,d=0;h<a.length;h+=3,d+=2)i.vertices.push((new w["default"]).fromArray(a,h)),void 0!=s&&i.colors.push((new c["default"]).fromArray(s,h));var f=t.groups;if(f.length>0)for(var p=0;p<f.length;p++)for(var v=f[p],m=v.start,g=v.count,y=m,_=m+g;y<_;y+=3)void 0!=n?e(n[y],n[y+1],n[y+2],v.materialIndex):e(y,y+1,y+2,v.materialIndex);else if(void 0!=n)for(var x=0;x<n.length;x+=3)e(n[x],n[x+1],n[x+2]);else for(var M=0;M<a.length/3;M+=3)e(M,M+1,M+2);return this.computeFaceNormals(),null!=t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!=t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},e.prototype.center=function(){return this.centerVector3||(this.centerVector3=new w["default"]),this.computeBoundingBox(),this.boundingBox.getCenter(this.centerVector3).negate(),this.translate(this.centerVector3.x,this.centerVector3.y,this.centerVector3.z),this},e.prototype.normalize=function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0==e?1:1/e,n=new g["default"];return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},e.prototype.computeFaceNormals=function(){for(var t=new w["default"],e=new w["default"],i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},e.prototype.computeVertexNormals=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=void 0,i=void 0,n=void 0,r=void 0,a=void 0,o=void 0;for(o=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)o[e]=new w["default"];if(t){var s=void 0,u=void 0,l=void 0,h=new w["default"],d=new w["default"];for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],s=this.vertices[a.a],u=this.vertices[a.b],l=this.vertices[a.c],h.subVectors(l,u),d.subVectors(s,u),h.cross(d),o[a.a].add(h),o[a.b].add(h),o[a.c].add(h)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)a=this.faces[n],o[a.a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,i=this.vertices.length;e<i;e++)o[e].normalize();for(n=0,r=this.faces.length;n<r;n++){a=this.faces[n];var f=a.vertexNormals;3==f.length?(f[0].copy(o[a.a]),f[1].copy(o[a.b]),f[2].copy(o[a.c])):(f[0]=o[a.a].clone(),f[1]=o[a.b].clone(),f[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},e.prototype.computeFlatVertexNormals=function(){var t=void 0,e=void 0,i=void 0;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){i=this.faces[t];var n=i.vertexNormals;3==n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},e.prototype.computeMorphNormals=function(){var t=void 0,i=void 0,n=void 0,r=void 0,a=void 0;for(n=0,r=this.faces.length;n<r;n++)for(a=this.faces[n],a.__originalFaceNormal?a.__originalFaceNormal.copy(a.normal):a.__originalFaceNormal=a.normal.clone(),a.__originalVertexNormals||(a.__originalVertexNormals=[]),t=0,i=a.vertexNormals.length;t<i;t++)a.__originalVertexNormals[t]?a.__originalVertexNormals[t].copy(a.vertexNormals[t]):a.__originalVertexNormals[t]=a.vertexNormals[t].clone();var o=new e;for(o.faces=this.faces,t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s=this.morphNormals[t].faceNormals,u=this.morphNormals[t].vertexNormals,l=void 0,h=void 0;for(n=0,r=this.faces.length;n<r;n++)l=new w["default"],h={a:new w["default"],b:new w["default"],c:new w["default"]},s.push(l),u.push(h)}var d=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var f=void 0,c=void 0;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],f=d.faceNormals[n],c=d.vertexNormals[n],f.copy(a.normal),c.a.copy(a.vertexNormals[0]),c.b.copy(a.vertexNormals[1]),c.c.copy(a.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],a.normal=a.__originalFaceNormal,a.vertexNormals=a.__originalVertexNormals},e.prototype.computeBoundingBox=function(){null==this.boundingBox&&(this.boundingBox=new d["default"]),this.boundingBox.setFromPoints(this.vertices)},e.prototype.computeBoundingSphere=function(){null==this.boundingSphere&&(this.boundingSphere=new _["default"]),this.boundingSphere.setFromPoints(this.vertices)},e.prototype.merge=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=void 0,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,u=t.faces,l=this.faceVertexUvs[0],h=t.faceVertexUvs[0],d=this.colors,f=t.colors;void 0!=e&&(n=(new v["default"]).getNormalMatrix(e));for(var c=0,p=o.length;c<p;c++){var m=o[c],g=m.clone();void 0!=e&&g.applyMatrix4(e),a.push(g)}for(var y=0,_=f.length;y<_;y++)d.push(f[y].clone());for(var x=0,b=u.length;x<b;x++){var M=u[x],w=void 0,S=void 0,A=void 0,C=M.vertexNormals,T=M.vertexColors;w=new P["default"](M.a+r,M.b+r,M.c+r),w.normal.copy(M.normal),void 0!=n&&w.normal.applyMatrix3(n).normalize();for(var E=0,D=C.length;E<D;E++)S=C[E].clone(),void 0!=n&&S.applyMatrix3(n).normalize(),w.vertexNormals.push(S);w.color.copy(M.color);for(var L=0,F=T.length;L<F;L++)A=T[L],w.vertexColors.push(A.clone());w.materialIndex=M.materialIndex+i,s.push(w)}for(var k=0,I=h.length;k<I;k++){var O=h[k],N=[];if(void 0!=O){for(var R=0,U=O.length;R<U;R++)N.push(O[R].clone());l.push(N)}}},e.prototype.mergeMesh=function(t){t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)},e.prototype.mergeVertices=function(){var t={},e=[],i=[],n=void 0,r=void 0,a=4,o=Math.pow(10,a),s=void 0,u=void 0,l=void 0,h=void 0,d=void 0,f=void 0;for(s=0,u=this.vertices.length;s<u;s++)n=this.vertices[s],r=Math.round(n.x*o)+"_"+Math.round(n.y*o)+"_"+Math.round(n.z*o),void 0==t[r]?(t[r]=s,e.push(this.vertices[s]),i[s]=e.length-1):i[s]=i[t[r]];var c=[];for(s=0,u=this.faces.length;s<u;s++){l=this.faces[s],l.a=i[l.a],l.b=i[l.b],l.c=i[l.c],h=[l.a,l.b,l.c];for(var p=0;p<3;p++)if(h[p]==h[(p+1)%3]){c.push(s);break}}for(s=c.length-1;s>=0;s--){var v=c[s];for(this.faces.splice(v,1),d=0,f=this.faceVertexUvs.length;d<f;d++)this.faceVertexUvs[d].splice(v,1)}var m=this.vertices.length-e.length;return this.vertices=e,m},e.prototype.setFromPoints=function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];this.vertices.push(new w["default"](n.x,n.y,n.z||0))}return this},e.prototype.sortFacesByMaterialIndex=function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,i=e.length,n=0;n<i;n++)e[n]._id=n;e.sort(t);var r=this.faceVertexUvs[0],a=this.faceVertexUvs[1],o=void 0,s=void 0;r&&r.length==i&&(o=[]),a&&a.length==i&&(s=[]);for(var u=0;u<i;u++){var l=e[u]._id;o&&o.push(r[l]),s&&s.push(a[l])}o&&(this.faceVertexUvs[0]=o),s&&(this.faceVertexUvs[1]=s)},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){var e=void 0,i=void 0,n=void 0,r=void 0,a=void 0,o=void 0;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null;var s=t.vertices;for(e=0,i=s.length;e<i;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,i=u.length;e<i;e++)this.colors.push(u[e].clone());var l=t.faces;for(e=0,i=l.length;e<i;e++)this.faces.push(l[e].clone());for(e=0,i=t.faceVertexUvs.length;e<i;e++){var h=t.faceVertexUvs[e];for(void 0==this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),n=0,r=h.length;n<r;n++){var d=h[n],f=[];for(a=0,o=d.length;a<o;a++){var c=d[a];f.push(c.clone())}this.faceVertexUvs[e].push(f)}}var p=t.morphTargets;for(e=0,i=p.length;e<i;e++){var v={};if(v.name=p[e].name,void 0!=p[e].vertices)for(v.vertices=[],n=0,r=p[e].vertices.length;n<r;n++)v.vertices.push(p[e].vertices[n].clone());if(void 0!=p[e].normals)for(v.normals=[],n=0,r=p[e].normals.length;n<r;n++)v.normals.push(p[e].normals[n].clone());this.morphTargets.push(v)}var m=t.morphNormals;for(e=0,i=m.length;e<i;e++){var g={};if(void 0!=m[e].vertexNormals)for(g.vertexNormals=[],n=0,r=m[e].vertexNormals.length;n<r;n++){var y=m[e].vertexNormals[n],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),g.vertexNormals.push(_)}if(void 0!=m[e].faceNormals)for(g.faceNormals=[],n=0,r=m[e].faceNormals.length;n<r;n++)g.faceNormals.push(m[e].faceNormals[n].clone());this.morphNormals.push(g)}var x=t.skinWeights;for(e=0,i=x.length;e<i;e++)this.skinWeights.push(x[e].clone());var b=t.skinIndices;for(e=0,i=b.length;e<i;e++)this.skinIndices.push(b[e].clone());var M=t.lineDistances;for(e=0,i=M.length;e<i;e++)this.lineDistances.push(M[e]);var w=t.boundingBox;null!=w&&(this.boundingBox=w.clone());var S=t.boundingSphere;return null!=S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},e}(C["default"]);e["default"]=D,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(17),s=n(o),u=i(1),l=n(u),h=i(3),d=n(h),f=i(2),c=n(f),p=i(20),v=n(p),m=i(9),g=i(15),y=n(g),_=i(26),x=n(_),b=i(192),M=n(b),w=i(14),S=n(w),P=i(5),A=n(P),C=i(94),T=n(C),E=i(4),D=n(E),L=i(50),F=n(L),k=i(91),I=n(k),O=i(23),N=n(O),R=i(11),U=n(R),B=i(8),j=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{data:{}},a=arguments[3];(0,l["default"])(this,e);var o=(0,d["default"])(this,t.call(this));return o.toAssign(r.data),o.changePositionEPSGType(r),o.init(r,a),o.type="Mesh",o.drawMode=m.TrianglesDrawMode,o.initDefaultGeo(i,n),o}return(0,c["default"])(e,t),e.prototype.changePositionEPSGType=function(t){t&&Array.isArray(t.shapes)&&t.shapes.forEach(function(t){t instanceof U["default"]&&t.changeEPSGType(B.Const.EPSGType.EPSGWeb)})},e.prototype.initDefaultGeo=function(t,e){this.geometry||(this.geometry=void 0!=t?t:new y["default"]),this.material||(this.material=void 0!=e?e:new x["default"]({color:16777215*Math.random()})),this.updateMorphTargets()},e.prototype.init=function(t,e){},e.prototype.setDrawMode=function(t){this.drawMode=t},e.prototype.clone=function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new e(this.geometry,this.material).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e,!0),this.drawMode=e.drawMode,void 0!=e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!=e.morphTargetDictionary&&(this.morphTargetDictionary=(0,s["default"])({},e.morphTargetDictionary)),this},e.prototype.updateMorphTargets=function(){var t=this.geometry,e=void 0,i=void 0,n=void 0;if(t instanceof y["default"]){var r=t.morphAttributes,o=(0,a["default"])(r);if(o.length>0){var s=r[o[0]];if(void 0!=s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,i=s.length;e<i;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var u=t.morphTargets;if(void 0!=u&&u.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,i=u.length;e<i;e++)n=u[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.raycastInverseMatrix=new S["default"],this.raycastRay=new T["default"],this.raycastSphere=new F["default"],this.raycastVA=new D["default"],this.raycastVB=new D["default"],this.raycastVC=new D["default"],this.raycastTempA=new D["default"],this.raycastTempB=new D["default"],this.raycastTempC=new D["default"],this.raycastIntersectionPoint=new D["default"],this.raycastIntersectionPointWorld=new D["default"],this.raycastUvA=new A["default"],this.raycastUvB=new A["default"],this.raycastUvC=new A["default"]},e.prototype.raycastCheckIntersection=function(t,e,i,n,r,a,o,s){var u=void 0;if(u=e.side==m.BackSide?n.intersectTriangle(o,a,r,!0,s):n.intersectTriangle(r,a,o,e.side!=m.DoubleSide,s),!u)return null;this.raycastIntersectionPointWorld.copy(s),this.raycastIntersectionPointWorld.applyMatrix4(t.matrixWorld);var l=i.ray.origin.distanceTo(this.raycastIntersectionPointWorld);return l<i.near||l>i.far?null:{distance:l,point:this.raycastIntersectionPointWorld.clone(),object:t}},e.prototype.raycastCheckBufferGeometryIntersection=function(t,e,i,n,r,a,o,s,u){this.raycastVA.fromBufferAttribute(r,o),this.raycastVB.fromBufferAttribute(r,s),this.raycastVC.fromBufferAttribute(r,u);var l=this.raycastCheckIntersection(t,e,i,n,this.raycastVA,this.raycastVB,this.raycastVC,this.raycastIntersectionPoint);if(l){a&&(this.raycastUvA.fromBufferAttribute(a,o),this.raycastUvB.fromBufferAttribute(a,s),this.raycastUvC.fromBufferAttribute(a,u),l.uv=M["default"].getUV(this.raycastIntersectionPoint,this.raycastVA,this.raycastVB,this.raycastVC,this.raycastUvA,this.raycastUvB,this.raycastUvC,new A["default"]));var h=new I["default"](o,s,u);M["default"].getNormal(this.raycastVA,this.raycastVB,this.raycastVC,h.normal),l.face=h}return l},e.prototype.raycast=function(t,e){var i=this.geometry,n=this.material,r=this.matrixWorld;if(n&&(i.boundingSphere||i.computeBoundingSphere(),this.raycastSphere.copy(i.boundingSphere),this.raycastSphere.applyMatrix4(r),0!=t.ray.intersectsSphere(this.raycastSphere)&&(this.raycastInverseMatrix.getInverse(r),this.raycastRay.copy(t.ray).applyMatrix4(this.raycastInverseMatrix),!i.boundingBox||0!=this.raycastRay.intersectsBox(i.boundingBox)))){var a=void 0;if(i instanceof y["default"]){var o=void 0,s=void 0,u=void 0,l=i.index,h=i.attributes.position,d=i.attributes.uv,f=i.groups,c=i.drawRange,p=void 0,v=void 0,m=void 0,g=void 0,_=void 0,x=void 0,b=void 0,w=void 0;if(l)if(Array.isArray(n))for(p=0,m=f.length;p<m;p++)for(_=f[p],x=n[_.materialIndex],b=Math.max(_.start,c.start),w=Math.min(_.start+_.count,c.start+c.count),v=b,g=w;v<g;v+=3)o=l.getX(v),s=l.getX(v+1),u=l.getX(v+2),a=this.raycastCheckBufferGeometryIntersection(this,x,t,this.raycastRay,h,d,o,s,u),a&&(a.faceIndex=Math.floor(v/3),e.push(a));else for(b=Math.max(0,c.start),w=Math.min(l.count,c.start+c.count),p=b,m=w;p<m;p+=3)o=l.getX(p),s=l.getX(p+1),u=l.getX(p+2),a=this.raycastCheckBufferGeometryIntersection(this,n,t,this.raycastRay,h,d,o,s,u),a&&(a.faceIndex=Math.floor(p/3),e.push(a));else if(void 0!=h)if(Array.isArray(n))for(p=0,m=f.length;p<m;p++)for(_=f[p],x=n[_.materialIndex],b=Math.max(_.start,c.start),w=Math.min(_.start+_.count,c.start+c.count),v=b,g=w;v<g;v+=3)o=v,s=v+1,u=v+2,a=this.raycastCheckBufferGeometryIntersection(this,x,t,this.raycastRay,h,d,o,s,u),a&&(a.faceIndex=Math.floor(v/3),e.push(a));else for(b=Math.max(0,c.start),w=Math.min(h.count,c.start+c.count),p=b,m=w;p<m;p+=3)o=p,s=p+1,u=p+2,a=this.raycastCheckBufferGeometryIntersection(this,n,t,this.raycastRay,h,d,o,s,u),a&&(a.faceIndex=Math.floor(p/3),e.push(a))}else if(i instanceof N["default"]){var S=void 0,P=void 0,C=void 0,T=Array.isArray(n),E=i.vertices,D=i.faces,L=void 0,F=i.faceVertexUvs[0];F.length>0&&(L=F);for(var k=0,I=D.length;k<I;k++){var O=D[k],R=T?n[O.materialIndex]:n;if(void 0!=R){if(S=E[O.a],P=E[O.b],C=E[O.c],1==R.morphTargets){var U=i.morphTargets,B=this.morphTargetInfluences;this.raycastVA.set(0,0,0),this.raycastVB.set(0,0,0),this.raycastVC.set(0,0,0);for(var j=0,z=U.length;j<z;j++){var G=B[j];if(0!=G){var V=U[j].vertices;this.raycastVA.addScaledVector(this.raycastTempA.subVectors(V[O.a],S),G),this.raycastVB.addScaledVector(this.raycastTempB.subVectors(V[O.b],P),G),
this.raycastVC.addScaledVector(this.raycastTempC.subVectors(V[O.c],C),G)}}this.raycastVA.add(S),this.raycastVB.add(P),this.raycastVC.add(C),S=this.raycastVA,P=this.raycastVB,C=this.raycastVC}if(a=this.raycastCheckIntersection(this,R,t,this.raycastRay,S,P,C,this.raycastIntersectionPoint)){if(L&&L[k]){var W=L[k];this.raycastUvA.copy(W[0]),this.raycastUvB.copy(W[1]),this.raycastUvC.copy(W[2]),a.uv=M["default"].getUV(this.raycastIntersectionPoint,S,P,C,this.raycastUvA,this.raycastUvB,this.raycastUvC,new A["default"])}a.face=O,a.faceIndex=k,e.push(a)}}}}}},e}(v["default"]);e["default"]=j,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.initConfig=function(t){this.config=t,this.EngineIP=t.EngineIP},t.getResolution=function(t){return t/this.IPU/this.DPI},t.WebtoP84=function(t,e){return{x:this.WebtoP84_X(t),y:this.WebtoP84_Y(e)}},t.P84toWeb=function(t,e){return{x:this.P84ToWeb_X(t),y:this.P84ToWeb_Y(e)}},t.WebtoP84_Y=function(t){return t/=111319.4907777778,180/Math.PI*(2*Math.atan(Math.exp(t*Math.PI/180))-Math.PI/2)},t.WebtoP84_X=function(t){return t/111319.4907777778},t.P84ToWeb_Y=function(t){return t=Math.log(Math.tan((90+t)*Math.PI/360))/(Math.PI/180),t=111319.4907777778*t},t.P84ToWeb_X=function(t){return 111319.4907777778*t},t.getR10=function(t,e){var i=this.getResolution(e);return parseInt(((this.config.DatumPoint.y-t)/(i*this.config.TileSize)).toString())},t.getC10=function(t,e){var i=this.getResolution(e);return parseInt(((t-this.config.DatumPoint.x)/(i*this.config.TileSize)).toString())},t.getR16=function(t){var e=t.toString(16);return"R"+"00000000".substring(0,8-e.length)+e},t.getC16=function(t){var e=t.toString(16);return"C"+"00000000".substring(0,8-e.length)+e},t.getCDevX=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=this.getResolution(e);return this.config.DatumPoint.x+(t+i)*this.config.TileSize*n},t.getRDevY=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=this.getResolution(e);return this.config.DatumPoint.y-(t+i)*this.config.TileSize*n},t}();e["default"]=o,o.IPU=39.37,o.DPI=96,o.config={},t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(9),c=i(12),p=n(c),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="MeshBasicMaterial",this.color=new p["default"](16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=f.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLineWidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLineWidth=e.wireframeLineWidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=i(9),c=i(37),p=n(c),v=i(5),m=n(v),g=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_IMAGE,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_MAPPING,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.ClampToEdgeWrapping,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f.ClampToEdgeWrapping,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f.LinearFilter,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f.LinearMipMapLinearFilter,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:f.RGBAFormat,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:f.UnsignedByteType,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,v=arguments.length>9&&void 0!==arguments[9]?arguments[9]:f.LinearEncoding;(0,a["default"])(this,e);var g=(0,s["default"])(this,t.call(this));return g.image=i,g.mipmaps=[],g.mapping=n,g.wrapS=r,g.wrapT=o,g.magFilter=u,g.minFilter=l,g.anisotropy=c,g.format=h,g.type=d,g.offset=new m["default"](0,0),g.repeat=new m["default"](1,1),g.center=new m["default"](0,0),g.rotation=0,g.matrixAutoUpdate=!0,g.matrix=new p["default"],g.generateMipmaps=!0,g.premultiplyAlpha=!1,g.flipY=!0,g.unpackAlignment=4,g.encoding=v,g.version=0,g.onUpdate=null,g.needsUpdate=!1,g}return(0,l["default"])(e,t),e.prototype.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},e.prototype.transformUv=function(t){if(this.mapping!=f.UVMapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case f.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case f.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case f.MirroredRepeatWrapping:1==Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case f.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case f.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case f.MirroredRepeatWrapping:1==Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t},e}(d["default"]);e["default"]=g,g.DEFAULT_IMAGE=void 0,g.DEFAULT_MAPPING=f.UVMapping,Object.defineProperty(g.prototype,"needsUpdate",{set:function(t){1==t&&this.version++}}),t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Events={Map:{Resize:"MapResize",HandlerChange:"MapHandlerChange",Renderer:"MapRenderer",ScaleChange:"MapScaleChange",CenterChange:"MapCenterChange",CenterChanged:"MapCenterChanged",ZoomChange:"MapZoomChange",Finish:"MapFinish"},Mouse:{KeyDown:"KeyDown",KeyUp:"KeyUp",Wheel:"MouseWheel",Drag:"MouseDrag",Move:"MouseMove",Down:"MouseDown",Up:"MouseUp",RightClick:"MouseRightClick",DragEnd:"MouseDragEnd",Click:"MouseClick",DBClick:"MouseDBClick"},Mesh:{Click:"MeshClick",UnClick:"MeshUnClick",Hover:"MeshHover",UnHover:"MeshUnHover",SaveState:"MeshSaveState"}}},function(t,e){var i=t.exports={version:"2.6.2"};"number"==typeof __e&&(__e=i)},function(t,e,i){"use strict";function n(t){return"[object Array]"===S.call(t)}function r(t){return"[object ArrayBuffer]"===S.call(t)}function a(t){return"undefined"!=typeof FormData&&t instanceof FormData}function o(t){var e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}function s(t){return"string"==typeof t}function u(t){return"number"==typeof t}function l(t){return"undefined"==typeof t}function h(t){return null!==t&&"object"==typeof t}function d(t){return"[object Date]"===S.call(t)}function f(t){return"[object File]"===S.call(t)}function c(t){return"[object Blob]"===S.call(t)}function p(t){return"[object Function]"===S.call(t)}function v(t){return h(t)&&p(t.pipe)}function m(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}function g(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function y(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function _(t,e){if(null!==t&&"undefined"!=typeof t)if("object"==typeof t||n(t)||(t=[t]),n(t))for(var i=0,r=t.length;i<r;i++)e.call(null,t[i],i,t);else for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.call(null,t[a],a,t)}function x(){function t(t,i){"object"==typeof e[i]&&"object"==typeof t?e[i]=x(e[i],t):e[i]=t}for(var e={},i=0,n=arguments.length;i<n;i++)_(arguments[i],t);return e}function b(t,e,i){return _(e,function(e,n){i&&"function"==typeof e?t[n]=M(e,i):t[n]=e}),t}var M=i(154),w=i(670),S=Object.prototype.toString;t.exports={isArray:n,isArrayBuffer:r,isBuffer:w,isFormData:a,isArrayBufferView:o,isString:s,isNumber:u,isObject:h,isUndefined:l,isDate:d,isFile:f,isBlob:c,isFunction:p,isStream:v,isURLSearchParams:m,isStandardBrowserEnv:y,forEach:_,merge:x,extend:b,trim:g}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Tween=e.TweenEx=void 0;var r=i(1),a=n(r),o=i(10),s=n(o),u={tweens:{},tweensAddedDuringUpdate:{},nextId:0,getAll:function(){return(0,s["default"])(this.tweens).map(function(t){return this.tweens[t]})},removeAll:function(){this.tweens={}},add:function(t){this.tweens[t.getId()]=t,this.tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this.tweens[t.getId()],delete this.tweensAddedDuringUpdate[t.getId()]},update:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(0,s["default"])(this.tweens);if(0===i.length)return!1;for(;i.length>0;){this.tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++)this.tweens[i[n]]&&this.tweens[i[n]].update(this.now())===!1&&!e&&delete this.tweens[i[n]];i=(0,s["default"])(this.tweensAddedDuringUpdate)}return!0},getNextId:function(){return this.nextId++},now:function(){return(new Date).getTime()}},l=function(){function t(e){(0,a["default"])(this,t),this.object=e,this.valuesStart={},this.valuesEnd={},this.valuesStartRepeat={},this.duration=1e3,this.repeat=0,this.repeatDelayTime=void 0,this.yoyo=!1,this.isPlaying=!1,this.reversed=!1,this.delayTime=0,this.startTime=null,this.easingFunction=h.Linear.None,this.interpolationFunction=d.Linear,this.chainedTweens=[],this.onStartCallback=null,this.onStartCallbackFired=!1,this.onUpdateCallback=null,this.onCompleteCallback=null,this.onStopCallback=null,this.id=u.getNextId()}return t.prototype.getId=function(){return this.id},t.prototype.to=function(t,e){return this.valuesEnd=t,void 0!==e&&(this.duration=e),this},t.prototype.start=function(){u.add(this),this.isPlaying=!0,this.onStartCallbackFired=!1,this.startTime=u.now(),this.startTime+=this.delayTime;for(var t in this.valuesEnd){if(Array.isArray(this.valuesEnd[t])){if(0===this.valuesEnd[t].length)continue;this.valuesEnd[t]=[this.object[t]].concat(this.valuesEnd[t])}void 0!==this.object[t]&&(this.valuesStart[t]=this.object[t],Array.isArray(this.valuesStart[t])||(this.valuesStart[t]*=1),this.valuesStartRepeat[t]=this.valuesStart[t]||0)}return this},t.prototype.stop=function(){return this.isPlaying?(u.remove(this),this.isPlaying=!1,null!==this.onStopCallback&&this.onStopCallback.call(this.object,this.object),this.stopChainedTweens(),this):this},t.prototype.end=function(){return this.update(this.startTime+this.duration),this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this.chainedTweens.length;t<e;t++)this.chainedTweens[t].stop()},t.prototype.delay=function(t){return this.delayTime=t,this},t.prototype.setRepeat=function(t){return this.repeat=t,this},t.prototype.repeatDelay=function(t){return this.repeatDelayTime=t,this},t.prototype.setYoyo=function(t){return this.yoyo=t,this},t.prototype.easing=function(t){return this.easingFunction=t,this},t.prototype.interpolation=function(t){return this.interpolationFunction=t,this},t.prototype.chain=function(){return this.chainedTweens=arguments,this},t.prototype.onStart=function(t){return this.onStartCallback=t,this},t.prototype.onUpdate=function(t){return this.onUpdateCallback=t,this},t.prototype.onComplete=function(t){return this.onCompleteCallback=t,this},t.prototype.onStop=function(t){return this.onStopCallback=t,this},t.prototype.update=function(t){var e=void 0,i=void 0,n=void 0;if(t<this.startTime)return!0;this.onStartCallbackFired===!1&&(null!==this.onStartCallback&&this.onStartCallback.call(this.object,this.object),this.onStartCallbackFired=!0),i=(t-this.startTime)/this.duration,i=i>1?1:i,n=this.easingFunction(i);for(e in this.valuesEnd)if(void 0!==this.valuesStart[e]){var r=this.valuesStart[e]||0,a=this.valuesEnd[e];Array.isArray(a)?this.object[e]=this.interpolationFunction(a,n):("string"==typeof a&&(a="+"===a.charAt(0)||"-"===a.charAt(0)?r+parseFloat(a):parseFloat(a)),"number"==typeof a&&(this.object[e]=r+(a-r)*n))}if(null!==this.onUpdateCallback&&this.onUpdateCallback.call(this.object,n),1===i){if(this.repeat>0){isFinite(this.repeat)&&this.repeat--;for(e in this.valuesStartRepeat){if("string"==typeof this.valuesEnd[e]&&(this.valuesStartRepeat[e]=this.valuesStartRepeat[e]+parseFloat(this.valuesEnd[e])),this.yoyo){var o=this.valuesStartRepeat[e];this.valuesStartRepeat[e]=this.valuesEnd[e],this.valuesEnd[e]=o}this.valuesStart[e]=this.valuesStartRepeat[e]}return this.yoyo&&(this.reversed=!this.reversed),void 0!==this.repeatDelayTime?this.startTime=t+this.repeatDelayTime:this.startTime=t+this.delayTime,!0}null!==this.onCompleteCallback&&this.onCompleteCallback.call(this.object,this.object);for(var s=0,u=this.chainedTweens.length;s<u;s++)this.chainedTweens[s].start(this.startTime+this.duration);return!1}return!0},t}(),h={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-this.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*this.Easing.Bounce.In(2*t):.5*this.Easing.Bounce.Out(2*t-1)+.5}}},d={Linear:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),a=this.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],n):e>1?a(t[i],t[i-1],i-n):a(t[r],t[r+1>i?i:r+1],n-r)},Bezier:function(t,e){for(var i=0,n=t.length-1,r=Math.pow,a=this.Interpolation.Utils.Bernstein,o=0;o<=n;o++)i+=r(1-e,n-o)*r(e,o)*t[o]*a(n,o);return i},CatmullRom:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),a=this.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(r=Math.floor(n=i*(1+e))),a(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(a(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):a(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],n-r)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=this.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var t=[1];return function(e){var i=1;if(t[e])return t[e];for(var n=e;n>1;n--)i*=n;return t[e]=i,i}}(),CatmullRom:function(t,e,i,n,r){var a=.5*(i-t),o=.5*(n-e),s=r*r,u=r*s;return(2*e-2*i+a+o)*u+(-3*e+3*i-2*a-o)*s+a*r+e}}};e.TweenEx=u,e.Tween=l},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(22),c=n(f),p=i(12),v=n(p),m=i(14),g=n(m),y=i(4),_=n(y),x=i(27),b=n(x),M=i(572),w=n(M),S=i(9),P=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Material",this.fog=!0,this.lights=!0,this.blending=S.NormalBlending,this.side=S.FrontSide,this.flatShading=!1,this.vertexColors=S.NoColors,this.opacity=1,this.transparent=!1,this.blendSrc=S.SrcAlphaFactor,this.blendDst=S.OneMinusSrcAlphaFactor,this.blendEquation=S.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=S.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.needsUpdate=!0,this.clearInspectArea(),this.clearGridTint(),this.clearFaceClap(),this.clearGradual(),this.clearDigArea()},e.prototype.onBeforeCompile=function(){},e.prototype.setValues=function(t){for(var e in t){var i=t[e];if(void 0!=i)if("shading"!=e){var n=this[e];n instanceof v["default"]?n.set(i):n instanceof _["default"]&&i instanceof _["default"]?n.copy(i):this[e]=i}else this.flatShading=i==S.FlatShading}},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.userData=JSON.parse((0,a["default"])(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(e){var n=e.length;i=new Array(n);for(var r=0;r!=n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this.shadowSide=t.shadowSide,this},e.prototype.setInspectArea=function(t){var e=this;this.inspectArea=1*t.length,t.forEach(function(t,i){e["inspectAreaProjection"+i]=t.projectionMatrix,e["inspectAreaModelView"+i]=t.modelViewMatrix,e["inspectAreaTexture"+i]=t.texture,e["inspectAreaNear"+i]=t.near,e["inspectAreaFar"+i]=t.far}),this.needsUpdate=!0},e.prototype.clearInspectArea=function(){var t=this;this.inspectArea=0,[0,1,2].forEach(function(e){t["inspectAreaProjection"+e]=new g["default"],t["inspectAreaModelView"+e]=new g["default"],t["inspectAreaTexture"+e]=new b["default"],t["inspectAreaNear"+e]=.1,t["inspectAreaFar"+e]=.1}),this.needsUpdate=!0},e.prototype.setGridTint=function(t,e,i){this.gridTint=1,this.gridTintProjection=t,this.gridTintModelView=e,this.gridTintTexture=i,this.needsUpdate=!0},e.prototype.clearGridTint=function(){this.gridTint=0,this.gridTintProjection=new g["default"],this.gridTintModelView=new g["default"],this.gridTintTexture=new b["default"],this.needsUpdate=!0},e.prototype.setFaceClap=function(t,e,i,n){this.faceClip=1,this.faceClipProjection=t,this.faceClipModelView=e,this.faceClipTexture=i,this.faceClipRotateX=n,this.needsUpdate=!0},e.prototype.clearFaceClap=function(){this.faceClip=0,this.faceClipProjection=new g["default"],this.faceClipModelView=new g["default"],this.faceClipTexture=new b["default"],this.faceClipRotateX=0,this.needsUpdate=!0},e.prototype.setGradual=function(t,e){var i=w["default"].makeColorBar(e);if(i){this.gradual=2;var n=this;this.gradualTexture=new b["default"];var r=new Image;r.crossOrigin="*",r.onload=function(){n.gradualTexture.image=r,n.gradualTexture.needsUpdate=!0},r.src=i}else this.gradual=1,this.gradualHigh=t;this.needsUpdate=!0},e.prototype.clearGradual=function(){this.gradual=0,this.gradualHigh=0,this.gradualTexture=new b["default"],this.needsUpdate=!0},e.prototype.setDigArea=function(t,e,i){this.digAreaGrid=1,this.digAreaProjectionMatrix=t,this.digAreaModelViewMatrix=e,this.digAreaTexture=i,this.needsUpdate=!0},e.prototype.clearDigArea=function(){this.digAreaGrid=0,this.digAreaProjectionMatrix=new g["default"],this.digAreaModelViewMatrix=new g["default"],this.digAreaTexture=new b["default"],this.needsUpdate=!0},e}(c["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.map=e,this.init()}return t.prototype.init=function(){},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(1),o=r(a),s=i(5),u=r(s),l=i(27),h=r(l),d=i(42),f=n(d),c=i(6),p=r(c),v=function(){function t(){(0,o["default"])(this,t)}return t.createLayer=function(t,e){if(f[t.layer_name]){var i={id:t.id,objType:t.id,group_name:t.group_name,is_grid:t.is_grid,js_type:t.js_type,min_scale:t.min_scale,max_scale:t.max_scale,name:t.name,PObjType:t.pid,visible:t.visible,zindex:t.zindex,canDraw:!0,business:t.business};return new f[t.layer_name](i,e)}return p["default"].warn("\u65e0\u5bf9\u5e94\u56fe\u5c42\u5bf9\u8c61:"+t.layer_name),null},t.getMousePosition=function(t,e,i,n){var r=new u["default"];return r.x=t/i*2-1,r.y=2*-(e/n)+1,r},t.createTexture=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=new h["default"];if(i&&this.imgCache[t])n.image=this.imgCache[t],n.needsUpdate=!0,e&&e(!0);else{var r=new Image;r.crossOrigin="*",r.onload=function(){n.image=r,n.needsUpdate=!0,e&&e(!0)},r.onerror=function(){e&&e(!1)},r.src=t,i&&(this.imgCache[t]=r)}return n},t.removeCache=function(t){var e=this.imgCache[t];e&&delete this.imgCache[t]},t}();e["default"]=v,v.imgCache={},t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(26);Object.defineProperty(e,"MeshBasicMaterial",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(68);Object.defineProperty(e,"MeshLambertMaterial",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(82);Object.defineProperty(e,"MeshPhongMaterial",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(32);Object.defineProperty(e,"Material",{enumerable:!0,get:function(){return n(s)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(32),c=n(f),p=i(46),v=n(p),m=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this));return n.setValues(i),n}return(0,d["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=v["default"].cloneUniforms(e.uniforms),this.defines=(0,a["default"])({},e.defines),this.wireframe=e.wireframe,this.wireframeLineWidth=e.wireframeLineWidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.lineWidth=1,this.wireframe=!1,this.wireframeLineWidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1},e}(c["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=function(){function t(){(0,a["default"])(this,t),this.elements=[1,0,0,0,1,0,0,0,1]}return t.prototype.set=function(t,e,i,n,r,a,o,s,u){var l=this.elements;return l[0]=t,l[1]=n,l[2]=o,l[3]=e,l[4]=r,l[5]=s,l[6]=i,l[7]=a,l[8]=u,this},t.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.prototype.clone=function(){return(new t).fromArray(this.elements)},t.prototype.copy=function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},t.prototype.setFromMatrix4=function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},t.prototype.applyToBufferAttribute=function(t){this.applyToBufferAttributeVector3||(this.applyToBufferAttributeVector3=new s["default"]);for(var e=0,i=t.count;e<i;e++)this.applyToBufferAttributeVector3.x=t.getX(e),this.applyToBufferAttributeVector3.z=t.getZ(e),this.applyToBufferAttributeVector3.applyMatrix3(this),t.setXYZ(e,this.applyToBufferAttributeVector3.x,this.applyToBufferAttributeVector3.y,this.applyToBufferAttributeVector3.z);return t},t.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},t.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},t.prototype.multiplyMatrices=function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[3],s=i[6],u=i[1],l=i[4],h=i[7],d=i[2],f=i[5],c=i[8],p=n[0],v=n[3],m=n[6],g=n[1],y=n[4],_=n[7],x=n[2],b=n[5],M=n[8];return r[0]=a*p+o*g+s*x,r[3]=a*v+o*y+s*b,r[6]=a*m+o*_+s*M,r[1]=u*p+l*g+h*x,r[4]=u*v+l*y+h*b,r[7]=u*m+l*_+h*M,r[2]=d*p+f*g+c*x,r[5]=d*v+f*y+c*b,r[8]=d*m+f*_+c*M,this},t.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},t.prototype.determinant=function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],u=t[7],l=t[8];return e*a*l-e*o*u-i*r*l+i*o*s+n*r*u-n*a*s},t.prototype.getInverse=function(t){var e=t.elements,i=this.elements,n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],h=e[7],d=e[8],f=d*s-u*h,c=u*l-d*o,p=h*o-s*l,v=n*f+r*c+a*p;if(0==v)return this.identity();var m=1/v;return i[0]=f*m,i[1]=(a*h-d*r)*m,i[2]=(u*r-a*s)*m,i[3]=c*m,i[4]=(d*n-a*l)*m,i[5]=(a*o-u*n)*m,i[6]=p*m,i[7]=(r*l-h*n)*m,i[8]=(s*n-r*o)*m,this},t.prototype.transpose=function(){var t=void 0,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},t.prototype.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},t.prototype.transposeIntoArray=function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},t.prototype.setUvTransform=function(t,e,i,n,r,a,o){var s=Math.cos(r),u=Math.sin(r);this.set(i*s,i*u,-i*(s*a+u*o)+a+t,-n*u,n*s,-n*(-u*a+s*o)+o+e,0,0,1)},t.prototype.scale=function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.elements,r=n[0],a=n[3],o=n[6],s=n[1],u=n[4],l=n[7];return n[0]=e*r+i*s,n[3]=e*a+i*u,n[6]=e*o+i*l,n[1]=-i*r+e*s,n[4]=-i*a+e*u,n[7]=-i*o+e*l,this},t.prototype.translate=function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},t.prototype.equals=function(t){for(var e=this.elements,i=t.elements,n=0;n<9;n++)if(e[n]!=i[n])return!1;return!0},t.prototype.fromArray=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;i<9;i++)this.elements[i]=t[i+e];return this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=i(45),c=n(f),p=i(27),v=n(p),m=i(9),g=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o.width=i,o.height=n,o.scissor=new c["default"](0,0,i,n),o.scissorTest=!1,o.viewport=new c["default"](0,0,i,n),o.texture=new v["default"]((void 0),(void 0),r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),o.texture.generateMipmaps=r.generateMipmaps||!1,o.texture.minFilter=void 0!=r.minFilter?r.minFilter:m.LinearFilter,o.depthBuffer=void 0==r.depthBuffer||r.depthBuffer,o.stencilBuffer=void 0==r.stencilBuffer||r.stencilBuffer,o.depthTexture=void 0!=r.depthTexture?r.depthTexture:null,o}return(0,l["default"])(e,t),e.prototype.setSize=function(t,e){this.width==t&&this.height==e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,
this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.toAssign=function(t){this.earth=t,this.type="Controller"},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(398),p=r(c),v=i(79),m=n(v),g=i(48),y=i(25),_=r(y),x=i(6),b=r(x),M=i(21),w=r(M),S=i(44),P=r(S),A=i(13),C=function(t){function e(i,n){(0,u["default"])(this,e);var r=(0,h["default"])(this,t.call(this,i));return r.earth=n,r.init(),r.initStates(),r}return(0,f["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.childLayer=[],this.type="Layer",this.drawMeshs={},this.rcCache={},this.virtual=!1,this.isWait=!1,this.waitFnList=[]},e.prototype.getModel=function(t){return this.drawMeshs[t]},e.prototype.canSelect=function(){return this.userData.canSelect||!1},e.prototype.isGround=function(){return!1},e.prototype.isShow=function(){var t=this.earth.getControl("ViewControl"),e=t.getCameraLength();return e>=1*(this.userData.min_scale||Number.MIN_VALUE)&&e<=1*(this.userData.max_scale||Number.MAX_VALUE)},e.prototype.isVirtual=function(){return this.virtual},e.prototype.canDraw=function(){return void 0!=this.userData.canDraw&&this.userData.canDraw},e.prototype.setVisible=function(t){this.visible=t,this.childLayer.forEach(function(e){e.setVisible(t)}),this.visible?"1"==this.userData.is_grid?this.reloadData():this.reloadDBData():this.removeAll()},e.prototype.remove=function(e){return e.userData.drawNum>1?(e.userData.drawNum-=1,this):(t.prototype.remove.call(this,e),this.earth.fireEvent("disposeMesh",e,this.earth),delete this.drawMeshs[e.userData.id],this)},e.prototype.removeAll=function(){var t=this;(0,o["default"])(this.drawMeshs).map(function(e){var i=t.drawMeshs[e];i.userData.drawNum=1,t.remove(i)}),this.rcCache={}},e.prototype.initModel=function(t){if(!m[t.jsType])return void b["default"].warn("\u6a21\u578b\u5bf9\u8c61\u4e0d\u5b58\u5728:"+t.jsType);if(this.drawMeshs[t.data.id])return void(this.drawMeshs[t.data.id].userData.drawNum+=1);var e=new m[t.jsType](t,this.earth);e.userData.drawNum=1,this.add(e),this.earth.fireEvent("initMesh",e,this.earth)},e.prototype.add=function(e){var i=this;return this.isWait?this.waitFnList.push(function(){i.add(e)}):(t.prototype.add.call(this,e),this.drawMeshs[e.userData.id]=e),this},e.prototype.rcPush=function(t,e){this.rcCache[t]&&(this.rcCache[t].state="load",this.rcCache[t].meshs.push(e))},e.prototype.draw=function(t,e){var i=this;e&&!this.rcCache[e]&&"0_0_0"!=e||(t.add&&t.add.forEach(function(t){if(b["default"].isEmpty(i.userData.PObjType)||b["default"].isEmpty(t.data.pid)||t.data.pid==i.userData.PObjType){var n=i.drawMeshs[t.data.id];n&&i.remove(n),i.initModel(t),b["default"].isEmpty(e)&&(e=P["default"].getRC(i.drawMeshs[t.data.id],i.earth.confg.RCScale)),i.rcPush(e,t.data.id)}}),t.update&&t.update.forEach(function(t){var n=i.drawMeshs[t.data.id];n&&(e=P["default"].getRC(n,i.earth.confg.RCScale),i.rcCache[e]&&b["default"].listSplice(i.rcCache[e].meshs,n.userData.id),n.userData.drawNum=1,i.remove(n),i.initModel(t),e=P["default"].getRC(i.drawMeshs[t.data.id],i.earth.confg.RCScale),i.rcPush(e,t.data.id))}),t["delete"]&&t["delete"].forEach(function(t){var n=i.drawMeshs[t];n&&(n.userData.drawNum=1,i.remove(n),e=P["default"].getRC(n,i.earth.confg.RCScale),i.rcCache[e]&&b["default"].listSplice(i.rcCache[e].meshs,t))}))},e.prototype.reloadData=function(){var t=this,e=this.earth.getService(g.RCService.fnName),i=this.getRCSize();(0,o["default"])(i).map(function(n){var r=i[n].rc;e.refreshData(r.r,r.c,r.s,t.userData.objType,t.userData.condition||"*")})},e.prototype.reloadDBData=function(){var t=this.earth.getService(g.RCService.fnName);t.refreshDBData(this.userData.objType,this.userData.condition||"*")},e.prototype.getRCSize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.earth.getControl("ViewControl"),i=e.getCameraSize(),n=_["default"].getR10(e.target.y+i,this.earth.confg.RCScale),r=_["default"].getR10(e.target.y-i,this.earth.confg.RCScale),a=_["default"].getC10(e.target.x-i,this.earth.confg.RCScale),o=_["default"].getC10(e.target.x+i,this.earth.confg.RCScale);this.restRCCacheState();for(var s=n;s<=r;s++)for(var u=a;u<=o;u++){var l=this.earth.confg.RCScale+"_"+s+"_"+u;this.rcCache[l]?this.rcCache[l].use=!0:(t[l]||(t[l]={rc:{s:this.earth.confg.RCScale,r:s,c:u},objType:[],condition:[]}),t[l].objType.push(this.userData.objType),t[l].condition.push(this.userData.condition||"*"),this.rcCache[l]={use:!0,meshs:[],state:"loading"})}return this.removeRCCache(),t},e.prototype.restRCCacheState=function(){var t=this;(0,o["default"])(this.rcCache).map(function(e){"load"==t.rcCache[e].state&&(t.rcCache[e].use=!1)})},e.prototype.removeRCCache=function(){var t=this;(0,o["default"])(this.rcCache).map(function(e){0==t.rcCache[e].use&&(t.rcCache[e].meshs.forEach(function(e){var i=t.drawMeshs[e];i&&t.remove(i)}),delete t.rcCache[e])})},e.prototype.dispose=function(){var e=this.earth.getService(g.RCService.fnName);e.off(this.userData.objType,this.draw,this),this.earth.off(A.Events.Mouse.Down,this.mouseDown,this),this.earth.off(A.Events.Mouse.Up,this.mouseUp,this),this.removeAll(),t.prototype.dispose.call(this)},e.prototype.exeWaitFn=function(){var t=this;if(!this.isWait){var e=this.waitFnList.pop();e&&e(),this.exeTimer=setTimeout(function(){t.exeWaitFn()},0)}},e.prototype.mouseDown=function(){this.isWait=!0,this.exeTimer&&clearTimeout(this.exeTimer),this.exeTimer=null},e.prototype.mouseUp=function(){this.isWait=!1,this.exeWaitFn()},e.prototype.init=function(){var t=this.earth.getService(g.RCService.fnName);t.on(this.userData.objType,this.draw,this),this.earth.on(A.Events.Mouse.Down,this.mouseDown,this),this.earth.on(A.Events.Mouse.Up,this.mouseUp,this)},e.prototype.initStates=function(){b["default"].isEmpty(this.userData.zindex)||(this.position.z=1*this.userData.zindex),this.visible=0!=this.userData.visible},e.prototype.changeAllMeshsColor=function(t,e){!this.isVirtual()&&this.visible&&(this.traverse(function(i){e.indexOf(i.userData.id)<0&&i instanceof w["default"]&&i.visible&&i.changeColor(t,null,!0)}),this.childLayer.forEach(function(i){i.changeAllMeshsColor(t,e)}))},e.prototype.getAllMeshs=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2];!this.isVirtual()&&this.visible&&(i&&!this.canSelect()||(this.traverse(function(i){e.indexOf(i)<0&&i instanceof w["default"]&&i.visible&&t.push(i)}),this.childLayer.forEach(function(n){n.getAllMeshs(t,e,i)})))},e}(p["default"]);e["default"]=C,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(78),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.earth=e,this.view=this.earth.getControl("ViewControl"),this.select=this.earth.getControl("SelectControl"),this.scale=this.earth.getControl("ScaleControl"),this.orbit=new s["default"](this.view.camera,this.view.target,this.earth),this.orbit.register(),this.select.register(),this.scale.register(),this.earth.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){this.orbit.dispose(),this.select.dispose(),this.scale.dispose(),this.earth.off("dispose",this.dispose,this)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(305);Object.defineProperty(e,"ActiveLayer",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(164);Object.defineProperty(e,"StaticLayer",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(311);Object.defineProperty(e,"OsgbLayer",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(105);Object.defineProperty(e,"MarkerLayer",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(306);Object.defineProperty(e,"ClapLayer",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(308);Object.defineProperty(e,"GridTintLayer",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(310);Object.defineProperty(e,"MarkerStaticLayer",{enumerable:!0,get:function(){return n(h)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.objFn={},this.earth=e,this.worker=e.getService("WorkerService")}return t.prototype.on=function(t,e,i){this.objFn[t]||(this.objFn[t]=[]),this.objFn[t].push({fn:e,scope:i})},t.prototype.off=function(t,e,i){if(this.objFn[t])if(e){for(var n in this.objFn[t])if(this.objFn[t][n].fn===e&&this.objFn[t][n].scope===i){this.objFn[t].splice(n,1);break}0==this.objFn[t].length&&delete this.objFn[t]}else delete this.objFn[t]},t.prototype.fireEvent=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this.objFn[t]&&this.objFn[t].forEach(function(t){t.fn.apply(t.scope,i)})},t.prototype.dispose=function(){this.objFn={}},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(14),s=n(o),u=i(20),l=n(u),h=i(120),d=n(h),f=i(4),c=n(f),p=i(25),v=n(p),m=i(11),g=n(m),y=i(8),_=i(7),x=n(_),b=i(41),M=n(b),w=function(){function t(){(0,a["default"])(this,t)}return t.isPointInScreen=function(t,e){e.updateMatrixWorld(),e.updateProjectionMatrix(),e.matrixWorldInverse.getInverse(e.matrixWorld);var i=new d["default"];return i.setFromMatrix((new s["default"]).multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse)),t instanceof l["default"]?i.intersectsObject(t):t instanceof c["default"]?i.containsPoint(t):void 0},t.getRC=function(t,e){var i=t.position,n=v["default"].getR10(i.y,e),r=v["default"].getC10(i.x,e);return e+"_"+n+"_"+r},t.mathLineInsideBuffer=function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,{});if(Array.isArray(e))for(var n=0;n<e.length;n++)for(var r=0;r<t.length-1;r++){var a=t[r].clone().changeEPSGType(y.Const.EPSGType.EPSGWeb),o=t[r+1].clone().changeEPSGType(y.Const.EPSGType.EPSGWeb);i[e[n].key]||(i[e[n].key]=this.isLineIntersectRectangle(a,o,e[n].value))}return i},t.isLineIntersectRectangle=function(t,e,i){var n=t.y-e.y,r=e.x-t.x,a=t.x*e.y-e.x*t.y;return t.x>=i.minX&&t.x<=i.maxX&&t.y>=i.minY&&t.y<=i.maxY||(e.x>=i.minX&&e.x<=i.maxX&&e.y>=i.minY&&e.y<=i.maxY||(n*i.minX+r*i.maxY+a>=0&&n*i.maxX+r*i.minY+a<=0||n*i.minX+r*i.maxY+a<=0&&n*i.maxX+r*i.minY+a>=0||n*i.minX+r*i.minY+a>=0&&n*i.maxX+r*i.maxY+a<=0||n*i.minX+r*i.minY+a<=0&&n*i.maxX+r*i.maxY+a>=0)&&!(t.x<i.minX&&e.x<i.minX||t.x>i.maxX&&e.x>i.maxX||t.y>i.maxY&&e.y>i.maxY||t.y<i.minY&&e.y<i.minY))},t.mathCircleInsideBuffer=function(t,e,i){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,{});return Array.isArray(e)&&e.forEach(function(e){var r=t.clone().changeEPSGType(y.Const.EPSGType.EPSGWeb),a=new g["default"]((e.value.minX+e.value.maxX)/2,(e.value.minY+e.value.maxY)/2,0,y.Const.EPSGType.EPSGWeb),o=new c["default"](Math.abs(r.x-a.x),Math.abs(r.y-a.y),0),s=new c["default"]((e.value.maxX-e.value.minX)/2,(e.value.maxY-e.value.minY)/2,0),u=o.sub(s);u.setX(Math.max(u.x,0)),u.setY(Math.max(u.y,0)),n[e.key]=u.dot(u)-Math.pow(i,2)<=0}),n},t.mathPolygonInsideBuffer=function(t,e){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,{});if(Array.isArray(e)){var n=1/0,r=-(1/0),a=1/0,o=-(1/0);t.forEach(function(t){var e=t.clone().changeEPSGType(y.Const.EPSGType.EPSGWeb);e.x<n&&(n=e.x),e.x>r&&(r=e.x),e.y<a&&(a=e.y),e.y>o&&(o=e.y)});for(var s=0;s<e.length;s++)for(var u=0;u<t.length-1;u++){var l=t[u].clone().changeEPSGType(y.Const.EPSGType.EPSGWeb),h=t[u+1].clone().changeEPSGType(y.Const.EPSGType.EPSGWeb);if(!i[e[s].key]){var d=new g["default"](e[s].value.minX,e[s].value.minY),f=new g["default"](e[s].value.maxX,e[s].value.maxY);n<=e[s].value.minX&&r>=e[s].value.maxX&&a<=e[s].value.minY&&o>=e[s].value.maxY&&(i[e[s].key]=!0),i[e[s].key]||(i[e[s].key]=this.isPolygonIntersectRectangle(l,h,d,f))}}}return i},t.isPolygonIntersectRectangle=function(t,e,i,n){var r=void 0;return r=Math.max(t.x,e.x)>=Math.min(i.x,n.x)&&Math.max(i.x,n.x)>=Math.min(t.x,e.x)&&Math.max(t.y,e.y)>=Math.min(i.y,n.y)&&Math.max(i.y,n.y)>=Math.min(t.y,e.y)&&(this.crossPoint(t,e,i)*this.crossPoint(t,e,n)<=0&&this.crossPoint(i,n,t)*this.crossPoint(i,n,e)<=0)},t.crossPoint=function(t,e,i){return(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)},t.getXYZ=function(t,e,i){var n=Math.sin(i)*t,r=Math.sin(e)*Math.cos(i)*t,a=Math.cos(e)*Math.cos(i)*t;return new c["default"](a,r,n)},t.createCurvePoints=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t.length>=3){var n=Math.PI/10,r=Math.PI-n;if(0==e)return t;var a=1/e;t.push(t[t.length-1]);for(var o=[],s=0;s<t.length-2;){var u=t[s].clone(),l=t[s+1].clone(),h=t[s+2].clone(),d=u.clone().sub(l),f=h.clone().sub(l),c=d.angleTo(f),p=d.length(),v=f.length();if(o.push(u),c>n&&c<r&&p>i&&v>i){var m=l.clone().lerp(u,i/p),g=l.clone().lerp(h,i/v);o.push(m);for(var y=a;y<.999999;y+=a){var _=y,x=m.clone().lerp(l,_),b=l.clone().lerp(g,_);o.push(x.lerp(b,_))}t[s+1]=g,s++}else s++;s==t.length-2&&o.push(h)}return o}return t},t.getObjectViewScale=function(t,e){var i=.1,n=100,r=t.getControl("ViewControl");if(t.earthHandler instanceof M["default"]){var a=void 0!=e?e.getWorldPosition():t.earthHandler.orbit.target;n=r.camera.position.distanceTo(a);var o=t.getSize();i=2*this.getCameraSizeByPerspectiveCamera(r.camera,t.earthHandler.orbit,n).top/o.height}return i},t.getCameraSizeByPerspectiveCamera=function(t,e,i){var n=t.fov,r=t.aspect,a=void 0!=i?i:e.target.distanceTo(t.position),o=Math.tan(x["default"].degToRad(n)/2)*a,s=o*r;return{top:o||1,right:s}},t}();e["default"]=w,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,a["default"])(this,t),this.x=e,this.y=i,this.z=n,this.w=r}return t.prototype.set=function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},t.prototype.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.setZ=function(t){return this.z=t,this},t.prototype.setW=function(t){return this.w=t,this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!=t.w?t.w:1,this},t.prototype.add=function(t,e){return void 0!=e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},t.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},t.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},t.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},t.prototype.sub=function(t,e){return void 0!=e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},t.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},t.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},t.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.applyMatrix4=function(t){var e=this.x,i=this.y,n=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*e+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*e+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*e+a[7]*i+a[11]*n+a[15]*r,this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t._w);var e=Math.sqrt(1-t._w*t._w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t._x/e,this.y=t._y/e,this.z=t._z/e),this},t.prototype.setAxisAngleFromRotationMatrix=function(t){var e=void 0,i=void 0,n=void 0,r=void 0,a=.01,o=.1,s=t.elements,u=s[0],l=s[4],h=s[8],d=s[1],f=s[5],c=s[9],p=s[2],v=s[6],m=s[10];if(Math.abs(l-d)<a&&Math.abs(h-p)<a&&Math.abs(c-v)<a){if(Math.abs(l+d)<o&&Math.abs(h+p)<o&&Math.abs(c+v)<o&&Math.abs(u+f+m-3)<o)return this.set(1,0,0,0),this;e=Math.PI;var g=(u+1)/2,y=(f+1)/2,_=(m+1)/2,x=(l+d)/4,b=(h+p)/4,M=(c+v)/4;return g>y&&g>_?g<a?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(g),n=x/i,r=b/i):y>_?y<a?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(y),i=x/n,r=M/n):_<a?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(_),i=b/r,n=M/r),this.set(i,n,r,e),this}var w=Math.sqrt((v-c)*(v-c)+(h-p)*(h-p)+(d-l)*(d-l));return Math.abs(w)<.001&&(w=1),this.x=(v-c)/w,this.y=(h-p)/w,this.z=(d-l)/w,this.w=Math.acos((u+f+m-1)/2),this},t.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},t.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},t.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},t.prototype.clampScalar=function(e,i){return this.clampScalarMin||(this.clampScalarMin=new t,this.clampScalarMax=new t),this.clampScalarMin.set(e,e,e,e),this.clampScalarMax.set(i,i,i,i),this.clamp(this.clampScalarMin,this.clampScalarMax)},t.prototype.clampLength=function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},t.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},t.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},t.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},t.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},t.prototype.normalize=function(){return this.divideScalar(this.length()||1)},t.prototype.setLength=function(){return this.normalize().multiplyScalar(length)},t.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},t.prototype.lerpVectors=function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},t.prototype.equals=function(t){return t.x==this.x&&t.y==this.y&&t.z==this.z&&t.w==this.w},t.prototype.fromArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},t.prototype.fromBufferAttribute=function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(12),s=n(o),u=i(37),l=n(u),h=i(14),d=n(h),f=i(5),c=n(f),p=i(4),v=n(p),m=i(45),g=n(m),y=i(27),_=n(y),x=function(){function t(){(0,a["default"])(this,t)}return t.cloneUniforms=function(t){var e={};for(var i in t){e[i]={};for(var n in t[i]){var r=t[i][n];r&&(r instanceof s["default"]||r instanceof l["default"]||r instanceof d["default"]||r instanceof c["default"]||r instanceof v["default"]||r instanceof g["default"]||r instanceof _["default"])?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e},t.mergeUniforms=function(t){for(var e={},i=0;i<t.length;i++){var n=this.cloneUniforms(t[i]);for(var r in n)e[r]=n[r]}return e},t}();e["default"]=x,t.exports=e["default"]},function(t,e,i){t.exports={"default":i(631),__esModule:!0}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(338);Object.defineProperty(e,"RCService",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(332);Object.defineProperty(e,"AttributeService",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(334);Object.defineProperty(e,"FileService",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(335);Object.defineProperty(e,"MarkerService",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(333);Object.defineProperty(e,"CameraService",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(167);Object.defineProperty(e,"InnerService",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(337);Object.defineProperty(e,"PoiService",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(336);Object.defineProperty(e,"NavigateService",{enumerable:!0,get:function(){return n(d)["default"]}});var f=i(166);Object.defineProperty(e,"DataControllerService",{enumerable:!0,get:function(){return n(f)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(108),c=n(f),p=i(7),v=n(p),m=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;(0,s["default"])(this,e);var o=(0,l["default"])(this,t.call(this));return o.fov=i,o.zoom=1,o.near=r,o.aspect=n,o.filmGauge=35,o.filmOffset=0,o.far=a,o.type="PerspectiveCamera",o.updateProjectionMatrix(),o}return(0,d["default"])(e,t),e.prototype.copy=function(e,i){return t.prototype.copy.call(this,e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=(0,a["default"])({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},e.prototype.setFocalLength=function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*v["default"].Rad2Deg*Math.atan(e),this.updateProjectionMatrix()},e.prototype.getFocalLength=function(){var t=Math.tan(.5*v["default"].Deg2Rad*this.fov);return.5*this.getFilmHeight()/t},e.prototype.getEffectiveFOV=function(){return 2*v["default"].Rad2Deg*Math.atan(Math.tan(.5*v["default"].Deg2Rad*this.fov)/this.zoom)},e.prototype.getFilmWidth=function(){return this.filmGauge*Math.min(this.aspect,1)},e.prototype.getFilmHeight=function(){return this.filmGauge/Math.max(this.aspect,1)},e.prototype.setViewOffset=function(t,e,i,n,r,a){this.aspect=t/e,this.view||(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},e.prototype.clearViewOffset=function(){this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},e.prototype.updateProjectionMatrix=function(){var t=this.near,e=t*Math.tan(.5*v["default"].Deg2Rad*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,a=this.view;if(this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*n/o,e-=a.offsetY*i/s,n*=a.width/o,i*=a.height/s}var u=this.filmOffset;0!=u&&(r+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far)},e}(c["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=i(69),l=n(u),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a["default"])(this,t),this.center=e,this.radius=i}return t.prototype.set=function(t,e){return this.center.copy(t),this.radius=e,this},t.prototype.setFromPoints=function(t,e){this.setFromPointsBox3||(this.setFromPointsBox3=new l["default"]);var i=this.center;void 0!=e?i.copy(e):this.setFromPointsBox3.setFromPoints(t).getCenter(i);for(var n=0,r=0,a=t.length;r<a;r++)n=Math.max(n,i.distanceToSquared(t[r]));return this.radius=Math.sqrt(n),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},t.prototype.empty=function(){return this.radius<=0},t.prototype.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},t.prototype.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},t.prototype.intersectsSphere=function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},t.prototype.intersectsBox=function(t){return t.intersectsSphere(this)},t.prototype.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},t.prototype.clampPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"],i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},t.prototype.getBoundingBox=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l["default"];return t.set(this.center,this.center),t.expandByScalar(this.radius),t},t.prototype.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},t.prototype.translate=function(t){return this.center.add(t),this},t.prototype.equals=function(t){return t.center.equals(this.center)&&t.radius==this.radius},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.toAssign=function(t){this.map=t,this.type="Controller"},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.map.on("dispose",this.dispose,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.map.off("dispose",this.dispose,this)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){t.exports=!i(73)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(54),r=i(29),a=i(210),o=i(74),s=i(62),u="prototype",l=function(t,e,i){var h,d,f,c=t&l.F,p=t&l.G,v=t&l.S,m=t&l.P,g=t&l.B,y=t&l.W,_=p?r:r[e]||(r[e]={}),x=_[u],b=p?n:v?n[e]:(n[e]||{})[u];p&&(i=e);for(h in i)d=!c&&b&&void 0!==b[h],d&&s(_,h)||(f=d?b[h]:i[h],_[h]=p&&"function"!=typeof b[h]?i[h]:g&&d?a(f,n):y&&b[h]==f?function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e[u]=t[u],e}(f):m&&"function"==typeof f?a(Function.call,f):f,m&&((_.virtual||(_.virtual={}))[h]=f,t&l.R&&x&&!x[h]&&o(x,h,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)return void t.set(e.subarray(i,i+n),r);for(var a=0;a<n;a++)t[r+a]=e[i+a]},flattenChunks:function(t){var e,i,n,r,a,o;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(o=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)a=t[e],o.set(a,r),r+=a.length;return o}},a={arraySet:function(t,e,i,n,r){for(var a=0;a<n;a++)t[r+a]=e[i+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(n)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(122),s=i(9),u=i(172),l=n(u),h=function(){function t(e,i,n,r){(0,a["default"])(this,t),this.DefaultInterpolation=s.InterpolateLinear,this.initAttributes(e,i,n,r)}return t.prototype.initAttributes=function(t,e,i,n){this.name=t,this.times=l["default"].convertArray(e,this.TimeBufferType),this.values=l["default"].convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()},t.prototype.InterpolantFactoryMethodDiscrete=function(t){return new o.DiscreteInterpolant(this.times,this.values,this.getValueSize(),t)},t.prototype.InterpolantFactoryMethodLinear=function(t){return new o.LinearInterpolant(this.times,this.values,this.getValueSize(),t)},t.prototype.InterpolantFactoryMethodSmooth=function(t){
return new o.CubicInterpolant(this.times,this.values,this.getValueSize(),t)},t.prototype.setInterpolation=function(t){var e=void 0;switch(t){case s.InterpolateDiscrete:e=this.InterpolantFactoryMethodDiscrete;break;case s.InterpolateLinear:e=this.InterpolantFactoryMethodLinear;break;case s.InterpolateSmooth:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("KeyframeTrack:",i),this}return this.createInterpolant=e,this},t.prototype.getInterpolation=function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return s.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return s.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return s.InterpolateSmooth}},t.prototype.getValueSize=function(){return this.values.length/this.times.length},t.prototype.shift=function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},t.prototype.scale=function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},t.prototype.trim=function(t,e){for(var i=this.times,n=i.length,r=0,a=n-1;r!==n&&i[r]<t;)++r;for(;a!==-1&&i[a]>e;)--a;if(++a,0!==r||a!==n){r>=a&&(a=Math.max(a,1),r=a-1);var o=this.getValueSize();this.times=l["default"].arraySlice(i,r,a),this.values=l["default"].arraySlice(this.values,r*o,a*o)}return this},t.prototype.validate=function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"==typeof s&&isNaN(s)){console.error("KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==n&&l["default"].isTypedArray(n))for(var u=0,h=n.length;u!==h;++u){var d=n[u];if(isNaN(d)){console.error("KeyframeTrack: Value is not a valid number.",this,u,d),t=!1;break}}return t},t.prototype.optimize=function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=this.getInterpolation()===s.InterpolateSmooth,r=1,a=t.length-1,o=1;o<a;++o){var u=!1,h=t[o],d=t[o+1];if(h!==d&&(1!==o||h!==h[0]))if(n)u=!0;else for(var f=o*i,c=f-i,p=f+i,v=0;v!==i;++v){var m=e[f+v];if(m!==e[c+v]||m!==e[p+v]){u=!0;break}}if(u){if(o!==r){t[r]=t[o];for(var g=o*i,y=r*i,_=0;_!==i;++_)e[y+_]=e[g+_]}++r}}if(a>0){t[r]=t[a];for(var x=a*i,b=r*i,M=0;M!==i;++M)e[b+M]=e[x+M];++r}return r!==t.length&&(this.times=l["default"].arraySlice(t,0,r),this.values=l["default"].arraySlice(e,0,r*i)),this},t.prototype.clone=function(){var t=l["default"].arraySlice(this.times,0),e=l["default"].arraySlice(this.values,0),i=this.constructor,n=new i(this.name,t,e);return n.createInterpolant=this.createInterpolant,n},t.toJSON=function(t){var e=t.constructor,i=void 0;if(e.toJSON instanceof Function)i=e.toJSON(t);else{i={name:t.name,times:l["default"].convertArray(t.times,Array),values:l["default"].convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(i.interpolation=n)}return i.type=t.ValueTypeName,i},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=i(7),c=n(f),p=i(4),v=n(p),m=i(14),g=n(m),y=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Curve",this.arcLengthDivisions=200},e.prototype.getPoint=function(t,e){return null},e.prototype.getPointAt=function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},e.prototype.getPoints=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},e.prototype.getSpacedPoints=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},e.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},e.prototype.getLengths=function(t){if(t||(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),a+=e.distanceTo(r),n.push(a),r=e;return this.cacheArcLengths=n,n},e.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},e.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),r=0,a=n.length;i=e?e:t*n[a-1];for(var o,s=0,u=a-1;s<=u;)if(r=Math.floor(s+(u-s)/2),o=n[r]-i,o<0)s=r+1;else{if(!(o>0)){u=r;break}u=r-1}if(r=u,n[r]===i)return r/(a-1);var l=n[r],h=n[r+1],d=h-l,f=(i-l)/d,c=(r+f)/(a-1);return c},e.prototype.getTangent=function(t){var e=1e-4,i=t-e,n=t+e;i<0&&(i=0),n>1&&(n=1);var r=this.getPoint(i),a=this.getPoint(n),o=a.clone().sub(r);return o.normalize()},e.prototype.getTangentAt=function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},e.prototype.computeFrenetFrames=function(t,e){var i,n,r,a=new v["default"],o=[],s=[],u=[],l=new v["default"],h=new g["default"];for(i=0;i<=t;i++)n=i/t,o[i]=this.getTangentAt(n),o[i].normalize();s[0]=new v["default"],u[0]=new v["default"];var d=Number.MAX_VALUE,f=Math.abs(o[0].x),p=Math.abs(o[0].y),m=Math.abs(o[0].z);for(f<=d&&(d=f,a.set(1,0,0)),p<=d&&(d=p,a.set(0,1,0)),m<=d&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],l),u[0].crossVectors(o[0],s[0]),i=1;i<=t;i++)s[i]=s[i-1].clone(),u[i]=u[i-1].clone(),l.crossVectors(o[i-1],o[i]),l.length()>Number.EPSILON&&(l.normalize(),r=Math.acos(c["default"].clamp(o[i-1].dot(o[i]),-1,1)),s[i].applyMatrix4(h.makeRotationAxis(l,r))),u[i].crossVectors(o[i],s[i]);if(e===!0)for(r=Math.acos(c["default"].clamp(s[0].dot(s[t]),-1,1)),r/=t,o[0].dot(l.crossVectors(s[0],s[t]))>0&&(r=-r),i=1;i<=t;i++)s[i].applyMatrix4(h.makeRotationAxis(o[i],r*i)),u[i].crossVectors(o[i],s[i]);return{tangents:o,normals:s,binormals:u}},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},e}(d["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.PlaneBufferGeometry=e.PlaneGeometry=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(23),d=n(h),f=i(15),c=n(f),p=i(18),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));return u.type="PlaneGeometry",u.parameters={width:i,height:n,widthSegments:r,heightSegments:o},u.fromBufferGeometry(new m(i,n,r,o)),u.mergeVertices(),u}return(0,l["default"])(e,t),e}(d["default"]),m=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));u.type="PlaneBufferGeometry",u.parameters={width:i,height:n,widthSegments:r,heightSegments:o};var l=i/2,h=n/2,d=Math.floor(r)||1,f=Math.floor(o)||1,c=d+1,v=f+1,m=i/d,g=n/f,y=void 0,_=void 0,x=[],b=[],M=[],w=[];for(_=0;_<v;_++){var S=_*g-h;for(y=0;y<c;y++){var P=y*m-l;b.push(P,-S,0),M.push(0,0,1),w.push(y/d),w.push(1-_/f)}}for(_=0;_<f;_++)for(y=0;y<d;y++){var A=y+c*_,C=y+c*(_+1),T=y+1+c*(_+1),E=y+1+c*_;x.push(A,C,E),x.push(C,T,E)}return u.setIndex(x),u.addAttribute("position",new p.Float32BufferAttribute(b,3)),u.addAttribute("normal",new p.Float32BufferAttribute(M,3)),u.addAttribute("uv",new p.Float32BufferAttribute(w,2)),u}return(0,l["default"])(e,t),e}(c["default"]);e.PlaneGeometry=v,e.PlaneBufferGeometry=m},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=i(12),c=n(f),p=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this));return r.type="Light",r.color=new c["default"](i),r.intensity=n,r.receiveShadow=void 0,r}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=i(4),l=n(u),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,a["default"])(this,t),this._x=e,this._y=i,this._z=n,this._w=r}return t.slerpFlat=function(t,e,i,n,r,a,o){var s=i[n+0],u=i[n+1],l=i[n+2],h=i[n+3],d=r[a+0],f=r[a+1],c=r[a+2],p=r[a+3];if(h!=p||s!=d||u!=f||l!=c){var v=1-o,m=s*d+u*f+l*c+h*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var _=Math.sqrt(y),x=Math.atan2(_,m*g);v=Math.sin(v*x)/_,o=Math.sin(o*x)/_}var b=o*g;if(s=s*v+d*b,u=u*v+f*b,l=l*v+c*b,h=h*v+p*b,v==1-o){var M=1/Math.sqrt(s*s+u*u+l*l+h*h);s*=M,u*=M,l*=M,h*=M}}t[e]=s,t[e+1]=u,t[e+2]=l,t[e+3]=h},t.prototype.set=function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._w)},t.prototype.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._w=t._w,this.onChangeCallback(),this},t.prototype.setFromEuler=function(t,e){var i=t._x,n=t._y,r=t._z,a=t._order,o=Math.cos,s=Math.sin,u=o(i/2),l=o(n/2),h=o(r/2),d=s(i/2),f=s(n/2),c=s(r/2);return"XYZ"==a?(this._x=d*l*h+u*f*c,this._y=u*f*h-d*l*c,this._z=u*l*c+d*f*h,this._w=u*l*h-d*f*c):"YXZ"==a?(this._x=d*l*h+u*f*c,this._y=u*f*h-d*l*c,this._z=u*l*c-d*f*h,this._w=u*l*h+d*f*c):"ZXY"==a?(this._x=d*l*h-u*f*c,this._y=u*f*h+d*l*c,this._z=u*l*c+d*f*h,this._w=u*l*h-d*f*c):"ZYX"==a?(this._x=d*l*h-u*f*c,this._y=u*f*h+d*l*c,this._z=u*l*c-d*f*h,this._w=u*l*h+d*f*c):"YZX"==a?(this._x=d*l*h+u*f*c,this._y=u*f*h+d*l*c,this._z=u*l*c-d*f*h,this._w=u*l*h-d*f*c):"XZY"==a&&(this._x=d*l*h-u*f*c,this._y=u*f*h-d*l*c,this._z=u*l*c+d*f*h,this._w=u*l*h+d*f*c),0!=e&&this.onChangeCallback(),this},t.prototype.setFromAxisAngle=function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},t.prototype.setFromRotationMatrix=function(t){var e=t.elements,i=e[0],n=e[4],r=e[8],a=e[1],o=e[5],s=e[9],u=e[2],l=e[6],h=e[10],d=i+o+h,f=void 0;return d>0?(f=.5/Math.sqrt(d+1),this._w=.25/f,this._x=(l-s)*f,this._y=(r-u)*f,this._z=(a-n)*f):i>o&&i>h?(f=2*Math.sqrt(1+i-o-h),this._w=(l-s)/f,this._x=.25*f,this._y=(n+a)/f,this._z=(r+u)/f):o>h?(f=2*Math.sqrt(1+o-i-h),this._w=(r-u)/f,this._x=(n+a)/f,this._y=.25*f,this._z=(s+l)/f):(f=2*Math.sqrt(1+h-i-o),this._w=(a-n)/f,this._x=(r+u)/f,this._y=(s+l)/f,this._z=.25*f),this.onChangeCallback(),this},t.prototype.setFromUnitVectors=function(t,e){var i=new l["default"],n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?i.set(-t.y,t.x,0):i.set(0,-t.z,t.y)):i.crossVectors(t,e),this._x=i.x,this._y=i.y,this._z=i.z,this._w=n,this.normalize()},t.prototype.angleTo=function(t){return 2*Math.acos(Math.abs(s["default"].clamp(this.dot(t),-1,1)))},t.prototype.rotateTowards=function(t,e){var i=this.angleTo(t);if(0==i)return this;var n=Math.min(1,e/i);return this.slerp(t,n),this},t.prototype.inverse=function(){return this.conjugate()},t.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},t.prototype.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},t.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.prototype.normalize=function(){var t=this.length();return 0==t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},t.prototype.multiply=function(t,e){return void 0!=e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},t.prototype.premultiply=function(t){return this.multiplyQuaternions(t,this)},t.prototype.multiplyQuaternions=function(t,e){var i=t._x,n=t._y,r=t._z,a=t._w,o=e._x,s=e._y,u=e._z,l=e._w;return this._x=i*l+a*o+n*u-r*s,this._y=n*l+a*s+r*o-i*u,this._z=r*l+a*u+i*s-n*o,this._w=a*l-i*o-n*s-r*u,this.onChangeCallback(),this},t.prototype.slerp=function(t,e){if(0==e)return this;if(1==e)return this.copy(t);var i=this._x,n=this._y,r=this._z,a=this._w,o=a*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-e;return this._w=u*a+e*this._w,this._x=u*i+e*this._x,this._y=u*n+e*this._y,this._z=u*r+e*this._z,this.normalize()}var l=Math.sqrt(s),h=Math.atan2(l,o),d=Math.sin((1-e)*h)/l,f=Math.sin(e*h)/l;return this._w=a*d+this._w*f,this._x=i*d+this._x*f,this._y=n*d+this._y*f,this._z=r*d+this._z*f,this.onChangeCallback(),this},t.prototype.equals=function(t){return t._x==this._x&&t._y==this._y&&t._z==this._z&&t._w==this._w},t.prototype.fromArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},t.prototype.setX=function(t){this._x=t,this.onChangeCallback()},t.prototype.setY=function(t){this._y=t,this.onChangeCallback()},t.prototype.setZ=function(t){this._z=t,this.onChangeCallback()},t.prototype.setW=function(t){this._w=t,this.onChangeCallback()},t.prototype.onChange=function(t){return this.onChangeCallback=t,this},t.prototype.onChangeCallback=function(){},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=i(15),c=n(f),p=i(26),v=n(p),m=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{data:{}},o=arguments[3];(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));return r&&u.toAssign(r.data),u.init(r,o),u.mode=0,u.type="Line",u.initDefaultGeo(i,n),u}return(0,l["default"])(e,t),e.prototype.init=function(t,e){},e.prototype.initDefaultGeo=function(t,e){this.geometry||(this.geometry=void 0!=t?t:new c["default"]),this.material||(this.material=void 0!=e?e:new v["default"]({color:16777215*Math.random()}))},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){var n=i(87),r=i(212),a=i(145),o=Object.defineProperty;e.f=i(52)?Object.defineProperty:function(t,e,i){if(n(t),e=a(e,!0),n(i),r)try{return o(t,e,i)}catch(s){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,a["default"])(this,t),this.width=e,this.height=i,this.high=n}return t.prototype.equals=function(t){return this.width==t.width&&this.height==t.height&&t.high==t.high},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i,n){(0,a["default"])(this,t),this.socket=e,this.self=i,this.routes=n,this.init()}return t.prototype.init=function(){},t.prototype.getData=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return[]},i=this;this.socket.sendData(t,function(n){n.applyData=t.applyData;var r=e(n);i.self.postMessage(n,r)})},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(135),a=n(r),o=i(1),s=n(o),u=function(){function t(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,s["default"])(this,t),this.data=e,this.itemSize=i,this.offset=n,this.normalized=r}return t.prototype.setX=function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},t.prototype.setY=function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},t.prototype.setZ=function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},t.prototype.setW=function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},t.prototype.getX=function(t){return this.data.array[t*this.data.stride+this.offset]},t.prototype.getY=function(t){return this.data.array[t*this.data.stride+this.offset+1]},t.prototype.getZ=function(t){return this.data.array[t*this.data.stride+this.offset+2]},t.prototype.getW=function(t){return this.data.array[t*this.data.stride+this.offset+3]},t.prototype.setXY=function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},t.prototype.setXYZ=function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},t.prototype.setXYZW=function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this},t}();e["default"]=u,(0,a["default"])(u.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=i(12),c=n(f),p=i(180),v=n(p),m=i(181),g=n(m),y=i(110),_=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="ShapePath",this.color=new c["default"],this.subPaths=[],this.currentPath=null},e.prototype.moveTo=function(t,e){this.currentPath=new v["default"],this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},e.prototype.lineTo=function(t,e){this.currentPath.lineTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},e.prototype.bezierCurveTo=function(t,e,i,n,r,a){this.currentPath.bezierCurveTo(t,e,i,n,r,a)},e.prototype.splineThru=function(t){this.currentPath.splineThru(t)},e.prototype.toShapes=function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],a=new g["default"];a.curves=r.curves,e.push(a)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,a=0;a<i;r=a++){var o=e[r],s=e[a],u=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=e[a],u=-u,s=e[r],l=-l),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var h=l*(t.x-o.x)-u*(t.y-o.y);if(0===h)return!0;if(h<0)continue;n=!n}}else{if(t.y!=o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return n}var r=y.ShapeUtils.isClockWise,a=this.subPaths;if(0===a.length)return[];if(e===!0)return i(a);var o,s,u,l=[];if(1===a.length)return s=a[0],u=new g["default"],u.curves=s.curves,l.push(u),l;var h=!r(a[0].getPoints());h=t?!h:h;var d,f=[],c=[],p=[],v=0;c[v]=void 0,p[v]=[];for(var m=0,_=a.length;m<_;m++)s=a[m],d=s.getPoints(),o=r(d),o=t?!o:o,o?(!h&&c[v]&&v++,c[v]={s:new g["default"],p:d},c[v].s.curves=s.curves,h&&v++,p[v]=[]):p[v].push({h:s,p:d[0]});if(!c[0])return i(a);if(c.length>1){for(var x=!1,b=[],M=0,w=c.length;M<w;M++)f[M]=[];for(var M=0,w=c.length;M<w;M++)for(var S=p[M],P=0;P<S.length;P++){for(var A=S[P],C=!0,T=0;T<c.length;T++)n(A.p,c[T].p)&&(M!=T&&b.push({froms:M,tos:T,hole:P}),C?(C=!1,f[T].push(A)):x=!0);C&&f[M].push(A)}b.length>0&&(x||(p=f))}for(var E,m=0,D=c.length;m<D;m++){u=c[m].s,l.push(u),E=p[m];for(var L=0,F=E.length;L<F;L++)u.holes.push(E[L].h)}return l},e}(d["default"]);e["default"]=_,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(26),d=n(h),f=i(12),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="MeshLambertMaterial",this.emissive=new c["default"](0),this.emissiveIntensity=1,this.emissiveMap=null,this.morphNormals=!1,this.lights=!0},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.morphNormals=e.morphNormals,this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(23),s=n(o),u=i(50),l=n(u),h=i(4),d=n(h),f=i(15),c=n(f),p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new d["default"]((+(1/0)),(+(1/0)),(+(1/0))),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d["default"]((-(1/0)),(-(1/0)),(-(1/0)));(0,a["default"])(this,t),this.min=e,this.max=i}return t.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},t.prototype.setFromArray=function(t){for(var e=+(1/0),i=+(1/0),n=+(1/0),r=-(1/0),a=-(1/0),o=-(1/0),s=0,u=t.length;s<u;s+=3){var l=t[s],h=t[s+1],d=t[s+2];l<e&&(e=l),h<i&&(i=h),d<n&&(n=d),l>r&&(r=l),h>a&&(a=h),d>o&&(o=d)}return this.min.set(e,i,n),this.max.set(r,a,o),this},t.prototype.setFromBufferAttribute=function(t){for(var e=+(1/0),i=+(1/0),n=+(1/0),r=-(1/0),a=-(1/0),o=-(1/0),s=0,u=t.count;s<u;s++){var l=t.getX(s),h=t.getY(s),d=t.getZ(s);l<e&&(e=l),h<i&&(i=h),d<n&&(n=d),l>r&&(r=l),h>a&&(a=h),d>o&&(o=d)}return this.min.set(e,i,n),this.max.set(r,a,o),this},t.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},t.prototype.setFromCenterAndSize=function(t,e){var i=new d["default"],n=i.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},t.prototype.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},t.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},t.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.prototype.getCenter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new d["default"];return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},t.prototype.getSize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new d["default"];return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},t.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},t.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},t.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},t.prototype.expandByObject=function(t){var e=this;t.updateMatrixWorld(!0);var i=void 0,n=void 0,r=void 0,a=new d["default"];return t.traverse(function(t){var o=t.geometry;if(void 0!=o)if(o instanceof s["default"]){var u=o.vertices;for(n=0,r=u.length;n<r;n++)a.copy(u[n]),a.applyMatrix4(t.matrixWorld),i.expandByPoint(a)}else if(o instanceof c["default"]){var l=o.attributes.position;if(void 0!=l)for(n=0,r=l.count;n<r;n++)a.fromBufferAttribute(l,n).applyMatrix4(t.matrixWorld),e.expandByPoint(a)}}),this},t.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},t.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},t.prototype.getParameter=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d["default"];return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},t.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},t.prototype.intersectsSphere=function(t){return this.intersectsSphereVector3||(this.intersectsSphereVector3=new d["default"]),this.clampPoint(t.center,this.intersectsSphereVector3),this.intersectsSphereVector3.distanceToSquared(t.center)<=t.radius*t.radius},t.prototype.intersectsPlane=function(t){var e=void 0,i=void 0;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant},t.prototype.intersectsTriangle=function(t){},t.prototype.clampPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d["default"];return e.copy(t).clamp(this.min,this.max)},t.prototype.distanceToPoint=function(t){this.distanceToPointVector3||(this.distanceToPointVector3=new d["default"]);var e=this.distanceToPointVector3.copy(t).clamp(this.min,this.max);return e.sub(t).length()},t.prototype.getBoundingSphere=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l["default"];return this.getBoundingSphereVector3||(this.getBoundingSphereVector3=new d["default"]),this.getCenter(t.center),t.radius=.5*this.getSize(this.getBoundingSphereVector3).length(),t},t.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},t.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},t.prototype.applyMatrix4=function(t){return this.applyMatrix4Vector3||(this.applyMatrix4Vector3=[new d["default"],new d["default"],new d["default"],new d["default"],new d["default"],new d["default"],new d["default"],new d["default"]]),this.isEmpty()?this:(this.applyMatrix4Vector3[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),this.applyMatrix4Vector3[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),this.applyMatrix4Vector3[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),this.applyMatrix4Vector3[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),this.applyMatrix4Vector3[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),this.applyMatrix4Vector3[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),this.applyMatrix4Vector3[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),this.applyMatrix4Vector3[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(this.applyMatrix4Vector3),this)},t.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},t.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t}();e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(44),p=r(c),v=i(25),m=r(v),g=i(6),y=r(g),_=i(5),x=r(_),b=i(573),M=r(b),w=i(205),S=n(w),P=i(134),A=r(P),C=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];(0,u["default"])(this,e);var r=(0,h["default"])(this,t.call(this,i));return r.typeInfos={},r.typeInfos=i.objTypes,r.map=n,r.init(),r.initStates(),r}return(0,f["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Layer",this.drawMeshs={},this.elType="canvas",this.rcCache={}},e.prototype.synWorkerDraw=function(){},e.prototype.canDraw=function(){return void 0!=this.userData.canDraw&&this.userData.canDraw},e.prototype.getModel=function(t){return this.drawMeshs[t]},e.prototype.isWorkerDraw=function(){return!1},e.prototype.synCtxToWorker=function(t){},e.prototype.canSelect=function(){return this.userData.canSelect||!1},e.prototype.isGround=function(){return!1},e.prototype.resizeChange=function(){this.scaleChange()},e.prototype.isShow=function(){var t=this.map.getControl("ScaleControl"),e=t.scale;return e>=1*(this.userData.min_scale||Number.MIN_VALUE)&&e<=1*(this.userData.max_scale||Number.MAX_VALUE)},e.prototype.isVirtual=function(){return!1},e.prototype.dragEnd=function(){this.doDragend(),this.needsUpdate=!0},e.prototype.drag=function(t){this.needsUpdate=!0},e.prototype.scaleChange=function(){this.removeAll(),this.drag(new x["default"]),this.dragEnd()},e.prototype.add=function(e){return t.prototype.add.call(this,e),this.drawMeshs[e.userData.id]=e,this.map.fireEvent("initMesh",e,this.map),this},e.prototype.remove=function(e){return e.userData.drawNum>1?(e.userData.drawNum-=1,this):(t.prototype.remove.call(this,e),delete this.drawMeshs[e.userData.id],this.map.fireEvent("disposeMesh",e,this.map),this)},e.prototype.removeAll=function(){var t=this;(0,o["default"])(this.drawMeshs).map(function(e){var i=t.drawMeshs[e];i.userData.drawNum=1,t.remove(i)}),this.rcCache={}},e.prototype.setVisible=function(t){this.visible=t,this.needsUpdate=!0},e.prototype.initStates=function(){this.visible=0!=this.userData.visible},e.prototype.initModel=function(t,e,i){if(!S[e])return void y["default"].warn("\u6a21\u578b\u5bf9\u8c61\u4e0d\u5b58\u5728:"+e);if(this.drawMeshs[t.data.id])return void(this.drawMeshs[t.data.id].userData.drawNum+=1);var n=new S[e](t,this.map);n.userData.drawNum=1,n.userData.objType=i,this.add(n)},e.prototype.getOriginalType=function(t){return this.userData.objTypes[t].js_type},e.prototype.rcPush=function(t,e){this.rcCache[t]&&(this.rcCache[t].state="load",this.rcCache[t].meshs.push(e))},e.prototype.draw=function(t,e,i){var n=this;e&&!this.rcCache[e]&&"0_0_0"!=e||(t.add&&t.add.forEach(function(t){var r=n.getOriginalType(i||t.js_type);
n.initModel(t,r,i),y["default"].isEmpty(e)&&(e=p["default"].getRC(n.drawMeshs[t.data.id],n.map.confg.RCScale)),n.rcPush(e,t.data.id)}),t.update&&t.update.forEach(function(t){var r=n.drawMeshs[t.data.id];if(r){e=p["default"].getRC(r,n.map.confg.RCScale),n.rcCache[e]&&y["default"].listSplice(n.rcCache[e].meshs,r.userData.id),n.remove(r);var a=n.getOriginalType(i||t.js_type);n.initModel(t,a,i),e=p["default"].getRC(n.drawMeshs[t.data.id],n.map.confg.RCScale),n.rcPush(e,t.data.id)}}),t["delete"]&&t["delete"].forEach(function(t){var i=n.drawMeshs[t];i&&(n.remove(i),e=p["default"].getRC(i,n.map.confg.RCScale),n.rcCache[e]&&y["default"].listSplice(n.rcCache[e].meshs,t))}))},e.prototype.doDragend=function(){var t=this,e={},i=this.map.getControl("ScaleControl"),n=i.scale;void 0!=this.typeInfos&&((0,o["default"])(this.typeInfos).map(function(i){var r=t.typeInfos[i],a=r.is_tile||0;e[a]||(e[a]={}),e[a].type||(e[a].type=[]),e[a].condition||(e[a].condition=[]),r.max_scale>=n&&r.min_scale<=n&&(e[a].type.push(r.id),e[a].condition.push(r.condition||"*"))}),(0,o["default"])(e).map(function(i){var n=t.map.getService(A["default"].fnName),r=t.getRCSize();(0,o["default"])(r).map(function(t){var a=r[t].rc;y["default"].isEmpty(e[i].type)||n.refreshData(a.r,a.c,a.s,e[i].type.join(";"),e[i].condition.join(";"))})}))},e.prototype.init=function(){var t=this,e=this.map.getService(A["default"].fnName);this.userData.objTypes&&(0,o["default"])(this.userData.objTypes).map(function(i){e.on(i,t.draw,t)})},e.prototype.dispose=function(){var e=this,i=this.map.getService(A["default"].fnName);this.userData.objTypes&&((0,o["default"])(this.userData.objTypes).map(function(t){i.off(t,e.draw,e)}),this.removeAll(),t.prototype.dispose.call(this))},e.prototype.getAllMeshs=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];!this.isVirtual()&&this.visible&&(n&&!this.canSelect()||this.traverse(function(n){i.indexOf(n)<0&&n instanceof e==0&&n.visible&&t.push(n)}))},e.prototype.getRCSize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.map.getControl("ViewControl"),i=this.map.getSize(),n=m["default"].getR10(e.target.y,this.map.confg.RCScale),r=m["default"].getC10(e.target.x,this.map.confg.RCScale),a=y["default"].getDevicePixelRatio(),o=Math.ceil(i.width/512/a),s=Math.ceil(i.height/512/a),u=n-s,l=r-o,h=n+s,d=r+o;this.restRCCacheState();for(var f=u;f<=h;f++)for(var c=l;c<=d;c++){var p=this.map.confg.RCScale+"_"+f+"_"+c;this.rcCache[p]?this.rcCache[p].use=!0:(t[p]||(t[p]={rc:{s:this.map.confg.RCScale,r:f,c:c},objType:[],condition:[]}),t[p].objType.push(this.userData.objType),t[p].condition.push(this.userData.condition||"*"),this.rcCache[p]={use:!0,meshs:[],state:"loading"})}return this.removeRCCache(),t},e.prototype.restRCCacheState=function(){var t=this;(0,o["default"])(this.rcCache).map(function(e){"load"==t.rcCache[e].state&&(t.rcCache[e].use=!1)})},e.prototype.removeRCCache=function(){var t=this;(0,o["default"])(this.rcCache).map(function(e){0==t.rcCache[e].use&&(t.rcCache[e].meshs.forEach(function(e){var i=t.drawMeshs[e];i&&t.remove(i)}),delete t.rcCache[e])})},e}(M["default"]);e["default"]=C,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(607);Object.defineProperty(e,"DrawLayer",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(204);Object.defineProperty(e,"MarkerLayer",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(609);Object.defineProperty(e,"MeshLayer",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(613);Object.defineProperty(e,"WorkerLayer",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(612);Object.defineProperty(e,"TrafficLayer",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(608);Object.defineProperty(e,"HotLayer",{enumerable:!0,get:function(){return n(l)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.objFn={},this.map=e,this.worker=e.getService("WorkerService")}return t.prototype.on=function(t,e,i){this.objFn[t]||(this.objFn[t]=[]),this.objFn[t].push({fn:e,scope:i})},t.prototype.off=function(t,e,i){if(this.objFn[t])if(e){for(var n in this.objFn[t])if(this.objFn[t][n].fn===e&&this.objFn[t][n].scope===i){this.objFn[t].splice(n,1);break}0==this.objFn[t].length&&delete this.objFn[t]}else delete this.objFn[t]},t.prototype.fireEvent=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this.objFn[t]&&this.objFn[t].forEach(function(t){t.fn.apply(t.scope,i)})},t}();e["default"]=o,t.exports=e["default"]},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e,i){var n=i(63),r=i(100);t.exports=i(52)?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){var n=i(213),r=i(136);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(143)("wks"),r=i(102),a=i(54).Symbol,o="function"==typeof a,s=t.exports=function(t){return n[t]||(n[t]=o&&a[t]||(o?a:r)("Symbol."+t))};s.store=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=i(60),l=n(u),h=i(392),d=n(h),f=i(5),c=n(f),p=i(4),v=n(p),m=i(13),g=function(){function t(e,i,n){(0,a["default"])(this,t),this.zoomSpeed=1.5,this.scale=1,this.offset=new v["default"],this.lastPosition=new v["default"],this.lastQuaternion=new l["default"],this.spherical=new d["default"],this.sphericalDelta=new d["default"],this.minPolarAngle=0,this.maxPolarAngle=s["default"].degToRad(90),this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.panOffset=new v["default"],this.EPS=1e-6,this.autoRotateSpeed=1.5,this.phi=0,this.theta=0,this.MouseButtons={ORBIT:2,ZOOM:1,PAN:0},this.STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},this.enableRotate=!0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.enablePan=!0,this.rotateStart=new c["default"],this.rotateEnd=new c["default"],this.rotateDelta=new c["default"],this.panStart=new c["default"],this.panEnd=new c["default"],this.panDelta=new c["default"],this.dollyStart=new c["default"],this.dollyEnd=new c["default"],this.dollyDelta=new c["default"],this.rotateSpeed=1,this.panLeftVector3=new v["default"],this.panUpVector3=new v["default"],this.panOffsetVector3=new v["default"],this.camera=e,this.earth=n,this.target=i,this.initAttributes()}return t.prototype.initAttributes=function(){this.quat=(new l["default"]).setFromUnitVectors(this.camera.up,new v["default"](0,1,0)),this.quatInverse=this.quat.clone().inverse(),this.minDistance=this.camera.near,this.maxDistance=this.camera.far,this.state=this.STATE.NONE,this.maxPolarAngle=s["default"].degToRad(this.earth.userData.polarAngle||65)},t.prototype.update=function(){var t=this.target.clone(),e=this.camera.position;this.offset.copy(e).sub(this.target),this.offset.applyQuaternion(this.quat),this.spherical.setFromVector3(this.offset),this.autoRotate&&this.rotateLeft(this.getAutoRotationAngle()),this.spherical.phi+=this.sphericalDelta.phi,this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.theta+=this.sphericalDelta.theta,this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.phi=this.spherical.phi,this.theta=this.spherical.theta,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),this.target.x+=this.panOffset.x,this.target.y+=this.panOffset.y,this.bound&&!this.bound.containsPoint(this.target)?this.target.copy(t):(this.offset.setFromSpherical(this.spherical),this.offset.applyQuaternion(this.quatInverse),e.copy(this.target).add(this.offset)),this.camera.lookAt(this.target),this.enableDamping?this.panOffset.multiplyScalar(1-this.dampingFactor):this.panOffset.set(0,0,0),0==this.sphericalDelta.phi&&0==this.sphericalDelta.theta||this.earth.fireEvent(m.Events.Earth.AngleChange,this.spherical),this.sphericalDelta.set(0,0,0),this.scale=1},t.prototype.setBound=function(t){this.bound=t},t.prototype.setPosition=function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,arguments.length>2&&void 0!==arguments[2]?arguments[2]:45;this.camera.position.copy(t),this.target=new v["default"](t.x,t.y,t.z),this.update()},t.prototype.resetAziumthalAngle=function(t){this.sphericalDelta.theta=t,this.update()},t.prototype.rotateLeft=function(t){this.sphericalDelta.theta-=t},t.prototype.rotateUp=function(t){this.sphericalDelta.phi-=t},t.prototype.panLeft=function(t,e){this.panLeftVector3.setFromMatrixColumn(e,0),this.panLeftVector3.multiplyScalar(-t),this.panOffset.add(this.panLeftVector3)},t.prototype.panUp=function(t,e){this.panUpVector3.setFromMatrixColumn(e,1),this.panUpVector3.multiplyScalar(t),this.panOffset.add(this.panUpVector3)},t.prototype.pan=function(t,e){var i=this.camera.position;this.panOffsetVector3.copy(i).sub(this.target);var n=this.panOffsetVector3.length(),r=n/500*this.camera.fov/80,a=t*=r,o=e*=(1.2+this.phi)*r;this.panLeft(a,this.camera.matrix),this.panUp(o,this.camera.matrix)},t.prototype.dollyIn=function(t){this.scale/=t},t.prototype.dollyOut=function(t){this.scale*=t},t.prototype.down=function(t,e){switch(t.button){case this.MouseButtons.ORBIT:if(!this.enableRotate)return;this.handleMouseDownRotate(t),this.state=this.STATE.ROTATE;break;case this.MouseButtons.ZOOM:if(!this.enableZoom)return;this.handleMouseDownDolly(t),this.state=this.STATE.DOLLY;break;case this.MouseButtons.PAN:if(!this.enablePan)return;this.handleMouseDownPan(t),this.state=this.STATE.PAN}this.state!=this.STATE.NONE&&(e.on(m.Events.Mouse.Move,this.move,this),e.on(m.Events.Mouse.Up,this.up,this))},t.prototype.handleMouseDownRotate=function(t){this.rotateStart.set(t.clientX,t.clientY)},t.prototype.handleMouseDownDolly=function(t){this.dollyStart.set(t.clientX,t.clientY)},t.prototype.handleMouseDownPan=function(t){this.panStart.set(t.clientX,t.clientY)},t.prototype.handleMouseMoveRotate=function(t){this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart);var e=this.earth.getSize();this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.width*this.rotateSpeed),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.height*this.rotateSpeed),this.rotateStart.copy(this.rotateEnd)},t.prototype.handleMouseMoveDolly=function(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyIn(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyOut(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd)},t.prototype.handleMouseMovePan=function(t){this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)},t.prototype.move=function(t,e){switch(this.state){case this.STATE.ROTATE:if(!this.enableRotate)return;this.handleMouseMoveRotate(t);break;case this.STATE.DOLLY:if(!this.enableZoom)return;this.handleMouseMoveDolly(t);break;case this.STATE.PAN:if(!this.enablePan)return;this.handleMouseMovePan(t)}},t.prototype.up=function(t,e){e.off(m.Events.Mouse.Move,this.move,this),e.off(m.Events.Mouse.Up,this.up,this),this.state=this.STATE.NONE},t.prototype.wheel=function(t,e){t.deltaY<0?this.dollyOut(this.getZoomScale()):this.dollyIn(this.getZoomScale())},t.prototype.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},t.prototype.getAutoRotationAngle=function(){return 2*Math.PI/60/60*this.autoRotateSpeed},t.prototype.register=function(){this.earth.on(m.Events.Mouse.Down,this.down,this),this.earth.on(m.Events.Mouse.Wheel,this.wheel,this),this.earth.on(m.Events.Earth.Renderer,this.update,this)},t.prototype.dispose=function(){this.earth.off(m.Events.Mouse.Down,this.down,this),this.earth.off(m.Events.Mouse.Wheel,this.wheel,this),this.earth.off(m.Events.Earth.Renderer,this.update,this)},t}();e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(321);Object.defineProperty(e,"Shapes",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(318);Object.defineProperty(e,"Obj",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(315);Object.defineProperty(e,"Fbx",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(319);Object.defineProperty(e,"Osgb",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(106);Object.defineProperty(e,"Marker",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(316);Object.defineProperty(e,"Line",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(323);Object.defineProperty(e,"Water",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(158);Object.defineProperty(e,"DigArea",{enumerable:!0,get:function(){return n(d)["default"]}});var f=i(281);Object.defineProperty(e,"Clap",{enumerable:!0,get:function(){return n(f)["default"]}});var c=i(282);Object.defineProperty(e,"GridTint",{enumerable:!0,get:function(){return n(c)["default"]}});var p=i(160);Object.defineProperty(e,"InspectArea",{enumerable:!0,get:function(){return n(p)["default"]}});var v=i(317);Object.defineProperty(e,"MeshLine",{enumerable:!0,get:function(){return n(v)["default"]}});var m=i(314);Object.defineProperty(e,"FatLine",{enumerable:!0,get:function(){return n(m)["default"]}});var g=i(320);Object.defineProperty(e,"Polygon",{enumerable:!0,get:function(){return n(g)["default"]}});var y=i(322);Object.defineProperty(e,"VideoWall",{enumerable:!0,get:function(){return n(y)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(49),s=n(o),u=i(14),l=n(u),h=i(24),d=n(h),f=i(38),c=n(f),p=i(8),v=i(13),m=function(){function t(e){(0,a["default"])(this,t),this.earth=e,this.layerTask=p.Const.LayerMask.Zero}return t.prototype.initCamera=function(){if(!this.camera){this.camera=new s["default"];var t=this.earth.getSize();this.camera.aspect=t.width/t.height,this.camera.fov=30,this.camera.layers.set(this.layerTask),this.target=new c["default"](5*t.width,5*t.height)}},t.prototype.initRenderMesh=function(t){t.renderer.setClearColor("#FFFFFF",1),t.renderer.setRenderTarget(this.target),t.renderer.clear(),t.renderer.render(t.scene,this.camera,this.target,!1),t.renderer.setRenderTarget(null),t.renderer.setClearColor(t.earth.userData.renderColor||"#000000",t.earth.userData.renderAlpha||1)},t.prototype.changeLayersMask=function(t){var e=this;t.forEach(function(t){t.children.forEach(function(t){t.layers.set(e.layerTask),t.children.forEach(function(t){t.layers.set(e.layerTask)})})})},t.prototype.initRenderBuffer=function(t){var e=this;t.forEach(function(t){if(t instanceof d["default"]){var i=new l["default"];i.multiplyMatrices(e.camera.matrixWorldInverse,t.matrixWorld),Array.isArray(t.material)?t.material.forEach(function(n){e.doRenderEffect(n,i,parseInt(t.userData.rotatex||"0"))}):e.doRenderEffect(t.material,i,parseInt(t.userData.rotatex||"0"))}},this)},t.prototype.dispose=function(){this.earth.off(v.Events.Earth.Renderer,this.update,this),this.clearAll(this.earth.getControl("ViewControl"))},t.prototype.doRenderEffect=function(t,e,i){},t.prototype.clearRenderEffect=function(t){},t.prototype.update=function(t){},t.prototype.clearAll=function(t,e){},t}();e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(108),c=n(f),p=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;(0,s["default"])(this,e);var h=(0,l["default"])(this,t.call(this));return h.type="OrthographicCamera",h.zoom=1,h.view=null,h.left=i,h.right=n,h.top=r,h.bottom=a,h.near=o,h.far=u,h.updateProjectionMatrix(),h}return(0,d["default"])(e,t),e.prototype.copy=function(e,i){return t.prototype.copy.call(this,e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=(0,a["default"])({},e.view),this},e.prototype.setViewOffset=function(t,e,i,n,r,a){this.view||(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},e.prototype.clearViewOffset=function(){this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},e.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,a=i+t,o=n+e,s=n-e;if(this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,d=(this.top-this.bottom)/this.view.height;r+=h*(this.view.offsetX/u),a=r+h*(this.view.width/u),o-=d*(this.view.offsetY/l),s=o-d*(this.view.height/l)}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},e}(c["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(68),d=n(h),f=i(12),c=n(f),p=i(5),v=n(p),m=i(9),g=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="MeshPhongMaterial",this.specular=new c["default"](1118481),this.shininess=30,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=m.TangentSpaceNormalMap,this.normalScale=new v["default"](1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.specular.copy(e.specular),this.shininess=e.shininess,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i,n,r){(0,a["default"])(this,t),this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!=r?r:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings={},this.beforeStart=this.copySampleValue,this.afterEnd=this.copySampleValue}return t.prototype.copySampleValue=function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n,a=0;a!==n;++a)e[a]=i[r+a];return e},t.prototype.evaluate=function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{var a=void 0;i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd(i-1,t,r)}if(i===o)break;if(r=n,n=e[++i],t<n)break e}a=e.length;break i}{if(t>=r)break t;var s=e[1];t<s&&(i=2,r=s);for(var u=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart(0,t,n);if(i===u)break;if(n=r,r=e[--i-1],t>=r)break e}a=i,i=0}}for(;i<a;){var l=i+a>>>1;t<e[l]?a=l:i=l+1}if(n=e[i],r=e[i-1],void 0===r)return this._cachedIndex=0,this.beforeStart(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd(i-1,r,t)}this._cachedIndex=i,this.intervalChanged(i,r,n)}return this.interpolate(i,r,t,n)},t.prototype.intervalChanged=function(t,e,i){},t.prototype.interpolate=function(t,e,i,n){},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return t.prototype.setSize=function(t,e){},t.prototype.render=function(t,e,i,n,r){console.error("Pass.render() must be implemented in derived pass.")},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(22),c=n(f),p=i(5),v=n(p),m=i(4),g=n(m),y=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.translateX=function(t){this.position.x+=t,this.needsUpdate=!0},e.prototype.translateY=function(t){this.position.y+=t,this.needsUpdate=!0},e.prototype.add=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t==this?this:(t.parent&&t.parent.remove(t),t.parent=this,t.fireEvent("added",this),this.children.push(t),this.needsUpdate=!0,this)},e.prototype.remove=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return i!=-1&&(t.dispose(),t.parent=null,t.fireEvent("removed",this),this.children.splice(i,1)),this.needsUpdate=!0,this},e.prototype.raycast=function(t,e){},e.prototype.traverse=function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},e.prototype.traverseVisible=function(t){if(this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},e.prototype.traverseAncestors=function(t){var e=this.parent;null!=e&&(t(e),e.traverseAncestors(t))},e.prototype.clone=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(new e).copy(this,t)},e.prototype.copy=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.position.copy(t.position),this.scale.copy(t.scale),this.visible=t.visible,this.renderOrder=t.renderOrder,this.userData=JSON.parse((0,a["default"])(t.userData)),e)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Object2D",this.children=new Array,this.position=new g["default"],this.scale=new v["default"](1,1),this.visible=!0,this.renderOrder=0,this.needsUpdate=!0},e}(c["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(629),a=n(r),o=i(628),s=n(o),u="function"==typeof s["default"]&&"symbol"==typeof a["default"]?function(t){return typeof t}:function(t){return t&&"function"==typeof s["default"]&&t.constructor===s["default"]&&t!==s["default"].prototype?"symbol":typeof t};e["default"]="function"==typeof s["default"]&&"symbol"===u(a["default"])?function(t){return"undefined"==typeof t?"undefined":u(t)}:function(t){return t&&"function"==typeof s["default"]&&t.constructor===s["default"]&&t!==s["default"].prototype?"symbol":"undefined"==typeof t?"undefined":u(t)}},function(t,e,i){var n=i(75);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){var n=i(219),r=i(137);t.exports=Object.keys||function(t){return n(t,r)}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(109),d=n(h),f=i(66),c=n(f),p=i(367),v=n(p),m=i(368),g=n(m),y=i(12),_=n(y),x=i(7),b=n(x),M=i(14),w=n(M),S=i(94),P=n(S),A=i(50),C=n(A),T=i(5),E=n(T),D=i(4),L=n(D),F=i(21),k=n(F),I=i(48),O=i(11),N=n(O),R=i(8),U=i(6),B=n(U),j=i(284),z=n(j),G=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:{}},n=arguments[1];(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this,i,n));return r.start=new L["default"],r.end=new L["default"],r.inverseMatrix=new w["default"],r.ray=new P["default"],r.sphere=new C["default"],r}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.start=new L["default"],this.end=new L["default"],this.points=[],this.type="Polyline",this.isEditNode=!1,this.ray=new P["default"],this.sphere=new C["default"],this.inverseMatrix=new w["default"],this.moveArrays=[],this.virMoveArrays=[]},e.prototype.init=function(t,e){this.earth=e},e.prototype.initDefaultGeo=function(t,e){this.geometry=new v["default"];var i={color:this.userData.color?"#"+this.userData.color:"#ff0000",lineWidth:this.userData.line_width||1};this.material=new g["default"](i),this.material.resolution=new E["default"](900,700)},e.prototype.drawLine=function(){var t=[],e=[],i=new _["default"](16777215*Math.random()),n=new N["default"];this.points.forEach(function(r,a){r.changeEPSGType(R.Const.EPSGType.EPSGWeb),0==a&&n.copy(r);var o=r.clone().sub(n);t.push(o.x,o.y,o.z),e.push(i.r,i.g,i.b)},this),this.geometry.setPositions(t),this.geometry.setColors(e),this.computeLineDistances(),this.position.copy(n)},e.prototype.addPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.updatePoint(t,!1),e&&this.points.push(t),this.drawLine()},e.prototype.computeLineDistances=function(){var t=this.geometry,e=t.attributes.instanceStart;if(e){for(var i=t.attributes.instanceEnd,n=new Float32Array(2*e.data.count),r=0,a=0,o=e.data.count;r<o;r++,a+=2)this.start.fromBufferAttribute(e,r),this.end.fromBufferAttribute(i,r),n[a]=0===a?0:n[a-1],n[a+1]=n[a]+this.start.distanceTo(this.end);var s=new d["default"](n,2,1);return t.addAttribute("instanceDistanceStart",new c["default"](s,1,0)),t.addAttribute("instanceDistanceEnd",new c["default"](s,1,1)),this}},e.prototype.updatePoint=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.points.pop(),this.points.push(t),e&&this.drawLine()},e.prototype.updatePoints=function(t){this.points=t,this.drawLine()},e.prototype.endPoint=function(){this.points.pop(),this.drawLine()},e.prototype.getInfo=function(t){var e={objType:this.parent?this.parent.userData.objType:t,position:this.points,userData:this.userData,gtype:3002};return e},e.prototype.nodeDelete=function(t){if(t)if(this.points.length>2){var e=t.userData.nodeIndex;this.points.splice(e,1),this.updateLine()}else B["default"].warn("\u7ebf\u6bb5\u7684\u9876\u70b9\u6570\u4e0d\u80fd\u5c11\u4e8e\u4e24\u4e2a\uff01")},e.prototype.createDivChild=function(t,e){var i=document.createElement("div");return i.innerHTML=t,i.style.cursor="pointer",i.event={fn:e,type:"click"},i},e.prototype.removeNodes=function(){var t=this;this.moveArrays.forEach(function(e){t.parent.remove(e)},this),this.virMoveArrays.forEach(function(e){t.parent.remove(e)},this),this.moveArrays=[],this.virMoveArrays=[]},e.prototype.showLineNode=function(){var t=this;this.removeNodes();var e=B["default"].getDefaultNumber(this.userData.line_width,1.5);"Polygon"==this.type&&(e=3);var i=0;this.points.forEach(function(n,r){var a=t.parent.userData.objType+"_"+t.userData.id+"_"+r,o=new z["default"]({data:{id:a,width:1.5*e,objType:"meshNode",color:"ff0000",opacity:.8,nodeIndex:r,parentObj:t,isNode:!0},shapes:n.clone()},t.earth);t.parent.add(o),t.moveArrays.push(o),r<t.points.length-1&&t.addVirNode(n,r+1,i++,!1)},this)},e.prototype.doEdit=function(){if(!this.isEditNode){this.showLineNode(),this.isEditNode=!0;var t=document.createElement("div");t.appendChild(this.createDivChild("\u5220\u9664\u8282\u70b9",this.nodeDelete.bind(this))),this.earth.Api.Menus.setMenu("meshNode",t)}},e.prototype.doFinish=function(){if(this.isEditNode){this.removeNodes(),this.isEditNode=!1;var t=this.earth.getControl("SelectControl");t.doUnSelect();var e=this.earth.getService(I.RCService.fnName);e.updateData([this.getInfo()]);for(var i=this.parent.children.length-1;i>=0;i--)if(this.parent.children[i].userData&&"meshNode"==this.parent.children[i].userData.objType){this.earth.Api.Menus.clear("meshNode");break}}},e.prototype.updateLine=function(){this.showLineNode(),this.drawLine()},e.prototype.nodeUpdate=function(t,e){var i=e.userData.nodeIndex,n=new N["default"](t.x,t.y,t.z,R.Const.EPSGType.EPSGWeb);1!=e.userData.isNode&&1!=e.userData.isInsert||(this.points[i]=n),this.dealVirNode(n,e)},e.prototype.moveVirNode=function(t,e,i){this.virMoveArrays[e].position.copy(t.clone().add(this.points[i].clone()).multiplyScalar(.5))},e.prototype.dealVirNode=function(t,e){var i=e.userData.nodeIndex;e.userData.isNode||1==e.userData.isInsert&&0==e.userData.isNode?0==i?(this.moveVirNode(t,i,1),"Polygon"==this.type&&this.moveVirNode(t,this.virMoveArrays.length-1,this.points.length-2)):i==this.points.length-1?(this.moveVirNode(t,i-1,i-1),"Polygon"==this.type&&this.moveVirNode(t,0,1)):(this.moveVirNode(t,i-1,i-1),this.moveVirNode(t,i,i+1)):0==e.userData.isInsert&&0==e.userData.isNode&&(this.moveArrays.forEach(function(t,e){e>=i+1&&(t.userData.nodeIndex=e+1)}),e.userData.isInsert=!0,e.userData.nodeIndex=i+1,e.userData.isNode=!0,this.points.splice(i+1,0,t.clone()),this.addVirNode(t,i,i,!0),this.addVirNode(t,i+1,i+2,!0)),this.drawLine()},e.prototype.addVirNode=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=B["default"].getDefaultNumber(this.userData.line_width,1.5);"Polygon"==this.type&&(r=3);var a=this.parent.userData.objType+"_"+this.userData.id+"_"+b["default"].getUUID()+"_Vir",o=t.clone().add(this.points[e].clone()).multiplyScalar(.5),s=new z["default"]({data:{id:a,width:1.5*r,objType:"meshVirNode",color:"00ff00",opacity:.8,nodeIndex:i,parentObj:this,isNode:!1},shapes:o},this.earth);this.parent.add(s),1==n?this.virMoveArrays.splice(e,0,s):this.virMoveArrays.push(s)},e.prototype.raycast=function(t,e){var i=t.linePrecision,n=i*i,r=this.geometry,a=this.matrixWorld;if(null===r.boundingSphere&&r.computeBoundingSphere(),this.sphere.copy(r.boundingSphere),this.sphere.applyMatrix4(a),t.ray.intersectsSphere(this.sphere)!==!1){this.inverseMatrix.getInverse(a),this.ray.copy(t.ray).applyMatrix4(this.inverseMatrix);for(var o=new L["default"],s=new L["default"],u=new L["default"],l=new L["default"],h=1,d=r.attributes,f=d.originPosition.array,c=0,p=f.length/3-1;c<p;c+=h){var v=c,m=c+1;o.fromArray(f,3*v),s.fromArray(f,3*m);var g=this.ray.distanceSqToSegment(o,s,l,u);if(!(g>n)){l.applyMatrix4(this.matrixWorld);var y=t.ray.origin.distanceTo(l);y<t.near||y>t.far||(this.userData.nodeIndex=c,e.push({distance:y,point:u.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this,nodeIndex:c}))}}}},e}(k["default"]);e["default"]=G,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t),this.eventSet={}}return t.prototype.on=function(t,e,i){
null==this.eventSet[t]&&(this.eventSet[t]=[]),this.eventSet[t].push({fn:e,scope:i})},t.prototype.unshift=function(t,e,i){null==this.eventSet[t]&&(this.eventSet[t]=[]),this.eventSet[t].unshift({fn:e,scope:i})},t.prototype.off=function(t,e,i){if(null!=this.eventSet[t]){for(var n in this.eventSet[t])if(this.eventSet[t][n].fn===e&&this.eventSet[t][n].scope===i){this.eventSet[t].splice(n,1);break}0==this.eventSet[t].length&&delete this.eventSet[t]}},t.prototype.offAllEvents=function(){this.eventSet={}},t.prototype.containsKey=function(t){return null!=this.eventSet[t]},t.prototype.fireEvent=function(t){var e=!0;if(!this.eventSet||null==this.eventSet[t])return e;var i=this.eventSet[t];try{for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var o=0;o<i.length;o++)if(i[o].fn.apply(i[o].scope,r)){e=!1;break}}catch(s){console.error(s)}return e},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=i(12),l=n(u),h=function(){function t(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s["default"],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new l["default"],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,a["default"])(this,t),this.a=e,this.b=i,this.c=n,this.normal=r instanceof s["default"]?r:new s["default"],this.vertexNormals=Array.isArray(r)?r:[],this.color=o instanceof l["default"]?o:new l["default"],this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=u}return t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var n=0,r=t.vertexColors.length;n<r;n++)this.vertexColors[n]=t.vertexColors[n].clone();return this},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.BoxBufferGeometry=e.BoxGeometry=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(23),d=n(h),f=i(15),c=n(f),p=i(18),v=i(4),m=n(v),g=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,a["default"])(this,e);var h=(0,s["default"])(this,t.call(this));return h.parameters={width:i,height:n,depth:r,widthSegments:o,heightSegments:u,depthSegments:l},h.type="BoxGeometry",h.fromBufferGeometry(new y(i,n,r,o,u,l)),h.mergeVertices(),h}return(0,l["default"])(e,t),e}(d["default"]),y=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,a["default"])(this,e);var h=(0,s["default"])(this,t.call(this));return h.type="BoxBufferGeometry",h.parameters={width:i,height:n,depth:r,widthSegments:o,heightSegments:u,depthSegments:l},h.indices=[],h.vertices=[],h.normals=[],h.uvs=[],h.numberOfVertices=0,h.groupStart=0,h.buildPlane("z","y","x",-1,-1,r,n,i,l,u,0),h.buildPlane("z","y","x",1,-1,r,n,-i,l,u,1),h.buildPlane("x","z","y",1,1,i,r,n,o,l,2),h.buildPlane("x","z","y",1,-1,i,r,-n,o,l,3),h.buildPlane("x","y","z",1,-1,i,n,r,o,u,4),h.buildPlane("x","y","z",-1,-1,i,n,-r,o,u,5),h.setIndex(h.indices),h.addAttribute("position",new p.Float32BufferAttribute(h.vertices,3)),h.addAttribute("normal",new p.Float32BufferAttribute(h.normals,3)),h.addAttribute("uv",new p.Float32BufferAttribute(h.uvs,2)),h}return(0,l["default"])(e,t),e.prototype.buildPlane=function(t,e,i,n,r,a,o,s,u,l,h){var d=a/u,f=o/l,c=a/2,p=o/2,v=s/2,g=u+1,y=l+1,_=0,x=0,b=void 0,M=void 0,w=new m["default"];for(M=0;M<y;M++){var S=M*f-p;for(b=0;b<g;b++){var P=b*d-c;w[t]=P*n,w[e]=S*r,w[i]=v,this.vertices.push(w.x,w.y,w.z),w[t]=0,w[e]=0,w[i]=s>0?1:-1,this.normals.push(w.x,w.y,w.z),this.uvs.push(b/u),this.uvs.push(1-M/l),_+=1}}for(M=0;M<l;M++)for(b=0;b<u;b++){var A=this.numberOfVertices+b+g*M,C=this.numberOfVertices+b+g*(M+1),T=this.numberOfVertices+(b+1)+g*(M+1),E=this.numberOfVertices+(b+1)+g*M;this.indices.push(A,C,E),this.indices.push(C,T,E),x+=6}this.addGroup(this.groupStart,x,h),this.groupStart+=x,this.numberOfVertices+=_},e}(c["default"]);e.BoxGeometry=g,e.BoxBufferGeometry=y},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(12),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.type="LineBasicMaterial",n.color=new c["default"](16777215),n.lineWidth=1,n.linecap="round",n.linejoin="round",n.lights=!1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.lineWidth=e.lineWidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},e.prototype.setDigArea=function(t,e,i){},e.prototype.clearDigArea=function(){},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"];(0,a["default"])(this,t),this.origin=e,this.direction=i}return t.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},t.prototype.at=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"];return e.copy(this.direction).multiplyScalar(t).add(this.origin)},t.prototype.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},t.prototype.recast=function(t){return this.recastVector3||(this.recastVector3=new s["default"]),this.origin.copy(this.at(t,this.recastVector3)),this},t.prototype.closestPointToPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"];e.subVectors(t,this.origin);var i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)},t.prototype.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},t.prototype.distanceSqToPoint=function(t){this.distanceSqToPointVector3||(this.distanceSqToPointVector3=new s["default"]);var e=this.distanceSqToPointVector3.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(this.distanceSqToPointVector3.copy(this.direction).multiplyScalar(e).add(this.origin),this.distanceSqToPointVector3.distanceToSquared(t))},t.prototype.distanceSqToSegment=function(t,e,i,n){this.distanceSqToSegmentSegCenter||(this.distanceSqToSegmentSegCenter=new s["default"],this.distanceSqToSegmentSegDir=new s["default"],this.distanceSqToSegmentDiff=new s["default"]),this.distanceSqToSegmentSegCenter.copy(t).add(e).multiplyScalar(.5),this.distanceSqToSegmentSegDir.copy(e).sub(t).normalize(),this.distanceSqToSegmentDiff.copy(this.origin).sub(this.distanceSqToSegmentSegCenter);var r,a,o,u,l=.5*t.distanceTo(e),h=-this.direction.dot(this.distanceSqToSegmentSegDir),d=this.distanceSqToSegmentDiff.dot(this.direction),f=-this.distanceSqToSegmentDiff.dot(this.distanceSqToSegmentSegDir),c=this.distanceSqToSegmentDiff.lengthSq(),p=Math.abs(1-h*h);if(p>0)if(r=h*f-d,a=h*d-f,u=l*p,r>=0)if(a>=-u)if(a<=u){var v=1/p;r*=v,a*=v,o=r*(r+h*a+2*d)+a*(h*r+a+2*f)+c}else a=l,r=Math.max(0,-(h*a+d)),o=-r*r+a*(a+2*f)+c;else a=-l,r=Math.max(0,-(h*a+d)),o=-r*r+a*(a+2*f)+c;else a<=-u?(r=Math.max(0,-(-h*l+d)),a=r>0?-l:Math.min(Math.max(-l,-f),l),o=-r*r+a*(a+2*f)+c):a<=u?(r=0,a=Math.min(Math.max(-l,-f),l),o=a*(a+2*f)+c):(r=Math.max(0,-(h*l+d)),a=r>0?l:Math.min(Math.max(-l,-f),l),o=-r*r+a*(a+2*f)+c);else a=h>0?-l:l,r=Math.max(0,-(h*a+d)),o=-r*r+a*(a+2*f)+c;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(this.distanceSqToSegmentSegDir).multiplyScalar(a).add(this.distanceSqToSegmentSegCenter),o},t.prototype.intersectSphere=function(t,e){this.intersectSphereVector3||(this.intersectSphereVector3=new s["default"]),this.intersectSphereVector3.subVectors(t.center,this.origin);var i=this.intersectSphereVector3.dot(this.direction),n=this.intersectSphereVector3.dot(this.intersectSphereVector3)-i*i,r=t.radius*t.radius;if(n>r)return null;var a=Math.sqrt(r-n),o=i-a,u=i+a;return o<0&&u<0?null:o<0?this.at(u,e):this.at(o,e)},t.prototype.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},t.prototype.distanceToPlane=function(t){var e=t.normal.dot(this.direction);if(0==e)return 0==t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},t.prototype.intersectPlane=function(t,e){var i=this.distanceToPlane(t);return null==i?null:this.at(i,e)},t.prototype.intersectsPlane=function(t){var e=t.distanceToPoint(this.origin);if(0==e)return!0;var i=t.normal.dot(this.direction);return i*e<0},t.prototype.intersectBox=function(t,e){var i,n,r,a,o,s,u=1/this.direction.x,l=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(i=(t.min.x-d.x)*u,n=(t.max.x-d.x)*u):(i=(t.max.x-d.x)*u,n=(t.min.x-d.x)*u),l>=0?(r=(t.min.y-d.y)*l,a=(t.max.y-d.y)*l):(r=(t.max.y-d.y)*l,a=(t.min.y-d.y)*l),i>a||r>n?null:((r>i||i!=i)&&(i=r),(a<n||n!=n)&&(n=a),h>=0?(o=(t.min.z-d.z)*h,s=(t.max.z-d.z)*h):(o=(t.max.z-d.z)*h,s=(t.min.z-d.z)*h),i>s||o>n?null:((o>i||i!=i)&&(i=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,e)))},t.prototype.intersectsBox=function(t){return this.intersectsBoxVector3||(this.intersectsBoxVector3=new s["default"]),null!=this.intersectBox(t,this.intersectsBoxVector3)},t.prototype.intersectTriangle=function(t,e,i,n,r){this.intersectTriangleDiff||(this.intersectTriangleDiff=new s["default"],this.intersectTriangleEdge1=new s["default"],this.intersectTriangleEdge2=new s["default"],this.intersectTriangleNormal=new s["default"]),this.intersectTriangleEdge1.subVectors(e,t),this.intersectTriangleEdge2.subVectors(i,t),this.intersectTriangleNormal.crossVectors(this.intersectTriangleEdge1,this.intersectTriangleEdge2);var a,o=this.direction.dot(this.intersectTriangleNormal);if(o>0){if(n)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}this.intersectTriangleDiff.subVectors(this.origin,t);var u=a*this.direction.dot(this.intersectTriangleEdge2.crossVectors(this.intersectTriangleDiff,this.intersectTriangleEdge2));if(u<0)return null;var l=a*this.direction.dot(this.intersectTriangleEdge1.cross(this.intersectTriangleDiff));if(l<0)return null;if(u+l>o)return null;var h=-a*this.intersectTriangleDiff.dot(this.intersectTriangleNormal);return h<0?null:this.at(h/o,r)},t.prototype.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},t.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},e.prototype.copy=function(e,i){return t.prototype.copy.call(this,e,i),e.background&&(this.background=e.background.clone()),e.fog&&(this.fog=e.fog.clone()),e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(85),d=n(h),f=i(25),c=n(f),p=i(5),v=n(p),m=i(4),g=n(m),y=i(28),_=i(11),x=n(_),b=i(8),M=function(t){function e(i,n,r){(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this,i.data));return o.init(i,n,r),o}return(0,l["default"])(e,t),e.prototype.init=function(t,e,i){this.map=e},e.prototype.projectToScreen=function(t){var e=this.map.getControl("ScaleControl"),i=this.map.getControl("ViewControl"),n=c["default"].getResolution(e.scale),r=this.map.getSize(),a=new v["default"](t.x,t.y);return a.x=i.target.x-a.x,a.y-=i.target.y,a.divideScalar(n),new v["default"](r.width/2,r.height/2).sub(a)},e.prototype.draw=function(t){},e.prototype.isInside=function(t,e){return!0},e.prototype.setPosition=function(t){this.position.copy(t),this.parent.needsUpdate=!0},e.prototype.saveState=function(){this.map.fireEvent(y.Events.Mesh.SaveState,this)},e.prototype.getInfo=function(t){var e=(new x["default"]).copy(this.position);e.EPSGType=b.Const.EPSGType.EPSGWeb;var i={objType:this.userData.objType||t,position:e,userData:this.userData};return this.updateInfo(i,this.points),i},e.prototype.updateInfo=function(t,e){},e.prototype.click=function(t){this.fireEvent(y.Events.Mesh.Click,this,t),this.map.fireEvent(y.Events.Mesh.Click,this,t)},e.prototype.unClick=function(){this.resetColor(),this.fireEvent(y.Events.Mesh.UnClick,this),this.map.fireEvent(y.Events.Mesh.UnClick,this)},e.prototype.resetColor=function(){this.fillColor=""},e.prototype.hover=function(){this.fillColor="00FF00",this.fireEvent(y.Events.Mesh.Hover,this),this.map.fireEvent(y.Events.Mesh.Hover,this)},e.prototype.unHover=function(){this.resetColor(),this.fireEvent(y.Events.Mesh.UnHover,this),this.map.fireEvent(y.Events.Mesh.UnHover,this)},e.prototype.screenToProject=function(t){var e=this.map.getControl("ScaleControl"),i=this.map.getControl("ViewControl"),n=c["default"].getResolution(e.scale),r=this.map.getSize(),a=new g["default"](t.x,t.y,0);return a.multiplyScalar(n),a.x=i.target.x+a.x,a.y=i.target.y-a.y,a.sub(new g["default"](r.width/2*n,-(r.height/2)*n,0))},e.prototype.getModelCenter=function(){return new v["default"](0,0)},e.prototype.updatePoints=function(t){},e.prototype.move=function(t){},e}(d["default"]);e["default"]=M,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(5),d=n(h),f=i(8),c=i(25),p=n(c),v=i(6),m=n(v),g=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.Const.EPSGType.EPSG84;(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this,i,n));return o.EPSGType=r,o}return(0,l["default"])(e,t),e.prototype.set=function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.Const.EPSGType.EPSG84;return t.prototype.set.call(this,e,i),this.EPSGType=n,this},e.prototype.getXY=function(){return{x:this.x,y:this.y}},e.prototype.changeEPSGType=function(t){return this.EPSGType!=t&&(t==f.Const.EPSGType.EPSG84?(this.y=p["default"].WebtoP84_Y(this.y),this.x=p["default"].WebtoP84_X(this.x)):t==f.Const.EPSGType.EPSGWeb?(this.y=p["default"].P84ToWeb_Y(this.y),this.x=p["default"].P84ToWeb_X(this.x)):m["default"].warn("\u672a\u77e5\u7c7b\u578b\u8f6c\u6362:"+this.EPSGType+"=>"+t),this.EPSGType=t),this},e.prototype.clone=function(){return new e(this.x,this.y,this.EPSGType)},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e){t.exports=!0},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,i){var n=i(136);t.exports=function(t){return Object(n(t))}},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},function(t,e,i){(function(e){"use strict";function n(t,e){!a.isUndefined(t)&&a.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function r(){var t;return"undefined"!=typeof XMLHttpRequest?t=i(150):"undefined"!=typeof e&&(t=i(150)),t}var a=i(30),o=i(242),s={"Content-Type":"application/x-www-form-urlencoded"},u={adapter:r(),transformRequest:[function(t,e){return o(e,"Content-Type"),a.isFormData(t)||a.isArrayBuffer(t)||a.isBuffer(t)||a.isStream(t)||a.isFile(t)||a.isBlob(t)?t:a.isArrayBufferView(t)?t.buffer:a.isURLSearchParams(t)?(n(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):a.isObject(t)?(n(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},a.forEach(["delete","get","head"],function(t){u.headers[t]={}}),a.forEach(["post","put","patch"],function(t){u.headers[t]=a.merge(s)}),t.exports=u}).call(e,i(679))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(291);Object.defineProperty(e,"Shapes",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(290);Object.defineProperty(e,"Line",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(293);Object.defineProperty(e,"Water",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(292);Object.defineProperty(e,"VideoWall",{enumerable:!0,get:function(){return n(s)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(204),c=n(f),p=i(79),v=i(48),m=i(13),g=i(25),y=n(g),_=i(6),x=n(_),b=i(69),M=n(b),w=i(11),S=n(w),P=i(64),A=n(P),C=i(7),T=n(C),E=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.virtualObject=[],i.hideObject=[],i}return(0,d["default"])(e,t),e.prototype.synDraw=function(t){var e=this;t.forEach(function(t){var i=e.drawMeshs[t.id];i&&(i.visible=t.show,e.hideObject.indexOf(t.id)==-1&&e.hideObject.push(t.id))}),this.needsUpdate=!0},e.prototype.cleanVirtual=function(){for(var t=this.virtualObject.length-1;t>=0;t--){var e=this.drawMeshs[this.virtualObject[t]];e&&(this.remove(e),x["default"].listSplice(this.virtualObject,this.virtualObject[t]))}},e.prototype.showHide=function(){for(var t=this.hideObject.length-1;t>=0;t--){var e=this.drawMeshs[this.hideObject[t]];e&&(e.visible=!0,x["default"].listSplice(this.hideObject,this.hideObject[t]))}},e.prototype.synClusterDraw=function(t){var e=this;this.cleanVirtual(),this.showHide();var i=t.info,n=t.points;(0,a["default"])(i).map(function(t){e.synDraw(i[t])}),(0,a["default"])(n).map(function(t){e.doCluster(n[t])}),this.needsUpdate=!0},e.prototype.doCluster=function(t){var e=new M["default"];e.setFromPoints(t);var i=e.getCenter(),n=T["default"].getUUID(),r=new S["default"](i.x,i.y,i.z||0,"3857"),a=new Array;a.push(r);var o=this.setMarkerInfo(t.length),s={};o.id=n,s.jsType="Marker",s.data=o,s.shapes=a;var u=new A["default"](32,32,32);t.length>99&&(u=new A["default"](48,48,48)),this.initModel(s,"Marker",u),this.virtualObject.push(n),this.needsUpdate=!0},e.prototype.getOriginalType=function(t){return t},e.prototype.initModel=function(t,e,i){if("Marker"!=t.jsType)return void x["default"].warn("\u6a21\u578b\u5bf9\u8c61\u4e0d\u5b58\u5728:"+t.jsType);var n=new p.Marker(t,this.map,i),r=this.map.getControl("ViewControl"),a=Math.min(800/r.getCameraLength(),1);a<.7&&(a=.7),n.scale.set(a,a),this.add(n),this.map.fireEvent("initMesh",n,this.map)},e.prototype.getRCSize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.map.getControl("ViewControl"),i=e.getCameraSize(),n=y["default"].getR10(e.target.y+i,this.map.confg.RCScale),r=y["default"].getR10(e.target.y-i,this.map.confg.RCScale),a=y["default"].getC10(e.target.x-i,this.map.confg.RCScale),o=y["default"].getC10(e.target.x+i,this.map.confg.RCScale);this.restRCCacheState();for(var s=n;s<=r;s++)for(var u=a;u<=o;u++){var l=this.map.confg.RCScale+"_"+s+"_"+u;this.rcCache[l]?this.rcCache[l].use=!0:(t[l]||(t[l]={rc:{s:this.map.confg.RCScale,r:s,c:u},objType:[],condition:[]}),t[l].objType.push(this.userData.objType),t[l].condition.push(this.userData.condition||"*"),this.rcCache[l]={use:!0,meshs:[],state:"loading"})}return this.removeRCCache(),t},e.prototype.isShow=function(){var t=this.map.getControl("ViewControl"),e=t.getCameraLength();return e>=1*(this.userData.min_scale||Number.MIN_VALUE)&&e<=1*(this.userData.max_scale||Number.MAX_VALUE)},e.prototype.cameraChange=function(){this.needsUpdate=!0},e.prototype.roadScaleChange=function(){var t=this.map.getControl("ViewControl"),e=Math.max(Math.min(800/t.getCameraLength(),1),.7);this.traverse(function(t){t instanceof p.Marker&&t.scale.set(e,e)}),this.needsUpdate=!0},e.prototype.init=function(){var t=this.map.getService(v.RCService.fnName);t.on(this.userData.objType,this.draw,this);var e=this.map.getService(v.MarkerService.fnName);e.on(this.uuid,this.synDraw,this),e.on(this.uuid+"_cluster",this.synClusterDraw,this),this.map.on(m.Events.Earth.CameraChange,this.cameraChange,this),this.map.on(m.Events.Earth.Resize,this.cameraChange,this),this.map.on(m.Events.Earth.AngleChange,this.roadScaleChange,this),this.map.on(m.Events.Earth.ZoomChange,this.roadScaleChange,this),this.setClusterParm(150,3)},e.prototype.dispose=function(){var e=this.map.getService(v.RCService.fnName);e.off(this.userData.objType,this.draw);var i=this.map.getService(v.MarkerService.fnName);i.off(this.uuid,this.synDraw,this),i.off(this.uuid+"_cluster",this.synClusterDraw,this),this.map.off(m.Events.Earth.CameraChange,this.cameraChange,this),this.map.off(m.Events.Earth.Resize,this.cameraChange,this),this.map.off(m.Events.Earth.AngleChange,this.roadScaleChange,this),this.map.off(m.Events.Earth.ZoomChange,this.roadScaleChange,this),t.prototype.dispose.call(this)},e.prototype.setMarkerRules=function(t){var e="./images/icon/10.png";return t<=20&&t>10?e="./images/icon/20.png":t<=30&&t>20?e="./images/icon/30.png":t<=40&&t>30?e="./images/icon/40.png":t>40&&(e="./images/icon/50.png"),e},e.prototype.getMarkerRuleIcon=function(t){var e=this.setMarkerRules(t);return e},e.prototype.setMarkerInfo=function(t){var e={};return e.font_color="ffffff",e.is_bold=1,e.font_size=14,e.name=t,t<10?e.offsetxy="10,3":t>=10&&t<100?e.offsetxy="6,3":e.offsetxy="8,10",e.icon=this.getMarkerRuleIcon(t),e},e.prototype.setClusterParm=function(t,e){this.pxRange=t,this.minCluster=e;var i=this.map.getService(v.MarkerService.fnName);i.synClusterParam("add",this.uuid,this.pxRange,this.minCluster)},e}(c["default"]);e["default"]=E,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(133),d=n(h),f=i(4),c=n(f),p=i(288),v=n(p),m=i(11),g=n(m),y=i(8),_=i(44),x=n(_),b=i(6),M=n(b),w=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i,n){if(this.map=i,t.prototype.init.call(this,e,i,n),this.isSyn=!1,2==e.shapes.length){this.position1=new c["default"];var r=e.shapes[1],a=new g["default"](r.x,r.y,r.z||0,r.EPSGType);a.changeEPSGType(y.Const.EPSGType.EPSGWeb),this.position1.copy(a),this.road=new v["default"](e,i)}},e.prototype.dispose=function(){var e=this.map.getService("MarkerService");e.synMarker("remove",this.userData.id,this.parent.uuid),this.visible=!1,t.prototype.dispose.call(this),this.map.Api.Time.off(.3,this.setVauge,this)},e.prototype.draw=function(t){var e=this.map.getControl("ViewControl"),i=this.map.getSize();if(this.road&&!this.road.isComplete())return void(this.parent.needsUpdate=!0);if(this.icon&&!this.icon.isComplete())return void(this.parent.needsUpdate=!0);if(this.label&&!this.label.isComplete())return void(this.parent.needsUpdate=!0);if(this.visible){if(!this.isSyn){this.isSyn=!0;var n=this.map.getService("MarkerService");if(0!=this.isTogether){var r=this.getMarkerSize(),a=this.map.getControl("ViewControl");a.canvasRenderer.isSynMarker=!1,n.synMarker("add",this.userData.id,this.parent.uuid,this.position.toArray(),r,this.isTogether)}}if(this.px=this.position.clone().projectToScreen(e.camera,i.width,i.height),this.position1){var o=this.position1.clone().projectToScreen(e.camera,i.width,i.height),s=new c["default"](0,0,0);if(s.copy(this.position).add(this.position1),s.divideScalar(2),!x["default"].isPointInScreen(s,e.camera))return;return void(this.road&&this.road.draw(t,this.px,o,this.scale))}x["default"].isPointInScreen(this.position,e.camera)&&(this.icon&&(this.isAnimation?(this.count||(this.count=0),this.map.Api.Time.on(.3,this.setVauge,this),this.count%2==0&&(M["default"].isEmpty(this.jumpUrl)||(this.count%4==0?this.icon.setUrl(this.jumpUrl):this.icon.setUrl(this.iconUrl)),this.icon.draw(t,this.px))):this.icon.draw(t,this.px),this.count++),this.label&&this.label.draw(t,this.px,this.icon),this.drawSelect(t,this.px))}},e.prototype.setVauge=function(){this.parent&&(this.parent.needsUpdate=!0)},e}(d["default"]);e["default"]=w,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(69),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=i(14),c=n(f),p=i(4),v=n(p),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.projectionMatrix=new c["default"],this.matrixWorldInverse=new c["default"],this.projectionMatrixInverse=new c["default"],this.type="Camera",this.isCamera=!0},e.prototype.copy=function(e,i){return t.prototype.copy.call(this,e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},e.prototype.getWorldDirection=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new v["default"];this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},e.prototype.updateMatrixWorld=function(e){t.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},e.prototype.clone=function(){return(new e).copy(this)},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(178),d=n(h),f=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this,i,n));return o.meshPerAttribute=r,o}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function r(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeUtils=void 0;var a=i(372),o=e.ShapeUtils={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return o.area(t)<0},triangulateShape:function(t,e){var i=[],o=[],s=[];n(t),r(i,t);var u=t.length;e.forEach(n);for(var l=0;l<e.length;l++)o.push(u),u+=e[l].length,r(i,e[l]);for(var h=a.Earcut.triangulate(i,o),l=0;l<h.length;l+=3)s.push(h.slice(l,l+3));return s}}},function(t,e){"use strict";function i(t,e,i,n,r){var a=.5*(n-e),o=.5*(r-i),s=t*t,u=t*s;return(2*i-2*n+a+o)*u+(-3*i+3*n-2*a-o)*s+a*t+i}function n(t,e){var i=1-t;return i*i*e}function r(t,e){return 2*(1-t)*t*e}function a(t,e){return t*t*e}function o(t,e,i,o){return n(t,e)+r(t,i)+a(t,o)}function s(t,e){var i=1-t;return i*i*i*e}function u(t,e){var i=1-t;return 3*i*i*t*e}function l(t,e){return 3*(1-t)*t*t*e}function h(t,e){return t*t*t*e}function d(t,e,i,n,r){return s(t,e)+u(t,i)+l(t,n)+h(t,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.CatmullRom=i,e.QuadraticBezier=o,e.CubicBezier=d},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(57),d=n(h),f=i(5),c=n(f),p=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c["default"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"];(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this));return r.v1=i,r.v2=n,r}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="LineCurve"},e.prototype.getPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"];return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},e.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ExtrudeBufferGeometry=e.ExtrudeGeometry=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(23),d=n(h),f=i(15),c=n(f),p=i(18),v=i(5),m=n(v),g=i(110),y=i(4),_=n(y),x={generateTopUV:function(t,e,i,n,r){var a=e[3*i],o=e[3*i+1],s=e[3*n],u=e[3*n+1],l=e[3*r],h=e[3*r+1];return[new m["default"](a,o),new m["default"](s,u),new m["default"](l,h)]},generateSideWallUV:function(t,e,i,n,r,a){var o=e[3*i],s=e[3*i+1],u=e[3*i+2],l=e[3*n],h=e[3*n+1],d=e[3*n+2],f=e[3*r],c=e[3*r+1],p=e[3*r+2],v=e[3*a],g=e[3*a+1],y=e[3*a+2];return Math.abs(s-h)<.01?[new m["default"](o,1-u),new m["default"](l,1-d),new m["default"](f,1-p),new m["default"](v,1-y)]:[new m["default"](s,1-u),new m["default"](h,1-d),new m["default"](c,1-p),new m["default"](g,1-y)]}},b=function(t){function e(i,n){(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this));
return r.type="ExtrudeGeometry",r.parameters={shapes:i,options:n},r.fromBufferGeometry(new M(i,n)),r.mergeVertices(),r}return(0,l["default"])(e,t),e}(d["default"]),M=function(t){function e(i,n){function r(t){function e(t,e,i){return e||console.error("ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function i(t,e,i){var n,r,a,o=t.x-e.x,s=t.y-e.y,u=i.x-t.x,l=i.y-t.y,h=o*o+s*s,d=o*l-s*u;if(Math.abs(d)>Number.EPSILON){var f=Math.sqrt(h),c=Math.sqrt(u*u+l*l),p=e.x-s/f,v=e.y+o/f,g=i.x-l/c,y=i.y+u/c,_=((g-p)*l-(y-v)*u)/(o*l-s*u);n=p+o*_-t.x,r=v+s*_-t.y;var x=n*n+r*r;if(x<=2)return new m["default"](n,r);a=Math.sqrt(x/2)}else{var b=!1;o>Number.EPSILON?u>Number.EPSILON&&(b=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(b=!0):Math.sign(s)===Math.sign(l)&&(b=!0),b?(n=-s,r=o,a=Math.sqrt(h)):(n=o,r=s,a=Math.sqrt(h/2))}return new m["default"](n/a,r/a)}function r(){var t=l.length/3;if(w){var e=0,i=Z*e;for($=0;$<K;$++)Q=G[$],d(Q[2]+i,Q[1]+i,Q[0]+i);for(e=b+2*A,i=Z*e,$=0;$<K;$++)Q=G[$],d(Q[0]+i,Q[1]+i,Q[2]+i)}else{for($=0;$<K;$++)Q=G[$],d(Q[2],Q[1],Q[0]);for($=0;$<K;$++)Q=G[$],d(Q[0]+Z*b,Q[1]+Z*b,Q[2]+Z*b)}u.addGroup(t,l.length/3-t,0)}function a(){var t=l.length/3,e=0;for(o(V,e),e+=V.length,N=0,R=j.length;N<R;N++)O=j[N],o(O,e),e+=O.length;u.addGroup(t,l.length/3-t,1)}function o(t,e){var i,n;for($=t.length;--$>=0;){i=$,n=$-1,n<0&&(n=t.length-1);var r=0,a=b+2*A;for(r=0;r<a;r++){var o=Z*r,s=Z*(r+1),u=e+i+o,l=e+n+o,h=e+n+s,d=e+i+s;f(u,l,h,d)}}}function s(t,e,i){v.push(t),v.push(e),v.push(i)}function d(t,e,i){c(t),c(e),c(i);var n=l.length/3,r=T.generateTopUV(u,l,n-3,n-2,n-1);p(r[0]),p(r[1]),p(r[2])}function f(t,e,i,n){c(t),c(e),c(n),c(e),c(i),c(n);var r=l.length/3,a=T.generateSideWallUV(u,l,r-6,r-3,r-2,r-1);p(a[0]),p(a[1]),p(a[3]),p(a[1]),p(a[2]),p(a[3])}function c(t){l.push(v[3*t+0]),l.push(v[3*t+1]),l.push(v[3*t+2])}function p(t){h.push(t.x),h.push(t.y)}var v=[],y=void 0!=n.curveSegments?n.curveSegments:12,b=void 0!=n.steps?n.steps:1,M=void 0!=n.depth?n.depth:100,w=void 0==n.bevelEnabled||n.bevelEnabled,S=void 0!=n.bevelThickness?n.bevelThickness:6,P=void 0!=n.bevelSize?n.bevelSize:S-2,A=void 0!=n.bevelSegments?n.bevelSegments:3,C=n.extrudePath,T=void 0!=n.UVGenerator?n.UVGenerator:x;void 0!=n.amount&&(M=n.amount);var E,D,L,F,k,I=!1;C&&(E=C.getSpacedPoints(b),I=!0,w=!1,D=C.computeFrenetFrames(b,!1),L=new _["default"],F=new _["default"],k=new _["default"]),w||(A=0,S=0,P=0);var O,N,R,U=t.extractPoints(y),B=U.shape,j=U.holes,z=!g.ShapeUtils.isClockWise(B);if(z)for(B=B.reverse(),N=0,R=j.length;N<R;N++)O=j[N],g.ShapeUtils.isClockWise(O)&&(j[N]=O.reverse());var G=g.ShapeUtils.triangulateShape(B,j),V=B;for(N=0,R=j.length;N<R;N++)O=j[N],B=B.concat(O);for(var W,X,H,Y,q,Q,Z=B.length,K=G.length,J=[],$=0,tt=V.length,et=tt-1,it=$+1;$<tt;$++,et++,it++)et===tt&&(et=0),it===tt&&(it=0),J[$]=i(V[$],V[et],V[it]);var nt,rt=[],at=J.concat();for(N=0,R=j.length;N<R;N++){for(O=j[N],nt=[],$=0,tt=O.length,et=tt-1,it=$+1;$<tt;$++,et++,it++)et===tt&&(et=0),it===tt&&(it=0),nt[$]=i(O[$],O[et],O[it]);rt.push(nt),at=at.concat(nt)}for(W=0;W<A;W++){for(H=W/A,Y=S*Math.cos(H*Math.PI/2),X=P*Math.sin(H*Math.PI/2),$=0,tt=V.length;$<tt;$++)q=e(V[$],J[$],X),s(q.x,q.y,-Y);for(N=0,R=j.length;N<R;N++)for(O=j[N],nt=rt[N],$=0,tt=O.length;$<tt;$++)q=e(O[$],nt[$],X),s(q.x,q.y,-Y)}for(X=P,$=0;$<Z;$++)q=w?e(B[$],at[$],X):B[$],I?(F.copy(D.normals[0]).multiplyScalar(q.x),L.copy(D.binormals[0]).multiplyScalar(q.y),k.copy(E[0]).add(F).add(L),s(k.x,k.y,k.z)):s(q.x,q.y,0);var ot;for(ot=1;ot<=b;ot++)for($=0;$<Z;$++)q=w?e(B[$],at[$],X):B[$],I?(F.copy(D.normals[ot]).multiplyScalar(q.x),L.copy(D.binormals[ot]).multiplyScalar(q.y),k.copy(E[ot]).add(F).add(L),s(k.x,k.y,k.z)):s(q.x,q.y,M/b*ot);for(W=A-1;W>=0;W--){for(H=W/A,Y=S*Math.cos(H*Math.PI/2),X=P*Math.sin(H*Math.PI/2),$=0,tt=V.length;$<tt;$++)q=e(V[$],J[$],X),s(q.x,q.y,M+Y);for(N=0,R=j.length;N<R;N++)for(O=j[N],nt=rt[N],$=0,tt=O.length;$<tt;$++)q=e(O[$],nt[$],X),I?s(q.x,q.y+E[b-1].y,E[b-1].x+Y):s(q.x,q.y,M+Y)}r(),a()}(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this));o.type="ExtrudeBufferGeometry",o.parameters={shapes:i,options:n},i=Array.isArray(i)?i:[i];for(var u=o,l=[],h=[],d=0,f=i.length;d<f;d++){var c=i[d];r(c)}return o.addAttribute("position",new p.Float32BufferAttribute(l,3)),o.addAttribute("uv",new p.Float32BufferAttribute(h,2)),o.computeVertexNormals(),o}return(0,l["default"])(e,t),e}(c["default"]);e.ExtrudeGeometry=b,e.ExtrudeBufferGeometry=M},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeBufferGeometry=e.ShapeGeometry=void 0;var r=i(86),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(23),c=n(f),p=i(15),v=n(p),m=i(18),g=i(110),y=function(t){function e(i,n){(0,s["default"])(this,e);var r=(0,l["default"])(this,t.call(this));return r.type="ShapeGeometry","object"===("undefined"==typeof n?"undefined":(0,a["default"])(n))&&(n=n.curveSegments),r.parameters={shapes:i,curveSegments:n},r.fromBufferGeometry(new _(i,n)),r.mergeVertices(),r}return(0,d["default"])(e,t),e}(c["default"]),_=function(t){function e(i,n){(0,s["default"])(this,e);var r=(0,l["default"])(this,t.call(this));if(r.type="ShapeBufferGeometry",r.parameters={shapes:i,curveSegments:n},r.curveSegments=n||12,r.indices=[],r.vertices=[],r.normals=[],r.uvs=[],r.groupStart=0,r.groupCount=0,Array.isArray(i)===!1)r.addShape(i);else for(var a=0;a<i.length;a++)r.addShape(i[a]),r.addGroup(r.groupStart,r.groupCount,a),r.groupStart+=r.groupCount,r.groupCount=0;return r.setIndex(r.indices),r.addAttribute("position",new m.Float32BufferAttribute(r.vertices,3)),r.addAttribute("normal",new m.Float32BufferAttribute(r.normals,3)),r.addAttribute("uv",new m.Float32BufferAttribute(r.uvs,2)),r}return(0,d["default"])(e,t),e.prototype.addShape=function(t){var e=void 0,i=void 0,n=void 0,r=this.vertices.length/3,a=t.extractPoints(this.curveSegments),o=a.shape,s=a.holes;if(g.ShapeUtils.isClockWise(o)===!1)for(o=o.reverse(),e=0,i=s.length;e<i;e++)n=s[e],g.ShapeUtils.isClockWise(n)===!0&&(s[e]=n.reverse());var u=g.ShapeUtils.triangulateShape(o,s);for(e=0,i=s.length;e<i;e++)n=s[e],o=o.concat(n);for(e=0,i=o.length;e<i;e++){var l=o[e];this.vertices.push(l.x,l.y,0),this.normals.push(0,0,1),this.uvs.push(l.x,l.y)}for(e=0,i=u.length;e<i;e++){var h=u[e],d=h[0]+r,f=h[1]+r,c=h[2]+r;this.indices.push(d,f,c),this.groupCount+=3}},e}(v["default"]);e.ShapeGeometry=y,e.ShapeBufferGeometry=_},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(5),s=n(o),u=i(14),l=n(u),h=function(){function t(e){(0,a["default"])(this,t),this.camera=e,this.bias=0,this.radius=1,this.mapSize=new s["default"](4096,4096),this.map=null,this.matrix=new l["default"]}return t.prototype.copy=function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},t.prototype.clone=function(){return new t(this.camera).copy(this)},t.prototype.update=function(t){},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(59),d=n(h),f=i(115),c=n(f),p=i(49),v=n(p),m=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this,i,n));return u.type="PointLight",u.distance=r,u.decay=o,u.shadow=new c["default"](new v["default"](90,1,.5,500)),u}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(9),c=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.type="MeshDepthMaterial",n.depthPacking=f.BasicDepthPacking,n.skinning=!1,n.morphTargets=!1,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLineWidth=1,n.fog=!1,n.lights=!1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLineWidth=e.wireframeLineWidth,this},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(5),c=n(f),p=i(12),v=n(p),m=i(9),g=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new v["default"](16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new v["default"](0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=m.TangentSpaceNormalMap,this.normalScale=new c["default"](1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLineWidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLineWidth=e.wireframeLineWidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(135),a=n(r),o=i(1),s=n(o),u=i(7),l=n(u),h=i(14),d=n(h),f=i(60),c=n(f),p=i(4),v=n(p),m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DefaultOrder;(0,s["default"])(this,t),this._x=e,this._y=i,this._z=n,this._order=r}return t.prototype.set=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments[3];return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._order)},t.prototype.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},t.prototype.setFromRotationMatrix=function(t,e,i){var n=l["default"].clamp,r=t.elements,a=r[0],o=r[4],s=r[8],u=r[1],h=r[5],d=r[9],f=r[2],c=r[6],p=r[10];return e=e||this._order,"XYZ"==e?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(c,h),this._z=0)):"YXZ"==e?(this._x=Math.asin(-n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-f,a),this._z=0)):"ZXY"==e?(this._x=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"==e?(this._y=Math.asin(-n(f,-1,1)),Math.abs(f)<.99999?(this._x=Math.atan2(c,p),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,h))):"YZX"==e?(this._z=Math.asin(n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-d,h),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"==e&&(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(c,h),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-d,p),this._y=0)),this._order=e,0!=i&&this.onChangeCallback(),this},t.prototype.setFromQuaternion=function(t,e,i){return this.setFromQuaternionMatrix4||(this.setFromQuaternionMatrix4=new d["default"]),this.setFromQuaternionMatrix4.makeRotationFromQuaternion(t),this.setFromRotationMatrix(this.setFromQuaternionMatrix4,e,i)},t.prototype.setFromVector3=function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},t.prototype.reorder=function(t){return this.reorderQuaternion||(this.reorderQuaternion=new c["default"]),this.reorderQuaternion.setFromEuler(this),this.setFromQuaternion(this.reorderQuaternion,t)},t.prototype.equals=function(t){return t._x==this._x&&t._y==this._y&&t._z==this._z&&t._order==this._order},t.prototype.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!=t[3]&&(this._order=t[3]),this.onChangeCallback(),this},t.prototype.toArray=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},t.prototype.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new v["default"](this._x,this._y,this._z)},t.prototype.setX=function(t){this._x=t,this.onChangeCallback()},t.prototype.setY=function(t){this._y=t,this.onChangeCallback()},t.prototype.setZ=function(t){this._z=t,this.onChangeCallback()},t.prototype.setOrder=function(t){this._order=t,this.onChangeCallback()},t.prototype.onChange=function(t){return this.onChangeCallback=t,this},t.prototype.onChangeCallback=function(){},t}();e["default"]=m,m.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],m.DefaultOrder="XYZ",(0,a["default"])(m.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(121),s=n(o),u=i(50),l=n(u),h=i(4),d=n(h),f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new s["default"],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s["default"],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new s["default"],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new s["default"];(0,a["default"])(this,t),this.planes=[e,i,n,r,o,u]}return t.prototype.set=function(t,e,i,n,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},t.prototype.setFromMatrix=function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],u=i[5],l=i[6],h=i[7],d=i[8],f=i[9],c=i[10],p=i[11],v=i[12],m=i[13],g=i[14],y=i[15];return e[0].setComponents(o-n,h-s,p-d,y-v).normalize(),e[1].setComponents(o+n,h+s,p+d,y+v).normalize(),e[2].setComponents(o+r,h+u,p+f,y+m).normalize(),e[3].setComponents(o-r,h-u,p-f,y-m).normalize(),e[4].setComponents(o-a,h-l,p-c,y-g).normalize(),e[5].setComponents(o+a,h+l,p+c,y+g).normalize(),this},t.prototype.intersectsObject=function(t){this.intersectsObjectSphere||(this.intersectsObjectSphere=new l["default"]);var e=t.geometry;return e.boundingSphere||e.computeBoundingSphere(),this.intersectsObjectSphere.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(this.intersectsObjectSphere)},t.prototype.intersectsSprite=function(t){return this.intersectsSpriteSphere||(this.intersectsSpriteSphere=new l["default"]),this.intersectsSpriteSphere.center.set(0,0,0),this.intersectsSpriteSphere.radius=.7071067811865476,this.intersectsSpriteSphere.applyMatrix4(t.matrixWorld),this.intersectsSphere(this.intersectsSpriteSphere)},t.prototype.intersectsSphere=function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;r<6;r++){var a=e[r].distanceToPoint(i);if(a<n)return!1}return!0},t.prototype.intersectsBox=function(t){this.intersectsBoxVector3||(this.intersectsBoxVector3=new d["default"]);for(var e=this.planes,i=0;i<6;i++){var n=e[i];if(this.intersectsBoxVector3.x=n.normal.x>0?t.max.x:t.min.x,this.intersectsBoxVector3.y=n.normal.y>0?t.max.y:t.min.y,this.intersectsBoxVector3.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(this.intersectsBoxVector3)<0)return!1}return!0},t.prototype.containsPoint=function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0},t}();e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=i(37),l=n(u),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"](1,0,0),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a["default"])(this,t),this.normal=e,this.constant=i}return t.prototype.set=function(t,e){return this.normal.copy(t),this.constant=e,this},t.prototype.setComponents=function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},t.prototype.setFromNormalAndCoplanarPoint=function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},t.prototype.setFromCoplanarPoints=function(t,e,i){var n=new s["default"],r=new s["default"],a=n.subVectors(i,e).cross(r.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(a,t),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},t.prototype.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},t.prototype.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.prototype.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},t.prototype.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},t.prototype.projectPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"];return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},t.prototype.intersectLine=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"],i=new s["default"],n=t.delta(i),r=this.normal.dot(n);if(0!=r){var a=-(t.start.dot(this.normal)+this.constant)/r;if(!(a<0||a>1))return e.copy(n).multiplyScalar(a).add(t.start)}else if(0==this.distanceToPoint(t.start))return e.copy(t.start)},t.prototype.intersectsLine=function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0},t.prototype.intersectsBox=function(t){return t.intersectsPlane(this)},t.prototype.intersectsSphere=function(t){return t.intersectsPlane(this)},t.prototype.coplanarPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"];return t.copy(this.normal).multiplyScalar(-this.constant)},t.prototype.applyMatrix4=function(t,e){var i=new s["default"],n=new l["default"],r=e||n.getNormalMatrix(t),a=this.coplanarPoint(i).applyMatrix4(t),o=this.normal.applyMatrix3(r).normalize();return this.constant=-a.dot(o),this},t.prototype.translate=function(t){return this.constant-=t.dot(this.normal),this},t.prototype.equals=function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(394);Object.defineProperty(e,"DiscreteInterpolant",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(83);Object.defineProperty(e,"Interpolant",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(393);Object.defineProperty(e,"CubicInterpolant",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(395);Object.defineProperty(e,"LinearInterpolant",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(396);Object.defineProperty(e,"QuaternionLinearInterpolant",{enumerable:!0,get:function(){return n(u)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=i(189),c=n(f),p=i(15),v=n(p),m=i(50),g=n(m),y=i(94),_=n(y),x=i(14),b=n(x),M=i(4),w=n(M),S=function(t){function e(i,n){(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this));return r.geometry=void 0!=i?i:new v["default"],r.material=void 0!=n?n:new c["default"]({color:16777215*Math.random()}),r}return(0,l["default"])(e,t),e.prototype.clone=function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new e(this.geometry,this.material).copy(this)},e.prototype.raycast=function(t,e){function i(i,r){var o=this.ray.distanceSqToPoint(i);if(o<u){this.ray.closestPointToPoint(i,h),h.applyMatrix4(a);var s=t.ray.origin.distanceTo(h);if(s<t.near||s>t.far)return;e.push({distance:s,distanceToRay:Math.sqrt(o),point:h.clone(),index:r,face:null,object:n})}}this.inverseMatrix||(this.inverseMatrix=new b["default"],this.ray=new _["default"],this.sphere=new g["default"]);var n=this,r=this.geometry,a=this.matrixWorld,o=t.params.Points.threshold;if(r.boundingSphere||r.computeBoundingSphere(),this.sphere.copy(r.boundingSphere),this.sphere.applyMatrix4(a),this.sphere.radius+=o,0!=t.ray.intersectsSphere(this.sphere)){this.inverseMatrix.getInverse(a),this.ray.copy(t.ray).applyMatrix4(this.inverseMatrix);var s=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=s*s,l=new w["default"],h=new w["default"];if(r instanceof v["default"]){var d=r.index,f=r.attributes,c=f.position.array;if(d)for(var p=d.array,m=0,y=p.length;m<y;m++){var x=p[m];l.fromArray(c,3*x),i(l,x)}else for(var M=0,S=c.length/3;M<S;M++)l.fromArray(c,3*M),i(l,M)}else for(var P=r.vertices,A=0,C=P.length;A<C;A++)i(P[A],A)}},e}(d["default"]);e["default"]=S,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(38),d=n(h),f=function(t){function e(i,n,r){(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this,i,n,r));return o.activeCubeFace=0,o.activeMipMapLevel=0,o}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ShaderChunk=void 0;var r=i(409),a=n(r),o=i(410),s=n(o),u=i(411),l=n(u),h=i(412),d=n(h),f=i(413),c=n(f),p=i(414),v=n(p),m=i(415),g=n(m),y=i(416),_=n(y),x=i(417),b=n(x),M=i(420),w=n(M),S=i(421),P=n(S),A=i(422),C=n(A),T=i(423),E=n(T),D=i(453),L=n(D),F=i(454),k=n(F),I=i(455),O=n(I),N=i(456),R=n(N),U=i(424),B=n(U),j=i(425),z=n(j),G=i(426),V=n(G),W=i(427),X=n(W),H=i(428),Y=n(H),q=i(429),Q=n(q),Z=i(430),K=n(Z),J=i(435),$=n(J),tt=i(436),et=n(tt),it=i(439),nt=n(it),rt=i(440),at=n(rt),ot=i(441),st=n(ot),ut=i(442),lt=n(ut),ht=i(443),dt=n(ht),ft=i(444),ct=n(ft),pt=i(445),vt=n(pt),mt=i(447),gt=n(mt),yt=i(451),_t=n(yt),xt=i(450),bt=n(xt),Mt=i(448),wt=n(Mt),St=i(449),Pt=n(St),At=i(452),Ct=n(At),Tt=i(465),Et=n(Tt),Dt=i(466),Lt=n(Dt),Ft=i(470),kt=n(Ft),It=i(471),Ot=n(It),Nt=i(446),Rt=n(Nt),Ut=i(472),Bt=n(Ut),jt=i(473),zt=n(jt),Gt=i(474),Vt=n(Gt),Wt=i(475),Xt=n(Wt),Ht=i(467),Yt=n(Ht),qt=i(469),Qt=n(qt),Zt=i(468),Kt=n(Zt),Jt=i(476),$t=n(Jt),te=i(477),ee=n(te),ie=i(478),ne=n(ie),re=i(479),ae=n(re),oe=i(480),se=n(oe),ue=i(481),le=n(ue),he=i(482),de=n(he),fe=i(483),ce=n(fe),pe=i(484),ve=n(pe),me=i(485),ge=n(me),ye=i(486),_e=n(ye),xe=i(487),be=n(xe),Me=i(488),we=n(Me),Se=i(489),Pe=n(Se),Ae=i(490),Ce=n(Ae),Te=i(491),Ee=n(Te),De=i(492),Le=n(De),Fe=i(493),ke=n(Fe),Ie=i(494),Oe=n(Ie),Ne=i(437),Re=n(Ne),Ue=i(438),Be=n(Ue),je=i(495),ze=n(je),Ge=i(496),Ve=n(Ge),We=i(497),Xe=n(We),He=i(498),Ye=n(He),qe=i(499),Qe=n(qe),Ze=i(500),Ke=n(Ze),Je=i(501),$e=n(Je),ti=i(502),ei=n(ti),ii=i(503),ni=n(ii),ri=i(504),ai=n(ri),oi=i(505),si=n(oi),ui=i(506),li=n(ui),hi=i(507),di=n(hi),fi=i(508),ci=n(fi),pi=i(512),vi=n(pi),mi=i(513),gi=n(mi),yi=i(514),_i=n(yi),xi=i(509),bi=n(xi),Mi=i(510),wi=n(Mi),Si=i(511),Pi=n(Si),Ai=i(515),Ci=n(Ai),Ti=i(516),Ei=n(Ti),Di=i(517),Li=n(Di),Fi=i(518),ki=n(Fi),Ii=i(519),Oi=n(Ii),Ni=i(520),Ri=n(Ni),Ui=i(521),Bi=n(Ui),ji=i(522),zi=n(ji),Gi=i(523),Vi=n(Gi),Wi=i(524),Xi=n(Wi),Hi=i(525),Yi=n(Hi),qi=i(526),Qi=n(qi),Zi=i(527),Ki=n(Zi),Ji=i(528),$i=n(Ji),tn=i(529),en=n(tn),nn=i(530),rn=n(nn),an=i(531),on=n(an),sn=i(532),un=n(sn),ln=i(533),hn=n(ln),dn=i(534),fn=n(dn),cn=i(535),pn=n(cn),vn=i(536),mn=n(vn),gn=i(537),yn=n(gn),_n=i(538),xn=n(_n),bn=i(539),Mn=n(bn),wn=i(540),Sn=n(wn),Pn=i(541),An=n(Pn),Cn=i(542),Tn=n(Cn),En=i(543),Dn=n(En),Ln=i(544),Fn=n(Ln),kn=i(545),In=n(kn),On=i(461),Nn=n(On),Rn=i(462),Un=n(Rn),Bn=i(463),jn=n(Bn),zn=i(464),Gn=n(zn),Vn=i(418),Wn=n(Vn),Xn=i(419),Hn=n(Xn),Yn=i(431),qn=n(Yn),Qn=i(432),Zn=n(Qn),Kn=i(433),Jn=n(Kn),$n=i(434),tr=n($n),er=i(457),ir=n(er),nr=i(458),rr=n(nr),ar=i(459),or=n(ar),sr=i(460),ur=n(sr);e.ShaderChunk={alphamap_fragment:a["default"],alphamap_pars_fragment:s["default"],alphatest_fragment:l["default"],aomap_fragment:d["default"],aomap_pars_fragment:c["default"],begin_vertex:v["default"],beginnormal_vertex:g["default"],bsdfs:_["default"],bumpmap_pars_fragment:b["default"],clipping_planes_fragment:w["default"],clipping_planes_pars_fragment:P["default"],clipping_planes_pars_vertex:C["default"],clipping_planes_vertex:E["default"],gradual_fragment:L["default"],gradual_pars_fragment:k["default"],gradual_pars_vertex:O["default"],gradual_vertex:R["default"],color_fragment:B["default"],color_pars_fragment:z["default"],color_pars_vertex:V["default"],color_vertex:X["default"],common:Y["default"],cube_uv_reflection_fragment:Q["default"],defaultnormal_vertex:K["default"],displacementmap_pars_vertex:$["default"],displacementmap_vertex:et["default"],emissivemap_fragment:nt["default"],emissivemap_pars_fragment:at["default"],encodings_fragment:st["default"],encodings_pars_fragment:lt["default"],envmap_fragment:dt["default"],envmap_pars_fragment:ct["default"],envmap_pars_vertex:vt["default"],envmap_physical_pars_fragment:Rt["default"],envmap_vertex:gt["default"],fog_vertex:_t["default"],fog_pars_vertex:bt["default"],fog_fragment:wt["default"],fog_pars_fragment:Pt["default"],gradientmap_pars_fragment:Ct["default"],lightmap_fragment:Et["default"],lightmap_pars_fragment:Lt["default"],lights_lambert_vertex:kt["default"],lights_pars_begin:Ot["default"],lights_phong_fragment:Bt["default"],lights_phong_pars_fragment:zt["default"],lights_physical_fragment:Vt["default"],lights_physical_pars_fragment:Xt["default"],lights_fragment_begin:Yt["default"],lights_fragment_maps:Qt["default"],lights_fragment_end:Kt["default"],logdepthbuf_fragment:$t["default"],logdepthbuf_pars_fragment:ee["default"],logdepthbuf_pars_vertex:ne["default"],logdepthbuf_vertex:ae["default"],map_fragment:se["default"],map_pars_fragment:le["default"],map_particle_fragment:de["default"],map_particle_pars_fragment:ce["default"],metalnessmap_fragment:ve["default"],metalnessmap_pars_fragment:ge["default"],morphnormal_vertex:_e["default"],morphtarget_pars_vertex:be["default"],morphtarget_vertex:we["default"],normal_fragment_begin:Pe["default"],normal_fragment_maps:Ce["default"],normalmap_pars_fragment:Ee["default"],packing:Le["default"],premultiplied_alpha_fragment:ke["default"],project_vertex:Oe["default"],dithering_fragment:Re["default"],dithering_pars_fragment:Be["default"],roughnessmap_fragment:ze["default"],roughnessmap_pars_fragment:Ve["default"],shadowmap_pars_fragment:Xe["default"],shadowmap_pars_vertex:Ye["default"],shadowmap_vertex:Qe["default"],shadowmask_pars_fragment:Ke["default"],skinbase_vertex:$e["default"],skinning_pars_vertex:ei["default"],skinning_vertex:ni["default"],skinnormal_vertex:ai["default"],specularmap_fragment:si["default"],specularmap_pars_fragment:li["default"],tonemapping_fragment:di["default"],tonemapping_pars_fragment:ci["default"],uv_pars_fragment:vi["default"],uv_pars_vertex:gi["default"],uv_vertex:_i["default"],uv2_pars_fragment:bi["default"],uv2_pars_vertex:wi["default"],uv2_vertex:Pi["default"],worldpos_vertex:Ci["default"],background_frag:Ei["default"],background_vert:Li["default"],cube_frag:ki["default"],cube_vert:Oi["default"],depth_frag:Ri["default"],depth_vert:Bi["default"],distanceRGBA_frag:zi["default"],distanceRGBA_vert:Vi["default"],equirect_frag:Xi["default"],equirect_vert:Yi["default"],linedashed_frag:Qi["default"],linedashed_vert:Ki["default"],meshbasic_frag:$i["default"],meshbasic_vert:en["default"],meshlambert_frag:rn["default"],meshlambert_vert:on["default"],meshmatcap_frag:un["default"],meshmatcap_vert:hn["default"],meshphong_frag:fn["default"],meshphong_vert:pn["default"],meshphysical_frag:mn["default"],meshphysical_vert:yn["default"],normal_frag:xn["default"],normal_vert:Mn["default"],points_frag:Sn["default"],points_vert:An["default"],shadow_frag:Tn["default"],shadow_vert:Dn["default"],sprite_frag:Fn["default"],sprite_vert:In["default"],inspectarea_fragment:Nn["default"],inspectarea_pars_fragment:Un["default"],inspectarea_pars_vertex:jn["default"],inspectarea_vertex:Gn["default"],clap_pars_vertex:Wn["default"],
clap_vertex:Hn["default"],digArea_fragment:qn["default"],digArea_pars_fragment:Zn["default"],digArea_pars_vertex:Jn["default"],digArea_vertex:tr["default"],gridtint_fragment:ir["default"],gridtint_pars_fragment:rr["default"],gridtint_pars_vertex:or["default"],gridtint_vertex:ur["default"]}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(37),s=n(o),u=i(12),l=n(u),h=i(5),d=n(h),f=i(14),c=n(f),p=i(27),v=n(p),m=function g(){(0,a["default"])(this,g)};e["default"]=m,m.InspectArea={inspectArea:{value:0},inspectAreaProjection0:{value:new c["default"]},inspectAreaModelView0:{value:new c["default"]},inspectAreaTexture0:{value:new v["default"]},inspectAreaNear0:{value:.1},inspectAreaFar0:{value:.1},inspectAreaProjection1:{value:new c["default"]},inspectAreaModelView1:{value:new c["default"]},inspectAreaTexture1:{value:new v["default"]},inspectAreaNear1:{value:.1},inspectAreaFar1:{value:.1},inspectAreaProjection2:{value:new c["default"]},inspectAreaModelView2:{value:new c["default"]},inspectAreaTexture2:{value:new v["default"]},inspectAreaNear2:{value:.1},inspectAreaFar2:{value:.1}},m.GridTint={gridTint:{value:0},gridTintProjection:{value:new c["default"]},gridTintModelView:{value:new c["default"]},gridTintTexture:{value:new v["default"]}},m.FaceClap={faceClip:{value:0},faceClipProjection:{value:new c["default"]},faceClipModelView:{value:new c["default"]},faceClipTexture:{value:new v["default"]},faceClipRotateX:{value:0}},m.Gradual={gradual:{value:0},gradualHigh:{value:0},gradualTexture:{value:new v["default"]}},m.digArea={digAreaGrid:{value:0},digAreaProjectionMatrix:{value:new c["default"]},digAreaModelViewMatrix:{value:new c["default"]},digAreaTexture:{value:new v["default"]}},m.common={diffuse:{value:new l["default"](15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new s["default"]},alphaMap:{value:null}},m.specularmap={specularMap:{value:null}},m.envmap={envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},m.aomap={aoMap:{value:null},aoMapIntensity:{value:1}},m.lightmap={lightMap:{value:null},lightMapIntensity:{value:1}},m.emissivemap={emissiveMap:{value:null}},m.bumpmap={bumpMap:{value:null},bumpScale:{value:1}},m.normalmap={normalMap:{value:null},normalScale:{value:new d["default"](1,1)}},m.displacementmap={displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},m.roughnessmap={roughnessMap:{value:null}},m.metalnessmap={metalnessMap:{value:null}},m.gradientmap={gradientMap:{value:null}},m.fog={fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new l["default"](16777215)}},m.lights={ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},m.points={diffuse:{value:new l["default"](15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new s["default"]}},m.sprite={diffuse:{value:new l["default"](15658734)},opacity:{value:1},center:{value:new d["default"](.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new s["default"]}},t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(12),s=n(o),u=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;(0,a["default"])(this,t),this.color=new s["default"](e),this.density=i}return t.prototype.clone=function(){return new t(this.color,this.density)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(27),d=n(h),f=i(9),c=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.CubeReflectionMapping,r=arguments[2],o=arguments[3],u=arguments[4],l=arguments[5],h=arguments[6],d=arguments[7],c=arguments[8],p=arguments[9];(0,a["default"])(this,e);var v=(0,s["default"])(this,t.call(this,i,n,r,o,u,l,h,d,c,p));return v.flipY=!1,v}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(131),d=n(h),f=i(5),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.endPoint=function(){this.points.length>2&&this.points.pop(),this.points.pop(),this.points.push(this.points[0].clone()),this.parent&&(this.parent.needsUpdate=!0)},e.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.fillColor=this.userData.fill_color||"0078D7"},e.prototype.updatePoint=function(t){this.points.pop(),this.points.pop(),this.points.push(t),this.points.push(this.points[0].clone()),this.parent&&(this.parent.needsUpdate=!0)},e.prototype.getModelCenter=function(){var t=this,e=[],i=[];this.points.forEach(function(n){var r=t.projectToScreen(n);e.push(r.x),i.push(r.y)});var n=e.sort(function(t,e){return t-e}),r=i.sort(function(t,e){return t-e}),a=new c["default"]((n[0]+n[n.length-1])/2,r[0]);return a},e.prototype.move=function(t){var e=this.screenToProject(this.getModelCenter()),i=this.screenToProject(t),n=i.sub(e),r=new Array;this.points.forEach(function(t){r.push(t.add(n))}),this.updatePoints(r)},e.prototype.updateInfo=function(t,e){t.shapes||(t.shapes=new Array),t.shapes=e,t.position=null},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(96),d=n(h),f=i(8),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this.strokeColor=this.userData.color||"DD4F43",this.strokeOpacity=this.userData.opacity||1,this.strokeWeight=this.userData.line_width||2,this.points=[]},e.prototype.addPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.updatePoint(t,!1),e&&this.points.push(t),this.parent&&(this.parent.needsUpdate=!0)},e.prototype.updatePoint=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.points.pop(),this.points.push(t),e&&this.parent&&(this.parent.needsUpdate=!0)},e.prototype.draw=function(t){var e=this;this.points.length<2||(t.beginPath(),t.strokeStyle="#"+this.strokeColor,t.lineWidth=this.strokeWeight,t.lineJoin="round",t.globalAlpha=this.strokeOpacity,this.points.forEach(function(i,n){i.changeEPSGType(f.Const.EPSGType.EPSGWeb);var r=e.projectToScreen(i);0==n?t.moveTo(r.x,r.y):t.lineTo(r.x,r.y)}),t.stroke(),t.closePath(),this.fillColor&&(t.fillStyle="#"+this.fillColor,t.fill()))},e.prototype.updatePoints=function(t){this.points=t,this.parent&&(this.parent.needsUpdate=!0)},e.prototype.endPoint=function(){this.points.pop(),this.parent&&(this.parent.needsUpdate=!0)},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.map=e;var i=e.getControl("ScaleControl");i.register();var n=e.getControl("SelectControl");n.register(),this.map.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){var t=this.map.getControl("ScaleControl");t.dispose();var e=this.map.getControl("SelectControl");e.dispose(),this.map.off("dispose",this.dispose)},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(96),c=n(f),p=i(5),v=n(p),m=i(64),g=n(m),y=i(6),_=n(y),x=i(8),b=i(11),M=n(b),w=i(601),S=n(w),P=i(600),A=n(P),C=i(28),T=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.isAnimation=!1,i}return(0,d["default"])(e,t),e.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this.size=n;var r=e.data;this.rotateAngle=0,this.isTogether=parseInt(r.is_together||0),this.offsetxy=r.offset_xy||0,_["default"].isEmpty(r.icon)||(0==/http/i.test(r.icon)&&(r.icon=this.map.userData.ResourcesIP+"/"+r.icon),this.iconUrl||(this.iconUrl=""),this.iconUrl=r.icon,this.icon=new A["default"](r.icon,this,this.size)),_["default"].isEmpty(r.name)||1!=e.shapes.length||(this.label=new S["default"](r,i,this));var a=e.shapes[0],o=new M["default"](a.x,a.y,a.z||0,a.EPSGType);o.changeEPSGType(x.Const.EPSGType.EPSGWeb),this.position.copy(o)},e.prototype.draw=function(t){this.icon&&!this.icon.isComplete()||this.label&&!this.label.isComplete()||this.visible&&(this.px=this.projectToScreen(this.position),this.icon&&(this.isAnimation?(this.count||(this.count=0),this.map.Api.Time.on(.3,this.setVauge,this),this.count%2==0&&(_["default"].isEmpty(this.jumpUrl)||(this.count%4==0?this.icon.setUrl(this.jumpUrl):this.icon.setUrl(this.iconUrl)),this.icon.draw(t,this.px))):this.icon.draw(t,this.px),this.count++),this.label&&this.label.draw(t,this.px,this.icon),this.drawSelect(t,this.px))},e.prototype.isInside=function(t,e){if(!this.px)return!1;var i=this.getMarkerSize(),n=t-this.px.x,r=e-this.px.y;return n<=i.width&&n>=0&&r<=i.height&&r>=0},e.prototype.getMarkerSize=function(){var t=new g["default"](0,0,0);return this.icon||this.label?(this.icon?(t.width=this.icon.getSize().width,t.height=this.icon.getSize().height,this.label&&(t.width+=this.label.width+.1*t.width)):(t.width=this.label.width,t.height=this.label.height),t):t},e.prototype.changeColor=function(t){this.isSelect=!0,this.parent&&(this.parent.needsUpdate=!0)},e.prototype.resetColor=function(){this.isSelect=!1,this.parent&&(this.parent.needsUpdate=!0)},e.prototype.click=function(t){this.changeColor("#18ACF7"),this.fireEvent(C.Events.Mesh.Click,this,t),this.map.fireEvent(C.Events.Mesh.Click,this,t)},e.prototype.unClick=function(){this.resetColor(),this.fireEvent(C.Events.Mesh.UnClick,this),this.map.fireEvent(C.Events.Mesh.UnClick,this)},e.prototype.hover=function(){this.changeColor("#18ACF7"),this.fireEvent(C.Events.Mesh.Hover,this),this.map.fireEvent(C.Events.Mesh.Hover,this)},e.prototype.unHover=function(){this.resetColor(),this.fireEvent(C.Events.Mesh.UnHover,this),this.map.fireEvent(C.Events.Mesh.UnHover,this)},e.prototype.drawSelect=function(t,e){if(this.isSelect&&_["default"].isEmpty(this.userData.fill_color)){var i=this.getMarkerSize();try{var n=t.getImageData(e.x,e.y,i.width,i.height);n=this.transColor(n),t.putImageData(n,e.x,e.y)}catch(r){}}},e.prototype.transColor=function(t){for(var e=void 0,i=void 0,n=void 0,r=0;r<t.data.length;r+=4)e=t.data[r],i=t.data[r+1],n=t.data[r+2],t.data[r]=.272*e+.534*i+.131*n,t.data[r+1]=.349*e+.686*i+.168*n,t.data[r+2]=.393*e+.769*i+.189*n;return t},e.prototype.updateRotateAngle=function(t){this.rotateAngle=t},e.prototype.setIconUrl=function(t){0==/http/i.test(t)&&(t=this.map.userData.ResourcesIP+"/"+t),this.icon.setUrl(t),this.parent&&(this.parent.needsUpdate=!0)},e.prototype.setJumpUrl=function(t){0==/http/i.test(t)&&(t=this.map.userData.ResourcesIP+"/"+t),this.jumpUrl||(this.jumpUrl=""),this.jumpUrl=t},e.prototype.updateConfg=function(t){(0,a["default"])(this.userData,t),this.icon&&this.icon.updateConfig(),this.label&&this.label.updateConfig()},e.prototype.getMouseOffset=function(t){var e=new v["default"](0,0);return e.x=t.layerX-this.px.x,e.y=t.layerY-this.px.y,e},e.prototype.setVauge=function(){this.parent&&(this.parent.needsUpdate=!0)},e.prototype.getModelCenter=function(){return new v["default"](this.px.x,this.px.y)},e.prototype.move=function(t){var e=this.screenToProject(this.getModelCenter()),i=this.screenToProject(t),n=i.sub(e);this.px=this.projectToScreen(this.position.add(n)),this.parent&&(this.parent.needsUpdate=!0)},e}(c["default"]);e["default"]=T,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(72),c=n(f),p=i(6),v=n(p),m=i(16),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onRCService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.updateData=function(t){var i={method:m.Const.EventType.RC2DData,action:"update",datas:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.deleteData=function(t){var i={method:m.Const.EventType.RC2DData,action:"delete",datas:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.addData=function(t){var i={method:m.Const.EventType.RC2DData,action:"add",datas:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.refreshData=function(t,i,n,r,a){var o={method:m.Const.EventType.RC2DData,action:"get",objTypes:r,row:t,column:i,scale:n,conditions:a,applyData:{fn:e.fnName}};this.worker.postMessage(o)},e.prototype.refreshDBData=function(t,i){var n={method:m.Const.EventType.DBData,action:"get",objTypes:t,conditions:i,applyData:{fn:e.fnName}};this.worker.postMessage(n)},e.prototype.onRCService=function(t){var e=this;v["default"].isSuccess(t)&&t.values&&(0,a["default"])(t.values).map(function(i){e.fireEvent(i,t.values[i],t.message,i)})},e}(c["default"]);e["default"]=g,g.fnName="RCService",t.exports=e["default"]},function(t,e,i){t.exports={"default":i(634),__esModule:!0}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){t.exports={}},function(t,e,i){var n=i(87),r=i(215),a=i(137),o=i(142)("IE_PROTO"),s=function(){},u="prototype",l=function(){var t,e=i(211)("iframe"),n=a.length,r="<",o=">";for(e.style.display="none",i(645).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+o+"document.F=Object"+r+"/script"+o),t.close(),l=t.F;n--;)delete l[u][a[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(s[u]=n(t),i=new s,s[u]=null,i[o]=t):i=l(),void 0===e?i:r(i,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,i){var n=i(63).f,r=i(62),a=i(77)("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,a)&&n(t,a,{configurable:!0,value:e})}},function(t,e,i){var n=i(143)("keys"),r=i(102);t.exports=function(t){return n[t]||(n[t]=r(t))}},function(t,e,i){var n=i(29),r=i(54),a="__core-js_shared__",o=r[a]||(r[a]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i(98)?"pure":"global",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e,i){var n=i(75);t.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,i){var n=i(54),r=i(29),a=i(98),o=i(147),s=i(63).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=a?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},function(t,e,i){e.f=i(77)},function(t,e,i){"use strict";var n=i(55).assign,r=i(671),a=i(672),o=i(224),s={};n(s,r,a,o),t.exports=s},function(t,e){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";var n=i(30),r=i(234),a=i(237),o=i(243),s=i(241),u=i(153),l="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||i(236);t.exports=function(t){return new Promise(function(e,h){var d=t.data,f=t.headers;n.isFormData(d)&&delete f["Content-Type"];var c=new XMLHttpRequest,p="onreadystatechange",v=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in c||s(t.url)||(c=new window.XDomainRequest,p="onload",v=!0,c.onprogress=function(){},c.ontimeout=function(){}),t.auth){var m=t.auth.username||"",g=t.auth.password||"";f.Authorization="Basic "+l(m+":"+g)}if(c.open(t.method.toUpperCase(),a(t.url,t.params,t.paramsSerializer),!0),c.timeout=t.timeout,c[p]=function(){if(c&&(4===c.readyState||v)&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in c?o(c.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?c.response:c.responseText,a={data:n,status:1223===c.status?204:c.status,statusText:1223===c.status?"No Content":c.statusText,headers:i,config:t,request:c};r(e,h,a),c=null}},c.onerror=function(){h(u("Network Error",t,null,c)),c=null},c.ontimeout=function(){h(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",c)),c=null},n.isStandardBrowserEnv()){var y=i(239),_=(t.withCredentials||s(t.url))&&t.xsrfCookieName?y.read(t.xsrfCookieName):void 0;_&&(f[t.xsrfHeaderName]=_)}if("setRequestHeader"in c&&n.forEach(f,function(t,e){"undefined"==typeof d&&"content-type"===e.toLowerCase()?delete f[e]:c.setRequestHeader(e,t)}),t.withCredentials&&(c.withCredentials=!0),t.responseType)try{c.responseType=t.responseType}catch(x){if("json"!==t.responseType)throw x}"function"==typeof t.onDownloadProgress&&c.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){c&&(c.abort(),h(t),c=null)}),void 0===d&&(d=null),c.send(d)})}},function(t,e){"use strict";function i(t){this.message=t}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,t.exports=i},function(t,e){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,i){"use strict";var n=i(233);t.exports=function(t,e,i,r,a){var o=new Error(t);return n(o,e,i,r,a)}},function(t,e){"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(17),o=r(a),s=i(10),u=r(s),l=i(1),h=r(l),d=i(3),f=r(d),c=i(2),p=r(c),v=i(22),m=r(v),g=i(268),y=n(g),_=i(157),x=n(_),b=i(330),M=n(b),w=i(41),S=r(w),P=i(302),A=r(P),C=i(48),T=n(C),E=i(207),D=r(E),L=i(340),F=r(L),k=i(13),I=i(64),O=r(I),N=i(5),R=r(N),U=i(6),B=r(U),j=function(t){function e(){return(0,h["default"])(this,e),(0,f["default"])(this,t.apply(this,arguments))}return(0,p["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.services={},this.controls={},this.renders={}},e.prototype.getControl=function(t){return this.controls[t]},e.prototype.getSize=function(){var t=this.width||this.userData.dom.offsetWidth;t<1&&(t=parseInt(this.userData.dom.style.width));var e=this.height||this.userData.dom.offsetHeight;return e<1&&(e=parseInt(this.userData.dom.style.height)),new O["default"](t,e)},e.prototype.getOffset=function(){var t=this.userData.dom.offsetLeft,e=this.userData.dom.offsetTop;return new R["default"](t,e)},e.prototype.setSize=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.width=t,this.height=e,i&&(this.userData.dom.style.height=e+"px",this.userData.dom.style.width=t+"px"),this.fireEvent(k.Events.Earth.Resize,this)},e.prototype.setHandler=function(t){null!=this.earthHandler&&this.earthHandler.dispose(),this.earthHandler=t,this.fireEvent(k.Events.Earth.HandlerChange,this)},e.prototype.initApis=function(){var t=this;(0,u["default"])(y).map(function(e){t[e]=new y[e](t)},this)},e.prototype.initServices=function(){var t=this;this.services.WorkerService=new D["default"](this.userData.EngineIP),(0,u["default"])(T).map(function(e){t.services[e]=new T[e](t)},this)},e.prototype.initControls=function(){var t=this;(0,u["default"])(x).map(function(e){t.controls[e]=new x[e](t)},this)},e.prototype.initRenders=function(){var t=this;(0,u["default"])(M).map(function(e){t.renders[e]=new M[e](t)})},e.prototype.getService=function(t){return this.services[t]},e.prototype.show=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.getControl("ViewControl");e.run(t),window.dispatchEvent(new Event("resize"))},e.prototype.open=function(){this.userData.OpenBuildID="",this.userData.OpenDefaultFloor="";var t=this.getService(T.AttributeService.fnName);t.getConfig(this.userData.key,null,null,this.loadConfig,this)},e.prototype.openInner=function(t,e){this.userData.OpenBuildID=t,this.userData.OpenDefaultFloor=e;var i=this.getService(T.AttributeService.fnName);i.getConfig(this.userData.key,t,e,this.loadInnerConfig,this)},e.prototype.loadConfig=function(t){B["default"].isSuccess(t)&&(this.confg=new F["default"](t.values,this.userData),this.userData.isInner=!1,this.initControls(),this.initRenders(),this.setHandler(new S["default"](this)))},e.prototype.loadInnerConfig=function(t){B["default"].isSuccess(t)&&(this.confg=new F["default"](t.values,this.userData),this.userData.isInner=!0,this.initControls(),this.initRenders(),this.setHandler(new A["default"](this)),this.fireEvent(k.Events.Earth.OpenBuild,void 0,this.userData.OpenBuildID,this.userData.OpenDefaultFloor))},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.initApis(),this.initServices(),window.doGiswayEngineOverride&&window.doGiswayEngineOverride(this,"earth"),window.doGiswayEnginePlus&&window.doGiswayEnginePlus(this,"earth")},e.prototype.changeConfig=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o["default"])(this.userData,t),this.disposeChildren(),this.initServices(),this.open()},e.prototype.disposeChildren=function(){var t=this;(0,u["default"])(this.renders).map(function(e){t.renders[e].dispose()}),(0,u["default"])(this.controls).map(function(e){t.controls[e].dispose()}),(0,u["default"])(this.services).map(function(e){t.services[e].dispose()}),this.earthHandler&&this.earthHandler.dispose(),this.earthHandler=null,this.renders={},this.controls={},this.services={}},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposeChildren()},e}(m["default"]);e["default"]=j,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(246);Object.defineProperty(e,"Camera",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(263);Object.defineProperty(e,"PostProcess",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(247);Object.defineProperty(e,"Claps",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(255);Object.defineProperty(e,"Light",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(257);Object.defineProperty(e,"Menus",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(258);Object.defineProperty(e,"MeshInfo",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(261);Object.defineProperty(e,"Poi",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(262);Object.defineProperty(e,"Pop",{enumerable:!0,get:function(){return n(d)["default"]}});var f=i(264);Object.defineProperty(e,"Screen",{enumerable:!0,get:function(){return n(f)["default"]}});var c=i(265);Object.defineProperty(e,"Street",{enumerable:!0,get:function(){return n(c)["default"]}});var p=i(267);Object.defineProperty(e,"Type",{enumerable:!0,get:function(){return n(p)["default"]}});var v=i(266);Object.defineProperty(e,"Time",{enumerable:!0,get:function(){return n(v)["default"]}});var m=i(259);Object.defineProperty(e,"Models",{enumerable:!0,get:function(){return n(m)["default"]}});var g=i(250);Object.defineProperty(e,"GPS",{enumerable:!0,get:function(){return n(g)["default"]}});var y=i(254);Object.defineProperty(e,"Layers",{enumerable:!0,get:function(){return n(y)["default"]}});var _=i(249);Object.defineProperty(e,"Draws",{enumerable:!0,get:function(){return n(_)["default"]}});var x=i(256);Object.defineProperty(e,"Measure",{enumerable:!0,get:function(){return n(x)["default"]}});var b=i(253);Object.defineProperty(e,"Inspect",{enumerable:!0,get:function(){return n(b)["default"]}});var M=i(252);Object.defineProperty(e,"Inner",{enumerable:!0,get:function(){return n(M)["default"]}});var w=i(248);Object.defineProperty(e,"DigAreas",{enumerable:!0,get:function(){return n(w)["default"]}});var S=i(251);Object.defineProperty(e,"GridTints",{enumerable:!0,get:function(){return n(S)["default"]}});var P=i(260);Object.defineProperty(e,"Navigate",{enumerable:!0,get:function(){return n(P)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(279);Object.defineProperty(e,"ViewControl",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(271);Object.defineProperty(e,"CursorControl",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(276);Object.defineProperty(e,"MouseControl",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(277);Object.defineProperty(e,"ScaleControl",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(275);Object.defineProperty(e,"LayerControl",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(278);Object.defineProperty(e,"SelectControl",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(273);Object.defineProperty(e,"EditControl",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(272);Object.defineProperty(e,"DrawControl",{enumerable:!0,get:function(){return n(d)["default"]}});var f=i(274);Object.defineProperty(e,"FlyModeControl",{enumerable:!0,get:function(){return n(f)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(67),c=n(f),p=i(113),v=i(386),m=n(v),g=i(12),y=n(g),_=i(9),x=i(21),b=n(x),M=i(11),w=n(M),S=i(8),P=i(6),A=n(P),C=i(34),T=n(C),E=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,(0,a["default"])(this.userData,t),this.userData.high=A["default"].getDefaultNumber(t.high,.01),this.userData.bg_high=A["default"].getDefaultNumber(t.bg_high,0),this.material=this.getMaterialCfg();var i=t.shapes[0];i.z<this.userData.bg_high&&(i.z=this.userData.bg_high),i=new w["default"](i.x,i.y,i.z,i.EPSGType||S.Const.EPSGType.EPSG84),i.changeEPSGType(S.Const.EPSGType.EPSGWeb);var n=-this.userData.high;this.position.set(i.x,i.y,n),this.initGeometry(t)},e.prototype.initGeometry=function(t){var e=this,i=new c["default"];t.shapes.forEach(function(t,n){var r=new w["default"](t.x,t.y,t.z,t.EPSGType||S.Const.EPSGType.EPSG84);r.changeEPSGType(S.Const.EPSGType.EPSGWeb),r.sub(e.position),0==n?i.moveTo(r.x,r.y):i.lineTo(r.x,r.y)});var n=i.toShapes(!0),r={amount:t.high,bevelEnabled:!1,elementsNeedUpdate:!0};n.forEach(function(t,i){e.geometry=new p.ExtrudeGeometry(t,r)},this);var a=this.position.clone();a.z-=t.bg_high+t.high},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="DigArea",this.userData.objType="DigAreaObj",this.userData.high=0},e.prototype.getMaterialCfg=function(){var t=[],e={color:new y["default"]("#"+this.userData.color),depthTest:!1};if(this.userData.opacity=A["default"].getDefaultNumber(this.userData.opacity,1),(0,a["default"])(e,{transparent:this.userData.opacity<1,opacity:this.userData.opacity}),!A["default"].isEmpty(this.userData.material)){var i="0.05,0.05",n=i.split(","),r=T["default"].createTexture(this.userData.material);r.wrapS=r.wrapT=_.RepeatWrapping,r.repeat.set(parseFloat(n[0]),parseFloat(n[1])),e.map=r}e.depthTest=!0;for(var o=0;o<3;o++){var s=(0,a["default"])({},e);s.side=o%2==0?_.BackSide:_.DoubleSide;var u=new m["default"](s);t.push(u)}return t},e}(b["default"]);e["default"]=E,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(5),s=n(o),u=function l(t,e,i){(0,a["default"])(this,l),this.center=new s["default"](t.x,t.y),this.devPos=new s["default"](t.devX||0,t.devY||0),this.width=e,this.height=i,this.west=this.center.x-this.width/2,this.east=this.center.x+this.width/2,this.north=this.center.y+this.height/2,this.south=this.center.y-this.height/2};e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(49),d=n(h),f=i(92),c=i(381),p=i(35),v=i(14),m=n(v),g=i(38),y=n(g),_=i(21),x=n(_),b=i(331),M=n(b),w=i(8),S=i(13),P=i(44),A=n(P),C=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.geometry=new f.BoxBufferGeometry(2,2,2),this.material=new p.MeshBasicMaterial({color:"#ffffff"});var i=this.earth.getSize();this.target=new y["default"](i.width,i.height),this.setPosition(t.shapes)},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="InspectArea",this.userData.radius=200,this.userData.near=.1,this.userData.cantAngle=-20,this.userData.pathAngle=90,this.userData.levelDeg=100,this.userData.verticalDeg=50,this.camera=new d["default"],this.camera.up.set(0,0,1),this.helper=new c.CameraHelper(this.camera)},e.prototype.setLookAt=function(t){var e=t.distanceTo(this.position);e<25&&(e=25);var i=Math.asin((t.z-this.position.z)/e);this.userData.cantAngle=180*i/Math.PI,this.userData.radius=e,i=180*Math.asin((t.y-this.position.y)/Math.cos(i)/e)/Math.PI,t.x<this.position.x&&(i=180-i),this.userData.pathAngle=i,this.updateHelper()},e.prototype.updateHelper=function(){var t=this.userData.radius,e=this.userData.near,i=Math.asin(this.userData.verticalDeg/2/this.userData.radius)||0,n=this.userData.cantAngle/180*Math.PI,r=this.userData.pathAngle/180*Math.PI;this.setCameraParams(2*i,t,e,r,n)},e.prototype.setCameraParams=function(t,e,i,n,r){this.camera.aspect=this.userData.levelDeg/this.userData.verticalDeg,
this.camera.fov=180*t/Math.PI,this.camera.far=e,this.camera.near=i,this.camera.position.copy(this.position);var a=A["default"].getXYZ(e,n,r);a.add(this.position),this.camera.updateMatrix(),this.camera.updateMatrixWorld(!1),this.camera.updateProjectionMatrix(),this.camera.lookAt(a),this.initRenderBuffer(),this.helper.update()},e.prototype.initRenderBuffer=function(){this.viewControl||(this.viewControl=this.earth.getControl("ViewControl")),this.layerControl||(this.layerControl=this.earth.getControl("LayerControl")),this.setInspectAreaDepth(!0),this.viewControl.renderer.setRenderTarget(this.target),this.viewControl.renderer.clear(),this.viewControl.renderer.render(this.viewControl.scene,this.camera,this.target),this.viewControl.renderer.setRenderTarget(null),this.setInspectAreaDepth(!1)},e.prototype.setInspectAreaDepth=function(t){var e=this,i=this.layerControl.getAllSceneMeshs(!1);i.forEach(function(i){t?(i.oldMaterial=i.material,i.material=new M["default"]({}),i.material.uniforms.inspectAreaFar.value=e.camera.far,i.material.uniforms.inspectAreaNear.value=e.camera.near):(i.material=i.oldMaterial,delete i.oldMaterial)},this)},e.prototype.setPosition=function(t){t.changeEPSGType(w.Const.EPSGType.EPSGWeb),this.position.copy(t),this.camera.position.copy(t)},e.prototype.setDefault=function(){this.earth.on(S.Events.Mouse.Move,this.listenMouseMove,this)},e.prototype.setNotDefault=function(){this.earth.off(S.Events.Mouse.Move,this.listenMouseMove,this)},e.prototype.listenMouseMove=function(t){t||(t=event);var e=this.earth.getControl("LayerControl"),i=t.clientX||t.layerX||t.pageX,n=t.clientY||t.layerY||t.pageY,r=e.getSelectMeshs({x:i,y:n},!1);r&&r.point&&this.setLookAt(r.point)},e.prototype.dispose=function(){this.target.dispose(),this.camera.dispose(),this.helper.dispose(),t.prototype.dispose.call(this)},e.prototype.getUniforms=function(t){var e=new m["default"],i=this.camera.matrixWorldInverse;return e.multiplyMatrices(i,t.matrixWorld),{modelViewMatrix:e,projectionMatrix:this.camera.projectionMatrix,texture:this.target,near:this.camera.near,far:this.camera.far}},e}(x["default"]);e["default"]=C,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(91),d=n(h),f=i(23),c=n(f),p=i(35),v=i(12),m=n(v),g=i(4),y=n(g),_=i(24),x=n(_),b=i(9),M=i(11),w=n(M),S=i(8),P=i(89),A=n(P),C=i(6),T=n(C),E=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.endPoint=function(){this.points.length>2&&this.points.pop(),this.points.pop(),this.points.push(this.points[0].clone()),this.drawLine()},e.prototype.initDefaultGeo=function(e,i){t.prototype.initDefaultGeo.call(this,e,i),this.type="Polygon";var n={color:this.userData.fill_color?"#"+this.userData.fill_color:"#007ACC",transparent:!0,depthTest:!1,side:b.DoubleSide,opacity:this.userData.opacity||.5};this.mtl=new p.MeshPhongMaterial(n)},e.prototype.updatePoint=function(t){this.points.pop(),this.points.pop(),this.points.push(t),this.points.push(this.points[0].clone()),this.drawLine()},e.prototype.drawLine=function(){var t=[],e=[],i=new m["default"](16777215*Math.random()),n=new w["default"],r=new c["default"];if(this.points.forEach(function(a,o){a.changeEPSGType(S.Const.EPSGType.EPSGWeb),0==o&&n.copy(a);var s=a.clone().sub(n);t.push(s.x,s.y,s.z),e.push(i.r,i.g,i.b),r.vertices.push(new y["default"](s.x,s.y,s.z))}),this.geometry.setPositions(t),this.geometry.setColors(e),this.computeLineDistances(),this.position.copy(n),r.vertices.length>=3){for(var a=2;a<r.vertices.length;a++){var o=new d["default"](0,a-1,a);r.faces.push(o)}this.mesh?this.mesh.geometry=r:(this.mesh=new x["default"](r,this.mtl),this.add(this.mesh)),this.mesh.userData=this.userData}},e.prototype.nodeDelete=function(t){if(t){var e=t.userData.nodeIndex;if(this.points.length>3){if(0==e||e==this.points.length-1){var i=this.points[0],n=this.points[this.points.length-1];if(0==i.distanceTo(n))return}this.points.splice(e,1),this.parent.remove(t),this.updateLine()}else T["default"].warn("\u591a\u8fb9\u5f62\u7684\u9876\u70b9\u6570\u4e0d\u80fd\u5c11\u4e8e\u4e09\u4e2a\uff01")}},e.prototype.nodeUpdate=function(t,e){var i=e.userData.nodeIndex,n=new w["default"](t.x,t.y,t.z,S.Const.EPSGType.EPSGWeb);if(1==e.userData.isNode||1==e.userData.isInsert){if(0==i||i==this.points.length-1){var r=0==i?this.points.length-1:0,a=this.points[r];0==this.points[i].distanceTo(a)&&(this.points[r]=n.clone(),this.moveArrays[r].position=n.clone())}this.points[i]=n}this.dealVirNode(n,e)},e.prototype.doEdit=function(){t.prototype.doEdit.call(this),this.userData.oldOpacity=this.mtl.opacity,this.mtl.opacity=.5},e.prototype.getInfo=function(t){var e=this.userData.oldOpacity||this.userData.opacity;this.userData.opacity=e;var i=this.points[0],n=this.points[this.points.length-1];0!=i.distanceTo(n)&&this.points.push(i);var r={objType:this.parent?this.parent.userData.objType:t,position:this.points,userData:this.userData,gtype:3003};return r},e}(A["default"]);e["default"]=E,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(294);Object.defineProperty(e,"Fbx",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(297);Object.defineProperty(e,"Obj",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(295);Object.defineProperty(e,"Marker",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(298);Object.defineProperty(e,"Osgb",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(296);Object.defineProperty(e,"Mtl",{enumerable:!0,get:function(){return n(u)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=i(8),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="DigAreaLayer",this.virtual=!0,this.layers.set(f.Const.LayerMask.Four)},e.prototype.canDraw=function(){return!0},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(26),l=n(u),h=i(68),d=n(h),f=i(82),c=n(f),p=i(118),v=n(p),m=i(12),g=n(m),y=i(5),_=n(y),x=i(9),b=i(34),M=n(b),w=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s["default"])(this,t),this.light=parseInt(i.light||"0"),this.ResourcesIP=i.ResourcesIP||"",delete i.light,delete i.ResourcesIP,this.params={},(0,a["default"])(this.params,i),this.parse(e)}return t.prototype.parse=function(t){for(var e=t.split("\n"),i={},n=/\s+/,r={},a=0;a<e.length;a++){var o=e[a];if(o=o.trim(),0!==o.length&&"#"!==o.charAt(0)){var s=o.indexOf(" "),u=s>=0?o.substring(0,s):o;u=u.toLowerCase();var l=s>=0?o.substring(s+1):"";if(l=l.trim(),"newmtl"===u)i={name:l},r[l]=i;else if(i)if("ka"===u||"kd"===u||"ks"===u){var h=l.split(n,3);i[u]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else i[u]=l}}this.initMaterials(r)},t.prototype.initMaterials=function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},t.prototype.convert=function(t){var e={};for(var i in t){var n=t[i],r={};e[i]=r;for(var a in n){var o=n[a],s=a.toLowerCase();r[s]=o}}return e},t.prototype.create=function(t){return this.materials[t]?this.materials[t]:this.createMaterial(t)},t.prototype.createMaterial=function(t){function e(t){var e=t;if(!/http/i.test(t))return e=n.ResourcesIP+"/"+t}function i(t,i){if(!o[t]){var r=n.getTextureParams(i,o),a=e(r.url),s=n.loadTexture(a);s.wrapS=x.RepeatWrapping,s.wrapT=x.RepeatWrapping,"envMap"==t?s.mapping=x.SphericalReflectionMapping:(s.repeat.copy(r.scale),s.offset.copy(r.offset)),o[t]=s}}var n=this,r=this.materialsInfo[t],o={name:t,transparent:!1};(0,a["default"])(o,this.params);for(var s in r){var u=r[s],h=void 0;if(""!==u)switch(u.indexOf(".png")>0&&(o.transparent=!0),s.toLowerCase()){case"kd":o.color=(new g["default"]).fromArray(u);break;case"ks":break;case"map_ka":i("map",u);break;case"map_d":i("map",u);break;case"map_kd":i("map",u);break;case"metalness_map":i("metalnessMap",u);break;case"roughness_map":i("roughnessMap",u);break;case"env_map":i("envMap",u);break;case"map_ks":i("specularMap",u);break;case"map_bump":break;case"norm":i("normalMap",u);break;case"bump":i("bumpMap",u);break;case"ns":break;case"metalness":o.metalness=parseFloat(u);break;case"roughness":o.roughness=parseFloat(u);break;case"alpha_test":o.alphaTest=parseFloat(u);break;case"side":o.side=parseFloat(u);break;case"d":h=parseFloat(u),h<1&&(o.opacity=h,o.transparent=!0);break;case"tr":h=parseFloat(u),h>0&&(o.opacity=1-h,o.transparent=!0);break;case"light":o.lightMaterial=parseFloat(u)}}var f=this.light;switch(void 0!=o.lightMaterial&&(f=o.lightMaterial),f){case 1:this.materials[t]=new d["default"](o);break;case 2:this.materials[t]=new c["default"](o);break;case 3:this.materials[t]=new v["default"](o);break;default:this.materials[t]=new l["default"](o)}return this.materials[t]},t.prototype.getTextureParams=function(t,e){var i={scale:new _["default"](1,1),offset:new _["default"](0,0),url:""},n=t.split(/\s+/),r=void 0;return r=n.indexOf("-bm"),r>=0&&(e.bumpScale=parseFloat(n[r+1]),n.splice(r,2)),r=n.indexOf("-s"),r>=0&&(i.scale.set(parseFloat(n[r+1]),parseFloat(n[r+2])),n.splice(r,4)),r=n.indexOf("-o"),r>=0&&(i.offset.set(parseFloat(n[r+1]),parseFloat(n[r+2])),n.splice(r,4)),i.url=n.join(" ").trim(),i},t.prototype.loadTexture=function(t){return M["default"].createTexture(t)},t}();e["default"]=w,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(7),c=n(f),p=i(343),v=n(p),m=i(43),g=n(m),y=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.addFlyDataNodes=function(t,e,i,n){var r=this.earth.userData.EngineIP+"/gisway/earth/restful/DataControl/doAddFlyDataNodes",o=c["default"].getUUID();this.on(o,i,n);var s=new FormData;s.append("token",t),s.append("columnsJson",e),s.append("applyData",(0,a["default"])({fnid:o})),v["default"].post(r,s,this.onDataControllerService.bind(this))},e.prototype.getFlyDataNodes=function(t,e,i,n){var r=this.earth.userData.EngineIP+"/gisway/earth/restful/DataControl/readFlyDataNodes",o=c["default"].getUUID();this.on(o,i,n);var s=new FormData;s.append("token",t),s.append("flymode_id",e),s.append("applyData",(0,a["default"])({fnid:o})),v["default"].post(r,s,this.onDataControllerService.bind(this))},e.prototype.onDataControllerService=function(t){var e=JSON.parse(t.code),i=e.fnid;this.fireEvent(i,t),this.off(i)},e}(g["default"]);e["default"]=y,y.fnName="DataControllerService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(7),d=n(h),f=i(16),c=i(43),p=n(c),v=i(6),m=n(v),g=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onInnerService.bind(n)),n}return(0,l["default"])(e,t),e.prototype.refreshInnerData=function(t){var i={method:f.Const.EventType.InnerData,action:"get",floor_id:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.refreshInnerBusinessData=function(t){var i={method:f.Const.EventType.InnerBusinessData,action:"get",floor_id:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.refreshFloorData=function(t,i,n,r){var a=d["default"].getUUID();this.on(a,n,r);var o={method:f.Const.EventType.FloorData,action:"get",build_id:t,floor_id:i,applyData:{fn:e.fnName,fnid:a}};this.worker.postMessage(o)},e.prototype.refreshGdeFloorData=function(t,i){var n=d["default"].getUUID();this.on(n,t,i);var r={method:f.Const.EventType.GdeFloorData,action:"get",applyData:{fn:e.fnName,fnid:n}};this.worker.postMessage(r)},e.prototype.onInnerService=function(t){if(m["default"].isSuccess(t)){var e=t.applyData.fnid;e?(this.fireEvent(e,t),this.off(e)):this.fireEvent(t.message,t.values)}},e}(p["default"]);e["default"]=g,g.fnName="InnerService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(184),s=n(o),u=i(185),l=n(u),h=i(116),d=n(h),f=i(186),c=n(f),p=i(6),v=n(p),m=function(){function t(){(0,a["default"])(this,t)}return t.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this["create"+t]?this["create"+t](e):void v["default"].warn("\u521b\u5efa\u706f\u5149\u5931\u8d25,"+t+"\u65e0\u6b64\u706f.")},t.createPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new d["default"](t.color||"#FF0000",t.intensity,t.distance,t.decay);e.castShadow=t.castShadow||!1;var i=e.shadow.camera,n=1024;return i.near=1,i.far=t.distance,i.left=-n,i.right=n,i.top=n,i.bottom=-n,e.shadow.mapSize.x=4*n,e.shadow.mapSize.y=4*n,e.shadow.bias=0,e},t.createSpot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new c["default"](t.color||"#c7c7c7",t.intensity||1,t.distance||200,t.angle||.5,t.penumbra||.2,t.decay||2);e.castShadow=t.castShadow||!1;var i=e.shadow.camera;return i.near=1,i.far=t.distance,e.shadow.mapSize.x=4096,e.shadow.mapSize.y=4096,e},t.createAmbient=function(t){return new s["default"](t.color||"#c7c7c7",t.intensity||.7)},t.createDirectional=function(t){var e=new l["default"](t.color||"#fffff5",t.intensity||.8);e.castShadow=t.castShadow||!1;var i=e.shadow.camera;return i.far=t.far||5e4,e.shadow.bias=0,e},t}();e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(25),s=n(o),u=i(5),l=n(u),h=function(){function t(e,i,n){(0,a["default"])(this,t),this.routes=n,this.init()}return t.prototype.init=function(){},t.prototype.drawInit=function(t,e){this.workDatas||(this.workDatas={}),this.workDatas[t.uuid]||(this.workDatas[t.uuid]={}),this.workDatas[t.uuid].canvas=t.canvas},t.prototype.drawResize=function(t,e){this.workDatas[t.uuid].canvas&&(this.workDatas[t.uuid].canvas.width=t.data.width,this.workDatas[t.uuid].canvas.height=t.data.height)},t.prototype.add=function(t,e){},t.prototype.del=function(t,e){},t.prototype.syncDraw=function(t,e){},t.prototype.getDev=function(t,e,i,n){var r=s["default"].P84ToWeb_X(t[0]),a=s["default"].P84ToWeb_Y(t[1]),o=s["default"].getResolution(n),u=new l["default"](r,a);return u.x=e.x-u.x,u.y-=e.y,u.divideScalar(o),new l["default"](i.width/2,i.height/2).sub(u)},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(1),o=r(a),s=i(3),u=r(s),l=i(2),h=r(l),d=i(65),f=r(d),c=i(16),p=i(162),v=n(p),m=i(148),g=function(t){function e(){return(0,o["default"])(this,e),(0,u["default"])(this,t.apply(this,arguments))}return(0,h["default"])(e,t),e.prototype.init=function(){this.routes.add(c.Const.EventType.File,this.getFile.bind(this));var t=new Uint8Array([0,97,115,109,1,0,0,0,1,132,128,128,128,0,1,96,0,0,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,148,128,128,128,0,2,6,109,101,109,111,114,121,2,0,7,97,110,97,108,121,115,101,0,0,10,219,128,128,128,0,1,213,128,128,128,0,1,1,127,65,0,40,2,12,65,31,58,0,0,65,0,40,2,12,65,139,1,58,0,1,65,0,40,2,12,65,8,58,0,2,65,0,40,2,12,65,8,58,0,3,65,0,40,2,12,34,0,66,227,157,154,226,165,224,255,179,233,0,55,0,4,32,0,65,243,220,188,147,6,54,0,12,32,0,65,234,0,59,0,16,11,11,138,128,128,128,0,1,0,65,12,11,4,0,0,0,0]),e=new this.self.WebAssembly.Module(t);this.wasmInstance=new this.self.WebAssembly.Instance(e,{env:{}}),this.wasmInstance.exports.analyse(),this.length=18},e.prototype.inflate=function(t){var e=Math.floor(t.byteLength/2),i=t.byteLength%2,n=new ArrayBuffer(t.byteLength+this.length),r=new Uint8Array(n,this.length,e);r.set(new Uint8Array(t,e+i,e)),r=new Uint8Array(n,this.length+e+i,e),r.set(new Uint8Array(t,0,e));var a=new Uint8Array(this.wasmInstance.exports.memory.buffer,0,18),o=new Uint8Array(n);return o.set(a),a=new Uint8Array(t),1==i&&(o[this.length+e]=a[e]),(0,m.inflate)(o,{to:"string"})},e.prototype.getFile=function(t){var e=this,i=new XMLHttpRequest;t.gz&&(i.responseType="arraybuffer"),i.open(t.action,t.url);var n={success:!1,message:"",values:null,shapes:null,applyData:t.applyData};i.onload=function(r){var a=t.gz?r.target.response:r.target.responseText,o=[];if(v[t.type]){n.success=!0,t.gz&&(a=e.inflate(a));var s=new v[t.type](a,t.applyData.options);n.shapes=s.getAttributes(o)}else console.warn("\u6a21\u578b\u89e3\u6790\u4e0d\u5b58\u5728:"+t.type),n.message="\u6a21\u578b\u89e3\u6790\u4e0d\u5b58\u5728:"+t.type;i.onload=null,e.self.postMessage(n,o)},i.onerror=function(){n.message="\u8bbf\u95ee\u51fa\u9519:"+t.url,e.self.postMessage(n,[])},i.send()},e}(f["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=i(56),l=n(u),h=i(173),d=i(175),f=i(362),c=i(174),p=i(361),v=i(363),m=i(172),g=n(m),y=function(){function t(e,i,n){(0,a["default"])(this,t),this.name=e,this.tracks=n,this.duration=void 0!==i?i:-1,this.uuid=s["default"].getUUID(),this.duration<0&&this.resetDuration()}return t.prototype.getTrackTypeForValueTypeName=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return h.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return d.VectorKeyframeTrack;case"color":return f.ColorKeyframeTrack;case"quaternion":return c.QuaternionKeyframeTrack;case"bool":case"boolean":return p.BooleanKeyframeTrack;case"string":return v.StringKeyframeTrack}throw new Error("KeyframeTrack: Unsupported typeName: "+t)},t.prototype.parseKeyframeTrack=function(t){if(void 0===t.type)throw new Error("KeyframeTrack: track type undefined, can not parse");var e=this.getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],n=[];g["default"].flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return e.parse instanceof Function?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},t.parse=function(e){for(var i=[],n=e.tracks,r=1/(e.fps||1),a=0,o=n.length;a!==o;++a)i.push((new t).parseKeyframeTrack(n[a]).scale(r));return new t(e.name,e.duration,i)},t.toJSON=function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},r=0,a=i.length;r!==a;++r)e.push(l["default"].toJSON(i[r]));return n},t.CreateFromMorphTargetSequence=function(e,i,n,r){for(var a=i.length,o=[],s=0;s<a;s++){var u=[],l=[];u.push((s+a-1)%a,s,(s+1)%a),l.push(0,1,0);var d=g["default"].getKeyframeOrder(u);u=g["default"].sortedArray(u,1,d),l=g["default"].sortedArray(l,1,d),r||0!==u[0]||(u.push(a),l.push(l[0])),o.push(new h.NumberKeyframeTrack(".morphTargetInfluences["+i[s].name+"]",u,l).scale(1/n))}return new t(e,(-1),o)},t.findByName=function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},t.CreateClipsFromMorphTargetSequences=function(e,i,n){for(var r={},a=/^([\w-]*?)([\d]+)$/,o=0,s=e.length;o<s;o++){var u=e[o],l=u.name.match(a);if(l&&l.length>1){var h=l[1],d=r[h];d||(r[h]=d=[]),d.push(u)}}var f=[];for(var c in r)f.push(t.CreateFromMorphTargetSequence(c,r[c],i,n));return f},t.parseAnimation=function(e,i,n){if(!e)return console.error("AnimationClip: No animation in JSONLoader data."),null;for(var r=function(t,e,i,n,r){if(0!==i.length){var a=[],o=[];g["default"].flattenJSON(i,a,o,n),0!==a.length&&r.push(new t(e,a,o))}},a=[],o=e.name||"default",s=e.length||-1,u=e.fps||30,l=e.hierarchy||[],f=0;f<l.length;f++){var p=l[f].keys;if(p&&0!==p.length)if(p[0].morphTargets){var v={},m=void 0;for(m=0;m<p.length;m++)if(p[m].morphTargets)for(var y=0;y<p[m].morphTargets.length;y++)v[p[m].morphTargets[y]]=-1;for(var _ in v){for(var x=[],b=[],M=0;M!==p[m].morphTargets.length;++M){var w=p[m];x.push(w.time),b.push(w.morphTarget===_?1:0)}a.push(new h.NumberKeyframeTrack(".morphTargetInfluence["+_+"]",x,b))}s=v.length*(u||1)}else{var S=".bones["+i[f].name+"]";r(d.VectorKeyframeTrack,S+".position",p,"pos",a),r(c.QuaternionKeyframeTrack,S+".quaternion",p,"rot",a),r(d.VectorKeyframeTrack,S+".scale",p,"scl",a)}}if(0===a.length)return null;var P=new t(o,s,a);return P},t.prototype.resetDuration=function(){for(var t=this.tracks,e=0,i=0,n=t.length;i!==n;++i){var r=this.tracks[i];e=Math.max(e,r.times[r.times.length-1])}this.duration=e},t.prototype.trim=function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},t.prototype.optimize=function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},t.prototype.validate=function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},t.prototype.clone=function(){for(var e=[],i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new t(this.name,this.duration,e)},t}();e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.convertArray=function(t,e,i){return!t||!i&&t.constructor===e?t:e&&"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},t.isTypedArray=function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},t.arraySlice=function(e,i,n){return t.isTypedArray(e)?new e.constructor(e.subarray(i,void 0!==n?n:e.length)):e.slice(i,n)},t.getKeyframeOrder=function(t){for(var e=function(e,i){return t[e]-t[i]},i=t.length,n=new Array(i),r=0;r!==i;++r)n[r]=r;return n.sort(e),n},t.sortedArray=function(t,e,i){for(var n=t.length,r=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=i[a]*e,u=0;u!==e;++u)r[o++]=t[s+u];return r},t.flattenJSON=function(t,e,i,n){for(var r=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[r++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o)){do o=a[n],void 0!==o&&(e.push(a.time),i.push.apply(i,o)),a=t[r++];while(void 0!==a)}else if(void 0!==o.toArray){do o=a[n],void 0!==o&&(e.push(a.time),o.toArray(i,i.length)),a=t[r++];while(void 0!==a)}else do o=a[n],void 0!==o&&(e.push(a.time),i.push(o)),a=t[r++];while(void 0!==a)}},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.NumberKeyframeTrack=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(56),d=n(h);e.NumberKeyframeTrack=function(t){function e(i,n,r){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,i,n,r))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(e,i,n,r){this.ValueTypeName="number",t.prototype.initAttributes.call(this,e,i,n,r)},e}(d["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.QuaternionKeyframeTrack=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(56),d=n(h),f=i(9),c=i(122);e.QuaternionKeyframeTrack=function(t){function e(i,n,r){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,i,n,r))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(e,i,n,r){this.ValueTypeName="quaternion",this.DefaultInterpolation=f.InterpolateLinear,this.InterpolantFactoryMethodSmooth=void 0,t.prototype.initAttributes.call(this,e,i,n,r)},e.prototype.InterpolantFactoryMethodLinear=function(t){return new c.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),t)},e}(d["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.VectorKeyframeTrack=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(56),d=n(h);e.VectorKeyframeTrack=function(t){function e(i,n,r){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,i,n,r))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(e,i,n,r){this.ValueTypeName="vector",t.prototype.initAttributes.call(this,e,i,n,r)},e}(d["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,a["default"])(this,t),this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return t.prototype.start=function(){this.startTime=(performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.prototype.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.prototype.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.prototype.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=(performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(15),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},e.prototype.clone=function(){return(new e).copy(this)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i){(0,a["default"])(this,t),this.array=e,this.stride=i,this.count=void 0!=e?e.length/i:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.needsUpdate=!1}return t.prototype.onUploadCallback=function(){},t.prototype.setArray=function(t){return this.count=void 0!=t?t.length/this.stride:0,this.array=t,this},t.prototype.setDynamic=function(t){return this.dynamic=t,this},t.prototype.copy=function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},t.prototype.copyAt=function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},t.prototype.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.onUpload=function(t){return this.onUploadCallback=t,this},t}();e["default"]=o,Object.defineProperty(o.prototype,"needsUpdate",{set:function(t){t&&this.version++}}),t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(94),s=n(o),u=i(49),l=n(u),h=i(81),d=n(h),f=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;(0,a["default"])(this,t),this.ray=new s["default"](e,i),this.near=n,this.far=r,this.linePrecision=1.5,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}}}return t.prototype.set=function(t,e){this.ray.set(t,e)},t.prototype.setFromCamera=function(t,e){if(e instanceof l["default"])this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize();else{if(!(e instanceof d["default"]))throw new Error("\u9519\u8bef\u7684\u76f8\u673a\u5bf9\u8c61!");this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)}},t.prototype.intersect=function(t,e,i,n){if(t.visible&&(t.raycast(e,i),n))for(var r=t.children,a=0,o=r.length;a<o;a++)this.intersect(r[a],e,i,!0)},t.prototype.ascSort=function(t,e){return t.distance-e.distance},t.prototype.intersectObject=function(t,e,i){var n=i||[];return this.intersect(t,this,n,e),n.sort(this.ascSort),n},t.prototype.intersectObjects=function(t,e,i){for(var n=i||[],r=0,a=t.length;r<a;r++)this.intersect(t[r],this,n,e);return n.sort(this.ascSort),n},t}();e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(373),d=n(h),f=i(5),c=n(f),p=i(112),v=n(p),m=i(183),g=n(m),y=i(182),_=n(y),x=i(376),b=n(x),M=i(374),w=n(M),S=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.type="Path",n.currentPoint=new c["default"],i&&n.setFromPoints(i),n}return(0,l["default"])(e,t),e.prototype.setFromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},e.prototype.moveTo=function(t,e){this.currentPoint.set(t,e)},e.prototype.lineTo=function(t,e){var i=new v["default"](this.currentPoint.clone(),new c["default"](t,e));this.curves.push(i),this.currentPoint.set(t,e)},e.prototype.quadraticCurveTo=function(t,e,i,n){var r=new b["default"](this.currentPoint.clone(),new c["default"](t,e),new c["default"](i,n));this.curves.push(r),this.currentPoint.set(i,n)},e.prototype.bezierCurveTo=function(t,e,i,n,r,a){var o=new w["default"](this.currentPoint.clone(),new c["default"](t,e),new c["default"](i,n),new c["default"](r,a));this.curves.push(o),this.currentPoint.set(r,a)},e.prototype.splineThru=function(t){var e=[this.currentPoint.clone()].concat(t),i=new g["default"](e);this.curves.push(i),this.currentPoint.copy(t[t.length-1])},e.prototype.arc=function(t,e,i,n,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+o,e+s,i,n,r,a)},e.prototype.absarc=function(t,e,i,n,r,a){this.absellipse(t,e,i,i,n,r,a)},e.prototype.ellipse=function(t,e,i,n,r,a,o,s){var u=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+u,e+l,i,n,r,a,o,s)},e.prototype.absellipse=function(t,e,i,n,r,a,o,s){var u=new _["default"](t,e,i,n,r,a,o,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y);
}this.curves.push(u);var h=u.getPoint(1);this.currentPoint.copy(h)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},e}(d["default"]);e["default"]=S,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(180),d=n(h),f=i(7),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.uuid=c["default"].getUUID(),n.type="Shape",n.holes=[],n}return(0,l["default"])(e,t),e.prototype.getPointsHoles=function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},e.prototype.extractPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.holes=[];for(var i=0,n=e.holes.length;i<n;i++){var r=e.holes[i];this.holes.push(r.clone())}return this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(57),d=n(h),f=i(5),c=n(f),p=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;(0,a["default"])(this,e);var f=(0,s["default"])(this,t.call(this));return f.type="EllipseCurve",f.aX=i,f.aY=n,f.xRadius=r,f.yRadius=o,f.aStartAngle=u,f.aEndAngle=l,f.aClockwise=h,f.aRotation=d,f}return(0,l["default"])(e,t),e.prototype.getPoint=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"],i=2*Math.PI,n=this.aEndAngle-this.aStartAngle,r=Math.abs(n)<Number.EPSILON;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(n=r?0:i),this.aClockwise!==!0||r||(n===i?n=-i:n-=i);var a=this.aStartAngle+t*n,o=this.aX+this.xRadius*Math.cos(a),s=this.aY+this.yRadius*Math.sin(a);if(0!=this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=o-this.aX,d=s-this.aY;o=h*u-d*l+this.aX,s=h*l+d*u+this.aY}return e.set(o,s)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(57),d=n(h),f=i(5),c=n(f),p=i(111),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.points=i,n}return(0,l["default"])(e,t),e.prototype.getPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"],i=this.points,n=(i.length-1)*t,r=Math.floor(n),a=n-r,o=i[0===r?r:r-1],s=i[r],u=i[r>i.length-2?i.length-1:r+1],l=i[r>i.length-3?i.length-1:r+2];return e.set((0,p.CatmullRom)(a,o.x,s.x,u.x,l.x),(0,p.CatmullRom)(a,o.y,s.y,u.y,l.y)),e},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.points=[];for(var i=0,n=e.points.length;i<n;i++){var r=e.points[i];this.points.push(r.clone())}return this},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(59),d=n(h),f=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this,i,n));return r.type="AmbientLight",r.castShadow=void 0,r}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(59),d=n(h),f=i(20),c=n(f),p=i(382),v=n(p),m=i(4),g=n(m),y=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this,i,n));return r.type="DirectionalLight",r.position=new g["default"](0,1,0),r.updateMatrix(),r.target=new c["default"],r.shadow=new v["default"],r}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this},e}(d["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(59),d=n(h),f=i(20),c=n(f),p=i(187),v=n(p),m=i(4),g=n(m),y=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,a["default"])(this,e);var h=(0,s["default"])(this,t.call(this,i,n));return h.type="SpotLight",h.position=new g["default"](0,1,0),h.updateMatrix(),h.target=new c["default"],h.distance=r,h.angle=o,h.penumbra=u,h.decay=l,h.shadow=new v["default"],h}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this},e}(d["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(115),d=n(h),f=i(49),c=n(f),p=i(7),v=n(p),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,new c["default"](50,1,.5,500)))}return(0,l["default"])(e,t),e.prototype.update=function(t){var e=this.camera,i=2*v["default"].Rad2Deg*t.angle,n=this.mapSize.x/this.mapSize.y,r=t.distance||e.far;i==e.fov&&n==e.aspect&&r==e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix())},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(4),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.type="MeshDistanceMaterial",n.referencePosition=new c["default"],n.nearDistance=1,n.farDistance=1e3,n.skinning=!1,n.morphTargets=!1,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.fog=!1,n.lights=!1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(12),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.type="PointsMaterial",n.color=new c["default"](16777215),n.map=null,n.size=1,n.sizeAttenuation=!0,n.morphTargets=!1,n.lights=!1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(36),d=n(h),f=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.type="RawShaderMaterial",n}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(12),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="SpriteMaterial",this.color=new c["default"](16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new s["default"];(0,a["default"])(this,t),this.a=e,this.b=i,this.c=n}return t.getNormal=function(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s["default"];t.getNormalVector3||(t.getNormalVector3=new s["default"]),r.subVectors(n,i),t.getNormalVector3.subVectors(e,i),r.cross(t.getNormalVector3);var a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)},t.getBarycoord=function(e,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new s["default"];t.getBarycoordV0||(t.getBarycoordV0=new s["default"],t.getBarycoordV1=new s["default"],t.getBarycoordV2=new s["default"]),t.getBarycoordV0.subVectors(r,i),t.getBarycoordV1.subVectors(n,i),t.getBarycoordV2.subVectors(e,i);var o=t.getBarycoordV0.dot(t.getBarycoordV0),u=t.getBarycoordV0.dot(t.getBarycoordV1),l=t.getBarycoordV0.dot(t.getBarycoordV2),h=t.getBarycoordV1.dot(t.getBarycoordV1),d=t.getBarycoordV1.dot(t.getBarycoordV2),f=o*h-u*u;if(0==f)return a.set(-2,-1,-1);var c=1/f,p=(h*l-u*d)*c,v=(o*d-u*l)*c;return a.set(1-p-v,v,p)},t.containsPoint=function(e,i,n,r){return t.containsPointVector3||(t.containsPointVector3=new s["default"]),t.getBarycoord(e,i,n,r,t.containsPointVector3),this.containsPointVector3.x>=0&&this.containsPointVector3.y>=0&&this.containsPointVector3.x+this.containsPointVector3.y<=1},t.getUV=function(e,i,n,r,a,o,u,l){return t.getUVVector3||(t.getUVVector3=new s["default"]),t.getBarycoord(e,i,n,r,t.getUVVector3),l.set(0,0),l.addScaledVector(a,this.getUVVector3.x),l.addScaledVector(o,this.getUVVector3.y),l.addScaledVector(u,this.getUVVector3.z),l},t.prototype.getNormal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"];return t.getNormal(this.a,this.b,this.c,e)},t.prototype.getBarycoord=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"];return t.getBarycoord(e,this.a,this.b,this.c,i)},t.prototype.containsPoint=function(e){return t.containsPoint(e,this.a,this.b,this.c)},t.prototype.getUV=function(e,i,n,r,a){return t.getUV(e,this.a,this.b,this.c,i,n,r,a)},t.prototype.set=function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},t.prototype.setFromPointsAndIndices=function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},t.prototype.getArea=function(){return this.getAreaV0||(this.getAreaV0=new s["default"],this.getAreaV1=new s["default"]),this.getAreaV0.subVectors(this.c,this.b),this.getAreaV1.subVectors(this.a,this.b),.5*this.getAreaV0.cross(this.getAreaV1).length()},t.prototype.getMidpoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s["default"];return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.prototype.intersectsBox=function(t){return t.intersectsTriangle(this)},t.prototype.closestPointToPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s["default"];this.closestPointToPointVab||(this.closestPointToPointVab=new s["default"],this.closestPointToPointVac=new s["default"],this.closestPointToPointVbc=new s["default"],this.closestPointToPointVap=new s["default"],this.closestPointToPointVbp=new s["default"],this.closestPointToPointVcp=new s["default"]);var i=this.a,n=this.b,r=this.c,a=void 0,o=void 0;this.closestPointToPointVab.subVectors(n,i),this.closestPointToPointVac.subVectors(r,i),this.closestPointToPointVap.subVectors(t,i);var u=this.closestPointToPointVab.dot(this.closestPointToPointVap),l=this.closestPointToPointVac.dot(this.closestPointToPointVap);if(u<=0&&l<=0)return e.copy(i);this.closestPointToPointVbp.subVectors(t,n);var h=this.closestPointToPointVab.dot(this.closestPointToPointVbp),d=this.closestPointToPointVac.dot(this.closestPointToPointVbp);if(h>=0&&d<=h)return e.copy(n);var f=u*d-h*l;if(f<=0&&u>=0&&h<=0)return a=u/(u-h),e.copy(i).addScaledVector(this.closestPointToPointVab,a);this.closestPointToPointVcp.subVectors(t,r);var c=this.closestPointToPointVab.dot(this.closestPointToPointVcp),p=this.closestPointToPointVac.dot(this.closestPointToPointVcp);if(p>=0&&c<=p)return e.copy(r);var v=c*l-u*p;if(v<=0&&l>=0&&p<=0)return o=l/(l-p),e.copy(i).addScaledVector(this.closestPointToPointVac,o);var m=h*p-c*d;if(m<=0&&d-h>=0&&c-p>=0)return this.closestPointToPointVbc.subVectors(r,n),o=(d-h)/(d-h+(c-p)),e.copy(n).addScaledVector(this.closestPointToPointVbc,o);var g=1/(m+v+f);return a=v*g,o=f*g,e.copy(i).addScaledVector(this.closestPointToPointVab,a).addScaledVector(this.closestPointToPointVac,o)},t.prototype.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(61),d=n(h),f=i(18),c=i(4),p=n(c),v=i(15),m=n(v),g=i(23),y=n(g),_=function(t){function e(i,n){(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this,i,n,null));return r.type="LineSegments",r}return(0,l["default"])(e,t),e.prototype.computeLineDistances=function(){var t=new p["default"],e=new p["default"];return function(){var i=this.geometry;if(i instanceof m["default"])if(i.index)console.warn("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else{for(var n=i.attributes.position,r=[],a=0,o=n.count;a<o;a+=2)t.fromBufferAttribute(n,a),e.fromBufferAttribute(n,a+1),r[a]=0==a?0:r[a-1],r[a+1]=r[a]+t.distanceTo(e);i.addAttribute("lineDistance",new f.Float32BufferAttribute(r,1))}else if(i instanceof y["default"])for(var s=i.vertices,u=i.lineDistances,l=0,h=s.length;l<h;l+=2)t.copy(s[l]),e.copy(s[l+1]),u[l]=0==l?0:u[l-1],u[l+1]=u[l]+t.distanceTo(e);return this}},e}(d["default"]);e["default"]=_,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(24),d=n(h),f=i(14),c=n(f),p=i(45),v=n(p),m=i(23),g=n(m),y=function(t){function e(i,n){(0,a["default"])(this,e),i instanceof g["default"]&&console.error("SkinnedMesh no longer supports Geometry. Use BufferGeometry instead.");var r=(0,s["default"])(this,t.call(this,i,n));return r.type="SkinnedMesh",r.bindMode="attached",r.bindMatrix=new c["default"],r.bindMatrixInverse=new c["default"],r}return(0,l["default"])(e,t),e.prototype.bind=function(t,e){this.skeleton=t,void 0==e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},e.prototype.pose=function(){this.skeleton.pose()},e.prototype.normalizeSkinWeights=function(){for(var t=new v["default"],e=this.geometry.attributes.skinWeight,i=0,n=e.count;i<n;i++){t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.w=e.getW(i);var r=1/t.manhattanLength();r!=1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}},e.prototype.updateMatrixWorld=function(t){d["default"].prototype.updateMatrixWorld.call(this,t),"attached"==this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"==this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},e.prototype.clone=function(){return new e(this.geometry,this.material).copy(this)},e}(d["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=i(191),c=n(f),p=i(5),v=n(p),m=i(66),g=n(m),y=i(15),_=n(y),x=i(178),b=n(x),M=i(4),w=n(M),S=i(14),P=n(S),A=i(192),C=n(A),T=void 0,E=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c["default"](null);(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));if(n.type="Sprite",void 0==T){T=new _["default"];var r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o=new b["default"](r,5);T.setIndex([0,1,2,0,2,3]),T.addAttribute("position",new g["default"](o,3,0,(!1))),T.addAttribute("uv",new g["default"](o,2,3,(!1)))}return n.geometry=T,n.material=i,n.center=new v["default"](.5,.5),n}return(0,l["default"])(e,t),e.prototype.transformVertex=function(t,e,i,n,r,a){this.intersectPoint||(this.intersectPoint=new w["default"],this.worldScale=new w["default"],this.mvPosition=new w["default"],this.alignedPosition=new v["default"],this.rotatedPosition=new v["default"],this.viewWorldMatrix=new P["default"],this.vA=new w["default"],this.vB=new w["default"],this.vC=new w["default"],this.uvA=new v["default"],this.uvB=new v["default"],this.uvC=new v["default"]),this.alignedPosition.subVectors(t,i).addScalar(.5).multiply(n),void 0!=r?(this.rotatedPosition.x=a*this.alignedPosition.x-r*this.alignedPosition.y,this.rotatedPosition.y=r*this.alignedPosition.x+a*this.alignedPosition.y):this.rotatedPosition.copy(this.alignedPosition),t.copy(e),t.x+=this.rotatedPosition.x,t.y+=this.rotatedPosition.y,t.applyMatrix4(this.viewWorldMatrix)},e.prototype.raycast=function(t,e){this.worldScale.setFromMatrixScale(this.matrixWorld),this.viewWorldMatrix.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),this.mvPosition.setFromMatrixPosition(this.modelViewMatrix);var i=this.material.rotation,n=void 0,r=void 0;0!=i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;this.transformVertex(this.vA.set(-.5,-.5,0),this.mvPosition,a,this.worldScale,n,r),this.transformVertex(this.vB.set(.5,-.5,0),this.mvPosition,a,this.worldScale,n,r),this.transformVertex(this.vC.set(.5,.5,0),this.mvPosition,a,this.worldScale,n,r),this.uvA.set(0,0),this.uvB.set(1,0),this.uvC.set(1,1);var o=t.ray.intersectTriangle(this.vA,this.vB,this.vC,!1,this.intersectPoint);if(o||(this.transformVertex(this.vB.set(-.5,.5,0),this.mvPosition,a,this.worldScale,n,r),this.uvB.set(0,1),o=t.ray.intersectTriangle(this.vA,this.vC,this.vB,!1,this.intersectPoint))){var s=t.ray.origin.distanceTo(this.intersectPoint);s<t.near||s>t.far||e.push({distance:s,point:this.intersectPoint.clone(),uv:C["default"].getUV(this.intersectPoint,this.vA,this.vB,this.vC,this.uvA,this.uvB,this.uvC,new v["default"]),face:null,object:this})}},e.prototype.clone=function(){return new e(this.material).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),void 0!=e.center&&this.center.copy(e.center),this},e}(d["default"]);e["default"]=E,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(81),c=n(f),p=i(58),v=i(36),m=n(v),g=i(24),y=n(g),_=i(46),x=n(_),b=i(95),M=n(b),w=i(84),S=n(w),P=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tDiffuse";(0,s["default"])(this,e);var r=(0,l["default"])(this,t.call(this));return r.textureID=n,i instanceof m["default"]?(r.uniforms=i.uniforms,r.material=i):i&&(r.uniforms=x["default"].cloneUniforms(i.uniforms),r.material=new m["default"]({defines:(0,a["default"])({},i.defines),uniforms:r.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader})),r.camera=new c["default"]((-1),1,1,(-1),0,1),r.scene=new M["default"],r.quad=new y["default"](new p.PlaneBufferGeometry(2,2),null),r.quad.frustumCulled=!1,r.scene.add(r.quad),r}return(0,d["default"])(e,t),e.prototype.render=function(t,e,i,n,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)},e}(S["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ShaderLib=void 0;var r=i(46),a=n(r),o=i(127),s=n(o),u=i(12),l=n(u),h=i(126),d=i(37),f=n(d),c=i(4),p=n(c),v={basic:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].specularmap,s["default"].envmap,s["default"].aomap,s["default"].lightmap,s["default"].fog,s["default"].InspectArea,s["default"].GridTint,s["default"].FaceClap,s["default"].Gradual,s["default"].digArea]),vertexShader:h.ShaderChunk.meshbasic_vert,fragmentShader:h.ShaderChunk.meshbasic_frag},lambert:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].specularmap,s["default"].envmap,s["default"].aomap,s["default"].lightmap,s["default"].emissivemap,s["default"].fog,s["default"].lights,s["default"].InspectArea,s["default"].GridTint,s["default"].FaceClap,s["default"].Gradual,{emissive:{value:new l["default"](0)}},s["default"].digArea]),vertexShader:h.ShaderChunk.meshlambert_vert,fragmentShader:h.ShaderChunk.meshlambert_frag},phong:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].specularmap,s["default"].envmap,s["default"].aomap,s["default"].lightmap,s["default"].emissivemap,s["default"].bumpmap,s["default"].normalmap,s["default"].displacementmap,s["default"].gradientmap,s["default"].fog,s["default"].lights,s["default"].InspectArea,s["default"].GridTint,s["default"].FaceClap,s["default"].Gradual,{emissive:{value:new l["default"](0)},specular:{value:new l["default"](1118481)},shininess:{value:30}},s["default"].digArea]),vertexShader:h.ShaderChunk.meshphong_vert,fragmentShader:h.ShaderChunk.meshphong_frag},standard:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].envmap,s["default"].aomap,s["default"].lightmap,s["default"].emissivemap,s["default"].bumpmap,s["default"].normalmap,s["default"].displacementmap,s["default"].roughnessmap,s["default"].metalnessmap,s["default"].fog,s["default"].lights,s["default"].InspectArea,s["default"].GridTint,s["default"].FaceClap,{emissive:{value:new l["default"](0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}},s["default"].digArea]),vertexShader:h.ShaderChunk.meshphysical_vert,fragmentShader:h.ShaderChunk.meshphysical_frag},matcap:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].bumpmap,s["default"].normalmap,s["default"].displacementmap,s["default"].fog,{matcap:{value:null}}]),vertexShader:h.ShaderChunk.meshmatcap_vert,fragmentShader:h.ShaderChunk.meshmatcap_frag},points:{uniforms:a["default"].mergeUniforms([s["default"].points,s["default"].fog]),vertexShader:h.ShaderChunk.points_vert,fragmentShader:h.ShaderChunk.points_frag},dashed:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:h.ShaderChunk.linedashed_vert,fragmentShader:h.ShaderChunk.linedashed_frag},depth:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].displacementmap]),vertexShader:h.ShaderChunk.depth_vert,fragmentShader:h.ShaderChunk.depth_frag},normal:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].bumpmap,s["default"].normalmap,s["default"].displacementmap,{opacity:{value:1}}]),vertexShader:h.ShaderChunk.normal_vert,fragmentShader:h.ShaderChunk.normal_frag},sprite:{uniforms:a["default"].mergeUniforms([s["default"].sprite,s["default"].fog]),vertexShader:h.ShaderChunk.sprite_vert,fragmentShader:h.ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new f["default"]},t2D:{value:null}},vertexShader:h.ShaderChunk.background_vert,fragmentShader:h.ShaderChunk.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:h.ShaderChunk.cube_vert,fragmentShader:h.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:h.ShaderChunk.equirect_vert,fragmentShader:h.ShaderChunk.equirect_frag},distanceRGBA:{uniforms:a["default"].mergeUniforms([s["default"].common,s["default"].displacementmap,{referencePosition:{value:new p["default"]},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:h.ShaderChunk.distanceRGBA_vert,fragmentShader:h.ShaderChunk.distanceRGBA_frag},shadow:{uniforms:a["default"].mergeUniforms([s["default"].lights,s["default"].fog,{color:{value:new l["default"](0)},opacity:{value:1}}]),vertexShader:h.ShaderChunk.shadow_vert,fragmentShader:h.ShaderChunk.shadow_frag}};v.physical={uniforms:a["default"].mergeUniforms([v.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:h.ShaderChunk.meshphysical_vert,fragmentShader:h.ShaderChunk.meshphysical_frag},e.ShaderLib=v},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,i){var n=t[0];if(n<=0||n>0)return t;var r=e*i,a=Y[r];if(void 0==a&&(a=new Float32Array(r),Y[r]=a),0!=e){n.toArray(a,0);for(var o=1,s=0;o!=e;++o)s+=i,t[o].toArray(a,s)}return a}function a(t,e){if(t.length!=e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!=e[i])return!1;return!0}function o(t,e){for(var i=0,n=e.length;i<n;i++)t[i]=e[i]}function s(t,e){var i=q[e];void 0==i&&(i=new Int32Array(e),q[e]=i);for(var n=0;n!=e;++n)i[n]=t.allocTextureUnit();return i}function u(t,e){var i=this.cache;i[0]!=e&&(t.uniform1f(this.addr,e),i[0]=e)}function l(t,e){var i=this.cache;i[0]!=e&&(t.uniform1i(this.addr,e),i[0]=e)}function h(t,e){var i=this.cache;if(void 0!=e.x)i[0]==e.x&&i[1]==e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(a(i,e))return;t.uniform2fv(this.addr,e),o(i,e)}}function d(t,e){var i=this.cache;if(void 0!=e.x)i[0]==e.x&&i[1]==e.y&&i[2]==e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!=e.r)i[0]==e.r&&i[1]==e.g&&i[2]==e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(a(i,e))return;t.uniform3fv(this.addr,e),o(i,e)}}function f(t,e){var i=this.cache;if(void 0!=e.x)i[0]==e.x&&i[1]==e.y&&i[2]==e.z&&i[3]==e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(a(i,e))return;t.uniform4fv(this.addr,e),o(i,e)}}function c(t,e){var i=this.cache,n=e.elements;if(void 0==n){if(a(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),o(i,e)}else{if(a(i,n))return;K.set(n),t.uniformMatrix2fv(this.addr,!1,K),o(i,n)}}function p(t,e){var i=this.cache,n=e.elements;if(void 0==n){if(a(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),o(i,e)}else{if(a(i,n))return;Z.set(n),t.uniformMatrix3fv(this.addr,!1,Z),o(i,n)}}function v(t,e){var i=this.cache,n=e.elements;if(void 0==n){if(a(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),o(i,e)}else{if(a(i,n))return;Q.set(n),t.uniformMatrix4fv(this.addr,!1,Q),o(i,n)}}function m(t,e,i){var n=this.cache,r=i.allocTextureUnit();n[0]!=r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||W,r)}function g(t,e,i){var n=this.cache,r=i.allocTextureUnit();n[0]!=r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||X,r)}function y(t,e,i){var n=this.cache,r=i.allocTextureUnit();n[0]!=r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||H,r)}function _(t,e){var i=this.cache;a(i,e)||(t.uniform2iv(this.addr,e),o(i,e))}function x(t,e){var i=this.cache;a(i,e)||(t.uniform3iv(this.addr,e),o(i,e))}function b(t,e){var i=this.cache;a(i,e)||(t.uniform4iv(this.addr,e),o(i,e))}function M(t){switch(t){case 5126:return u;case 35664:return h;case 35665:return d;case 35666:return f;case 35674:return c;case 35675:return p;case 35676:return v;case 35678:case 36198:return m;case 35679:return g;case 35680:return y;case 5124:case 35670:return l;case 35667:case 35671:return _;case 35668:case 35672:return x;case 35669:case 35673:return b}}function w(t,e){var i=this.cache;a(i,e)||(t.uniform1fv(this.addr,e),o(i,e))}function S(t,e){var i=this.cache;a(i,e)||(t.uniform1iv(this.addr,e),o(i,e))}function P(t,e){var i=this.cache,n=r(e,this.size,2);a(i,n)||(t.uniform2fv(this.addr,n),this.updateCache(n))}function A(t,e){var i=this.cache,n=r(e,this.size,3);a(i,n)||(t.uniform3fv(this.addr,n),this.updateCache(n))}function C(t,e){var i=this.cache,n=r(e,this.size,4);a(i,n)||(t.uniform4fv(this.addr,n),this.updateCache(n))}function T(t,e){var i=this.cache,n=r(e,this.size,4);a(i,n)||(t.uniformMatrix2fv(this.addr,!1,n),this.updateCache(n))}function E(t,e){var i=this.cache,n=r(e,this.size,9);a(i,n)||(t.uniformMatrix3fv(this.addr,!1,n),this.updateCache(n))}function D(t,e){var i=this.cache,n=r(e,this.size,16);a(i,n)||(t.uniformMatrix4fv(this.addr,!1,n),this.updateCache(n))}function L(t,e,i){var n=this.cache,r=e.length,u=s(i,r);0==a(n,u)&&(t.uniform1iv(this.addr,u),o(n,u));for(var l=0;l!=r;++l)i.setTexture2D(e[l]||W,u[l])}function F(t,e,i){var n=this.cache,r=e.length,u=s(i,r);0==a(n,u)&&(t.uniform1iv(this.addr,u),o(n,u));for(var l=0;l!=r;++l)i.setTextureCube(e[l]||H,u[l])}function k(t){switch(t){case 5126:return w;case 35664:return P;case 35665:return A;case 35666:return C;case 35674:return T;case 35675:return E;case 35676:return D;case 35678:return L;case 35680:return F;case 5124:case 35670:return S;case 35667:case 35671:return _;case 35668:case 35672:return x;case 35669:case 35673:return b}}function I(t,e){t.seq.push(e),t.map[e.id]=e}function O(t,e,i){var n=t.name,r=n.length;for(et.lastIndex=0;;){var a=et.exec(n),o=et.lastIndex,s=a[1],u="]"==a[2],l=a[3];if(u&&(s=0|s),void 0==l||"["==l&&o+2==r){I(i,void 0==l?new J(s,t,e):new $(s,t,e));break}var h=i.map,d=h[s];void 0==d&&(d=new tt(s),I(i,d)),i=d}}Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLUniforms=void 0;var N=i(1),R=n(N),U=i(27),B=n(U),j=i(200),z=n(j),G=i(129),V=n(G),W=new B["default"],X=new z["default"],H=new V["default"],Y=[],q=[],Q=new Float32Array(16),Z=new Float32Array(9),K=new Float32Array(4),J=function nt(t,e,i){
(0,R["default"])(this,nt),this.id=t,this.addr=i,this.cache=[],this.setValue=M(e.type)},$=function(){function t(e,i,n){(0,R["default"])(this,t),this.id=e,this.addr=n,this.cache=[],this.size=i.size,this.setValue=k(i.type)}return t.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!=t.length&&(this.cache=new Float32Array(t.length)),o(e,t)},t}(),tt=function(){function t(e){(0,R["default"])(this,t),this.id=e,this.seq=[],this.map={}}return t.prototype.setValue=function(t,e,i){for(var n=this.seq,r=0,a=n.length;r!=a;++r){var o=n[r];o.setValue(t,e[o.id],i)}},t}(),et=/([\w\d_]+)(\])?(\[|\.)?/g,it=function(){function t(e,i,n){(0,R["default"])(this,t),this.seq=[],this.map={},this.renderer=n;for(var r=e.getProgramParameter(i,e.ACTIVE_UNIFORMS),a=0;a<r;++a){var o=e.getActiveUniform(i,a),s=e.getUniformLocation(i,o.name);O(o,s,this)}}return t.prototype.setValue=function(t,e,i){var n=this.map[e];void 0!=n&&n.setValue(t,i,this.renderer)},t.prototype.setOptional=function(t,e,i){var n=e[i];void 0!=n&&this.setValue(t,i,n)},t.upload=function(t,e,i,n){for(var r=0,a=e.length;r!=a;++r){var o=e[r],s=i[o.id];0!=s.needsUpdate&&o.setValue(t,s.value,n)}},t.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!=r;++n){var a=t[n];a.id in e&&i.push(a)}return i},t}();e.WebGLUniforms=it},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(27),d=n(h),f=i(9),c=function(t){function e(i,n,r,o,u,l,h,d){var c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:f.NearestFilter,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:f.NearestFilter,v=arguments[10],m=arguments[11];(0,a["default"])(this,e);var g=(0,s["default"])(this,t.call(this,null,l,h,d,c,p,o,u,v,m));return g.image={data:i,width:n,height:r},g.magFilter=c,g.minFilter=p,g.generateMipmaps=!1,g.flipY=!1,g.unpackAlignment=1,g}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(9),d=i(27),f=n(d),c=function(t){function e(i,n,r,o){(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this,null));return u.image={data:i,width:n,height:r,depth:o},u.magFilter=h.NearestFilter,u.minFilter=h.NearestFilter,u.generateMipmaps=!1,u.flipY=!1,u}return(0,l["default"])(e,t),e}(f["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(27),d=n(h),f=i(9),c=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d["default"].DEFAULT_IMAGE,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d["default"].DEFAULT_MAPPING,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.ClampToEdgeWrapping,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f.ClampToEdgeWrapping,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f.LinearFilter,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f.LinearFilter,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:f.RGBAFormat,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:f.UnsignedByteType,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;arguments.length>9&&void 0!==arguments[9]?arguments[9]:f.LinearEncoding;(0,a["default"])(this,e);var v=(0,s["default"])(this,t.call(this,i,n,r,o,u,l,h,c,p));return v.isVideoTexture=!0,v.generateMipmaps=!1,v}return(0,l["default"])(e,t),e.prototype.update=function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(155),l=n(u),h=i(13),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s["default"])(this,t),this.pixelRatio=1,this.params=e,this.domElement=document.createElement("div"),this.canvasSet={},this.isContextLost=!1,this.isSynMarker=!0}return t.prototype.initAttributes=function(t){},t.prototype.render=function(t,e,i,n){var r=this;this.isContextLost||(this.resetState(),this.synCamera(e,i,n),t.children.forEach(function(t){var e=t;if(!r.canvasSet[e.uuid]){var i=document.createElement(e.elType);if(i instanceof HTMLCanvasElement){if(e.isWorkerDraw())r.canvasSet[t.uuid]={body:i};else{var n=i.getContext("2d");r.initAttributes(n),r.canvasSet[t.uuid]={body:i,ctx:n}}i.width=r.width,i.height=r.height}else r.canvasSet[t.uuid]={body:i};i.id=t.userData.objType,i.style.width=r.width+"px",i.style.height=r.height+"px",r.domElement.appendChild(i),i.style.position="absolute"}r.canvasSet[e.uuid].use=!0,r.renderObjects(e)}),this.clearLayers())},t.prototype.setPixelRatio=function(t){this.pixelRatio=t},t.prototype.synCamera=function(t,e,i){if(t instanceof l["default"]!=0){if(this.isSynMarker)if(this.oldPosition){var n=this.oldPosition.x.toFixed(6),r=this.oldPosition.y.toFixed(6),a=this.oldPosition.z.toFixed(6),o=e.position.x.toFixed(6),s=e.position.y.toFixed(6),u=e.position.z.toFixed(6),d=this.oldTarget.x.toFixed(6),f=this.oldTarget.y.toFixed(6),c=this.oldTarget.z.toFixed(6),p=e.lookAtTarget.x.toFixed(6),v=e.lookAtTarget.y.toFixed(6),m=e.lookAtTarget.z.toFixed(6);if(n==o&&r==s&&a==u&&d==p&&f==v&&c==m)return;this.oldPosition=i?i:e.position.clone(),this.oldTarget=e.lookAtTarget.clone()}else this.oldPosition=i?i:e.position.clone(),this.oldTarget=e.lookAtTarget.clone();var g=t.getService("CameraService"),y={aspect:e.aspect,far:e.far,fov:e.fov,near:e.near,up:e.up,position:this.oldPosition.toArray(),target:this.oldTarget.toArray()};this.isSynMarker=!0,g.synCamera(y,t.getSize()),t.fireEvent(h.Events.Earth.CameraChange,t)}},t.prototype.setSize=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.width=t,this.height=e,n&&(this.domElement.style.width=this.width+"px",this.domElement.style.height=this.height+"px"),(0,a["default"])(this.canvasSet).map(function(t){i.canvasSet[t].ctx&&(i.canvasSet[t].body.width=i.width,i.canvasSet[t].body.height=i.height),n&&(i.canvasSet[t].body.style.width=i.width+"px",i.canvasSet[t].body.style.height=i.height+"px")})},t.prototype.resetState=function(){var t=this;(0,a["default"])(this.canvasSet).map(function(e){t.canvasSet[e].use=!1})},t.prototype.clearLayers=function(){var t=this;(0,a["default"])(this.canvasSet).map(function(e){t.canvasSet[e].use||(t.domElement.removeChild(t.canvasSet[e].body),delete t.canvasSet[e])})},t.prototype.renderObjects=function(t){var e=this;return t.visible&&t.isShow()?(this.canvasSet[t.uuid].body.style.display="block",void(t.needsUpdate&&(t.needsUpdate=!1,t.isWorkerDraw()?(t.synCtxToWorker(this.canvasSet[t.uuid].body),t.synWorkerDraw()):(this.canvasSet[t.uuid].ctx.clearRect(0,0,this.canvasSet[t.uuid].body.width,this.canvasSet[t.uuid].body.height),t.children.forEach(function(i){i.draw(e.canvasSet[t.uuid].ctx)}))))):void(this.canvasSet[t.uuid].body.style.display="none")},t.prototype.dispose=function(){this.isContextLost=!0},t}();e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(85),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(70),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.userData.canSelect=!0,this.type="MarkerLayer"},e.prototype.dragEnd=function(){t.prototype.dragEnd.call(this),this.doDragend()},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(133);Object.defineProperty(e,"Marker",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(614);Object.defineProperty(e,"Polygon",{enumerable:!0,get:function(){return n(a)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(615);Object.defineProperty(e,"AttributeService",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(134);Object.defineProperty(e,"RCService",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(616);Object.defineProperty(e,"MarkerService",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(618);Object.defineProperty(e,"PoiService",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(617);Object.defineProperty(e,"NavigateService",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(619);Object.defineProperty(e,"WorkerService",{enumerable:!0,get:function(){return n(l)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(680),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.webWorker=[],this.threadNum=0,this.callbackFns={},this.EngineIP="",this.analyseWorker=null,this.EngineIP=e}return t.prototype.addFn=function(t,e){this.callbackFns[t]=e},t.prototype.onMessage=function(t){var e=t.data.applyData.fn;this.callbackFns[e](t.data)},t.prototype.initWorker=function(){var t=2;if(this.webWorker.length<t){var e=new s["default"](208);this.initWk(e),e.onmessage=this.onMessage.bind(this),this.threadNum=this.webWorker.length,this.webWorker[this.threadNum]=e}else this.threadNum++,this.threadNum>t-1&&(this.threadNum=0)},t.prototype.initWk=function(t){var e={method:"init",EngineIP:this.EngineIP};t.postMessage(e)},t.prototype.initAnalyseWorker=function(){this.analyseWorker=new s["default"](208),this.initWk(this.analyseWorker),this.analyseWorker.onmessage=this.onMessage.bind(this)},t.prototype.postMessage=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(void 0!=i)return this.analyseWorker||this.initAnalyseWorker(),void this.analyseWorker.postMessage(t,n);if(this.initWorker(),1==e)for(var r=0;r<=this.threadNum;r++)this.webWorker[r].postMessage(t,n);else this.webWorker[this.threadNum].postMessage(t,n)},t.prototype.dispose=function(){this.webWorker.forEach(function(t){t.terminate()}),this.webWorker=[],this.analyseWorker&&(this.analyseWorker.terminate(),this.analyseWorker=null)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){var i=e.EngineIP.replace("http","ws"),n=new l["default"](i+"/websocket/gisway.earth.controller.websocket.DataSocket");p=new d["default"],(0,s["default"])(c).map(function(e){new c[e](n,t,p)})}var o=i(10),s=r(o),u=i(339),l=r(u),h=i(344),d=r(h),f=i(354),c=n(f),p=void 0;t.exports=function(t){t.addEventListener("message",function(e){var i=e.data.method;if("init"==i)return void a(t,e.data);var n=p.to(i);n?n(e.data):console.warn("\u65e0\u5bf9\u5e94\u65b9\u6cd5:"+i)})}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){var n=i(641);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,i){var n=i(75),r=i(54).document,a=n(r)&&n(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e,i){t.exports=!i(52)&&!i(73)(function(){return 7!=Object.defineProperty(i(211)("div"),"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(209);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,i){"use strict";var n=i(98),r=i(53),a=i(221),o=i(74),s=i(138),u=i(647),l=i(141),h=i(218),d=i(77)("iterator"),f=!([].keys&&"next"in[].keys()),c="@@iterator",p="keys",v="values",m=function(){return this};t.exports=function(t,e,i,g,y,_,x){u(i,e,g);var b,M,w,S=function(t){if(!f&&t in T)return T[t];switch(t){case p:return function(){return new i(this,t)};case v:return function(){return new i(this,t)}}return function(){return new i(this,t)}},P=e+" Iterator",A=y==v,C=!1,T=t.prototype,E=T[d]||T[c]||y&&T[y],D=E||S(y),L=y?A?S("entries"):D:void 0,F="Array"==e?T.entries||E:E;if(F&&(w=h(F.call(new t)),w!==Object.prototype&&w.next&&(l(w,P,!0),n||"function"==typeof w[d]||o(w,d,m))),A&&E&&E.name!==v&&(C=!0,D=function(){return E.call(this)}),n&&!x||!f&&!C&&T[d]||o(T,d,D),s[e]=D,s[P]=m,y)if(b={values:A?D:S(v),keys:_?D:S(p),entries:L},x)for(M in b)M in T||a(T,M,b[M]);else r(r.P+r.F*(f||C),e,b);return b}},function(t,e,i){var n=i(63),r=i(87),a=i(88);t.exports=i(52)?Object.defineProperties:function(t,e){r(t);for(var i,o=a(e),s=o.length,u=0;s>u;)n.f(t,i=o[u++],e[i]);return t}},function(t,e,i){var n=i(99),r=i(100),a=i(76),o=i(145),s=i(62),u=i(212),l=Object.getOwnPropertyDescriptor;e.f=i(52)?l:function(t,e){if(t=a(t),e=o(e,!0),u)try{return l(t,e)}catch(i){}if(s(t,e))return r(!n.f.call(t,e),t[e])}},function(t,e,i){var n=i(219),r=i(137).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},function(t,e,i){var n=i(62),r=i(101),a=i(142)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),n(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},function(t,e,i){var n=i(62),r=i(76),a=i(643)(!1),o=i(142)("IE_PROTO");t.exports=function(t,e){var i,s=r(t),u=0,l=[];for(i in s)i!=o&&n(s,i)&&l.push(i);for(;e.length>u;)n(s,i=e[u++])&&(~a(l,i)||l.push(i));return l}},function(t,e,i){var n=i(53),r=i(29),a=i(73);t.exports=function(t,e){var i=(r.Object||{})[t]||Object[t],o={};o[t]=e(i),n(n.S+n.F*a(function(){i(1)}),"Object",o)}},function(t,e,i){t.exports=i(74)},function(t,e,i){"use strict";function n(t,e){if(e<65534&&(t.subarray&&o||!t.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var i="",n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i}var r=i(55),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(s){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){o=!1}for(var u=new r.Buf8(256),l=0;l<256;l++)u[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;u[254]=u[254]=1,e.string2buf=function(t){var e,i,n,a,o,s=t.length,u=0;for(a=0;a<s;a++)i=t.charCodeAt(a),55296===(64512&i)&&a+1<s&&(n=t.charCodeAt(a+1),56320===(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),u+=i<128?1:i<2048?2:i<65536?3:4;for(e=new r.Buf8(u),o=0,a=0;o<u;a++)i=t.charCodeAt(a),55296===(64512&i)&&a+1<s&&(n=t.charCodeAt(a+1),56320===(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),i<128?e[o++]=i:i<2048?(e[o++]=192|i>>>6,e[o++]=128|63&i):i<65536?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|63&i):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|63&i);return e},e.buf2binstring=function(t){return n(t,t.length)},e.binstring2buf=function(t){for(var e=new r.Buf8(t.length),i=0,n=e.length;i<n;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,r,a,o,s=e||t.length,l=new Array(2*s);for(r=0,i=0;i<s;)if(a=t[i++],a<128)l[r++]=a;else if(o=u[a],o>4)l[r++]=65533,i+=o-1;else{for(a&=2===o?31:3===o?15:7;o>1&&i<s;)a=a<<6|63&t[i++],o--;o>1?l[r++]=65533:a<65536?l[r++]=a:(a-=65536,l[r++]=55296|a>>10&1023,l[r++]=56320|1023&a)}return n(l,r)},e.utf8border=function(t,e){var i;for(e=e||t.length,e>t.length&&(e=t.length),i=e-1;i>=0&&128===(192&t[i]);)i--;return i<0?e:0===i?e:i+u[t[i]]>e?i:e}},function(t,e){"use strict";function i(t,e,i,n){for(var r=65535&t|0,a=t>>>16&65535|0,o=0;0!==i;){o=i>2e3?2e3:i,i-=o;do r=r+e[n++]|0,a=a+r|0;while(--o);r%=65521,a%=65521}return r|a<<16|0}t.exports=i},function(t,e){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e){"use strict";function i(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}function n(t,e,i,n){var a=r,o=n+i;t^=-1;for(var s=n;s<o;s++)t=t>>>8^a[255&(t^e[s])];return t^-1}var r=i();t.exports=n},function(t,e){"use strict";function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=i},function(t,e,i){t.exports=i(228)},function(t,e,i){"use strict";function n(t){var e=new o(t),i=a(o.prototype.request,e);return r.extend(i,o.prototype,e),r.extend(i,e),i}var r=i(30),a=i(154),o=i(230),s=i(103),u=n(s);u.Axios=o,u.create=function(t){return n(r.merge(s,t))},u.Cancel=i(151),u.CancelToken=i(229),u.isCancel=i(152),u.all=function(t){return Promise.all(t)},u.spread=i(244),t.exports=u,t.exports["default"]=u},function(t,e,i){"use strict";function n(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var i=this;t(function(t){i.reason||(i.reason=new r(t),e(i.reason))})}var r=i(151);n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var t,e=new n(function(e){t=e});return{token:e,cancel:t}},t.exports=n},function(t,e,i){"use strict";function n(t){this.defaults=t,this.interceptors={request:new o,response:new o}}var r=i(103),a=i(30),o=i(231),s=i(232),u=i(240),l=i(238);n.prototype.request=function(t){"string"==typeof t&&(t=a.merge({url:arguments[0]},arguments[1])),t=a.merge(r,this.defaults,{method:"get"},t),t.method=t.method.toLowerCase(),t.baseURL&&!u(t.url)&&(t.url=l(t.baseURL,t.url));var e=[s,void 0],i=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)i=i.then(e.shift(),e.shift());return i},a.forEach(["delete","get","head","options"],function(t){n.prototype[t]=function(e,i){return this.request(a.merge(i||{},{method:t,url:e}))}}),a.forEach(["post","put","patch"],function(t){n.prototype[t]=function(e,i,n){return this.request(a.merge(n||{},{method:t,url:e,data:i}))}}),t.exports=n},function(t,e,i){"use strict";function n(){this.handlers=[]}var r=i(30);n.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},n.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},n.prototype.forEach=function(t){r.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=n},function(t,e,i){"use strict";function n(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var r=i(30),a=i(235),o=i(152),s=i(103);t.exports=function(t){n(t),t.headers=t.headers||{},t.data=a(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]});var e=t.adapter||s.adapter;return e(t).then(function(e){return n(t),e.data=a(e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(n(t),e&&e.response&&(e.response.data=a(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e){"use strict";t.exports=function(t,e,i,n,r){return t.config=e,i&&(t.code=i),t.request=n,t.response=r,t}},function(t,e,i){"use strict";var n=i(153);t.exports=function(t,e,i){var r=i.config.validateStatus;i.status&&r&&!r(i.status)?e(n("Request failed with status code "+i.status,i.config,null,i.request,i)):t(i)}},function(t,e,i){"use strict";var n=i(30);t.exports=function(t,e,i){return n.forEach(i,function(i){t=i(t,e)}),t}},function(t,e){"use strict";function i(){this.message="String contains an invalid character"}function n(t){for(var e,n,a=String(t),o="",s=0,u=r;a.charAt(0|s)||(u="=",s%1);o+=u.charAt(63&e>>8-s%1*8)){if(n=a.charCodeAt(s+=.75),n>255)throw new i;e=e<<8|n}return o}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",t.exports=n},function(t,e,i){"use strict";function n(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var r=i(30);t.exports=function(t,e,i){if(!e)return t;var a;if(i)a=i(e);else if(r.isURLSearchParams(e))a=e.toString();else{var o=[];r.forEach(e,function(t,e){null!==t&&"undefined"!=typeof t&&(r.isArray(t)&&(e+="[]"),r.isArray(t)||(t=[t]),r.forEach(t,function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),o.push(n(e)+"="+n(t))}))}),a=o.join("&")}return a&&(t+=(t.indexOf("?")===-1?"?":"&")+a),t}},function(t,e){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,i){"use strict";var n=i(30);t.exports=n.isStandardBrowserEnv()?function(){return{write:function(t,e,i,r,a,o){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),n.isString(r)&&s.push("path="+r),n.isString(a)&&s.push("domain="+a),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(t,e){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,i){"use strict";var n=i(30);t.exports=n.isStandardBrowserEnv()?function(){function t(t){var e=t;return i&&(r.setAttribute("href",e),e=r.href),r.setAttribute("href",e),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}var e,i=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");return e=t(window.location.href),function(i){var r=n.isString(i)?t(i):i;return r.protocol===e.protocol&&r.host===e.host}}():function(){return function(){return!0}}()},function(t,e,i){"use strict";var n=i(30);t.exports=function(t,e){n.forEach(t,function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])})}},function(t,e,i){"use strict";var n=i(30);t.exports=function(t){var e,i,r,a={};return t?(n.forEach(t.split("\n"),function(t){r=t.indexOf(":"),e=n.trim(t.substr(0,r)).toLowerCase(),i=n.trim(t.substr(r+1)),e&&(a[e]=a[e]?a[e]+", "+i:i)}),a):a}},function(t,e){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(156),h=n(l),d=function f(t){var e=this;(0,u["default"])(this,f),(0,o["default"])(h).map(function(i){e[i]=new h[i](t)})};e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(78),d=n(h),f=i(41),c=n(f),p=i(301),v=n(p),m=i(303),g=n(m),y=i(11),_=n(y),x=i(8),b=i(6),M=n(b),w=i(31),S=i(19),P=n(S),A=i(4),C=n(A),T=i(107),E=n(T),D=i(128),L=n(D),F=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.apply(this,arguments));return i.followPosition=new C["default"],i}return(0,l["default"])(e,t),e.prototype.flyTo=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,r=arguments[3],a=this.earth.getControl("ViewControl");e.changeEPSGType(x.Const.EPSGType.EPSGWeb),t.changeEPSGType(x.Const.EPSGType.EPSGWeb);var o=a.target.clone(),s=a.camera.position.clone();this.tween&&this.tween.stop();var u={tx:o.x,ty:o.y,tz:o.z,px:s.x,py:s.y,pz:s.z},l={tx:e.x,ty:e.y,tz:e.z,px:t.x,py:t.y,pz:t.z};this.tween=new w.Tween(u).to(l,n).onUpdate(function(){a.flyTo(new C["default"](u.px,u.py,u.pz),new C["default"](u.tx,u.ty,u.tz))}).onComplete(function(){i.tween.stop(),i.tween=null,r&&r()}),this.tween.start()},e.prototype.follow=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new C["default"](100,100,100);this.stopFollow(),this.followFn=this.lookAt.bind(this,t,e,!1,i,function(){}),this.earth.Api.Time.on(.1,this.followFn,this)},e.prototype.stopFollow=function(){this.followFn&&this.earth.Api.Time.off(.1,this.followFn,this),this.followFn=null,this.followPosition=new C["default"]},e.prototype.lookAt=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new C["default"](100,100,100),r=arguments[4],a=this.earth.getControl("LayerControl"),o=a.getLayer(t),s=o.getModel(e);if(s){if(i){var u=this.earth.getControl("SelectControl");u.doUnSelect(),u.doSelect({object:s,point:s.position.clone()})}if(this.followFn){if(this.followPosition.equals(s.position))return void this.stopFollow();this.followPosition.copy(s.position)}var l=(new _["default"]).copy(s.position);l.EPSGType=x.Const.EPSGType.EPSGWeb;var h=l.clone();l.add(n),this.flyTo(l,h,1e3,r)}else M["default"].warn("\u627e\u4e0d\u5230\u8be5\u5bf9\u8c61!")},e.prototype.info=function(){var t=this.earth.getControl("ViewControl"),e=(new _["default"]).set(t.camera.position.x,t.camera.position.y,t.camera.position.z,x.Const.EPSGType.EPSGWeb),i=(new _["default"]).set(t.target.x,t.target.y,t.target.z,x.Const.EPSGType.EPSGWeb);return{position:e,target:i}},e.prototype.doLoop=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5,n=this.earth.earthHandler.orbit;n instanceof d["default"]?(this.flyTo(t,e,.1),n.autoRotate=!0,n.autoRotateSpeed=i):M["default"].warn("\u5f53\u524d\u975e\u6d4f\u89c8\u6a21\u5f0f,\u65e0\u6cd5\u65cb\u8f6c!")},e.prototype.stopLoop=function(){var t=this.earth.earthHandler.orbit;t instanceof d["default"]?t.autoRotate=!1:M["default"].warn("\u5f53\u524d\u975e\u6d4f\u89c8\u6a21\u5f0f,\u65e0\u6cd5\u505c\u6b62\u65cb\u8f6c!")},e.prototype.setPointLock=function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;M["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u56fa\u5b9a\u89c6\u89d2\u529f\u80fd!")},e.prototype.setPerson=function(t){this.earth.setHandler(new g["default"](this.earth,t))},e.prototype.setOrbit=function(){this.earth.setHandler(new c["default"](this.earth))},e.prototype.setFly=function(){this.earth.setHandler(new v["default"](this.earth))},e.prototype.setTouchMode=function(t){var e=this.earth.getControl("MouseControl");e.setButtonType(t)},e.prototype.setViewBound=function(t,e){t.changeEPSGType(x.Const.EPSGType.EPSGWeb),e.changeEPSGType(x.Const.EPSGType.EPSGWeb);var i=new E["default"](t,e);this.earth.earthHandler.orbit?this.earth.earthHandler.orbit.setBound(i):M["default"].warn("\u975e\u6d4f\u89c8\u6a21\u5f0f,\u65e0\u6cd5\u8bbe\u7f6e!")},e.prototype.setLookDistance=function(t,e){this.earth.earthHandler.orbit?(this.earth.earthHandler.orbit.minDistance=t,this.earth.earthHandler.orbit.maxDistance=e):M["default"].warn("\u975e\u6d4f\u89c8\u6a21\u5f0f,\u65e0\u6cd5\u8bbe\u7f6e!")},e.prototype.addFog=function(t,e){var i=this.earth.getControl("ViewControl");i.scene.fog=new L["default"](t,e)},e.prototype.removeFog=function(){var t=this.earth.getControl("ViewControl");t.scene.fog=null},e}(P["default"]);e["default"]=F,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=i(42),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.add=function(t){this.initLayer(),this.layer.add(t)},e.prototype.remove=function(t){this.initLayer(),this.layer.remove(t)},e.prototype.clear=function(){this.layer&&this.layer.removeAll()},e.prototype.initLayer=function(){this.layer||(this.layer=new f.ClapLayer({objType:"Clap",virtual:!0},this.earth),this.earth.getControl("LayerControl").addLayer(this.layer))},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(7),c=n(f),p=i(163),v=n(p),m=i(42),g=i(19),y=n(g),_=i(158),x=n(_),b=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.objType="DigAreaLayer",i}return(0,d["default"])(e,t),e.prototype.add=function(t){if(t){this.initLayer(),t&&(t.userData.id=c["default"].getUUID()),this.boxLayer.add(t);var e={};(0,a["default"])(e,t.userData);var i=new x["default"](e,this.earth);this.layer.add(i)}},e.prototype.remove=function(t){if(this.boxLayer&&this.boxLayer.remove(t),this.layer){var e=this.layer.getModel(t.userData.id);e&&this.layer.remove(e)}},e.prototype.clear=function(){var t=this.earth.getControl("LayerControl");this.layer&&(this.layer.removeAll(),t.removeLayer(this.layer),this.layer=void 0),this.boxLayer&&(this.boxLayer.removeAll(),t.removeLayer(this.boxLayer),this.boxLayer=void 0)},e.prototype.initLayer=function(){this.layer=this.earth.getControl("LayerControl").getLayer(this.objType),this.layer||(this.layer=new v["default"]({objType:this.objType},this.earth),this.earth.getControl("LayerControl").addLayer(this.layer),this.boxLayer||(this.boxLayer=new m.StaticLayer({objType:this.objType+"\u7bb1\u5b50\u56fe\u5c42",canSelect:!1},this.earth),this.earth.getControl("LayerControl").addLayer(this.boxLayer)))},e}(y["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(299),d=n(h),f=i(19),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.drawPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.earth.setHandler(new d["default"](this.earth));var i=this.earth.getControl("DrawControl");i.drawPoint(t,e)},e.prototype.drawLine=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];
this.earth.setHandler(new d["default"](this.earth));var i=this.earth.getControl("DrawControl");i.drawLine(t,e)},e.prototype.drawPolygon=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.earth.setHandler(new d["default"](this.earth));var i=this.earth.getControl("DrawControl");i.drawPolygon(t,e)},e.prototype.drawCircle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=new d["default"](this.earth);i.orbit.enablePan=!1,this.earth.setHandler(i);var n=this.earth.getControl("DrawControl");n.drawCircle(t,e)},e.prototype.drawTriangle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.earth.setHandler(new d["default"](this.earth));var i=this.earth.getControl("DrawControl");i.drawTriangle(t,e)},e.prototype.dealAngle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.earth.setHandler(new d["default"](this.earth));var i=this.earth.getControl("DrawControl");i.dealAngle(t,e)},e.prototype.drawRect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=new d["default"](this.earth);i.orbit.enablePan=!1,this.earth.setHandler(i);var n=this.earth.getControl("DrawControl");n.drawRect(t,e)},e.prototype.volumeOfT=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.earth.setHandler(new d["default"](this.earth));var i=this.earth.getControl("DrawControl");i.volumeOfT(t,e)},e.prototype.clear=function(){var t=this.earth.getControl("DrawControl");t.clear()},e.prototype.listenGeoClick=function(t){var e=this.earth.getControl("DrawControl");e.listenGeoClick({markers:[t]})},e}(c["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(19),c=n(f),p=i(6),v=n(p),m=i(7),g=n(m),y=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.gcj_encrypt=function(t,e){v["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u7ecf\u7eac\u5ea6\u8f6c\u9ad8\u5fb7\u5750\u6807\u529f\u80fd!")},e.prototype.gcj_decrypt_exact=function(t,e){v["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u9ad8\u5fb7\u5750\u6807\u8f6c\u7ecf\u7eac\u5ea6\u529f\u80fd!")},e.prototype.bd_encrypt=function(t,e){v["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u9ad8\u5fb7\u5750\u6807\u8f6c\u767e\u5ea6\u5750\u6807\u529f\u80fd!")},e.prototype.bd_decrypt=function(t,e){v["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u767e\u5ea6\u5750\u6807\u8f6c\u9ad8\u5fb7\u5750\u6807\u529f\u80fd!")},e.prototype.mercator_encrypt=function(t,e){var i=20037508.34*e/180,n=Math.log(Math.tan((90+t)*Math.PI/360))/(Math.PI/180);return n=20037508.34*n/180,{lat:n,lon:i}},e.prototype.mercator_decrypt=function(t,e){var i=e/20037508.34*180,n=t/20037508.34*180;return n=180/Math.PI*(2*Math.atan(Math.exp(n*Math.PI/180))-Math.PI/2),{lat:n,lon:i}},e.prototype.bd_mercator=function(t,e){var i=[75,60,45,30,15,0],n=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],r=null,a=t>74?74:t;a=a<-74?-74:a;for(var o=0;o<i.length;o++)if(t>=i[o]){r=n[o];break}if(null==r)for(var s=i.length-1;s>=0;s--)if(t<=-i[s]){r=n[s];break}var u=this.convertBD(e,t,r);return{lon:u[0],lat:u[1]}},e.prototype.mercator_bd=function(t,e){for(var i=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],n=[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],r=null,a={X:Math.abs(e),Y:Math.abs(t)},o=0;o<i.length;o++)if(a.Y>=i[o]){r=n[o];break}var s=this.convertBD(a.X,a.Y,r);return{lon:s[0],lat:s[1]}},e.prototype.convertBD=function(t,e,i){var n=i[0]+i[1]*Math.abs(t),r=Math.abs(e)/i[9],a=i[2]+i[3]*r+i[4]*r*r+i[5]*r*r*r+i[6]*r*r*r*r+i[7]*r*r*r*r*r+i[8]*r*r*r*r*r*r;return n*=t<0?-1:1,a*=e<0?-1:1,[n,a]},e.prototype.distance=function(t,e,i,n){var r=0,a=0,o=g["default"].degToRad(e),s=g["default"].degToRad(n),u=o-s,l=g["default"].degToRad(t)-g["default"].degToRad(i),h=2.27*Math.asin(Math.sqrt(Math.pow(Math.sin(u/2),2)+Math.cos(o)*Math.cos(s)*Math.pow(Math.sin(l/2),2)));h=6378137*h,h=Math.round(1e4*h)/1e4;var d=Math.abs(r-a);return 0!=d&&(h=Math.sqrt(h*h+d*d)),h},e.prototype.searchReverseBD=function(t,e){var i=t.baiduMapKey;if(i)if(this.earth.userData.baiduMapKey&&t.lon&&t.lat){var n=t.lon,r=t.lat,a=t.coordType||"wgs84ll",o=g["default"].getUUID(),s="http://api.map.baidu.com/geocoder/v2/?location="+r+","+n+"&coordtype="+a+"&output=json&pois=1&ak="+i+"&callback="+o;this.getCrossDomainData(o,s,this.earth.userData.dom,function(t){if(t){var i=JSON.parse(t),n=i.result.formatted_address||i.result.sematic_description;e(n)}})}else v["default"].warn("\u53c2\u6570\u9519\u8bef!");else v["default"].warn("\u672a\u914d\u7f6e\u767e\u5ea6\u79d8\u94a5!")},e.prototype.getPidBD=function(t,e){var i=t.baiduMapKey;if(i)if(this.earth.userData.baiduMapKey&&t.lon&&t.lat){var n=g["default"].getUUID(),r="https://mapsv0.bdimg.com/?qt=qsdata&x="+t.lon+"&y="+t.lat+"&fn="+n;this.getCrossDomainData(n,r,this.earth.userData.dom,function(t){if(t){var i=JSON.parse(t);e(i)}})}else v["default"].warn("\u53c2\u6570\u9519\u8bef!");else v["default"].warn("\u672a\u914d\u7f6e\u767e\u5ea6\u79d8\u94a5!")},e.prototype.getCrossDomainData=function(t,e,i,n){var r=document.createElement("script");r.id="BAIDU_POI_SEARCH",window[t]=function(e){n((0,a["default"])(e)),i.removeChild(r),window[t]=null},r.src=e,i.appendChild(r)},e}(c["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=i(42),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.add=function(t){this.initLayer(),this.layer.add(t)},e.prototype.clear=function(){this.layer&&(this.earth.getControl("LayerControl").removeLayer(this.layer),this.layer.removeAll(),this.layer=void 0)},e.prototype.initLayer=function(){this.layer||(this.layer=new f.GridTintLayer({objType:"GridTints",virtual:!0},this.earth),this.earth.getControl("LayerControl").addLayer(this.layer))},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setFloor=function(t){var e=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],this.earth.getControl("LayerControl")),i=e.getLayer("Inner_Floor");i&&i.changeFloor(t)},e.prototype.close=function(){var t=this.earth.getControl("LayerControl"),e=t.getLayer("Inner_Floor");e&&e.closeBuild(),this.earth.open()},e.prototype.open=function(t,e){this.earth.openInner(t,e)},e.prototype.info=function(t,e){var i=this.earth.getService("InnerService");i.refreshGdeFloorData(t,e)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.add=function(t){this.earth.renders.InspectRender.add(t)},e.prototype.remove=function(t){this.earth.renders.InspectRender.remove(t)},e.prototype.inspectFlat=function(){},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(42),p=n(c),v=i(6),m=r(v),g=i(19),y=r(g),_=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.setRegionsColor=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t.forEach(function(t){var r=i.getLayer(t);r&&r.changeAllMeshsColor(e,n[t]||[])})},e.prototype.addLayer=function(t){m["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u6dfb\u52a0\u56fe\u5c42\u529f\u80fd!")},e.prototype.removeLayer=function(t){m["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u5220\u9664\u56fe\u5c42\u529f\u80fd!")},e.prototype.getLayer=function(t){var e=this.earth.getControl("LayerControl");return e.getLayer(t)},e.prototype.getAllLayers=function(){var t=this.earth.getControl("LayerControl");return t.layerSet},e.prototype.init=function(){var t=this;(0,o["default"])(p).map(function(e){t[e]=p[e]})},e}(y["default"]);e["default"]=_,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(6),d=n(h),f=i(19),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.add=function(t,e,i){arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u6dfb\u52a0\u706f\u5149\u529f\u80fd!")},e.prototype.remove=function(t){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u5220\u9664\u706f\u5149\u529f\u80fd!")},e.prototype.updateAmbientLight=function(t){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u4fee\u6539\u73af\u5883\u706f\u5149\u529f\u80fd!")},e.prototype.updateDirLight=function(t){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u4fee\u6539\u5e73\u884c\u706f\u5149\u529f\u80fd!")},e}(c["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=i(4),c=n(f),p=i(7),v=n(p),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.getAngle=function(t){if(t.length<3)return 0;var e=t[0],i=t[1],n=t[2],r=new c["default"](i.x-e.x,i.y-e.y,i.z-e.z),a=new c["default"](n.x-i.x,n.y-i.y,n.z-i.z),o=Math.abs(180-v["default"].radToDeg(r.angleTo(a))).toFixed(2);return o},e.prototype.getArea=function(t){var e=0,i="\u5e73\u65b9\u7c73";if(t.length<3)return{area:e,unit:i};for(var n=t[0],r=1;r<t.length-1;r++){var a=t[r],o=t[r+1],s=n.distanceTo(a),u=a.distanceTo(o),l=o.distanceTo(n),h=(s+u+l)/2,d=Math.sqrt(h*(h-s)*(h-u)*(h-l));e+=d}return e>=1e6&&(i="\u5e73\u65b9\u516c\u91cc",e/=1e6),{area:parseFloat(e.toFixed(2)),unit:i}},e.prototype.getDistance=function(t){if(t.length<2)return{length:0,unit:"\u7c73"};for(var e=0,i=0;i<t.length-1;i++)e+=t[i].distanceTo(t[i+1]);return e>1e3?{distance:(e/1e3).toFixed(2),unit:"\u516c\u91cc"}:{distance:e.toFixed(2),unit:"\u7c73"}},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(6),d=n(h),f=i(19),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setMenu=function(t,e){arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u8bbe\u7f6e\u83dc\u5355\u529f\u80fd!")},e.prototype.clear=function(t,e){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u6e05\u7a7a\u83dc\u5355\u529f\u80fd!")},e.prototype.setObjMenu=function(t,e,i){arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u8bbe\u7f6e\u5bf9\u8c61\u83dc\u5355\u529f\u80fd!")},e}(c["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(6),d=n(h),f=i(19),c=n(f),p=i(44),v=n(p),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.getSelectObjects=function(){var t=this.earth.getControl("SelectControl"),e=[];return t.selectList.forEach(function(t){e.push(t.model)}),e},e.prototype.adsorb=function(t,e,i){},e.prototype.getMeshBoundingInfo=function(t){var e=[],i=this.earth.getControl("LayerControl"),n=[];return t?t.forEach(function(t){var e=i.getLayer(t);e.getAllMeshs(n,[],!1)},this):n=i.getAllMeshLayers(),n.forEach(function(t){if(t.geometry&&t.geometry.computeBoundingSphere instanceof Function&&(t.geometry.computeBoundingSphere(),t.geometry.computeBoundingSphereBox)){var i=t.position,n=t.geometry.computeBoundingSphereBox.min.x+i.x,r=t.geometry.computeBoundingSphereBox.min.y+i.y,a=t.geometry.computeBoundingSphereBox.max.x+i.x,o=t.geometry.computeBoundingSphereBox.max.y+i.y;e.push({key:t.userData.id,value:{minX:n,minY:r,maxX:a,maxY:o}})}},this),e},e.prototype.bufferCircleInspect=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.getMeshBoundingInfo(i);return v["default"].mathCircleInsideBuffer(t,r,e,n)},e.prototype.bufferLineInspect=function(t,e){var i=this.getMeshBoundingInfo(e);return v["default"].mathLineInsideBuffer(t,i)},e.prototype.bufferPolygonInspect=function(t,e){var i=this.getMeshBoundingInfo(e);return v["default"].mathPolygonInsideBuffer(t,i)},e.prototype.doMove=function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u79fb\u52a8\u5bf9\u8c61\u529f\u80fd!")},e.prototype.doEdit=function(){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u7f16\u8f91\u5bf9\u8c61\u529f\u80fd!")},e.prototype.doDelete=function(t){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u5220\u9664\u5bf9\u8c61\u529f\u80fd!")},e.prototype.doAdd=function(t,e){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u6dfb\u52a0\u5bf9\u8c61\u529f\u80fd!")},e}(c["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(19),p=r(c),v=i(79),m=n(v),g=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.init=function(){var t=this;(0,o["default"])(m).map(function(e){t[e]=m[e]})},e}(p["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.getFloorNavDatas=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2],n=this.earth.getService("NavigateService");n.getFloorNavDatas(t,e,i)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(19),c=n(f),p=i(48),v=i(6),m=n(v),g=i(166),y=n(g),_=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.search=function(t,e){var i=this.earth.getService("PoiService");i.getPois(t.k,t.v,function(t){m["default"].isSuccess(t)&&e(t.values)},this)},e.prototype.getPlaceMarker=function(t,e){var i=this.earth.getService(p.AttributeService.fnName);i.getPlaceMarker(t,e)},e.prototype.addPlaceMarker=function(t,e,i){var n=this.earth.getService(p.AttributeService.fnName);n.addPlaceMarker(t,e,i)},e.prototype.deletePlaceMarker=function(t,e,i){var n=this.earth.getService(p.AttributeService.fnName);n.deletePlaceMarker(t,e,i)},e.prototype.getFlyData=function(t,e){var i=this.earth.getService(p.AttributeService.fnName);i.getFlyData(t,e)},e.prototype.addFlyData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=arguments[2],n=this.earth.getService(p.AttributeService.fnName);n.addFlyData(t,e,i)},e.prototype.deleteFlyData=function(t,e,i){var n=this.earth.getService(p.AttributeService.fnName);n.deleteFlyData(t,e,i)},e.prototype.getFlyDataNodes=function(t,e,i,n){var r=this.earth.getService(y["default"].fnName);r.getFlyDataNodes(t,e,i,n)},e.prototype.addFlyDataNodes=function(t,e,i,n){var r=this.earth.getService(y["default"].fnName);r.addFlyDataNodes(t,(0,a["default"])(e),i,n)},e}(c["default"]);e["default"]=_,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(6),d=n(h),f=i(19),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setObjPop=function(t,e,i){arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u8bbe\u7f6e\u5bf9\u8c61\u6c14\u6ce1\u529f\u80fd!")},e.prototype.setPop=function(t,e){arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u5355\u7c7b\u5bf9\u8c61\u6c14\u6ce1\u529f\u80fd!")},e.prototype.show=function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u663e\u793a\u5355\u4f53\u6c14\u6ce1\u529f\u80fd!")},e.prototype.display=function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u663e\u793a\u5355\u4f53\u6c14\u6ce1\u529f\u80fd!")},e.prototype.clear=function(t,e){d["default"].warn("\u57fa\u7840\u529f\u80fd\u672a\u5f00\u542f\u6e05\u7a7a\u6c14\u6ce1\u529f\u80fd!")},e}(c["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=i(401),c=n(f),p=i(404),v=n(p),m=i(403),g=n(m),y=i(5),_=n(y),x=i(406),b=i(196),M=n(b),w=i(405),S=n(w),P=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.addOutlinePass=function(){var t=this.earth.getControl("ViewControl"),e=this.earth.getSize(),i=t.effectComposer;if(i||(i=new c["default"](t.renderer),i.setSize(e.width,e.height),t.addEffectComposer(i)),!i.isHasPass(v["default"])){var n=new v["default"](t.scene,t.camera);i.addPass(n)}var r=new g["default"](new _["default"](e.width,e.height),t.scene,t.camera);i.addPass(r);var a=new M["default"](x.FXAAShader);return a.uniforms.resolution.value.set(1/e.width/3,1/e.height/3),i.addPass(a),a.renderToScreen=!0,r},e.prototype.addNodePass=function(){},e.prototype.addUnrealBloomPass=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.earth.getControl("ViewControl"),i=this.earth.getSize(),n=e.effectComposer;if(n||(n=new c["default"](e.renderer),n.setSize(i.width,i.height),e.addEffectComposer(n)),!n.isHasPass(v["default"])){var r=new v["default"](e.scene,e.camera);n.addPass(r)}var a=new S["default"](new _["default"](i.width,i.height));return a.renderToScreen=!0,a.threshold=t.threshold||0,a.strength=t.strength||.5,a.radius=t.radius||0,e.renderer.toneMappingExposure=t.exposure||1,n.addPass(a),a},e}(d["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.print=function(){var t=this.earth.getControl("ViewControl"),e=t.domElement.toDataURL("image/jpeg",1),i=window.open("about:blank");i.document.body.style.margin="0";var n=new Image;n.onload=function(){i.print(),i.close()},i.document.body.appendChild(n),n.src=e},e.prototype.full=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=document.webkitIsFullScreen;if(!e&&t){var i=document.documentElement;i.requestFullscreen&&i.requestFullscreen()||i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}e&&!t&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():"")},e.prototype.photo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.earth.getControl("ViewControl"),n=i.domElement.toDataURL("image/jpeg",e);return t&&t(n),n},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(19),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.open=function(){},e.prototype.close=function(){},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(13),c=i(19),p=n(c),v=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.timeCache={},i}return(0,d["default"])(e,t),e.prototype.on=function(t,e,i){this.timeCache[t]||(this.timeCache[t]={t:0,fns:[]}),this.timeCache[t].fns.push({f:e,s:i})},e.prototype.off=function(t,e,i){if(this.timeCache[t]){for(var n in this.timeCache[t].fns)if(this.timeCache[t].fns[n].f==e&&this.timeCache[t].fns[n].s==i){this.timeCache[t].fns.splice(n,1);break}this.timeCache[t].fns.length<1&&delete this.timeCache[t]}},e.prototype.fireTimer=function(t){var e=this,i=(new Date).getTime();(0,a["default"])(this.timeCache).map(function(n){0==e.timeCache[n].t?e.timeCache[n].t=i:i-e.timeCache[n].t>=1e3*parseFloat(n)&&(e.timeCache[n].fns.forEach(function(i){i.f.call(i.s,t,e.earth)}),e.timeCache[n].t=i)})},e.prototype.init=function(){this.earth.on(f.Events.Earth.Renderer,this.fireTimer,this)},e}(p["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(18),p=i(157),v=i(89),m=r(v),g=i(41),y=r(g),_=i(300),x=r(_),b=i(304),M=r(b),w=i(79),S=n(w),P=i(11),A=r(P),C=i(64),T=r(C),E=i(6),D=r(E),L=i(168),F=r(L),k=i(31),I=i(19),O=r(I),N=function(t){function e(){(0,u["default"])(this,e);var i=(0,h["default"])(this,t.apply(this,arguments));return i.Point=A["default"],i.Tween=k.Tween,i.Polyline=m["default"],i.PointLockHandler=M["default"],i.DefaultHandler=y["default"],i.LayerControl=p.LayerControl,i.LightHelper=F["default"],i.EditHandler=x["default"],i.Helper=D["default"],i.Size=T["default"],i.BufferAttribute=c.BufferAttribute,i}return(0,f["default"])(e,t),e.prototype.init=function(){var t=this;this.Models={},(0,o["default"])(S).map(function(e){t.Models[e]=S[e]})},e}(O["default"]);e["default"]=N,t.exports=e["default"]},[681,245],function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(20),s=n(o),u=i(179),l=n(u),h=i(92),d=i(35),f=i(14),c=n(f),p=i(4),v=n(p),m=i(24),g=n(m),y=i(11),_=n(y),x=i(8),b=i(13),M=i(31),w=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new v["default"],n=arguments[2];(0,a["default"])(this,t),this.initAttributes(),this.earth=n,this.viewControl=this.earth.getControl("ViewControl"),this.selectControl=this.earth.getControl("SelectControl"),this.domElement=this.viewControl.domElement,this.camera=e,this.target=i,this.scene=this.viewControl.scene,this.initCameraGroup()}return t.prototype.flyTo=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,r=arguments[3],a=this.target.clone(),o=this.yawObject.position.clone();this.tween&&this.tween.stop();var s={tx:a.x,ty:a.y,tz:a.z,px:o.x,py:o.y,pz:o.z},u={tx:e.x,ty:e.y,tz:e.z,px:t.x,py:t.y,pz:t.z};this.tween=new M.Tween(s).to(u,n).onUpdate(function(){var t=new _["default"](s.px,s.py,s.pz,x.Const.EPSGType.EPSGWeb),e=new _["default"](s.tx,s.ty,s.tz,x.Const.EPSGType.EPSGWeb);i.yawObject.position.copy(t),i.target.copy(e)}).onComplete(function(){i.tween.stop(),i.tween=null,r&&r()}),this.tween.start()},t.prototype.initCameraGroup=function(){this.oldPosition=this.camera.position.clone(),this.camera.position.set(0,0,0),this.scene.remove(this.camera),this.pitchObject=new s["default"],this.pitchObject.add(this.camera),this.yawObject=new s["default"],this.yawObject.add(this.pitchObject);var t=new h.BoxGeometry(50,50,1),e=new d.MeshBasicMaterial({color:65280}),i=new g["default"](t,e);this.yawObject.add(i),this.scene.add(this.yawObject)},t.prototype.initAttributes=function(){this.target=new v["default"](0,0,0),this.isDown=!1,this.moveLeft=!1,this.moveRight=!1,this.moveForward=!1,this.moveBackward=!1,this.canJump=!0,this.spaceUp=!1,this.horizontalRaycaster=new l["default"](new v["default"],new v["default"],0,10),this.downRaycaster=new l["default"](new v["default"],new v["default"](0,0,(-1)),0,10),this.velocity=new v["default"],this.direction=new v["default"],this.rotation=new v["default"],this.speed=200,this.upSpeed=100},t.prototype.setPosition=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _["default"](0,0,0);this.flyTo(t,e||t,1e3)},t.prototype.setHorizionAngle=function(t){this.pitchObject.rotation._x=t/180*Math.PI},t.prototype.doMouseDown=function(t){this.isDown=!0},t.prototype.doMouseUp=function(t){this.isDown=!1},t.prototype.doMouseMove=function(t){if(this.isDown){var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,i=t.movementY||t.mozMovementY||t.webkitMovementY||0;this.yawObject.rotation.setZ(this.yawObject.rotation._z-.002*e),this.pitchObject.rotation.setX(this.pitchObject.rotation._x-.002*i),this.pitchObject.rotation.setX(Math.max(-Math.PI/3,Math.min(Math.PI/3,this.pitchObject.rotation._x))),this.pitchObject.rotation.setY(this.yawObject.rotation._y-2e-4*e)}},t.prototype.doKeyDownEvents=function(t){switch(t.keyCode){case 38:this.moveBackward=!0;break;case 87:this.moveBackward=!0;break;case 37:this.moveLeft=!0;break;case 65:this.moveLeft=!0;break;case 40:this.moveForward=!0;break;case 83:this.moveForward=!0;break;case 39:this.moveRight=!0;break;case 68:this.moveRight=!0;break;case 32:this.canJump&&this.spaceUp&&(this.velocity.z+=this.upSpeed),this.canJump=!1,this.spaceUp=!1}},t.prototype.doKeyUpEvents=function(t){switch(t.keyCode){case 38:this.moveBackward=!1;break;case 87:this.moveBackward=!1;break;case 37:this.moveLeft=!1;break;case 65:this.moveLeft=!1;break;case 40:this.moveForward=!1;break;case 83:this.moveForward=!1;break;case 39:this.moveRight=!1;break;case 68:this.moveRight=!1;break;case 32:this.spaceUp=!0}},t.prototype.doMouseRightClick=function(t){var e=this.selectControl.getMousePoint(t),i=this.yawObject.position.clone(),n=this.target.clone(),r=n.sub(i),a=e.distanceTo(i),o=a/10*1e3,s=e.add(r);this.flyTo(e,s,o)},t.prototype.update=function(t){this.velocity.x-=10*this.velocity.x*t,this.velocity.y-=10*this.velocity.y*t,this.velocity.z-=9.8*100*t,this.direction.y=Number(this.moveForward)-Number(this.moveBackward),this.direction.x=Number(this.moveLeft)-Number(this.moveRight),this.direction.normalize();var e=this.yawObject.getWorldDirection();this.rotation.copy(e.multiply(new v["default"]((-1),(-1),0)));var i=new c["default"];this.direction.y>0?this.direction.x>0?i.makeRotationZ(Math.PI/4):this.direction.x<0?i.makeRotationZ(-Math.PI/4):i.makeRotationZ(0):this.direction.y<0?this.direction.x>0?i.makeRotationZ(Math.PI/4*3):this.direction.x<0?i.makeRotationZ(-Math.PI/4*3):i.makeRotationZ(Math.PI):this.direction.x>0?i.makeRotationZ(Math.PI/2):this.direction.x<0&&i.makeRotationZ(-Math.PI/2),this.rotation.applyMatrix4(i),this.horizontalRaycaster.set(this.yawObject.position,this.rotation);var n=this.horizontalRaycaster.intersectObjects(this.scene.children,!0),r=n.length>0;r||((this.moveForward||this.moveBackward)&&(this.velocity.y-=this.direction.y*this.speed*t),(this.moveLeft||this.moveRight)&&(this.velocity.x-=this.direction.x*this.speed*t)),this.downRaycaster.ray.origin.copy(this.yawObject.position),
this.downRaycaster.ray.origin.z-=10;var a=this.downRaycaster.intersectObjects(this.scene.children,!0),o=a.length>0;o===!0?(this.velocity.z=Math.max(0,this.velocity.z),this.canJump=!0,this.yawObject.position.z=a[0].point.z+5):this.yawObject.translateZ(this.velocity.z*t),this.yawObject.translateX(this.velocity.x*t),this.yawObject.translateY(this.velocity.y*t),this.yawObject.position.z<5&&(this.velocity.z=0,this.yawObject.position.z=5,this.canJump=!0),this.target=this.yawObject.position.clone(),this.viewControl.target=this.target.clone(),this.viewControl.virtualCamera=this.yawObject.position.clone(),this.initTimer()},t.prototype.initTimer=function(){!this.timer&&(this.moveBackward||this.moveForward||this.moveLeft||this.moveRight)?this.timer=window.setInterval(this.reloadData.bind(this),3e3):this.moveBackward||this.moveForward||this.moveLeft||this.moveRight||(window.clearInterval(this.timer),this.timer=null)},t.prototype.reloadData=function(){this.earth.fireEvent(b.Events.Earth.CenterChange,this)},t.prototype.register=function(){this.earth.on(b.Events.Mouse.Move,this.doMouseMove,this),this.earth.on(b.Events.Mouse.Down,this.doMouseDown,this),this.earth.on(b.Events.Mouse.RightClick,this.doMouseRightClick,this),this.earth.on(b.Events.Mouse.Up,this.doMouseUp,this),this.earth.on(b.Events.Mouse.KeyDown,this.doKeyDownEvents,this),this.earth.on(b.Events.Mouse.KeyUp,this.doKeyUpEvents,this),this.earth.on(b.Events.Earth.Renderer,this.update,this)},t.prototype.dispose=function(){this.viewControl.virtualCamera=void 0,this.viewControl.camera.position.copy(this.yawObject.position.clone()),this.earth.off(b.Events.Mouse.Move,this.doMouseMove,this),this.earth.off(b.Events.Mouse.Down,this.doMouseDown,this),this.earth.off(b.Events.Mouse.RightClick,this.doMouseRightClick,this),this.earth.off(b.Events.Mouse.Up,this.doMouseUp,this),this.earth.off(b.Events.Mouse.KeyDown,this.doKeyDownEvents,this),this.earth.off(b.Events.Mouse.KeyUp,this.doKeyUpEvents,this),this.earth.off(b.Events.Earth.Renderer,this.update,this),this.scene.remove(this.yawObject),this.camera.position.copy(this.oldPosition),this.scene.add(this.camera)},t}();e["default"]=w,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(20),s=n(o),u=i(13),l=i(7),h=n(l),d=function(){function t(e,i,n){(0,a["default"])(this,t),this.earth=n,this.camera=e,this.scene=i,this.oldPosition=this.camera.position.clone(),this.camera.position.set(0,0,0),this.pitchObject=new s["default"],this.pitchObject.add(this.camera),this.yawObject=new s["default"],this.yawObject.add(this.pitchObject),this.scene.add(this.yawObject),this.yawObject.position.copy(this.oldPosition)}return t.prototype.setPosition=function(t,e,i){this.yawObject.position.copy(t),this.yawObject.rotation.z=h["default"].degToRad(e),this.pitchObject.rotation.y=h["default"].degToRad(i)},t.prototype.mouseDrag=function(t){var e=t.movementX,i=t.movementY;this.pitchObject.rotation.z-=.002*e,this.yawObject.rotation.y-=.002*i,this.yawObject.rotation.y=Math.max(-Math.PI/3,Math.min(Math.PI/3,this.yawObject.rotation.y))},t.prototype.register=function(){this.earth.on(u.Events.Mouse.Drag,this.mouseDrag,this)},t.prototype.dispose=function(){this.earth.off(u.Events.Mouse.Drag,this.mouseDrag,this),this.scene.remove(this.yawObject),this.yawObject.remove(this.pitchObject),this.pitchObject.remove(this.camera),this.yawObject.dispose(),this.pitchObject.dispose(),this.camera.position.copy(this.oldPosition)},t}();e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(39),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setDefault=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="default"},e.prototype.setPointer=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="pointer"},e.prototype.setText=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="text"},e.prototype.setCrosshair=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="crosshair"},e.prototype.setMove=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="move"},e.prototype.setEResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="e-resize"},e.prototype.setNeResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="ne-resize"},e.prototype.setNwResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="nw-resize"},e.prototype.setNResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="n-resize"},e.prototype.setSeResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="se-resize"},e.prototype.setSwResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="sw-resize"},e.prototype.setSResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="s-resize"},e.prototype.setWResize=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="w-resize"},e.prototype.setWait=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor=" wait"},e.prototype.setHelp=function(){var t=this.earth.getControl("ViewControl");t.domElement.style.cursor="help"},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r,a=i(17),o=n(a),s=i(1),u=n(s),l=i(3),h=n(l),d=i(2),f=n(d),c=i(7),p=n(c),v=i(39),m=n(v),g=i(280),y=n(g),_=i(161),x=n(_),b=i(89),M=n(b),w=i(41),S=n(w),P=i(42),A=i(79),C=i(107),T=n(C),E=i(11),D=n(E),L=i(13),F=i(6),k=n(F);!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Polygon=2]="Polygon",t[t.Triangle=3]="Triangle",t[t.Angle=4]="Angle",t[t.Volume=5]="Volume",t[t.Circle=6]="Circle",t[t.Rect=7]="Rect"}(r||(r={}));var I=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.drawPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];k["default"].warn("\u5355\u51fb\u5f00\u59cb\u6807\u70b9,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Point,this.cursorControl.setCrosshair(),void 0==t.isPoint&&(t.isPoint=!0),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.drawLine=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];k["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Line,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.drawPolygon=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];k["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Polygon,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.drawCircle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];k["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Circle,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.drawTriangle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];k["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Triangle,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.dealAngle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];k["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Angle,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.volumeOfT=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.initLayer(),this.drawMode=r.Volume,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.drawRect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.initLayer(),this.drawMode=r.Rect,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:p["default"].getUUID()},t),this.fn=e},e.prototype.click=function(t){var e=this.selectControl.getMousePoint(t);if(e){if(this.drawMode==r.Point)this.doPoint(e,this.cfg.isPoint,!0);else if(this.drawMode==r.Line||this.drawMode==r.Polygon||this.drawMode==r.Angle||this.drawMode==r.Volume){this.cfg.isPoint&&this.doPoint(e,this.cfg.isPoint,!1);var i=this.drawMode==r.Line||this.drawMode==r.Angle?new M["default"]({data:this.cfg},this.earth):new x["default"]({data:this.cfg},this.earth);this.coordinate.drawObj?(this.coordinate.drawObj.addPoint(e,!0),this.drawMode==r.Angle&&this.coordinate.drawObj.points.length>3&&(this.fn&&this.fn({coordinate:this.coordinate,markerLayer:this.markerLayer,type:"rightClick"}),this.endDraw())):(i.addPoint(e,!0),this.activeLayer.add(i),this.coordinate.drawObj=i)}else this.drawMode==r.Triangle&&(this.firstPoint||(this.firstPoint=e));this.fn&&this.fn({coordinate:this.coordinate,markerLayer:this.markerLayer,type:"click"})}},e.prototype.doPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var n=new A.Marker({data:{icon:this.cfg.pointUrl,id:p["default"].getUUID()},shapes:[{x:t.x,y:t.y,z:t.z,EPSGType:t.EPSGType}]},this.earth);this.coordinate.markers.push(n),this.markerLayer.add(n)}i&&(this.fn&&this.fn({point:t,markerLayer:this.markerLayer}),this.endDraw())},e.prototype.addStreetIcon=function(t){this.markerLayer||(this.markerLayer=new P.MarkerLayer({objType:"\u6807\u6ce8\u7ed8\u5236\u56fe\u5c42",canSelect:!0},this.earth),this.layerControl.addLayer(this.markerLayer));var e=new A.Marker({data:{icon:"./images/ico.png",id:p["default"].getUUID()},shapes:[t]},this.earth);return this.markerLayer.removeAll(),this.markerLayer.add(e),e},e.prototype.removeStreetIcon=function(){this.markerLayer&&(this.markerLayer.removeAll(),this.layerControl.removeLayer(this.markerLayer),this.markerLayer=void 0)},e.prototype.move=function(t){var e=this.selectControl.getMousePoint(t);if(e&&(this.drawMode!=r.Polygon&&this.drawMode!=r.Line&&this.drawMode!=r.Angle&&this.drawMode!=r.Volume||!this.coordinate.drawObj||(this.coordinate.drawObj.updatePoint(e),this.fn&&this.fn({coordinate:this.coordinate,point:e,markerLayer:this.markerLayer,type:"move"})),this.drawMode==r.Triangle&&this.firstPoint)){var i=e.clone();i.z=this.firstPoint.z;var n=e.clone();if(this.coordinate.drawObj)this.coordinate.drawObj.updatePoints([this.firstPoint,i,n,this.firstPoint]);else{var a=new M["default"]({data:this.cfg},this.earth);a.updatePoints([this.firstPoint,i,n,this.firstPoint]),this.coordinate.drawObj=a,this.activeLayer.add(this.coordinate.drawObj)}this.fn&&this.fn({coordinate:this.coordinate,point:e,markerLayer:this.markerLayer,type:"move"})}},e.prototype.rightClick=function(){this.coordinate.drawObj&&this.drawMode!=r.Point&&this.drawMode!=r.Angle&&(this.drawMode!=r.Polygon&&this.drawMode!=r.Volume&&this.drawMode!=r.Line||this.coordinate.drawObj.endPoint(),this.fn&&this.fn({coordinate:this.coordinate,drawLayer:this.activeLayer,markerLayer:this.markerLayer,type:"rightClick"})),this.endDraw()},e.prototype.drag=function(t){var e=this.selectControl.getMousePoint(t);if(e){if(this.drawMode==r.Circle)if(this.coordinate.drawObj)this.coordinate.drawObj.updatePoint(e);else{e.z=2,(0,o["default"])(this.cfg,{point:e});var i=new y["default"]({data:this.cfg},this.earth);this.activeLayer.add(i),this.coordinate.drawObj=i}else if(this.drawMode==r.Rect)if(this.coordinate.drawObj){var n=new T["default"];n.setFromPoints([this.firstPoint,e]),this.coordinate.drawObj.updatePoints([this.firstPoint,new D["default"](n.min.x,n.min.y,0,"3857"),e,new D["default"](n.max.x,n.max.y,0,"3857"),this.firstPoint])}else{this.firstPoint=e;var a=new x["default"]({data:this.cfg},this.earth);a.updatePoints([e,e,e,e,e]),this.activeLayer.add(a),this.coordinate.drawObj=a}this.fn&&this.fn({coordinate:this.coordinate,markerLayer:this.markerLayer,type:"drag"})}},e.prototype.dragEnd=function(){this.drawMode!=r.Circle&&this.drawMode!=r.Rect||this.endDraw()},e.prototype.keyUp=function(t){27==t.keyCode&&(this.listenGeoClick(this.coordinate),this.endDraw())},e.prototype.endDraw=function(){this.fn=null,this.firstPoint=null,this.earth.setHandler(new S["default"](this.earth)),this.cursorControl.setDefault(),this.coordinate={markers:[],drawObj:null,cfg:{}},this.cfg={}},e.prototype.listenGeoClick=function(t){var e=this;t&&(t.markers&&t.markers.forEach(function(t){e.markerLayer.remove(t)},this),t.drawObj&&this.activeLayer.remove(t.drawObj))},e.prototype.clear=function(){this.endDraw(),this.markerLayer&&(this.markerLayer.removeAll(),this.layerControl.removeLayer(this.markerLayer),this.markerLayer=void 0),this.activeLayer&&(this.activeLayer.removeAll(),this.layerControl.removeLayer(this.activeLayer),this.activeLayer=void 0)},e.prototype.register=function(){this.earth.on(L.Events.Mouse.Click,this.click,this),this.earth.on(L.Events.Mouse.Move,this.move,this),this.earth.on(L.Events.Mouse.RightClick,this.rightClick,this),this.earth.on(L.Events.Mouse.KeyUp,this.keyUp,this),this.earth.on(L.Events.Mouse.Drag,this.drag,this),this.earth.on(L.Events.Mouse.DragEnd,this.dragEnd,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(L.Events.Mouse.Click,this.click,this),this.earth.off(L.Events.Mouse.Move,this.move,this),this.earth.off(L.Events.Mouse.RightClick,this.rightClick,this),this.earth.off(L.Events.Mouse.KeyUp,this.keyUp,this),this.earth.off(L.Events.Mouse.Drag,this.drag,this),this.earth.off(L.Events.Mouse.DragEnd,this.dragEnd,this)},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.cfg={},this.defaultCfg={isPoint:!1,font_size:14,font_color:"f5f5f5",pointUrl:"./images/default/point.png"},this.coordinate={markers:[],drawObj:null,cfg:{}}},e.prototype.initComponent=function(){this.layerControl=this.earth.getControl("LayerControl"),this.selectControl=this.earth.getControl("SelectControl"),this.cursorControl=this.earth.getControl("CursorControl")},e.prototype.initLayer=function(){this.markerLayer||(this.markerLayer=new P.MarkerLayer({objType:"\u6807\u6ce8\u56fe\u5c42",canSelect:!0},this.earth),this.layerControl.addLayer(this.markerLayer)),this.activeLayer||(this.activeLayer=new P.ActiveLayer({objType:"\u7ed8\u5236\u56fe\u5c42",canSelect:!0},this.earth),this.layerControl.addLayer(this.activeLayer))},e}(m["default"]);e["default"]=I,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(4),d=n(h),f=i(39),c=n(f),p=i(41),v=n(p),m=i(48),g=i(13),y=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.editList=[]},e.prototype.add=function(t,e){this.editList.push({model:t,point:e,pos:t.position.clone()}),t.click()},e.prototype.getEditList=function(){return this.editList},e.prototype.remove=function(t){if(!(t.length<1)){var e=[];t.forEach(function(t){e.push({objType:t.parent.userData.objType,id:t.userData.id})});var i=this.earth.getService(m.RCService.fnName);i.deleteData(e)}},e.prototype.finish=function(){var t=[];if(this.editList.forEach(function(e){var i=e.model.getInfo();e.model.unClick(),null!=i&&(e.model.saveState(),t.push(e.model.getInfo()))}),t.length>0){var e=this.earth.getService(m.RCService.fnName);e.updateData(t)}this.editList=[]},e.prototype.click=function(t,e){this.finish(),e.setHandler(new v["default"](e))},e.prototype.keyUp=function(t,e){27==t.keyCode&&(this.editList.forEach(function(t){t.model.position.copy(t.point)}),this.editList=[],e.setHandler(new v["default"](e)))},e.prototype.move=function(t,e){var i=e.getControl("LayerControl"),n=t.offsetX||t.layerX||t.pageX,r=t.offsetY||t.layerY||t.pageY,a=[];this.editList.forEach(function(t){a.push(t.model)});var o=i.getSelectMeshs({x:n,y:r},!1,a);if(o){var s=new d["default"];o.point.z<1e-6&&o.point.z>0&&(o.point.z=0);for(var u=this.editList.length-1;u>=0;u--)u==this.editList.length-1&&(s=o.point.clone().sub(this.editList[u].point)),this.editList[u].model.setPosition(this.editList[u].pos.clone().add(s))}},e.prototype.register=function(){this.earth.on(g.Events.Mouse.Click,this.click,this),this.earth.on(g.Events.Mouse.Move,this.move,this),this.earth.on(g.Events.Mouse.KeyUp,this.keyUp,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(g.Events.Mouse.Click,this.click,this),this.earth.off(g.Events.Mouse.Move,this.move,this),this.earth.off(g.Events.Mouse.KeyUp,this.keyUp,this)},e}(c["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(47),o=r(a),s=i(17),u=r(s),l=i(1),h=r(l),d=i(3),f=r(d),c=i(2),p=r(c),v=i(156),m=n(v),g=i(39),y=r(g),_=i(11),x=r(_),b=i(8),M=i(13),w=i(6),S=r(w),P=i(31),A=function(t){function e(){return(0,h["default"])(this,e),(0,f["default"])(this,t.apply(this,arguments))}return(0,p["default"])(e,t),e.prototype.addFlyDataNodes=function(){var t=this.screenHelper.photo(null,.6),e=this.cameraHelper.info();return(0,u["default"])(e,{icon:t}),e},e.prototype.addFlyData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2],n=this;e.forEach(function(t,e){t.sort=e++,t.position=(0,o["default"])(t.position),t.target=(0,o["default"])(t.target)});var r=new m.Poi(this.earth);r.addFlyData({flyDataInfo:t},function(t){if(S["default"].isSuccess(t)){var r=t.values.id;n.saveFlyDataNodes(e,r,0,i)}else i&&i(t)},this)},e.prototype.saveFlyDataNodes=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments[3],r=new m.Poi(this.earth),a=this,o=t[i];o.sys_flymode_id=e,r.addFlyDataNodes(this.earth.userData.key,o,function(r){if(i<t.length-1){var o=t[++i];o.sys_flymode_id=e,a.saveFlyDataNodes(t,e,i,n)}else n("\u6dfb\u52a0\u5b8c\u6210")},this)},e.prototype.deleteFlyData=function(t,e){var i=new m.Poi(this.earth);i.deleteFlyData(t,function(t){e&&e(t)},this)},e.prototype.getFlyData=function(t){var e=new m.Poi(this.earth);e.getFlyData(function(e){t&&t(e)},this)},e.prototype.getFlyDataNodes=function(t,e){var i=new m.Poi(this.earth);i.getFlyDataNodes(this.earth.userData.key,t,function(t){e&&e(t)},this)},e.prototype.viewPath=function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.75;this.shapeList=[],t.forEach(function(t){if(!(t.position instanceof x["default"])){var i=JSON.parse(t.position),n=JSON.parse(t.target);t.position=new x["default"](parseFloat(i.x),parseFloat(i.y),parseFloat(i.z),i.EPSGType),t.target=new x["default"](parseFloat(n.x),parseFloat(n.y),parseFloat(n.z),n.EPSGType)}e.shapeList.push(t)},this),this.startNum=1,this.speed=i,this.lastPoint=void 0,this.lastTarget=void 0;var n=this.shapeList[0];this.cameraHelper.flyTo(n.position,n.target,1e3,this.initObjTween.bind(this))},e.prototype.start=function(){this.tween1?this.tween1.start():this.initObjTween()},e.prototype.pause=function(){this.tween1&&(this.nodeTimePast=this.nodeTimePastIng,this.tween1.stop())},e.prototype.finish=function(){this.tween1&&(this.shapeList=[],this.startNum=1,this.tween1.stop(),this.tween1=void 0)},e.prototype.initObjTween=function(){if(this.startNum>this.shapeList.length-1)return this.finish(),this.lastPoint=void 0,this.lastTarget=void 0,void this.earth.fireEvent(M.Events.Fly.Finish,this);var t=this.shapeList[this.startNum].position.clone(),e=this.shapeList[this.startNum].target.clone(),i=this.lastPoint,n=this.lastTarget,r=!1;i?this.cameraHelper.flyTo(i,n,1):(r=!0,i=this.shapeList[this.startNum-1].position.clone(),n=this.shapeList[this.startNum-1].target.clone());var a=i.clone().changeEPSGType(b.Const.EPSGType.EPSGWeb),o=t.clone().changeEPSGType(b.Const.EPSGType.EPSGWeb);e.changeEPSGType(b.Const.EPSGType.EPSGWeb);var s=a.distanceTo(o),u=s/this.speed*100,l=this;r&&(l.nodeTimeCost=u/l.times),this.flyTo(t,e,u/this.times)},e.prototype.flyTo=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,r=arguments[3];e.changeEPSGType(b.Const.EPSGType.EPSGWeb),t.changeEPSGType(b.Const.EPSGType.EPSGWeb);var a=this.viewControl.target.clone(),o=this.viewControl.camera.position.clone();this.tween1&&this.tween1.stop();var s=this,u={tx:a.x,ty:a.y,tz:a.z,px:o.x,py:o.y,pz:o.z},l={tx:e.x,ty:e.y,tz:e.z,px:t.x,py:t.y,pz:t.z},h=Date.now();this.tween1=new P.Tween(u).to(l,n).onUpdate(function(){var t=new x["default"](u.px,u.py,u.pz,b.Const.EPSGType.EPSGWeb),e=new x["default"](u.tx,u.ty,u.tz,b.Const.EPSGType.EPSGWeb);s.viewControl.flyTo(t.clone(),e.clone()),s.lastTarget=e.clone(),s.lastPoint=t.clone();var i=Date.now(),n=i-h,r=(s.nodeTimePast+n)/s.nodeTimeCost;s.nodeTimePastIng=s.nodeTimePast+n,r=r>1?1:r,s.earth.fireEvent(M.Events.Fly.FlyIng,r,s.startNum)}).onComplete(function(){i.tween1.stop(),i.tween1=null,s.startNum++,s.initObjTween(),r&&r()}),this.tween1.start()},e.prototype.register=function(){},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.nodeTimePast=0,this.nodeTimeCost=0,this.startNum=1,this.times=1},e.prototype.initComponent=function(){this.viewControl=this.earth.getControl("ViewControl"),this.screenHelper=this.earth.Api.Screen,this.cameraHelper=this.earth.Api.Camera},e}(y["default"]);e["default"]=A,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(626),a=n(r),o=i(10),s=n(o),u=i(1),l=n(u),h=i(3),d=n(h),f=i(2),c=n(f),p=i(179),v=n(p),m=i(39),g=n(m),y=i(21),_=n(y),x=i(309),b=n(x),M=i(105),w=n(M),S=i(312),P=n(S),A=i(313),C=n(A),T=i(48),E=i(11),D=n(E),L=i(13),F=i(6),k=n(F),I=i(34),O=n(I),N=i(8),R=function(t){function e(){return(0,l["default"])(this,e),(0,d["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.addLayer=function(t){t.userData.PObjType&&this.layerSet[t.userData.PObjType]?this.layerSet[t.userData.PObjType].childLayer.push(t):this.layerSet[t.userData.objType]=t;var e=this.earth.getControl("ViewControl");t instanceof w["default"]?e.canvas.add(t):(e.scene.add(t),t.isGround()&&this.earth.renders.DemRender.addGroundLayer(t))},e.prototype.getLayer=function(t){return this.layerSet[t]},e.prototype.removeLayer=function(t){var e=this.earth.getControl("ViewControl");delete this.layerSet[t.userData.objType],this.layerSet[t.userData.PObjType]&&k["default"].listSplice(this.layerSet[t.userData.PObjType].childLayer,t),t instanceof w["default"]?e.canvas.remove(t):e.scene.remove(t),t.dispose()},e.prototype.getAllMeshLayers=function(){var t=this,e=[];return(0,s["default"])(this.layerSet).map(function(i){var n=t.layerSet[i];"TileLayer"!=n.type&&n.getAllMeshs(e,[],!1)}),e},e.prototype.getAllMeshsNotGround=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=[];return(0,s["default"])(this.layerSet).map(function(n){var r=t.layerSet[n];r.isGround()||(e?r.getAllMeshs(i,[],!1):r instanceof w["default"]||r.getAllMeshs(i,[],!1))}),i},e.prototype.getAllSceneMeshs=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=[];return(0,s["default"])(this.layerSet).map(function(n){var r=t.layerSet[n];e?r.getAllMeshs(i,[],!1):r instanceof w["default"]||r.getAllMeshs(i,[],!1)}),i},e.prototype.getSelectMeshs=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.earth.getControl("ViewControl"),a=new v["default"],o=this.earth.getSize(),u=O["default"].getMousePosition(t.x,t.y,o.width,o.height);a.setFromCamera(u,r.camera);var l=[],h=[];(0,s["default"])(this.layerSet).map(function(t){var r=i.layerSet[t];r instanceof w["default"]?r.getAllMeshs(h,n,e):r.getAllMeshs(l,n,e)});var d=this.intersectMarkers(h,t,u);if(d.length<1&&(d=a.intersectObjects(l,!0),d.length>0&&d[0].object instanceof _["default"]==0&&d[0].object.traverseAncestors(function(t){if(t instanceof _["default"])return void(d[0].object=t)})),d.length<1)return null;var f=new D["default"](d[0].point.x,d[0].point.y,d[0].point.z,N.Const.EPSGType.EPSGWeb);return d[0].point=f,d[0]},e.prototype.intersectMarkers=function(t,e,i){for(var n=[],r=0;r<t.length;r++)if(t[r].isInside(e.x,e.y)){n.push({object:t[r],point:new D["default"]});break}return n},e.prototype.getLayersByType=function(t){var e=this,i=[],n=function(n){var r=e.layerSet[n];r.visible&&r.canDraw()&&(r instanceof t||(0,a["default"])(r)instanceof t)&&i.push(r),r.childLayer&&r.childLayer.forEach(function(e){e.visible&&e.canDraw()&&(e instanceof t||(0,a["default"])(r)instanceof t)&&i.push(r)})};for(var r in this.layerSet)n(r);return i},e.prototype.loadLayers=function(){var t=this;this.initInner();var e=this.earth.getService(T.AttributeService.fnName);e.getEarthLayers(this.earth.userData.key,this.earth.userData.isInner,function(e){k["default"].isSuccess(e)&&(e.values.forEach(function(e){var i=O["default"].createLayer(e,t.earth);i&&t.addLayer(i)}),t.loadLayersData(!1),t.initBGTiles(),t.initSky(),setTimeout(function(){t.earth.fireEvent(L.Events.Earth.Finish,t.earth)},3e3))},this)},e.prototype.initInner=function(){var t=new b["default"]({objType:"Inner_Floor"},this.earth);this.addLayer(t)},e.prototype.initSky=function(){if(1!=this.earth.userData.hideSky&&1!=this.earth.userData.isInner){var t=new P["default"]({objType:"\u5929\u7a7a"},this.earth);this.addLayer(t)}},e.prototype.initBGTiles=function(){if(1!=this.earth.userData.hideBGTile&&1!=this.earth.userData.isInner){var t={objType:"\u5e95\u56fe"};this.earth.userData.baseMap&&(t.baseMap=this.earth.userData.baseMap);var e=new C["default"](t,this.earth);this.addLayer(e)}},e.prototype.loadLayersData=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=[],n=[],r={};(0,s["default"])(this.layerSet).map(function(e){var a=t.layerSet[e];a.canDraw()&&a.visible&&("1"==a.userData.is_grid?a.isShow()?a.getRCSize(r):a.removeAll():(i.push(a.userData.objType),n.push(a.userData.condition||"*")))});var a=this.earth.getService("RCService");!e&&i.length>0&&a.refreshDBData(i.join(";"),n.join(";"));var o=(0,s["default"])(r);o.length>0&&o.map(function(t){var e=r[t].rc;a.refreshData(e.r,e.c,e.s,r[t].objType.join(";"),r[t].condition.join(";"))})},e.prototype.dragEnd=function(){this.stopLoad();var t=this;this.timerData=setTimeout(function(){t.loadLayersData(!0)},300)},e.prototype.stopLoad=function(){this.timerData&&clearTimeout(this.timerData),this.timerData=null},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.layerSet={}},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.loadLayers(),this.earth.on(L.Events.Earth.CenterChange,this.dragEnd,this),this.earth.on(L.Events.Earth.ScaleChange,this.dragEnd,this),this.earth.on(L.Events.Mouse.Down,this.stopLoad,this)},e.prototype.dispose=function(){var e=this;this.earth.off(L.Events.Earth.CenterChange,this.dragEnd,this),this.earth.off(L.Events.Earth.ScaleChange,this.dragEnd,this),this.earth.off(L.Events.Mouse.Down,this.stopLoad,this),t.prototype.dispose.call(this),(0,s["default"])(this.layerSet).map(function(t){e.removeLayer(e.layerSet[t])}),O["default"].imgCache={}},e}(g["default"]);e["default"]=R,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(5),d=n(h),f=i(39),c=n(f),p=i(13),v=i(6),m=n(v),g=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.apply(this,arguments));return i.buttonType=0,i}return(0,l["default"])(e,t),e.prototype.doMouseDown=function(t){this.isRightDown=2==t.button,this.isMouseDown=!0,this.isMouseMove=!1,this.isRotate=!1,this.oldPoint=new d["default"](t.clientX,t.clientY),this.earth.fireEvent(p.Events.Mouse.Down,t,this.earth)},e.prototype.doMouseMove=function(t){if(this.earth.fireEvent(p.Events.Mouse.Move,t,this.earth),this.isMouseDown){var e=new d["default"](t.clientX,t.clientY);this.isMouseMove=!this.oldPoint.equals(e),this.isRightDown&&this.isMouseMove?(this.isRotate=!0,this.earth.fireEvent(p.Events.Mouse.Rotate,t,this.earth)):this.earth.fireEvent(p.Events.Mouse.Drag,t,this.earth)}},e.prototype.doMouseUp=function(t){this.earth.fireEvent(p.Events.Mouse.Up,t,this.earth),this.isMouseDown&&(this.isRightDown?this.isRotate?this.earth.fireEvent(p.Events.Mouse.RotateEnd,t,this.earth):this.earth.fireEvent(p.Events.Mouse.RightClick,t,this.earth):this.isMouseMove?this.earth.fireEvent(p.Events.Mouse.DragEnd,t,this.earth):this.earth.fireEvent(p.Events.Mouse.Click,t,this.earth)),this.isMouseDown=!1,this.isRotate=!1},e.prototype.doMouseWheel=function(t){this.earth.fireEvent(p.Events.Mouse.Wheel,t,this.earth)},e.prototype.doKeyDown=function(t){this.earth.fireEvent(p.Events.Mouse.KeyDown,t,this.earth)},e.prototype.doKeyUp=function(t){this.earth.fireEvent(p.Events.Mouse.KeyUp,t,this.earth)},e.prototype.doContextMenu=function(t){m["default"].stopEvents(t)},e.prototype.doWindowResize=function(t){this.earth.fireEvent(p.Events.Earth.Resize,t,this.earth)},e.prototype.initMouseEvents=function(){var t=this.earth.getControl("ViewControl");t.domElement.addEventListener("mousedown",this.doMouseDownFn),t.domElement.addEventListener("mousemove",this.doMouseMoveFn),t.domElement.addEventListener("mouseup",this.doMouseUpFn),t.domElement.addEventListener("mouseout",this.doMouseUpFn),t.domElement.addEventListener("wheel",this.doMouseWheelFn),window.addEventListener("resize",this.doWindowResizeFn),window.addEventListener("keydown",this.doKeyDownFn),window.addEventListener("keyup",this.doKeyUpFn),this.hideSysContextMenu()},e.prototype.showSysContextMenu=function(){var t=this.earth.getControl("ViewControl");t.domElement.removeEventListener("contextmenu",this.doContextMenu)},e.prototype.hideSysContextMenu=function(){var t=this.earth.getControl("ViewControl");t.domElement.addEventListener("contextmenu",this.doContextMenu)},e.prototype.initTouchEvents=function(){var t=this.earth.getControl("ViewControl");t.domElement.addEventListener("touchstart",this.doTouchStart),t.domElement.addEventListener("touchmove",this.doTouchMove),t.domElement.addEventListener("touchend",this.doTouchEnd),this.hideSysContextMenu()},e.prototype.setButtonType=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.buttonType=t},e.prototype.touchStart=function(t){t.preventDefault(),
this.isRightDown=!1,this.isMouseDown=!0,this.isMouseMove=!1,this.isRotate=!1,t.changedTouches[0].button=this.buttonType,this.oldPoint=new d["default"](t.changedTouches[0].clientX,t.changedTouches[0].clientY),this.earth.fireEvent(p.Events.Mouse.Down,t.changedTouches[0],this.earth)},e.prototype.touchMove=function(t){if(t.preventDefault(),!this.isRightDown&&(this.earth.fireEvent(p.Events.Mouse.Move,t.changedTouches[0],this.earth),this.isMouseDown)){var e=new d["default"](t.changedTouches[0].clientX,t.changedTouches[0].clientY);this.isMouseMove=!this.oldPoint.equals(e),this.earth.fireEvent(p.Events.Mouse.Drag,t.changedTouches[0],this.earth)}},e.prototype.touchEnd=function(t){t.preventDefault(),this.earth.fireEvent(p.Events.Mouse.Up,t.changedTouches[0],this.earth),this.isMouseDown&&(this.isRightDown?this.isRotate?this.earth.fireEvent(p.Events.Mouse.RotateEnd,t.changedTouches[0],this.earth):this.earth.fireEvent(p.Events.Mouse.RightClick,t.changedTouches[0],this.earth):this.isMouseMove?this.earth.fireEvent(p.Events.Mouse.DragEnd,t.changedTouches[0],this.earth):this.earth.fireEvent(p.Events.Mouse.Click,t.changedTouches[0],this.earth)),this.isMouseDown=!1,this.isRotate=!1},e.prototype.removeEvents=function(){var t=this.earth.getControl("ViewControl");t.domElement.removeEventListener("mousedown",this.doMouseDownFn),t.domElement.removeEventListener("mousemove",this.doMouseMoveFn),t.domElement.removeEventListener("mouseup",this.doMouseUpFn),t.domElement.removeEventListener("mouseout",this.doMouseUpFn),t.domElement.removeEventListener("wheel",this.doMouseWheelFn),t.domElement.removeEventListener("contextmenu",this.doContextMenu),t.domElement.removeEventListener("touchstart",this.doTouchStart),t.domElement.removeEventListener("touchmove",this.doTouchMove),t.domElement.removeEventListener("touchend",this.doTouchEnd),window.removeEventListener("keydown",this.doKeyDownFn),window.removeEventListener("keyup",this.doKeyUpFn),window.removeEventListener("resize",this.doWindowResizeFn)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.doMouseDownFn=this.doMouseDown.bind(this),this.doMouseMoveFn=this.doMouseMove.bind(this),this.doMouseUpFn=this.doMouseUp.bind(this),this.doMouseWheelFn=this.doMouseWheel.bind(this),this.doKeyDownFn=this.doKeyDown.bind(this),this.doKeyUpFn=this.doKeyUp.bind(this),this.doTouchStart=this.touchStart.bind(this),this.doTouchMove=this.touchMove.bind(this),this.doTouchEnd=this.touchEnd.bind(this),this.doWindowResizeFn=this.doWindowResize.bind(this),this.initMouseEvents(),this.initTouchEvents()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.removeEvents()},e}(c["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(39),d=n(h),f=i(13),c=i(25),p=n(c),v=i(4),m=n(v),g=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.apply(this,arguments));return i.oldTarget=new m["default"],i}return(0,l["default"])(e,t),e.prototype.wheel=function(t){this.initRightScale()},e.prototype.dragEnd=function(t,e){var i=e.getControl("ViewControl");this.oldTarget.equals(i.target)||(this.oldTarget=i.target.clone(),e.fireEvent(f.Events.Earth.CenterChange,this.oldTarget,e))},e.prototype.setScale=function(t){this.scale!=t&&(this.scale=t,this.earth.fireEvent(f.Events.Earth.ScaleChange,this.scale,this.earth))},e.prototype.initRightScale=function(){var t=this,e=this.earth.getControl("ViewControl"),i=e.getCameraLength(),n=1/0;this.earth.confg.ScaleList.forEach(function(e,r){var a=Math.abs(i-e);a<n&&(n=a,t.scaleNum=r)}),this.setScale(this.earth.confg.ScaleList[this.scaleNum]);var r=p["default"].getResolution(i);this.earth.fireEvent(f.Events.Earth.ZoomChange,r,this.earth)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.initRightScale()},e.prototype.register=function(){this.earth.on(f.Events.Mouse.Wheel,this.wheel,this),this.earth.on(f.Events.Mouse.DragEnd,this.dragEnd,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(f.Events.Mouse.Wheel,this.wheel,this),this.earth.off(f.Events.Mouse.DragEnd,this.dragEnd,this)},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(39),d=n(h),f=i(106),c=n(f),p=i(11),v=n(p),m=i(8),g=i(13),y=i(341),_=n(y),x=i(342),b=n(x),M=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.toAssign=function(e){t.prototype.toAssign.call(this,e),this.selectList=[],this.menuHelper=new _["default"](this.earth),this.popHelper=new b["default"](this.earth)},e.prototype.doSelect=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||this.doUnSelect(),t&&(this.selectList.push({model:t.object,point:t.point}),i||t.object.click(t.point))},e.prototype.doUnSelect=function(){this.selectList.forEach(function(t){t.model.unClick()}),this.selectList=[],this.popHelper.close(),this.menuHelper.close()},e.prototype.click=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.getControl("LayerControl"),r=t.offsetX||t.layerX||t.pageX,a=t.offsetY||t.layerY||t.pageY,o=n.getSelectMeshs({x:r,y:a},!0);return this.doSelect(o,t.shiftKey,i),o?(i||this.popHelper.show(o.object),o):null},e.prototype.move=function(t,e){var i=e.getControl("CursorControl");this.hoverMesh&&(this.hoverMesh.unHover(),this.hoverMesh=null,i.setDefault());var n=e.getControl("LayerControl"),r=t.offsetX||t.layerX||t.pageX,a=t.offsetY||t.layerY||t.pageY,o=n.getSelectMeshs({x:r,y:a},!0);o&&(this.hoverMesh=o.object,this.hoverMesh.hover(),i.setPointer())},e.prototype.getMousePoint=function(t){var e=t.offsetX||t.layerX||t.pageX,i=t.offsetY||t.layerY||t.pageY,n=this.earth.getControl("LayerControl"),r=n.getSelectMeshs({x:e,y:i},!1);if(r){var a=new v["default"](0,0,0,m.Const.EPSGType.EPSGWeb);return a.copy(r.point)}return null},e.prototype.rightClick=function(t,e){var i=e.getControl("LayerControl"),n=t.offsetX||t.layerX||t.pageX,r=t.offsetY||t.layerY||t.pageY,a=this.click(t,e,!0);if(a||(a=i.getSelectMeshs({x:n,y:r},!1)),a){var o=this.earth.getSize(),s=this.earth.getControl("ViewControl"),u=a.object.getMouseOffset(t);if(a.object.rightClick&&a.object.rightClick(a),a.object instanceof c["default"]){var l=new v["default"](a.object.position.x,a.object.position.y,a.object.position.z,m.Const.EPSGType.EPSGWeb);this.menuHelper.show(a.object,l,u,s.camera,o)}else this.menuHelper.show(a.object,a.point,u,s.camera,o);window.document.oncontextmenu=function(){return!1}}},e.prototype.register=function(){this.earth.on(g.Events.Mouse.Click,this.click,this),this.earth.on(g.Events.Mouse.Move,this.move,this),this.earth.on(g.Events.Mouse.RightClick,this.rightClick,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(g.Events.Mouse.Click,this.click,this),this.earth.off(g.Events.Mouse.Move,this.move,this),this.earth.off(g.Events.Mouse.RightClick,this.rightClick,this)},e}(d["default"]);e["default"]=M,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(202),d=n(h),f=i(203),c=n(f),p=i(49),v=n(p),m=i(176),g=n(m),y=i(7),_=n(y),x=i(4),b=n(x),M=i(408),w=n(M),S=i(95),P=n(S),A=i(9),C=i(39),T=n(C),E=i(11),D=n(E),L=i(8),F=i(13),k=i(168),I=n(k),O=i(31),N=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initRenderer=function(){this.renderer=new w["default"]({antialias:!0,preserveDrawingBuffer:!0,logarithmicDepthBuffer:!1,alpha:!0}),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=A.PCFSoftShadowMap,this.renderer.sortObjects=!1,this.renderer.setClearColor(this.earth.userData.renderColor||"#000000",this.earth.userData.renderAlpha||1),this.renderer.setPixelRatio(this.earth.confg.DevicePixelRatio),this.domElement=this.renderer.domElement,this.domElement.style.position="absolute",this.earth.userData.dom.appendChild(this.domElement)},e.prototype.initCanvas=function(){this.canvas=new c["default"],this.canvasRenderer=new d["default"]({antialias:!0}),this.domCanvasElement=this.canvasRenderer.domElement,this.domCanvasElement.style.position="absolute",this.domCanvasElement.style.pointerEvents="none",this.canvasRenderer.setPixelRatio(this.earth.confg.DevicePixelRatio),this.earth.userData.dom.appendChild(this.domCanvasElement)},e.prototype.initScene=function(){this.scene=new P["default"];var t=this.earth.getSize();this.camera=new v["default"](30,t.width/t.height,1,this.earth.confg.ScaleList[0]),this.target=this.earth.confg.LookAt.changeEPSGType(L.Const.EPSGType.EPSGWeb);var e=this.earth.confg.CenterPoint.changeEPSGType(L.Const.EPSGType.EPSGWeb);this.camera.up.set(0,0,1),this.camera.position.copy(e),this.camera.lookAt(this.target)},e.prototype.initLights=function(){if(this.ambientLight=I["default"].createAmbient({color:this.earth.userData.ambientColor}),this.scene.add(this.ambientLight),!this.earth.userData.hideLight){var t=new D["default"](2231,(-2513),3e3,L.Const.EPSGType.EPSGWeb).add(this.target),e=t.distanceTo(new b["default"]);this.dirLight=I["default"].createDirectional({far:e+1e3,color:this.earth.userData.directionalColor,intensity:this.earth.userData.directionalIntensity,castShadow:this.earth.userData.castShadow||!1}),this.dirLight.position.copy(t),this.scene.add(this.dirLight),this.scene.add(this.dirLight.target),this.initLightPosition()}},e.prototype.updateView=function(){this.effectComposer?this.effectComposer.render():this.renderer.render(this.scene,this.camera),this.canvasRenderer.render(this.canvas,this.earth,this.camera,this.virtualCamera);var t=this.clock.getDelta();O.TweenEx.update(t),this.earth.fireEvent(F.Events.Earth.Renderer,t,this.earth),requestAnimationFrame(this.updateView.bind(this))},e.prototype.initLightPosition=function(){if(this.dirLight&&this.dirLight.visible&&this.dirLight.castShadow){var t=new D["default"](2231,(-2513),5e3,L.Const.EPSGType.EPSGWeb).add(this.target);this.dirLight.position.copy(t),this.dirLight.target.position.copy(this.target)}},e.prototype.addEffectComposer=function(t){this.effectComposer=t},e.prototype.flyTo=function(t,e){this.camera.position.copy(t),this.target.copy(e),this.earth.fireEvent(F.Events.Mouse.DragEnd,null,this.earth)},e.prototype.run=function(t){this.renderer.isContextLost=t},e.prototype.initSize=function(){var t=this.earth.getSize();this.camera.aspect=t.width/t.height,this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(!0),this.renderer.setSize(t.width,t.height,!0),this.effectComposer&&this.effectComposer.setSize(t.width,t.height),this.canvasRenderer.setSize(t.width,t.height,!0)},e.prototype.getCameraLength=function(){var t=this.camera.position.clone();return 0==t.x&&0==t.y&&0==t.z&&t.set(this.target.x,this.target.y,20),t.sub(this.target),t.length()},e.prototype.getCameraSize=function(){var t=this.getCameraLength();return Math.max(Math.tan(_["default"].degToRad(this.camera.fov/2))*t*2,1e3)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.renderer.dispose(),this.scene.dispose(),this.camera.dispose(),this.canvasRenderer.dispose(),this.earth.userData.dom.removeChild(this.domElement),this.earth.userData.dom.removeChild(this.domCanvasElement),this.earth.off(F.Events.Earth.Resize,this.initSize,this),this.earth.off(F.Events.Earth.CenterChange,this.initLightPosition,this)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.initRenderer(),this.initScene(),this.initLights(),this.initCanvas(),this.initSize(),this.clock=new g["default"],this.updateView(),this.earth.on(F.Events.Earth.Resize,this.initSize,this),this.earth.on(F.Events.Earth.CenterChange,this.initLightPosition,this)},e}(T["default"]);e["default"]=N,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(378),d=i(26),f=n(d),c=i(21),p=n(c),v=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(t,e){this.centerPoint=this.userData.point,this.radius=this.userData.radius||1},e.prototype.initDefaultGeo=function(t,e){this.type="Circle",this.geometry=new h.CircleGeometry(1,32);var i=this.getMaterialCfg();i.color||(i.color="#007ACC"),this.material=new f["default"](i),this.position.set(this.centerPoint.x,this.centerPoint.y,this.centerPoint.z)},e.prototype.updatePoint=function(t){this.radius=this.centerPoint.distanceTo(t),this.geometry=new h.CircleBufferGeometry(this.radius,32)},e}(p["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(67),d=n(h),f=i(114),c=i(12),p=n(c),v=i(7),m=n(v),g=i(21),y=n(g),_=i(11),x=n(_),b=i(8),M=i(6),w=n(M),S=i(35),P=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.userData.id=w["default"].getDefaultString(t.id,m["default"].getUUID()),this.userData.high=w["default"].getDefaultNumber(t.high,0),this.userData.bg_high=w["default"].getDefaultNumber(t.bg_high,0),this.material=new S.MeshBasicMaterial(this.getMaterialCfg());var i=t.shapes[0];i.z<this.userData.bg_high&&(i.z=this.userData.bg_high),i=new x["default"](i.x,i.y,i.z,i.EPSGType||b.Const.EPSGType.EPSG84),i.changeEPSGType(b.Const.EPSGType.EPSGWeb),this.position.set(i.x,i.y,i.z),this.initGeometry(t)},e.prototype.initGeometry=function(t){var e=this,i=new d["default"];t.shapes.forEach(function(t,n){var r=new x["default"](t.x,t.y,t.z,t.EPSGType||b.Const.EPSGType.EPSG84);r.changeEPSGType(b.Const.EPSGType.EPSGWeb),r.sub(e.position),0==n?i.moveTo(r.x,r.y):i.lineTo(r.x,r.y)});var n=i.toShapes(!0);this.geometry=new f.ShapeBufferGeometry(n)},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Clap",this.userData.objType="ClapObj"},e.prototype.getMaterialCfg=function(){return{transparent:1!=(this.userData.opacity||1),opacity:this.userData.opacity||1,color:new p["default"]("rgb("+this.userData.high+", 0, 0)")}},e}(y["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(21),d=n(h),f=i(11),c=n(f),p=i(8),v=i(114),m=i(67),g=n(m),y=i(34),_=n(y),x=i(58),b=i(25),M=n(b),w=i(6),S=n(w),P=i(12),A=n(P),C=i(7),T=n(C),E=i(35),D=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.userData.id=S["default"].getDefaultString(t.id,T["default"].getUUID()),this.userData.img=S["default"].getDefaultString(t.img,""),this.userData.color=S["default"].getDefaultString(t.color,"ffffff"),this.userData.is_rect=S["default"].getDefaultNumber(t.is_rect,0),this.userData.width=S["default"].getDefaultNumber(t.width,0),this.userData.height=S["default"].getDefaultNumber(t.height,0),this.userData.center_x=S["default"].getDefaultNumber(t.center_x,0),this.userData.center_y=S["default"].getDefaultNumber(t.center_y,0),this.initGeometry(t)},e.prototype.initDefaultGeo=function(t,e){},e.prototype.initGeometry=function(t){if(1==this.userData.is_rect)this.createMesh();else{var e=this,i=new g["default"],n=t.shapes[0];n=new c["default"](n.x,n.y,n.z,n.EPSGType||p.Const.EPSGType.EPSG84),n.changeEPSGType(p.Const.EPSGType.EPSGWeb),this.position.set(n.x,n.y,n.z),t.shapes.forEach(function(t,n){var r=new c["default"](t.x,t.y,t.z,t.EPSGType||p.Const.EPSGType.EPSG84);r.changeEPSGType(p.Const.EPSGType.EPSGWeb),r.sub(e.position),0==n?i.moveTo(r.x,r.y):i.lineTo(r.x,r.y)});var r=i.toShapes(!0);this.geometry=new v.ShapeBufferGeometry(r),this.material=new E.MeshBasicMaterial(this.getMaterialCfg())}},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="GridTint",this.userData.objType="GridTintObj"},e.prototype.createMesh=function(){var t=this,e=M["default"].getResolution(this.earth.confg.RCScale);if(this.material=new E.MeshBasicMaterial,S["default"].isEmpty(t.userData.img))S["default"].isEmpty(t.userData.color)||(this.material.color=new A["default"]("#"+this.userData.color));else{var i=this.userData.img.replace(new RegExp("\\\\","g"),"/");this.material.map=_["default"].createTexture(i,function(e){e&&(t.material.needsUpdate=!0)})}this.geometry=new x.PlaneBufferGeometry(t.userData.width/e,t.userData.height/e,1,1),this.position.set(t.userData.center_x,t.userData.center_y,.1)},e.prototype.getMaterialCfg=function(){var t={transparent:1!=(this.userData.opacity||1),opacity:this.userData.opacity||1};return t.color=new A["default"]("#"+this.userData.color),t},e}(d["default"]);e["default"]=D,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=function(t){function e(i,n,r,o,u,l){(0,a["default"])(this,e);var h=(0,s["default"])(this,t.call(this));return h.model=i,h.helper=l,h.html=o,h.point=n,h.offsetMenu=r,h.offset=l.earth.getOffset(),h.initHtmls(o,u),h.initEvents(),h}return(0,l["default"])(e,t),e.prototype.initEvents=function(){this.clickFn=this.click.bind(this),this.helper.earth.userData.dom.addEventListener("click",this.clickFn)},e.prototype.initHtmls=function(t,e){this.div=document.createElement("div"),this.div.className=e,this.div.style.position="absolute",this.div.style.display="none",this.div.appendChild(t),this.div.style.backgroundColor="#FFFFFF",this.div.style.border="1px solid #eeeeee"},e.prototype.show=function(){this.div.style.display="block",this.helper.earth.userData.dom.appendChild(this.div),this.initBinds(this.html),this.sysnMenu()},e.prototype.initBinds=function(t){t.event&&(t["on"+t.event.type]=t.event.fn.bind(null,this.model,this.point));for(var e=0;e<t.children.length;e++)this.initBinds(t.children[e])},e.prototype.click=function(){this.dispose()},e.prototype.dispose=function(){this.helper.earth.userData.dom.removeChild(this.div),this.helper.earth.userData.dom.removeEventListener("click",this.clickFn),this.helper.menu=null},e.prototype.sysnMenu=function(){this.div.style.display="block",this.helper.earth.userData.dom.appendChild(this.div);var t=this.projectToScreen();this.div.style.left=t.x+this.offsetMenu.x+this.offset.x-this.div.clientWidth/2+"px",this.div.style.top=t.y+this.offsetMenu.y+this.offset.y-this.div.clientHeight+"px"},e.prototype.projectToScreen=function(){var t=this.helper.earth.getControl("ViewControl"),e=this.helper.earth.getSize();if(this.point)return this.point.clone().projectToScreen(t.camera,e.width,e.height)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(92),d=i(35),f=i(21),c=n(f),p=i(11),v=n(p),m=i(8),g=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Move",this.userData.isNode=!0,this.userData.isInsert=!1},e.prototype.init=function(t,e){this.earth=e;var i=new v["default"](t.shapes.x,t.shapes.y,t.shapes.z,t.shapes.EPSGType);i.changeEPSGType(m.Const.EPSGType.EPSGWeb),this.position.copy(i)},e.prototype.initDefaultGeo=function(t,e){var i=this.userData.width;this.geometry=new h.BoxGeometry(i,i,i);var n={color:this.userData.color?"#"+this.userData.color:"#d1f310",transparent:!0,opacity:this.userData.opacity||1};this.material=new d.MeshLambertMaterial(n)},e.prototype.getInfo=function(){return null},e.prototype.setPosition=function(e){t.prototype.setPosition.call(this,e),this.userData.parentObj&&this.userData.parentObj.nodeUpdate&&this.userData.parentObj.nodeUpdate(e,this)},e.prototype.click=function(e){t.prototype.click.call(this,e),this.earth.Api.MeshInfo.doMove(!1)},e.prototype.unClick=function(){t.prototype.unClick.call(this),this.userData.isInsert&&this.userData.parentObj&&this.userData.parentObj.updateLine()},e}(c["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(35),c=i(7),p=n(c),v=i(4),m=n(v),g=i(9),y=i(21),_=n(y),x=i(286),b=n(x),M=i(41),w=n(M),S=i(324),P=n(S),A=i(8),C=i(13),T=i(44),E=n(T),D=i(6),L=n(D),F=i(34),k=n(F),I=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="NavLine",(0,a["default"])(this.userData,{lineWidth:1,speed:1,billboard:!1}),this.textureLength=7,this.lastSpriteScale=0},e.prototype.init=function(t,e){this.earth=e,this.earth.on(C.Events.Earth.Renderer,this.update,this);var i=[7,0];t.lineType=L["default"].getDefaultString(t.lineType,"NAVARROW"),A.Const.LineType[t.lineType]&&(i=A.Const.LineType[t.lineType]),t.type="ARROW"!=t.lineType&&"NAVARROW"!=t.lineType?"NORMAL":t.lineType,t.up=void 0!=t.up&&t.up instanceof m["default"]?t.up:new m["default"](0,0,1);var n={dashArray:i,lineWidth:L["default"].getDefaultNumber(t.lineWidth,1)/5,lineType:L["default"].getDefaultString(t.lineType,"NAVARROW"),type:t.type,up:t.up,yScale:1,smooth:!0,billboard:t.billboard};this.userData.lineWidth=n.lineWidth,(0,a["default"])(this.userData,n),this.textureLength=n.dashArray.reduce(function(t,e){return t+e});var r=this.textureLength,o=t.shapes,s=E["default"].createCurvePoints(o),u={radius:n.lineWidth,pathVertices:s,uvLength:r,up:n.up,notCenter:void 0,yScale:n.yScale,smooth:n.smooth};this.geometry=new b["default"](u),this.navLineStyle=new P["default"](n);var l=k["default"].createTexture(this.navLineStyle.canvas.toDataURL());if(l.minFilter=g.NearestFilter,l.needsUpdate=!0,l.wrapS=l.wrapT=g.RepeatWrapping,this.geometry instanceof b["default"]){var h=Math.ceil(this.geometry.length/this.geometry.uvLength);l.repeat.x=h,this.position.copy(this.geometry.lineCenter)}l.repeat.y=1,l.needsUpdate=!0,this.material=new f.MeshBasicMaterial(this.getMaterialCfg()),this.material.map=l,this.resetMaterialMapInfo()},e.prototype.resetMaterialMapInfo=function(){if(this.geometry instanceof b["default"]){var t=this.navLineStyle.materialInfo;this.material.map.offset.y=t.offset,this.material.side=t.side}},e.prototype.getMaterialCfg=function(){var t={transparent:!0,opacity:this.userData.opacity||1,needsUpdate:!0,depthWrite:!1,depthTest:!1,side:g.DoubleSide,color:"#ffffff"};return t},e.prototype.update=function(t){if(this.geometry){1==this.userData.animation&&(this.material.map.offset.x-=t*this.userData.speed);var e=E["default"].getObjectViewScale(this.earth,this);this.geometry instanceof b["default"]&&(this.lastSpriteScale.toFixed(10)!=e.toFixed(10)&&(this.geometry.setRadius(e*this.userData.lineWidth*.7),this.material.map.repeat.x=this.geometry.length/(this.textureLength*e*7),this.lastSpriteScale=e),this.rotateBillBoard())}},e.prototype.rotateBillBoard=function(){if(this.userData.billboard&&this.geometry instanceof b["default"]&&2==this.geometry.pathVertices.length){var t=this.geometry.pathVertices,e=t[1].clone().sub(t[0]).normalize(),i=e.dot(new m["default"](0,0,1)),n=p["default"].sign(i);if(this.earth.earthHandler instanceof w["default"]){var r=n*this.earth.earthHandler.orbit.spherical.theta;this.quaternion.setFromAxisAngle(e,r)}}},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(C.Events.Earth.Renderer,this.update,this)},e}(_["default"]);e["default"]=I,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(91),c=n(f),p=i(23),v=n(p),m=i(7),g=n(m),y=i(14),_=n(y),x=i(5),b=n(x),M=i(4),w=n(M),S=i(11),P=n(S),A=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return(0,a["default"])(n,i),n.initGeometry(i),n}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.pathVertices=null,this.radius=1,this.segments=12,this.uvLength=1,this.yScale=.3,this.up=new w["default"](0,0,1),this._uvs=[],this._rings=[],this.length=0,this.perimeter=0,this.lineCenter=new w["default"]},e.prototype.initGeometry=function(t){this.pathVertices.length>=2&&(this.createFacesNodes(),this.createFaces(),this.createFaceUvs(),this.computeFaceNormals())},e.prototype.createFacesNodes=function(){for(var t,e=new Array,i=2*Math.PI/this.segments,n=0;n<this.segments;n++){var r=new P["default"](0,this.radius*Math.sin(i*n)*this.yScale,this.radius*Math.cos(i*n));e.push(r),0==n&&(t=r)}e.push(t);var a,o,s,u,l=this.pathVertices.length,h=this.caculateCenterAndDistance(this.pathVertices);this.length=h.length,this.lineCenter=h.center,this.notCenter||this.offSetPts(this.pathVertices,this.lineCenter),this.perimeter=2*Math.PI*this.radius;var d,f=0,c=0,p=this.perimeter/this.segments;this._uvs=[],this.mapUp=this.up.clone();for(var n=0;n<l;n++){a=0==n?null:this.pathVertices[n-1],s=n==l-1?null:this.pathVertices[n+1],o=this.pathVertices[n],u=this.caculateMatrix(a,o,s),n>0&&(f+=o.distanceTo(a)),c=0,this._rings[n]=[],o.clone().y=0;for(var v=0;v<e.length;v++)d=e[v].clone().applyMatrix4(u),this.vertices.push(d),this._rings[n].push(d),this._uvs.push(new b["default"](f/this.length,1-c/this.perimeter)),c+=p}},e.prototype.createFaces=function(){for(var t,e=this.pathVertices.length,i=this.segments+1,n=0;n<e-1;n++){t=n*i;for(var r=0;r<i-1;r++)this.faces.push(new c["default"](t+r+1,t+r,t+i+r)),this.faces.push(new c["default"](t+r+1,t+r+i,t+i+r+1))}},e.prototype.createFaceUvs=function(){for(var t=0;t<this.faces.length;t++){var e=this.faces[t];this.faceVertexUvs[0].push([this._uvs[e.a],this._uvs[e.b],this._uvs[e.c]])}this.uvsNeedUpdate=!0},e.prototype.caculateCenterAndDistance=function(t){for(var e=t[0].clone(),i=0,n=1;n<t.length;n++)i+=t[n].distanceTo(t[n-1]),e.add(t[n]);return{length:i,center:e.divideScalar(t.length)}},e.prototype.offSetPts=function(t,e){t.forEach(function(t){t.sub(e)})},e.prototype.caculateMatrix=function(t,e,i){var n,r=t&&t.clone(),a=e.clone(),o=i&&i.clone(),s=1,u=null;if(t)if(i){var l=a.clone().sub(r).normalize(),h=o.sub(a).normalize();u=l.angleTo(h)/2,s=1/Math.cos(u),s=g["default"].clamp(s,1,2),n=l.add(h).normalize()}else n=a.sub(r).normalize();else n=o.sub(a).normalize();var d=this.mapUp.clone(),f=(new w["default"]).crossVectors(n,d).normalize(),c=(new w["default"]).crossVectors(f,n).normalize();f.multiplyScalar(s);var p=(new _["default"]).makeBasis(n,c,f).setPosition(e);return p},e.prototype.setRadius=function(t){for(var e,i,n=this._rings,r=0,a=1,o=0;o<n.length;o++){var s=n[o],u=this.pathVertices[o];if(u)for(var l=0;l<s.length;l++){var h=s[l];0==l&&1!=this.yScale&&(e=s[0].clone().sub(u).length()),1!=this.yScale&&(i=h.clone().sub(u),a=i.length()/e);var d=u.clone().add(h.clone().sub(u).normalize().multiplyScalar(t*a));this.vertices[r].copy(d),r++}}t<.1&&(t=.1),this.radius=t,this.verticesNeedUpdate=!0},e.prototype.getAttributes=function(t){var e=this.bufferGeometry.attributes;return t.push(e.position.array.buffer,e.uv.array.buffer,e.normal.array.buffer),e},e}(v["default"]);e["default"]=A,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=function(t){function e(i,n,r,o,u,l){(0,a["default"])(this,e);var h=(0,s["default"])(this,t.call(this));return h.model=i,h.helper=l,h.point=n,h.offset=l.earth.getOffset(),h.posOffset=r,h.initHtmls(o,u),h}return(0,l["default"])(e,t),e.prototype.initHtmls=function(t,e){this.div=document.createElement("div"),this.div.className=e,this.div.style.position="absolute",this.div.style.display="none",t&&t(this.div,this.model)},e.prototype.show=function(){this.div.style.display="block",this.helper.earth.userData.dom.appendChild(this.div),this.sysnPop()},e.prototype.dispose=function(){this.helper.earth.userData.dom.removeChild(this.div)},e.prototype.sysnPop=function(){this.div.style.display="block",this.helper.earth.userData.dom.appendChild(this.div);var t=this.projectToScreen();this.div.style.left=t.x+this.offset.x+this.posOffset.x-this.div.clientWidth/2+"px",this.div.style.top=t.y+this.offset.y+this.posOffset.y-this.div.clientHeight+"px"},e.prototype.projectToScreen=function(){var t=this.helper.earth.getControl("ViewControl"),e=this.helper.earth.getSize();if(this.point)return this.point.clone().projectToScreen(t.camera,e.width,e.height)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(6),s=n(o),u=function(){function t(e,i){(0,a["default"])(this,t),this.width=0,this.height=0,this.roadData={},this.status=!1,this.roadData=e.data,this.scale=e.scale,this.markerService=i.getService("MarkerService"),this.img=new Image,this.img2=new Image,this.loadImg(e.data)}return t.prototype.loadImg=function(t){var e=this.initImgData(t);this.markerService.getMarker(e,this.getImgLabelBack.bind(this),this)},t.prototype.isComplete=function(){return this.status?!s["default"].isEmpty(this.img2.src)&&this.img2.complete:!s["default"].isEmpty(this.img.src)&&this.img.complete},t.prototype.initConfig=function(t){this.width=t.width,this.height=t.height},t.prototype.getImgLabelBack=function(t){this.img.src=t.url,this.initConfig(t)},t.prototype.getImg2LabelBack=function(t){this.img2.src=t.url,this.initConfig(t)},t.prototype.loadImg2=function(t){var e=this.initImgData(t);this.markerService.getMarker(e,this.getImg2LabelBack.bind(this),this)},t.prototype.draw=function(t,e,i,n){var r=e.clone(),a=i.clone(),o=void 0;e.add(i),e.divideScalar(2);var s=parseInt(this.getRotateAngle(r,a).toFixed(0)),u=180-s;u>45&&u<135||u>225&&u<315?this.status=!0:this.status=!1,this.status&&!this.isComplete()&&this.loadImg2(this.roadData),u>45&&u<225||(this.status?s+=180:s-=180),t.save(),t.translate(e.x,e.y),t.rotate(s*Math.PI/180),t.translate(-e.x,-e.y),o=this.status?this.img2:this.img,t.drawImage(o,e.x-this.width*n.x/2,e.y-this.height*n.y/2,this.width*n.x,this.height*n.y),t.restore()},t.prototype.getRotateAngle=function(t,e){var i=Math.atan2(e.y-t.y,e.x-t.x);return this.getTheta(i)},t.prototype.getTheta=function(t){return t*(180/Math.PI)},t.prototype.initImgData=function(t){var e={};return e.fillColor=t.fill_color,e.fontColor=t.font_color,e.fontFace=t.font_face,e.fontSize=t.font_size,e.isBold=t.is_bold,e.labelStr=t.name,e.isRoate=this.status,e.isRoad=!0,e},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(58),c=i(26),p=n(c),v=i(21),m=n(v),g=i(34),y=n(g),_=i(159),x=n(_),b=function(t){
function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.material=new p["default"]({color:"#BFBFBF"}),this.visible=!1,this.texture=y["default"].createTexture(t.url,this.callbackTexture.bind(this),!1),this.geometry=new f.PlaneBufferGeometry(t.extent.width,t.extent.width,10,10),this.tileRC=t.tileRC,(0,a["default"])(this.userData,t)},e.prototype.changeUrl=function(t){this.material.map=y["default"].createTexture(t)},e.prototype.isAllCreate=function(){var t=!0;return this.children.forEach(function(e){if(1!=e.userData.isCreate)return void(t=!1)}),t},e.prototype.isInside=function(t,e){var i=this.userData.extent.center.distanceTo(t.center);return i<this.userData.extent.width*e},e.prototype.setDisplay=function(t){this.material.visible=t,t&&this.removeAll()},e.prototype.getExtents=function(){var t=[],e=this.userData.extent,i=e.width/4,n=e.width/2;return t.push(new x["default"]({x:e.center.x-i,y:e.center.y-i,devX:-i,devY:-i},n,n)),t.push(new x["default"]({x:e.center.x-i,y:e.center.y+i,devX:-i,devY:i},n,n)),t.push(new x["default"]({x:e.center.x+i,y:e.center.y-i,devX:i,devY:-i},n,n)),t.push(new x["default"]({x:e.center.x+i,y:e.center.y+i,devX:i,devY:i},n,n)),t},e.prototype.callbackTexture=function(t){if(this.userData.isCreate=!0,this.material.visible=t,t)this.material.map=this.texture,this.setVisible(!0);else{var i=this.parent;i instanceof e&&i.isAllCreate()&&i.setDisplay(!1)}this.children.length>0&&this.isAllCreate()&&(this.material.visible=!1)},e.prototype.setVisible=function(t){this.visible=t;var i=this.parent;i instanceof e&&t&&i.isAllCreate()&&i.setDisplay(!1)},e}(m["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(15),s=n(o),u=i(11),l=n(u),h=i(8),d=i(18),f=i(12),c=n(f),p=function(){function t(e){(0,a["default"])(this,t),this.initPosition(e),this.initGeometry(e)}return t.prototype.initPosition=function(t){var e=t.shapes[0];t.position=new l["default"](e.x,e.y,e.z,e.EPSGType),t.position.changeEPSGType(h.Const.EPSGType.EPSGWeb)},t.prototype.initGeometry=function(t){var e=[],i=[],n=new c["default"]("#"+(t.data.color||"ffffff"));t.shapes.forEach(function(r){var a=new l["default"](r.x,r.y,r.z,r.EPSGType);a.changeEPSGType(h.Const.EPSGType.EPSGWeb),a.sub(t.position),e.push(a.x,a.y,a.z),i.push(n.r,n.g,n.b)}),this.bufferGeometry=new s["default"],this.bufferGeometry.addAttribute("position",new d.Float32BufferAttribute(e,3)),this.bufferGeometry.addAttribute("color",new d.Float32BufferAttribute(i,3)),this.bufferGeometry.computeBoundingSphere()},t.prototype.getAttributes=function(t){var e=this.bufferGeometry.attributes;return t.push(e.position.array.buffer,e.color.array.buffer),e},t}();e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(67),d=n(h),f=i(113),c=i(11),p=n(c),v=i(8),m=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.initPosition(i),n.initGeometry(i),n}return(0,l["default"])(e,t),e.prototype.initPosition=function(t){var e=1*(t.data.bg_high||0),i=t.shapes[0];i.z=parseFloat(((i.z||0)+e).toFixed(6)),t.position=new p["default"](i.x,i.y,i.z,i.EPSGType),t.position.changeEPSGType(v.Const.EPSGType.EPSGWeb)},e.prototype.initGeometry=function(t){var e=this;t.shapes.forEach(function(i,n){var r=new p["default"](i.x,i.y,i.z,i.EPSGType);r.changeEPSGType(v.Const.EPSGType.EPSGWeb),r.sub(t.position),0==n?e.moveTo(r.x,r.y):e.lineTo(r.x,r.y)});var i=this.toShapes(!0),n={amount:t.data.high||.1,bevelEnabled:!1};this.bufferGeometry=new f.ExtrudeBufferGeometry(i,n)},e.prototype.getAttributes=function(t){var e=this.bufferGeometry.attributes;return t.push(e.position.array.buffer,e.uv.array.buffer,e.normal.array.buffer),e},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(11),d=n(h),f=i(104),c=i(15),p=n(c),v=i(18),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initGeometry=function(t){if(this.bufferGeometry=new p["default"],t.shapes instanceof Array){for(var e=[1,1,0,1,0,0,1,1,0,0,1,0],i=[],n=[],r=0;r<t.shapes.length;r++){var a=new d["default"](t.shapes[r].x,t.shapes[r].y,t.shapes[r].z||0,t.shapes[r].EPSGType||"4326");a.changeEPSGType("3857"),n.push(a)}for(var o=n[0],s=2;s<n.length;s++)i.push(n[0].x-o.x,n[0].y-o.y,n[0].z-o.z,n[s-1].x-o.x,n[s-1].y-o.y,n[s-1].z-o.z,n[s].x-o.x,n[s].y-o.y,n[s].z-o.z);this.bufferGeometry.addAttribute("position",new v.BufferAttribute(new Float32Array(i),3)),this.bufferGeometry.addAttribute("uv",new v.BufferAttribute(new Uint8Array(e),2))}},e.prototype.getAttributes=function(t){var e=this.bufferGeometry.attributes;return t.push(e.position.array.buffer,e.uv.array.buffer),e},e}(f.Shapes);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(67),d=n(h),f=i(11),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.initPosition(i),n}return(0,l["default"])(e,t),e.prototype.initPosition=function(t){var e=this,i=new d["default"],n=0,r=new c["default"](t.shapes[0].x,t.shapes[0].y,t.shapes[0].z||0,t.shapes[0].EPSGType).changeEPSGType("3857");t.shapes.forEach(function(t,e){var a=new c["default"](t.x,t.y,t.z||0,t.EPSGType).changeEPSGType("3857");a.sub(r),0===e?i.moveTo(a.x,a.y):i.lineTo(a.x,a.y),t.z>=0&&(n+=t.z)}),n/=Math.max(t.shapes.length,1),n+=parseFloat(t.data.bg_high||"0");var a=i.toShapes(!0,!0);a.forEach(function(t){e.result={shape:t,centerPoint:{x:r.x,y:r.y,z:n}}})},e.prototype.getAttributes=function(t){return this.result},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.FBXTree=e.AnimationParser=e.GeometryParser=e.TextParser=e["default"]=void 0;var r=i(17),a=n(r),o=i(86),s=n(o),u=i(10),l=n(u),h=i(1),d=n(h),f=i(18),c=i(15),p=n(c),v=i(20),m=n(v),g=i(370),y=n(g),_=i(12),x=n(_),b=i(119),M=n(b),w=i(7),S=n(w),P=i(37),A=n(P),C=i(14),T=n(C),E=i(60),D=n(E),L=i(4),F=n(L),k=i(45),I=n(k),O=i(397),N=n(O),R=i(400),U=n(R),B=i(9),j=function(){function t(e){(0,d["default"])(this,t),this.text=e,this.sceneGraph={children:[]},this.result=this.parse(e)}return t.prototype.getAttributes=function(t){return this.result},t.prototype.parse=function(t){var e=this.getFbxVersion(t);if(e<7e3)return void console.error("FBX version not supported, FileVersion: "+e);this.FBXTree=(new z).parse(t);var i=this.parseConnections(this.FBXTree),n=this.parseImages(this.FBXTree),r=this.parseTextures(this.FBXTree,i,n),a=this.parseMaterials(this.FBXTree,i,r),o=this.parseDeformers(this.FBXTree,i),s=(new G).parse(this.FBXTree,i,o);return this.parseScene(this.FBXTree,i,o,s,a),this.sceneGraph},t.prototype.getFbxVersion=function(t){var e=/FBXVersion: (\d+)/,i=t.match(e);return i?parseInt(i[1]):void console.error("Cannot find the version number for the file given.")},t.prototype.parseConnections=function(t){var e={};if("Connections"in t){var i=t.Connections.connections;i.forEach(function(t){var i=t[0],n=t[1],r=t[2];(0,l["default"])(e).indexOf(i.toString())<0&&(e[i]={parents:[],children:[]});var a={ID:n,relationship:r};e[i].parents.push(a),(0,l["default"])(e).indexOf(n.toString())<0&&(e[n]={parents:[],children:[]});var o={ID:i,relationship:r};e[n].children.push(o)})}return e},t.prototype.parseImages=function(t){var e={},i={};if("Video"in t.Objects){var n=t.Objects.Video;for(var r in n){var a=n[r],o=parseInt(r);if(e[o]=a.RelativeFilename||a.Filename,"Content"in a){var s=a.Content instanceof ArrayBuffer&&a.Content.byteLength>0,u="string"==typeof a.Content&&""!==a.Content;if(s||u){var l=this.parseImage(n[r]);i[a.RelativeFilename||a.Filename]=l}}}}for(var h in e){var d=e[h];void 0!==i[d]?e[h]=i[d]:e[h]=e[h].split("\\").pop()}return e},t.prototype.parseImage=function(t){var e=t.Content,i=t.RelativeFilename||t.Filename,n=i.slice(i.lastIndexOf(".")+1).toLowerCase(),r=void 0;switch(n){case"bmp":r="image/bmp";break;case"jpg":case"jpeg":r="image/jpeg";break;case"png":r="image/png";break;case"tif":r="image/tiff";break;default:return void console.warn('Image type "'+n+'" is not supported.')}if("string"==typeof e)return{type:r,values:"data:"+r+";base64,"+e};var a=new Uint8Array(e);return{type:r,values:a}},t.prototype.parseTextures=function(t,e,i){var n={};if("Texture"in t.Objects){var r=t.Objects.Texture;for(var a in r){var o=this.parseTexture(e,r[a],i);n[parseInt(a)]=o}}return n},t.prototype.parseTexture=function(t,e,i){var n=this.loadTexture(t,e,i);n.ID=e.id,n.name=e.attrName;var r=e.WrapModeU,a=e.WrapModeV,o=void 0!==r?r.value:0,s=void 0!==a?a.value:0;if(n.wrapS=0===o?B.RepeatWrapping:B.ClampToEdgeWrapping,n.wrapT=0===s?B.RepeatWrapping:B.ClampToEdgeWrapping,"Scaling"in e){var u=e.Scaling.value;n.repeat.x=u[0],n.repeat.y=u[1]}return n},t.prototype.loadTexture=function(t,e,i){var n=void 0,r=t[e.id].children;void 0!==r&&r.length>0&&void 0!==i[r[0].ID]&&(n=i[r[0].ID]);var a=void 0,o=e.FileName.slice(-3).toLowerCase();return"psd"===o?(console.warn("PSD textures are not supported, creating empty placeholder texture for ",n),a={className:"Texture"}):a={className:"Texture",fileName:n},a},t.prototype.parseMaterials=function(t,e,i){var n={};if("Material"in t.Objects){var r=t.Objects.Material;for(var a in r){var o=this.parseMaterial(t,e,r[a],i);null!==o&&(n[parseInt(a)]=o)}}return n},t.prototype.parseMaterial=function(t,e,i,n){var r=i.id,a=i.attrName,o=i.ShadingModel;if("object"===("undefined"==typeof o?"undefined":(0,s["default"])(o))&&(o=o.value),!(r in e))return null;var u=this.parseParameters(t,e,i,n,r),l=void 0;switch(o.toLowerCase()){case"phong":l={className:"MeshPhongMaterial",noConstructor:{}};break;case"lambert":l={className:"MeshLambertMaterial",noConstructor:{}};break;default:console.warn("Unknown material type "+o+". Is use Default material"),l={className:"MeshPhongMaterial",color:3342591,noConstructor:{}}}return l.noConstructor.setValues=u,l.name=a,l},t.prototype.parseParameters=function(t,e,i,n,r){var a={};i.BumpFactor&&(a.bumpScale=i.BumpFactor.value),i.Diffuse?a.color=(new x["default"]).fromArray(i.Diffuse.value):i.DiffuseColor&&"Color"===i.DiffuseColor.type&&(a.color=(new x["default"]).fromArray(i.DiffuseColor.value)),i.DisplacementFactor&&(a.displacementScale=i.DisplacementFactor.value),i.Emissive?a.emissive=(new x["default"]).fromArray(i.Emissive.value):i.EmissiveColor&&"Color"===i.EmissiveColor.type&&(a.emissive=(new x["default"]).fromArray(i.EmissiveColor.value)),i.EmissiveFactor&&(a.emissiveIntensity=parseFloat(i.EmissiveFactor.value)),i.Opacity&&(a.opacity=parseFloat(i.Opacity.value)),a.opacity<1&&(a.transparent=!0),i.ReflectionFactor&&(a.reflectivity=i.ReflectionFactor.value),i.Shininess&&(a.shininess=i.Shininess.value),i.Specular?a.specular=(new x["default"]).fromArray(i.Specular.value):i.SpecularColor&&"Color"===i.SpecularColor.type&&(a.specular=(new x["default"]).fromArray(i.SpecularColor.value));var o=this;return e[r].children.forEach(function(i){var r=i.relationship;switch(r){case"Bump":a.bumpMap=o.getTexture(t,e,n,i.ID);break;case"DiffuseColor":a.map=o.getTexture(t,e,n,i.ID);break;case"DisplacementColor":a.displacementMap=o.getTexture(t,e,n,i.ID);break;case"EmissiveColor":a.emissiveMap=o.getTexture(t,e,n,i.ID);break;case"NormalMap":a.normalMap=o.getTexture(t,e,n,i.ID);break;case"ReflectionColor":a.envMap=o.getTexture(t,e,n,i.ID),a.envMap.mapping=B.EquirectangularReflectionMapping;break;case"SpecularColor":a.specularMap=o.getTexture(t,e,n,i.ID);break;case"TransparentColor":a.alphaMap=o.getTexture(t,e,n,i.ID),a.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":}}),a},t.prototype.getTexture=function(t,e,i,n){return"LayeredTexture"in t.Objects&&n in t.Objects.LayeredTexture&&(console.warn("layered textures are not supported. Discarding all but first layer."),n=e[n].children[0].ID),i[n]},t.prototype.parseDeformers=function(t,e){var i={},n={};if("Deformer"in t.Objects){var r=t.Objects.Deformer;for(var a in r){var o=r[a],s=e[parseInt(a)];if("Skin"===o.attrType){var u=this.parseSkeleton(s,r);u.ID=a,s.parents.length>1&&console.warn("skeleton attached to more than one geometry is not supported."),u.geometryID=s.parents[0].ID,i[a]=u}else if("BlendShape"===o.attrType){var l={id:a};l.rawTargets=this.parseMorphTargets(e,s,r),l.id=a,s.parents.length>1&&console.warn("morph target attached to more than one geometry is not supported."),n[a]=l}}}return{skeletons:i,morphTargets:n}},t.prototype.parseSkeleton=function(t,e){var i=[];return t.children.forEach(function(t){var n=e[t.ID];if("Cluster"===n.attrType){var r={ID:t.ID,indices:[],weights:[],transformLink:(new T["default"]).fromArray(n.TransformLink.a)};"Indexes"in n&&(r.indices=n.Indexes.a,r.weights=n.Weights.a),i.push(r)}}),{rawBones:i,bones:[]}},t.prototype.parseMorphTargets=function(t,e,i){for(var n=[],r=0;r<e.children.length;r++){var a=e.children[r],o=i[a.ID],s={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;s.geoID=t[parseInt(a.ID)].children.filter(function(t){return void 0===t.relationship})[0].ID,n.push(s)}return n},t.prototype.parseScene=function(t,e,i,n,r){var a=this,o=this.parseModels(t,e,i.skeletons,n,r),s=t.Objects.Model,u=this,h=[];(0,l["default"])(o).map(function(t){var i=o[t];if(h.indexOf(i.ID)<0){var n=s[i.ID];u.setLookAtProperties(e,i,n);var r=e[i.ID].parents;r.forEach(function(t){var e=o[t.ID];void 0!==e&&(Array.isArray(e.children)||(e.children=[]),e.children.push(i),h.push(i.ID))}),null==i.parent&&h.indexOf(i.ID)<0&&(Array.isArray(a.sceneGraph.children)||(a.sceneGraph.children=[]),a.sceneGraph.children.push(i))}}),this.bindSkeleton(e,i.skeletons,n,o),this.createAmbientLight(),this.setupMorphMaterials(),this.sceneGraph.children.forEach(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrixWorld=e.parent.matrix);var i=t.generateTransform(e.userData.transformData);e.noConstructor.applyMatrix=i}});var d=(new V).parse(t,e,this.sceneGraph);1===this.sceneGraph.children.length&&(this.sceneGraph.children[0].animations=d,this.sceneGraph=this.sceneGraph.children[0]),this.sceneGraph.animations=d},t.prototype.parseModels=function(t,e,i,n,r){var a={},o=this.FBXTree.Objects.Model;for(var s in o){var u=parseInt(s),l=o[s],h=e[u],d=this.buildSkeleton(h,i,u,l.attrName);if(!d){switch(l.attrType){case"Camera":d=this.createCamera(h);break;case"Light":d=this.createLight(h);break;case"Mesh":d=this.createMesh(h,n,r);break;case"NurbsCurve":d=this.createCurve(h,n);break;case"LimbNode":case"Root":d={className:"Bone"};break;case"Null":default:d={className:"Object3D"}}d.name=t.sanitizeNodeName(l.attrName),d.ID=u}this.getTransformData(d,l),a[u]=d}return a},t.prototype.buildSkeleton=function(t,e,i,n){var r=null,a=this;return t.parents.forEach(function(t){var o=function(o){var s=e[o];s.rawBones.forEach(function(e,o){if(e.ID===t.ID){var u=r;r=new N["default"],r.matrixWorld.copy(e.transformLink),r.name=a.FBXTree.sanitizeNodeName(n),r.ID=i,s.bones[o]=r,null!==u&&r.add(u)}})};for(var s in e)o(s)}),r},t.prototype.createCamera=function(t){var e=void 0,i=void 0,n=this;if(t.children.forEach(function(t){var e=n.FBXTree.Objects.NodeAttribute[t.ID];void 0!=e&&(i=e)}),void 0==i)e=new m["default"];else{var r=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(r=1);var a=1;void 0!==i.NearPlane&&(a=i.NearPlane.value/1e3);var o=1e3;void 0!==i.FarPlane&&(o=i.FarPlane.value/1e3);var s=window.innerWidth,u=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(s=i.AspectWidth.value,u=i.AspectHeight.value);var l=45;void 0!==i.FieldOfView&&(l=i.FieldOfView.value);var h=i.FocalLength?i.FocalLength.value:null;switch(r){case 0:e={className:"PerspectiveCamera",fov:l,aspect:void 0,near:a,far:o,noConstructor:{}},null!==h&&(e.noConstructor.focalLength=h);break;case 1:e={className:"OrthographicCamera",left:void 0,right:void 0,top:void 0,bottom:void 0,nearClippingPlane:a,farClippingPlane:o,noConstructor:{}};break;default:console.warn("Unknown camera type "+r+"."),e={className:"Object3D"}}}return e},t.prototype.createLight=function(t){var e=void 0,i=void 0,n=this;if(t.children.forEach(function(t){var e=n.FBXTree.Objects.NodeAttribute[t.ID];void 0!=e&&(i=e)}),void 0==i)e=new m["default"];else{var r=void 0;r=void 0==i.LightType?0:i.LightType.value;var a=16777215;void 0!=i.Color&&(a=(new x["default"]).fromArray(i.Color.value));var o=void 0==i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(o=0);var s=0;void 0!==i.FarAttenuationEnd&&(s=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);var u=1;switch(r){case 0:e={className:"PointLight",color:a,intensity:o,distance:s,decay:u,noConstructor:{}};break;case 1:e={className:"DirectionalLight",color:a,intensity:o,noConstructor:{}};break;case 2:var l=Math.PI/3;void 0!=i.InnerAngle&&(l=S["default"].degToRad(i.InnerAngle.value));var h=0;void 0!==i.OuterAngle&&(h=S["default"].degToRad(i.OuterAngle.value),h=Math.max(h,1)),e={className:"SpotLight",color:a,intensity:o,distance:s,angle:l,penumbra:h,decay:u,noConstructor:{}};break;default:console.warn("Unknown light type "+i.LightType.value+", defaulting to a PointLight."),e={className:"PointLight",color:a,intensity:o,noConstructor:{}}}void 0!==i.CastShadows&&1===i.CastShadows.value&&(e.noConstructor.castShadow=!0)}return e},t.prototype.createMesh=function(t,e,i){var n=void 0,r=null,a=null,o=[];return t.children.forEach(function(t){t.ID in e&&(r=e[t.ID]),t.ID in i&&o.push(i[t.ID])}),o.length>1?a=o:o.length>0?a=o[0]:(a={className:"MeshPhongMaterial",color:13421772},o.push(a)),"color"in r.attributes&&o.forEach(function(t){t.vertexColors=B.VertexColors}),r.FBX_Deformer?(o.forEach(function(t){t.skinning=!0}),n={className:"SkinnedMesh",geometry:r,material:a,noConstructor:{normalizeSkinWeights:""}}):n={className:"Mesh",geometry:r,material:a,noConstructor:{}},n},t.prototype.createCurve=function(t,e){var i=t.children.reduce(function(t,i){return i.ID in e&&(t=e[i.ID]),t},null),n={className:"LineBasicMaterial",color:3342591,lineWidth:1};return{className:"Line",geometry:i,material:n,noConstructor:{}}},t.prototype.getTransformData=function(t,e){var i={};"InheritType"in e&&(i.inheritType=parseInt(e.InheritType.value)),"RotationOrder"in e?i.eulerOrder=this.FBXTree.getEulerOrder(e.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in e&&(i.translation=e.Lcl_Translation.value),"PreRotation"in e&&(i.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(i.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(i.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(i.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(i.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(i.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(i.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(i.rotationPivot=e.RotationPivot.value),t.userData||(t.userData={}),t.userData.transformData=i},t.prototype.setLookAtProperties=function(t,e,i){var n=this;if("LookAtProperty"in i){var r=t[e.ID].children;r.forEach(function(t){if("LookAtProperty"===t.relationship){var i=n.FBXTree.Objects.Model[t.ID];if("Lcl_Translation"in i){var r=i.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(r),n.sceneGraph.add(e.target)):e.lookAt((new F["default"]).fromArray(r))}}})}},t.prototype.bindSkeleton=function(t,e,i,n){var r=this.parsePoseNodes(),a=function(a){var o=e[a],s=t[parseInt(o.ID)].parents;s.forEach(function(e){if(e.ID in i){var a=e.ID,s=t[a];s.parents.forEach(function(t){if(t.ID in n){var e=n[t.ID];e.noConstructor||(e.noConstructor={}),e.noConstructor.bind=[new U["default"](o.bones),r[t.ID]]}})}})};for(var o in e)a(o)},t.prototype.parsePoseNodes=function(){var t={};if("Pose"in this.FBXTree.Objects){var e=this.FBXTree.Objects.Pose;for(var i in e)if("BindPose"==e[i].attrType){var n=e[i].PoseNode;Array.isArray(n)?n.forEach(function(e){t[e.Node]=(new T["default"]).fromArray(e.Matrix.a)}):t[n.Node]=(new T["default"]).fromArray(n.Matrix.a)}}return t},t.prototype.createAmbientLight=function(){if("GlobalSettings"in this.FBXTree&&"AmbientColor"in this.FBXTree.GlobalSettings){var t=this.FBXTree.GlobalSettings.AmbientColor.value,e=t[0],i=t[1],n=t[2];if(0!==e||0!==i||0!==n){var r=new x["default"](e,i,n).getHex(),a={className:"AmbientLight",color:r,intensity:1,noConstructor:{}};this.sceneGraph.children.push(a)}}},t.prototype.setupMorphMaterials=function(){var t=this;t.sceneGraph.children.forEach(function(e){"Mesh"===e.className&&e.geometry.morphAttributes.position&&e.geometry.morphAttributes.position.length&&(Array.isArray(e.material)?e.material.forEach(function(i,n){t.setupMorphMaterial(e,i,n)}):t.setupMorphMaterial(e,e.material))})},t.prototype.setupMorphMaterial=function(t,e,i){var n=t.uuid,r=e.uuid,o=void 0;if(this.sceneGraph.children.forEach(function(t){"Mesh"===t.className&&(Array.isArray(t.material)?t.material.forEach(function(e){e.uuid===r&&t.uuid!==n&&(o=!0)}):t.material.uuid===r&&t.uuid!==n&&(o=!0))}),1==o){var s=(0,a["default"])({},e);s.morphTargets=!0,void 0===i?t.material=s:t.material[i]=s}else e.morphTargets=!0},t}();e["default"]=j;var z=e.TextParser=function(){function t(){(0,d["default"])(this,t),this.currentIndent=0,this.allNodes=new W,this.nodeStack=[],this.currentProp=[],this.currentPropName=""}return t.prototype.getPrevNode=function(){return this.nodeStack[this.currentIndent-2]},t.prototype.getCurrentNode=function(){return this.nodeStack[this.currentIndent-1]},t.prototype.pushStack=function(t){this.nodeStack.push(t),this.currentIndent+=1},t.prototype.popStack=function(){this.nodeStack.pop(),this.currentIndent-=1},t.prototype.setCurrentProp=function(t,e){this.currentProp=t,this.currentPropName=e},t.prototype.parse=function(t){var e=this,i=t.split(/[\r\n]+/);return i.forEach(function(t,n){var r=t.match(/^[\s\t]*;/),a=t.match(/^[\s\t]*$/);if(!r&&!a){var o=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),s=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=t.match("^\\t{"+(e.currentIndent-1)+"}}");o?e.parseNodeBegin(t,o):s?e.parseNodeProperty(t,s,i[++n]):u?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)}}),this.allNodes},t.prototype.parseNodeBegin=function(t,e){var i=e[1].trim().replace(/^"/,"").replace(/"$/,""),n=e[2].split(",").map(function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")}),r={name:i,id:void 0,attrName:void 0,attrType:void 0},a=this.parseNodeAttr(n),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(i,r):i in o?("PoseNode"===i?o.PoseNode.push(r):void 0!==o[i].id&&(o[i]={},o[i][o[i].id]=o[i]),""!==a.id&&(o[i][a.id]=r)):"number"==typeof a.id?(o[i]={},o[i][a.id]=r):"Properties70"!==i&&("PoseNode"===i?o[i]=[r]:o[i]=r),"number"==typeof a.id&&(r.id=a.id),""!=a.name&&(r.attrName=a.name),""!=a.type&&(r.attrType=a.type),this.pushStack(r)},t.prototype.parseNodeAttr=function(t){var e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));var i="",n="";return t.length>1&&(i=t[1].replace(/^(\w+)::/,""),n=t[2]),{id:e,name:i,type:n}},t.prototype.parseNodeProperty=function(t,e,i){var n=e[1].replace(/^"/,"").replace(/"$/,"").trim(),r=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===r&&(r=i.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode(),o=a.name;if("Properties70"===o)return void this.parseNodeSpecialProperty(t,n,r);if("C"===n){var s=r.split(",").slice(1),u=parseInt(s[0]),l=parseInt(s[1]),h=r.split(",").slice(3);h=h.map(function(t){return t.trim().replace(/^"/,"")}),n="connections",r=[u,l],this.append(r,h),void 0===a[n]&&(a[n]=[])}"Node"===n&&(a.id=r),n in a&&Array.isArray(a[n])?a[n].push(r):"a"!==n?a[n]=r:a.a=r,this.setCurrentProp(a,n),"a"===n&&","!==r.slice(-1)&&(a.a=this.parseNumberArray(r))},t.prototype.parseNodePropertyContinued=function(t){var e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=this.parseNumberArray(e.a))},t.prototype.parseNodeSpecialProperty=function(t,e,i){var n=i.split('",').map(function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")}),r=n[0],a=n[1],o=n[2],s=n[3],u=n[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=this.parseNumberArray(u)}this.getPrevNode()[r]={type:a,type2:o,flag:s,value:u},this.setCurrentProp(this.getPrevNode(),r)},t.prototype.append=function(t,e){for(var i=0,n=t.length,r=e.length;i<r;i++,n++)t[n]=e[i]},t.prototype.parseNumberArray=function(t){return t.split(",").map(function(t){return parseFloat(t)})},t}(),G=e.GeometryParser=function(){function t(){(0,d["default"])(this,t)}return t.prototype.parse=function(t,e,i){var n={};if("Geometry"in t.Objects){var r=t.Objects.Geometry;for(var a in r){var o=e[parseInt(a)],s=this.parseGeometry(t,o,r[a],i);n[parseInt(a)]=s}}return n},t.prototype.parseGeometry=function(t,e,i,n){switch(i.attrType){case"Mesh":return this.parseMeshGeometry(t,e,i,n);case"NurbsCurve":return this.parseNurbsGeometry(i)}},t.prototype.parseMeshGeometry=function(t,e,i,n){var r=n.skeletons,a=n.morphTargets,o=e.parents.map(function(e){return t.Objects.Model[e.ID]});if(0!==o.length){var s=e.children.reduce(function(t,e){return void 0!==r[e.ID]&&(t=r[e.ID]),t},null),u=e.children.reduce(function(t,e){return void 0!==a[e.ID]&&(t=a[e.ID]),t},null),l=o[0],h={};"RotationOrder"in l&&(h.eulerOrder=t.getEulerOrder(l.RotationOrder.value)),"InheritType"in l&&(h.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(h.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(h.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(h.scale=l.GeometricScaling.value);var d=t.generateTransform(h);return this.genGeometry(t,i,s,u,d)}},t.prototype.genGeometry=function(t,e,i,n,r){var a=new p["default"];e.attrName&&(a.name=e.attrName);var o=this.parseGeoNode(e,i),s=this.genBuffers(t,o),u=new f.Float32BufferAttribute(s.vertex,3);if(r.applyToBufferAttribute(u),a.addAttribute("position",u),s.colors.length>0&&a.addAttribute("color",new f.Float32BufferAttribute(s.colors,3)),i&&(a.addAttribute("skinIndex",new f.Uint16BufferAttribute(s.weightsIndices,4)),a.addAttribute("skinWeight",new f.Float32BufferAttribute(s.vertexWeights,4)),a.FBX_Deformer=i),s.normal.length>0){var l=new f.Float32BufferAttribute(s.normal,3),h=(new A["default"]).getNormalMatrix(r);h.applyToBufferAttribute(l),a.addAttribute("normal",l)}if(s.uvs.forEach(function(t,e){var i="uv"+(e+1).toString();0===e&&(i="uv"),a.addAttribute(i,new f.Float32BufferAttribute(s.uvs[e],2))}),o.material&&"AllSame"!==o.material.mappingType){var d=s.materialIndex[0],c=0;if(s.materialIndex.forEach(function(t,e){t!==d&&(a.addGroup(c,e-c,d),d=t,c=e)}),a.groups.length>0){var v=a.groups[a.groups.length-1],m=v.start+v.count;m!==s.materialIndex.length&&a.addGroup(m,s.materialIndex.length-m,d)}0===a.groups.length&&a.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(t,a,e,n,r),a},t.prototype.parseGeoNode=function(t,e){var i={};if(i.vertexPositions=void 0!==t.Vertices?t.Vertices.a:[],i.vertexIndices=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(i.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(i.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(i.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){i.uv=[];for(var n=0;t.LayerElementUV[n];)i.uv.push(this.parseUVs(t.LayerElementUV[n])),n++}return i.weightTable={},null!==e&&(i.skeleton=e,e.rawBones.forEach(function(t,e){t.indices.forEach(function(n,r){void 0===i.weightTable[n]&&(i.weightTable[n]=[]),i.weightTable[n].push({id:e,weight:t.weights[r]})})})),i},t.prototype.genBuffers=function(t,e){var i={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},n=0,r=0,a=!1,o=[],s=[],u=[],l=[],h=[],d=[],f=this;return e.vertexIndices.forEach(function(c,p){var v=!1;c<0&&(c^=-1,v=!0);var m=[],g=[];if(o.push(3*c,3*c+1,3*c+2),e.color){var y=t.getData(p,n,c,e.color);u.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[c]&&e.weightTable[c].forEach(function(t){g.push(t.weight),m.push(t.id)}),g.length>4){a||(console.warn("Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),a=!0);var _=[0,0,0,0],x=[0,0,0,0];g.forEach(function(t,e){var i=t,n=m[e];x.forEach(function(t,e,r){if(i>t){r[e]=i,i=t;var a=_[e];_[e]=n,n=a}})}),m=_,g=x}for(;g.length<4;)g.push(0),m.push(0);for(var b=0;b<4;++b)h.push(g[b]),d.push(m[b])}if(e.normal){var M=t.getData(p,n,c,e.normal);s.push(M[0],M[1],M[2])}var w=void 0;e.material&&"AllSame"!==e.material.mappingType&&(w=t.getData(p,n,c,e.material)[0]),e.uv&&e.uv.forEach(function(e,i){var r=t.getData(p,n,c,e);void 0===l[i]&&(l[i]=[]),l[i].push(r[0]),l[i].push(r[1])}),r++,v&&(f.genFace(i,e,o,w,s,u,l,h,d,r),n++,r=0,o=[],s=[],u=[],l=[],h=[],d=[])}),i},t.prototype.genFace=function(t,e,i,n,r,a,o,s,u,l){for(var h=function(l){t.vertex.push(e.vertexPositions[i[0]]),t.vertex.push(e.vertexPositions[i[1]]),t.vertex.push(e.vertexPositions[i[2]]),t.vertex.push(e.vertexPositions[i[3*(l-1)]]),t.vertex.push(e.vertexPositions[i[3*(l-1)+1]]),t.vertex.push(e.vertexPositions[i[3*(l-1)+2]]),t.vertex.push(e.vertexPositions[i[3*l]]),t.vertex.push(e.vertexPositions[i[3*l+1]]),t.vertex.push(e.vertexPositions[i[3*l+2]]),e.skeleton&&(t.vertexWeights.push(s[0]),t.vertexWeights.push(s[1]),t.vertexWeights.push(s[2]),t.vertexWeights.push(s[3]),t.vertexWeights.push(s[4*(l-1)]),t.vertexWeights.push(s[4*(l-1)+1]),t.vertexWeights.push(s[4*(l-1)+2]),t.vertexWeights.push(s[4*(l-1)+3]),t.vertexWeights.push(s[4*l]),t.vertexWeights.push(s[4*l+1]),t.vertexWeights.push(s[4*l+2]),t.vertexWeights.push(s[4*l+3]),t.weightsIndices.push(u[0]),t.weightsIndices.push(u[1]),t.weightsIndices.push(u[2]),t.weightsIndices.push(u[3]),t.weightsIndices.push(u[4*(l-1)]),t.weightsIndices.push(u[4*(l-1)+1]),t.weightsIndices.push(u[4*(l-1)+2]),t.weightsIndices.push(u[4*(l-1)+3]),t.weightsIndices.push(u[4*l]),t.weightsIndices.push(u[4*l+1]),t.weightsIndices.push(u[4*l+2]),t.weightsIndices.push(u[4*l+3])),e.color&&(t.colors.push(a[0]),t.colors.push(a[1]),t.colors.push(a[2]),t.colors.push(a[3*(l-1)]),t.colors.push(a[3*(l-1)+1]),t.colors.push(a[3*(l-1)+2]),t.colors.push(a[3*l]),t.colors.push(a[3*l+1]),t.colors.push(a[3*l+2])),e.material&&"AllSame"!==e.material.mappingType&&(t.materialIndex.push(n),t.materialIndex.push(n),t.materialIndex.push(n)),e.normal&&(t.normal.push(r[0]),t.normal.push(r[1]),t.normal.push(r[2]),t.normal.push(r[3*(l-1)]),t.normal.push(r[3*(l-1)+1]),t.normal.push(r[3*(l-1)+2]),t.normal.push(r[3*l]),t.normal.push(r[3*l+1]),t.normal.push(r[3*l+2])),e.uv&&e.uv.forEach(function(e,i){void 0===t.uvs[i]&&(t.uvs[i]=[]),t.uvs[i].push(o[i][0]),t.uvs[i].push(o[i][1]),t.uvs[i].push(o[i][2*(l-1)]),t.uvs[i].push(o[i][2*(l-1)+1]),t.uvs[i].push(o[i][2*l]),t.uvs[i].push(o[i][2*l+1])})},d=2;d<l;d++)h(d)},t.prototype.addMorphTargets=function(t,e,i,n,r){if(null!==n){e.morphAttributes.position=[];var a=this;n.rawTargets.forEach(function(n){var o=t.Objects.Geometry[n.geoID];void 0!==o&&a.genMorphGeometry(t,e,i,o,r,n.name);
})}},t.prototype.genMorphGeometry=function(t,e,i,n,r,a){var o=new p["default"];n.attrName&&(o.name=n.attrName);for(var s=void 0!==i.PolygonVertexIndex?i.PolygonVertexIndex.a:[],u=void 0!==i.Vertices?i.Vertices.a.slice():[],l=void 0!==n.Vertices?n.Vertices.a:[],h=void 0!==n.Indexes?n.Indexes.a:[],d=0;d<h.length;d++){var c=3*h[d];u[c]+=l[3*d],u[c+1]+=l[3*d+1],u[c+2]+=l[3*d+2]}var v={vertexIndices:s,vertexPositions:u},m=this.genBuffers(t,v),g=new f.Float32BufferAttribute(m.vertex,3);g.name=a||n.attrName,r.applyToBufferAttribute(g),e.morphAttributes.position.push(g)},t.prototype.parseNormals=function(t){var e=t.MappingInformationType,i=t.ReferenceInformationType,n=t.Normals.a,r=[];return"IndexToDirect"===i&&("NormalIndex"in t?r=t.NormalIndex.a:"NormalsIndex"in t&&(r=t.NormalsIndex.a)),{dataSize:3,buffer:n,indices:r,mappingType:e,referenceType:i}},t.prototype.parseUVs=function(t){var e=t.MappingInformationType,i=t.ReferenceInformationType,n=t.UV.a,r=[];return"IndexToDirect"===i&&(r=t.UVIndex.a),{dataSize:2,buffer:n,indices:r,mappingType:e,referenceType:i}},t.prototype.parseVertexColors=function(t){var e=t.MappingInformationType,i=t.ReferenceInformationType,n=t.Colors.a,r=[];return"IndexToDirect"===i&&(r=t.ColorIndex.a),{dataSize:4,buffer:n,indices:r,mappingType:e,referenceType:i}},t.prototype.parseMaterialIndices=function(t){var e=t.MappingInformationType,i=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};for(var n=t.Materials.a,r=[],a=0;a<n.length;++a)r.push(a);return{dataSize:1,buffer:n,indices:r,mappingType:e,referenceType:i}},t.prototype.parseNurbsGeometry=function(t){if(void 0===y["default"])return console.error("The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new p["default"];var e=parseInt(t.Order);if(isNaN(e))return console.error("Invalid Order "+t.Order+" given for geometry ID: "+t.id),new p["default"];for(var i=e-1,n=t.KnotVector.a,r=[],a=t.Points.a,o=0,s=a.length;o<s;o+=4)r.push((new I["default"]).fromArray(a,o));var u=void 0,l=void 0;if("Closed"===t.Form)r.push(r[0]);else if("Periodic"===t.Form){u=i,l=n.length-1-u;for(var h=0;h<i;++h)r.push(r[h])}var d=new y["default"](i,n,r,u,l),c=d.getPoints(7*r.length),v=new Float32Array(3*c.length);c.forEach(function(t,e){t.toArray(v,3*e)});var m=new p["default"];return m.addAttribute("position",new f.BufferAttribute(v,3)),m},t}(),V=e.AnimationParser=function(){function t(){(0,d["default"])(this,t)}return t.prototype.parse=function(t,e,i){var n=[],r=this.parseClips(t,e,i);if(void 0!=r){for(var a in r){var o=r[a],s=this.addClip(i,o);n.push(s)}return n}},t.prototype.parseClips=function(t,e,i){if(void 0!==t.Objects.AnimationCurve){var n=this.parseAnimationCurveNodes(t);this.parseAnimationCurves(t,e,n);var r=this.parseAnimationLayers(t,e,i,n),a=this.parseAnimStacks(t,e,r);return a}},t.prototype.parseAnimationCurveNodes=function(t){var e=t.Objects.AnimationCurveNode,i={};for(var n in e){var r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){var a={id:r.id,attr:r.attrName,curves:{}};i[a.id]=a}}return i},t.prototype.parseAnimationCurves=function(t,e,i){var n=t.Objects.AnimationCurve,r=this;for(var a in n){var o={id:n[a].id,times:n[a].KeyTime.a.map(r.convertFBXTimeToSeconds),values:n[a].KeyValueFloat.a},s=e[o.id];if(void 0!==s){var u=s.parents[0].ID,l=s.parents[0].relationship;l.match(/X/)?i[u].curves.x=o:l.match(/Y/)?i[u].curves.y=o:l.match(/Z/)?i[u].curves.z=o:l.match(/d|DeformPercent/)&&u in i&&(i[u].curves.morph=o)}}},t.prototype.parseAnimationLayers=function(t,e,i,n){var r=t.Objects.AnimationLayer,a={},o=function(r){var o=[],s=e[parseInt(r)];if(void 0!=s){var u=s.children;u.forEach(function(r,a){if(r.ID in n){var s=n[r.ID];if(void 0!==s.curves.x||void 0!==s.curves.y||void 0!==s.curves.z){if(void 0===o[a]){var u=e[r.ID].parents.filter(function(t){return void 0!==t.relationship})[0].ID;if(void 0!=u){var l=t.Objects.Model[u.toString()],h={modelName:t.sanitizeNodeName(l.attrName),ID:l.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};i.children.forEach(function(t){t.ID==l.id&&(h.transform=t.matrix,t.userData.transformData&&(h.eulerOrder=t.userData.transformData.eulerOrder))}),h.transform||(h.transform=new T["default"]),"PreRotation"in l&&(h.preRotation=l.PreRotation.value),"PostRotation"in l&&(h.postRotation=l.PostRotation.value),o[a]=h}}o[a]&&(o[a][s.attr]=s)}else if(void 0!=s.curves.morph){if(void 0===o[a]){var d=e[r.ID].parents.filter(function(t){return void 0!==t.relationship})[0].ID,f=e[d].parents[0].ID,c=e[f].parents[0].ID,p=e[c].parents[0].ID,v=t.Objects.Model[p],m={modelName:t.sanitizeNodeName(v.attrName),morphName:t.Objects.Deformer[d].attrName};o[a]=m}o[a][s.attr]=s}}}),a[parseInt(r)]=o}};for(var s in r)o(s);return a},t.prototype.parseAnimStacks=function(t,e,i){var n=t.Objects.AnimationStack,r={};for(var a in n){var o=e[parseInt(a)].children;o.length>1&&console.warn("Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=i[o[0].ID];r[a]={name:n[a].attrName,layer:s}}return r},t.prototype.addClip=function(t,e){var i=[],n=this;return e.layer.forEach(function(e){i=i.concat(n.generateTracks(t,e))}),{className:"AnimationClip",name:e.name,duration:-1,tracks:i}},t.prototype.generateTracks=function(t,e){var i=[],n=new F["default"],r=new D["default"],a=new F["default"];if(e.transform&&e.transform.decompose(n,r,a),n=n.toArray(),r=(new M["default"]).setFromQuaternion(r,e.eulerOrder).toArray(),a=a.toArray(),void 0!=e.T&&(0,l["default"])(e.T.curves).length>0){var o=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==o&&i.push(o)}if(void 0!==e.R&&(0,l["default"])(e.R.curves).length>0){var s=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==s&&i.push(s)}if(void 0!==e.S&&(0,l["default"])(e.S.curves).length>0){var u=this.generateVectorTrack(e.modelName,e.S.curves,a,"scale");void 0!==u&&i.push(u)}if(void 0!==e.DeformPercent){var h=this.generateMorphTrack(t,e);void 0!==h&&i.push(h)}return i},t.prototype.generateVectorTrack=function(t,e,i,n){var r=this.getTimesForAllAxes(e),a=this.getKeyframeTrackValues(r,e,i);return{className:"VectorKeyframeTrack",name:t+"."+n,times:r,values:a}},t.prototype.generateRotationTrack=function(t,e,i,n,r,a){void 0!==e.x&&(this.interpolateRotations(e.x),e.x.values=e.x.values.map(S["default"].degToRad)),void 0!==e.y&&(this.interpolateRotations(e.y),e.y.values=e.y.values.map(S["default"].degToRad)),void 0!==e.z&&(this.interpolateRotations(e.z),e.z.values=e.z.values.map(S["default"].degToRad));var o=this.getTimesForAllAxes(e),s=this.getKeyframeTrackValues(o,e,i);void 0!==n&&(n=n.map(S["default"].degToRad),n.push(a),n=(new M["default"]).fromArray(n),n=(new D["default"]).setFromEuler(n)),void 0!==r&&(r=r.map(S["default"].degToRad),r.push(a),r=(new M["default"]).fromArray(r),r=(new D["default"]).setFromEuler(r).inverse());for(var u=new D["default"],l=new M["default"],h=[],d=0;d<s.length;d+=3)l.set(s[d],s[d+1],s[d+2],a),u.setFromEuler(l),void 0!==n&&u.premultiply(n),void 0!==r&&u.multiply(r),u.toArray(h,d/3*4);return{className:"QuaternionKeyframeTrack",name:t+".quaternion",times:o,values:h}},t.prototype.generateMorphTrack=function(t,e){var i=e.DeformPercent.curves.morph,n=i.values.map(function(t){return t/100}),r=t.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return{className:"NumberKeyframeTrack",name:e.modelName+".morphTargetInfluences["+r+"]",times:i.times,values:n}},t.prototype.getTimesForAllAxes=function(t){var e=[];return void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort(function(t,e){return t-e}).filter(function(t,e,i){return i.indexOf(t)==e})},t.prototype.getKeyframeTrackValues=function(t,e,i){var n=i,r=[],a=-1,o=-1,s=-1;return t.forEach(function(t){if(e.x&&(a=e.x.times.indexOf(t)),e.y&&(o=e.y.times.indexOf(t)),e.z&&(s=e.z.times.indexOf(t)),a!==-1){var i=e.x.values[a];r.push(i),n[0]=i}else r.push(n[0]);if(o!==-1){var u=e.y.values[o];r.push(u),n[1]=u}else r.push(n[1]);if(s!==-1){var l=e.z.values[s];r.push(l),n[2]=l}else r.push(n[2])}),r},t.prototype.interpolateRotations=function(t){for(var e=1;e<t.values.length;e++){var i=t.values[e-1],n=t.values[e]-i,r=Math.abs(n);if(r>=180){for(var a=r/180,o=n/a,s=i+o,u=t.times[e-1],l=t.times[e]-u,h=l/a,d=u+h,f=[],c=[];d<t.times[e];)f.push(d),d+=h,c.push(s),s+=o;t.times=this.inject(t.times,e,f),t.values=this.inject(t.values,e,c)}}},t.prototype.convertFBXTimeToSeconds=function(t){return t/46186158e3},t.prototype.inject=function(t,e,i){return t.slice(0,e).concat(i).concat(t.slice(e))},t}(),W=e.FBXTree=function(){function t(){(0,d["default"])(this,t),this.tempMat=new T["default"],this.tempEuler=new M["default"],this.tempVec=new F["default"],this.translation=new F["default"],this.rotation=new T["default"],this.dataArray=[]}return t.prototype.add=function(t,e){this[t]=e},t.prototype.generateTransform=function(t){var e=new T["default"],i=new T["default"],n=new T["default"],r=new T["default"],a=new T["default"],o=new T["default"],s=new T["default"],u=new T["default"],l=new T["default"],h=new T["default"],d=new T["default"],f=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(this.tempVec.fromArray(t.translation)),t.preRotation){var c=t.preRotation.map(S["default"].degToRad);c.push(t.eulerOrder),i.makeRotationFromEuler(this.tempEuler.fromArray(c))}if(t.rotation){var p=t.rotation.map(S["default"].degToRad);p.push(t.eulerOrder),n.makeRotationFromEuler(this.tempEuler.fromArray(p))}if(t.postRotation){var v=t.postRotation.map(S["default"].degToRad);v.push(t.eulerOrder),r.makeRotationFromEuler(this.tempEuler.fromArray(v))}t.scale&&a.scale(this.tempVec.fromArray(t.scale)),t.scalingOffset&&s.setPosition(this.tempVec.fromArray(t.scalingOffset)),t.scalingPivot&&o.setPosition(this.tempVec.fromArray(t.scalingPivot)),t.rotationOffset&&u.setPosition(this.tempVec.fromArray(t.rotationOffset)),t.rotationPivot&&l.setPosition(this.tempVec.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(h=t.parentMatrixWorld);var m=i.multiply(n).multiply(r),g=new T["default"];h.extractRotation(g);var y=new T["default"];y.copyPosition(h);var _=y.getInverse(y).multiply(h),x=g.getInverse(g).multiply(_),b=a,M=void 0;if(0===f)M=g.multiply(m).multiply(x).multiply(b);else if(1===f)M=g.multiply(x).multiply(m).multiply(b);else{var w=(new T["default"]).copy(a),P=x.multiply(w.getInverse(w));M=g.multiply(m).multiply(P).multiply(b)}var A=e.multiply(u).multiply(l).multiply(i).multiply(n).multiply(r).multiply(l.getInverse(l)).multiply(s).multiply(o).multiply(a).multiply(o.getInverse(o)),C=(new T["default"]).copyPosition(A),E=h.multiply(C);return d.copyPosition(E),A=d.multiply(M)},t.prototype.slice=function(t,e,i,n){for(var r=i,a=0;r<n;r++,a++)t[a]=e[r];return t},t.prototype.getEulerOrder=function(t){t=t||0;var e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===t?(console.warn("unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]},t.prototype.getData=function(t,e,i,n){var r=void 0;switch(n.mappingType){case"ByPolygonVertex":r=t;break;case"ByPolygon":r=e;break;case"ByVertice":r=i;break;case"AllSame":r=n.indices[0];break;default:console.warn("unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(r=n.indices[r]);var a=r*n.dataSize,o=a+n.dataSize;return this.slice(this.dataArray,n.buffer,a,o)},t.prototype.sanitizeNodeName=function(t){var e="\\[\\]\\.:\\/",i=new RegExp("["+e+"]","g");return t.replace(/\s/g,"_").replace(i,"")},t}()},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.prototype.getAttributes=function(t){},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.text=e}return t.prototype.getAttributes=function(t){return this.text},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(18),s=function(){function t(){(0,a["default"])(this,t),this.objects=[],this.object={},this.position=[],this.normal=[],this.colors=[],this.uvs=[],this.materialLibraries=[]}return t.prototype.startObject=function(t,e){if(this.object&&this.object.fromDeclaration===!1)return this.object.name=t,void(this.object.fromDeclaration=e!==!1);var i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{position:[],normal:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(t,e){var i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);var n={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&e.groupEnd===-1&&(e.groupEnd=this.geometry.position.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},i&&i.name&&"function"==typeof i.clone){var n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},t.prototype.finalize=function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},t.prototype.parseVertexIndex=function(t,e){var i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},t.prototype.parseNormalIndex=function(t,e){var i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},t.prototype.parseUVIndex=function(t,e){var i=parseInt(t,10);return 2*(i>=0?i-1:i+e/2)},t.prototype.addVertex=function(t,e,i){var n=this.position,r=this.object.geometry.position;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},t.prototype.addVertexPoint=function(t){var e=this.position,i=this.object.geometry.position;i.push(e[t+0],e[t+1],e[t+2])},t.prototype.addVertexLine=function(t){var e=this.position,i=this.object.geometry.position;i.push(e[t+0],e[t+1],e[t+2])},t.prototype.addNormal=function(t,e,i){var n=this.normal,r=this.object.geometry.normal;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},t.prototype.addColor=function(t,e,i){var n=this.colors,r=this.object.geometry.colors;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},t.prototype.addUV=function(t,e,i){var n=this.uvs,r=this.object.geometry.uvs;r.push(n[t+0],n[t+1]),r.push(n[e+0],n[e+1]),r.push(n[i+0],n[i+1])},t.prototype.addUVLine=function(t){var e=this.uvs,i=this.object.geometry.uvs;i.push(e[t+0],e[t+1])},t.prototype.addFace=function(t,e,i,n,r,a,o,s,u){var l=this.position.length,h=this.parseVertexIndex(t,l),d=this.parseVertexIndex(e,l),f=this.parseVertexIndex(i,l);if(this.addVertex(h,d,f),void 0!==n&&""!==n){var c=this.uvs.length;h=this.parseUVIndex(n,c),d=this.parseUVIndex(r,c),f=this.parseUVIndex(a,c),this.addUV(h,d,f)}if(void 0!==o&&""!==o){var p=this.normal.length;h=this.parseNormalIndex(o,p),d=o===s?h:this.parseNormalIndex(s,p),f=o===u?h:this.parseNormalIndex(u,p),this.addNormal(h,d,f)}this.colors.length>0&&this.addColor(h,d,f)},t.prototype.addPointGeometry=function(t){this.object.geometry.type="Points";for(var e=this.position.length,i=0,n=t.length;i<n;i++)this.addVertexPoint(this.parseVertexIndex(t[i],e))},t.prototype.addLineGeometry=function(t,e){this.object.geometry.type="Line";for(var i=this.position.length,n=this.uvs.length,r=0,a=t.length;r<a;r++)this.addVertexLine(this.parseVertexIndex(t[r],i));for(var o=0,s=e.length;o<s;o++)this.addUVLine(this.parseUVIndex(e[o],n))},t}(),u=function(){function t(e){(0,a["default"])(this,t),this.object_pattern=/^[og]\s*(.+)?/,this.material_library_pattern=/^mtllib /,this.material_use_pattern=/^usemtl /,this.initGeometry(e)}return t.prototype.initGeometry=function(t){var e=this,i=new s;i.startObject("",!1),t.indexOf("\r\n")!==-1&&(t=t.replace(/\r\n/g,"\n")),t.indexOf("\\\n")!==-1&&(t=t.replace(/\\\n/g,""));for(var n=t.split("\n"),r="",a="",u=0,l=[],h=0,d=n.length;h<d;h++)if(r=n[h],r=r.trim(),u=r.length,0!==u&&(a=r.charAt(0),"#"!==a))if("v"===a){var f=r.split(/\s+/);switch(f[0]){case"v":i.position.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),8===f.length&&i.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6]));break;case"vn":i.normal.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":i.uvs.push(parseFloat(f[1]),parseFloat(f[2]))}}else if("f"===a){for(var c=r.substr(1).trim(),p=c.split(/\s+/),v=[],m=0,g=p.length;m<g;m++){var y=p[m];if(y.length>0){var _=y.split("/");v.push(_)}}for(var x=v[0],b=1,M=v.length-1;b<M;b++){var w=v[b],S=v[b+1];i.addFace(x[0],w[0],S[0],x[1],w[1],S[1],x[2],w[2],S[2])}}else if("l"===a){var P=r.substring(1).trim().split(" "),A=[],C=[];if(r.indexOf("/")===-1)A=P;else for(var T=0,E=P.length;T<E;T++){var D=P[T].split("/");""!==D[0]&&A.push(D[0]),""!==D[1]&&C.push(D[1])}i.addLineGeometry(A,C)}else if("p"===a){var L=r.substr(1).trim(),F=L.split(" ");i.addPointGeometry(F)}else if(null!==(l=this.object_pattern.exec(r))){var k=(" "+l[0].substr(1).trim()).substr(1);i.startObject(k)}else if(this.material_use_pattern.test(r))i.object.startMaterial(r.substring(7).trim(),i.materialLibraries);else if(this.material_library_pattern.test(r))i.materialLibraries.push(r.substring(7).trim());else{if("s"!==a){if("\0"===r)continue;throw new Error('OBJLoader: Unexpected line: "'+r+'"')}if(l=r.split(" "),l.length>1){var I=l[1].trim().toLowerCase();i.object.smooth="0"!==I&&"off"!==I}else i.object.smooth=!0;var O=i.object.currentMaterial();O&&(O.smooth=i.object.smooth)}i.finalize(),this.objects=[],i.objects.forEach(function(t){var i={position:new o.Float32BufferAttribute(t.geometry.position,3),normal:new o.Float32BufferAttribute(t.geometry.normal,3),color:new o.Float32BufferAttribute(t.geometry.color,3),uv:new o.Float32BufferAttribute(t.geometry.uvs,2)},n={geometry:i,materials:[]};t.materials.forEach(function(t){delete t.clone,n.materials.push(t)}),e.objects.push(n)})},t.prototype.getAttributes=function(t){return this.objects.forEach(function(e){t.push(e.geometry.color.array.buffer),t.push(e.geometry.normal.array.buffer),t.push(e.geometry.uv.array.buffer),t.push(e.geometry.position.array.buffer)}),this.objects},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.prototype.getAttributes=function(t){},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(78),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.earth=e;var i=this.earth.getControl("ViewControl"),n=this.earth.getControl("ScaleControl"),r=this.earth.getControl("DrawControl");this.orbit=new s["default"](i.camera,i.target,this.earth),this.orbit.register(),n.register(),r.register(),this.earth.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){this.orbit.dispose();var t=this.earth.getControl("ScaleControl"),e=this.earth.getControl("DrawControl");t.dispose(),e.dispose(),this.earth.off("dispose",this.dispose,this)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(78),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.earth=e;var i=this.earth.getControl("ViewControl"),n=this.earth.getControl("ScaleControl"),r=this.earth.getControl("EditControl");this.orbit=new s["default"](i.camera,i.target,this.earth),this.orbit.register(),n.register(),r.register(),this.earth.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){this.orbit.dispose();var t=this.earth.getControl("ScaleControl"),e=this.earth.getControl("EditControl");t.dispose(),e.dispose(),this.earth.off("dispose",this.dispose,this)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(41),d=n(h),f=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.flyModeControl=n.earth.getControl("FlyModeControl"),n.flyModeControl.register(),n}return(0,l["default"])(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.flyModeControl.dispose()},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(78),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.earth=e;var i=this.earth.getControl("ViewControl"),n=this.earth.getControl("SelectControl"),r=this.earth.getControl("ScaleControl");this.orbit=new s["default"](i.camera,i.target,this.earth),this.orbit.register(),n.register(),r.register(),this.earth.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){this.orbit.dispose();var t=this.earth.getControl("ScaleControl"),e=this.earth.getControl("SelectControl");t.dispose(),e.dispose(),this.earth.off("dispose",this.dispose,this)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(269),l=n(u),h=i(8),d=i(31),f=i(41),c=n(f),p=function(){function t(e,i){(0,s["default"])(this,t),this.earth=e,this.resetEarth(i)}return t.prototype.initHandler=function(t){var e=this.earth.getControl("ViewControl"),i=this.earth.getControl("SelectControl"),n=e.target.clone();t&&(n=t.changeEPSGType(h.Const.EPSGType.EPSGWeb)),n.z<10&&(n.z=10),this.orbit=new l["default"](e.camera,e.target,this.earth),this.orbit.setPosition(n,e.target||t),this.orbit.register(),i.register(),this.earth.on("dispose",this.dispose,this)},t.prototype.resetEarth=function(t){var e=this;if(this.earth.earthHandler instanceof c["default"]){var i=this.earth.earthHandler,n={azimuAngle:0,rotateUpAngle:0},r={azimuAngle:0,rotateUpAngle:0},o=i.orbit.spherical.theta;this.tween1=new d.Tween(n).to({azimuAngle:-o},1e3).onUpdate(function(){i.orbit.resetAziumthalAngle(n.azimuAngle-r.azimuAngle),i.orbit.rotateUp(-90-r.rotateUpAngle),(0,a["default"])(r,n)}).onComplete(function(){e.tween1.stop(),e.tween1=null,e.initHandler(t)}),this.tween1.start()}else this.initHandler(t)},t.prototype.dispose=function(){this.orbit.dispose();var t=this.earth.getControl("SelectControl");t.dispose(),this.earth.off("dispose",this.dispose,this)},t}();e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(270),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.earth=e;var i=this.earth.getControl("ViewControl");this.lock=new s["default"](i.camera,i.scene,this.earth),this.lock.register(),this.earth.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){this.lock.dispose(),this.earth.off("dispose",this.dispose,this)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.userData.canSelect=!0},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=i(8),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="ClapLayer",this.virtual=!0,this.layers.set(f.Const.LayerMask.Three)},e.prototype.canDraw=function(){return!0},e.prototype.remove=function(e){return this.earth.fireEvent("removeClap",e),t.prototype.remove.call(this,e)},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(71),c=i(40),p=n(c),v=i(48),m=i(34),g=n(m),y=i(31),_=i(13),x=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.markerList=[],i}return(0,d["default"])(e,t),e.prototype.draw=function(t){var e=this;if(t){var i=this,n=this.earth.getControl("ViewControl");t.forEach(function(t){t.data.pid=i.userData.id;var r=g["default"].createLayer(t.data,i.earth);r instanceof f.MarkerLayer?(e.markerList.push(r),n.canvas.add(r)):i.add(r),r.draw({add:t.children},"0_0_0")}),this.earth.fireEvent(_.Events.Earth.FloorLoad,this)}},e.prototype.createTween=function(t){var e=this,i={z:this.position.z},n=new y.Tween(i).to({z:t},400).onUpdate(function(){e.position.z=i.z}).onComplete(function(){n.stop()});n.start()},e.prototype.toShort=function(t,e){this.showBusinessLayer(!t);var i=parseFloat(this.userData.high);if(this.scale.z=1,t)i<e?this.createTween(i):(this.createTween(i+8*(i-e)),this.scale.z=.1);else if(this.createTween(i),!this.isLoadData){var n=this.earth.getService(v.InnerService.fnName);n.refreshInnerBusinessData(this.userData.id),this.isLoadData=!0}},e.prototype.showBusinessLayer=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,a["default"])(this.drawMeshs).map(function(i){"1"==t.drawMeshs[i].userData.business&&(t.drawMeshs[i].visible=e)}),this.markerList.forEach(function(t){"1"==t.userData.business&&(t.visible=e)})},e.prototype.dispose=function(){var e=this.earth.getControl("ViewControl");this.markerList.forEach(function(t){e.canvas.remove(t)}),this.markerList=[];var i=this.earth.getService(v.InnerService.fnName);i.off(this.userData.id,this.draw,this),t.prototype.dispose.call(this)},e.prototype.init=function(){var t=this.earth.getService(v.InnerService.fnName);t.on(this.userData.id,this.draw,this),t.refreshInnerData(this.userData.id)},e.prototype.initStates=function(){this.position.z=1*this.userData.high},e}(p["default"]);e["default"]=x,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=i(8),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="GridTintLayer",this.virtual=!0,this.layers.set(f.Const.LayerMask.Two)},e.prototype.canDraw=function(){return!0},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(40),c=n(f),p=i(167),v=n(p),m=i(11),g=n(m),y=i(8),_=i(13),x=i(6),b=n(x),M=i(31),w=i(307),S=n(w),P=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.builds=[]},e.prototype.canDraw=function(){return!1},e.prototype.setVisible=function(t){this.visible=t},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(_.Events.Earth.OpenBuild,this.openBuild,this)},e.prototype.init=function(){this.earth.on(_.Events.Earth.OpenBuild,this.openBuild,this)},e.prototype.changeFloor=function(t){var e=this,i=this.drawMeshs[t];if(i){var n=i.userData.high;(0,a["default"])(this.drawMeshs).map(function(r){e.drawMeshs[r].userData.pid==i.userData.pid&&e.drawMeshs[r].toShort(r!=t,n)}),this.earth.fireEvent(_.Events.Earth.ChangeFloor,i,this)}},e.prototype.initFloors=function(t){var e=this;if(b["default"].isSuccess(t)&&(this.hideBuilds(),Array.isArray(t.values))){var i=void 0,n=this;t.values.forEach(function(t,r){0==r&&(i=t.id);var a=new S["default"]({id:t.id,pid:t.pid,high:t.high},e.earth);n.add(a)}),this.changeFloor(i),this.earth.fireEvent(_.Events.Earth.OpenedBuild,t.values,this)}},e.prototype.openBuild=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(n||this.closeBuild(),t&&(this.builds.push({m:t,p:t.position.clone(),lock:r}),r)){var a=new g["default"](t.position.x,t.position.y,t.position.z,y.Const.EPSGType.EPSGWeb);a.addScalar(100);var o=new g["default"](t.position.x,t.position.y,0,y.Const.EPSGType.EPSGWeb),s=this;this.earth.Api.Camera.flyTo(a,o.clone(),1e3,function(){if(s.earth.earthHandler.orbit){var e=t.geometry.computeBoundingSphereBox.clone();e.min.add(o),e.max.add(o),e.expandByScalar(10),s.earth.earthHandler.orbit.setBound(e)}})}var u=this.earth.getService(v["default"].fnName);u.refreshFloorData(e,i,this.initFloors,this)},e.prototype.closeBuild=function(){this.showBuilds(),this.removeAll(),this.earth.fireEvent(_.Events.Earth.CloseBuild,this)},e.prototype.hideBuilds=function(){var t=this;this.builds.forEach(function(e){e.m.visible&&t.createTween(e.m,e.m.position.z,500,!1)})},e.prototype.showBuilds=function(){var t=this;this.builds.forEach(function(e){t.createTween(e.m,e.m.position.z,e.p.z,!0),e.lock&&t.earth.earthHandler.orbit&&t.earth.earthHandler.orbit.setBound(null)}),this.builds=[]},e.prototype.createTween=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={z:e},a=new M.Tween(r).to({z:i},700).onUpdate(function(){t.visible=!0,t.position.z=r.z}).onComplete(function(){t.visible=n});a.start()},e.prototype.getAllMeshs=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=(arguments[2],this);(0,a["default"])(this.drawMeshs).map(function(n){var r=i.drawMeshs[n];r.children.forEach(function(i){i.canSelect()&&i.traverse(function(i){e.indexOf(i)<0&&i instanceof c["default"]==0&&i.visible&&t.push(i)})})})},e}(c["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){
return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(105),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.userData.canSelect=!1},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.isGround=function(){return!0},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(379),d=i(26),f=n(d),c=i(24),p=n(c),v=i(9),m=i(13),g=i(34),y=n(g),_=i(164),x=n(_),b=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(){var t=y["default"].createTexture(this.earth.userData.ResourcesIP+"/images/sky.jpg"),e=new f["default"]({map:t,side:v.BackSide}),i=new h.SphereGeometry(5e6,8,8);this.sky=new p["default"](i,e),this.sky.rotateX(Math.PI/2),this.add(this.sky),this.initEvents(),this.drag()},e.prototype.drag=function(){var t=this.earth.getControl("ViewControl");this.position.set(t.target.x,t.target.y,0)},e.prototype.scaleChange=function(t){this.visible=t<5e6},e.prototype.initEvents=function(){this.earth.on(m.Events.Mouse.Drag,this.drag,this),this.earth.on(m.Events.Earth.ScaleChange,this.scaleChange,this)},e.prototype.isVirtual=function(){return!0},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(m.Events.Mouse.Drag,this.drag,this),this.earth.off(m.Events.Earth.ScaleChange,this.scaleChange,this)},e}(x["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(40),d=n(h),f=i(159),c=n(f),p=i(289),v=n(p),m=i(13),g=i(25),y=n(g),_=i(6),x=n(_),b=i(7),M=n(b),w=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.toAssign=function(e){t.prototype.toAssign.call(this,e),this.userData.baseMap&&(this.baseMap=this.userData.baseMap,delete this.userData.baseMap)},e.prototype.changeType=function(t,e){var i=this;this.baseMapIndex=t,this.dataType=this.baseMap[this.baseMapIndex].type,this.baseMapName=x["default"].isEmpty(e)?this.baseMap[this.baseMapIndex]["default"]:e,this.traverse(function(t){if(t instanceof v["default"]){var e=i.getURL(t.tileRC.l,t.tileRC.r,t.tileRC.c);t.changeUrl(e)}})},e.prototype.initTiles=function(){this.changeType(0),this.initGlobal(),this.dragEnd()},e.prototype.initGlobal=function(){var t=this;if(!this.initDrawGlobal){this.initDrawGlobal=!0;var e=this.earth.confg.ScaleList[this.level0],i=e/this.earth.confg.RCScale,n=x["default"].getTileGrids(1),r=this.earth.getControl("ViewControl"),a=y["default"].getR10(r.target.y,e),o=y["default"].getC10(r.target.x,e),s={level:this.level0,objType:"TILE_000_TILE",zoom:i,scale:e},u=this.earth.confg.TileSize*i;n.forEach(function(i){var n=a+i[0],r=o+i[1],l=y["default"].getCDevX(r,e),h=y["default"].getRDevY(n,e);if(n>=0&&r>=0){s.extent=new c["default"]({x:l,y:h,devX:l,devY:h},u,u);var d=t.createTile(s);d.position.set(l,h,0),t.add(d)}},this)}},e.prototype.dragEnd=function(){var t=this,e=this.earth.getControl("ScaleControl"),i=this.getExtent(),n=e.scaleNum;this.traverse(function(e){if(e instanceof v["default"]){var r=e.userData.level<n-2?2:4;if(e.isInside(i,r))if(e.userData.level<n){var a=e.userData.level+1;if(a>t.earth.confg.ScaleList.length+1)return;var o=e.userData.zoom/2,s=t.earth.confg.ScaleList[a];if(e.children.length<1){var u=e.getExtents();u.forEach(function(i){var n={objType:"TILE_000_TILE",scale:s,zoom:o,level:a,extent:i},r=t.createTile(n);r.position.set(i.devPos.x,i.devPos.y,0),e.add(r)})}}else e.setDisplay(!0);else e.setDisplay(!0)}})},e.prototype.scaleChange=function(){this.dragEnd()},e.prototype.getExtent=function(){var t=this.earth.getControl("ViewControl"),e=t.getCameraSize();return new c["default"]({x:t.target.x,y:t.target.y},e,e)},e.prototype.createTile=function(t){var e=t.level,i=y["default"].getR10(t.extent.center.y,t.scale),n=y["default"].getC10(t.extent.center.x,t.scale);return t.url=this.getURL(e,i,n),t.tileRC={l:e,r:i,c:n},t.id=M["default"].getUUID(),new v["default"](t,this.earth)},e.prototype.getLevel=function(t){return"10"==this.dataType?t:t<10?"L0"+t:"L"+t},e.prototype.getURL=function(t,e,i){var n=this.baseMap[this.baseMapIndex][this.baseMapName];if("10"==this.dataType)n=n.replace("{r}",e).replace("{c}",i).replace("{l}",t);else{var r=this.getLevel(t);n=n.replace("{r}",y["default"].getR16(e)).replace("{c}",y["default"].getC16(i)).replace("{l}",r)}return n},e.prototype.initEvents=function(){this.earth.on(m.Events.Mouse.DragEnd,this.dragEnd,this),this.earth.on(m.Events.Earth.ScaleChange,this.scaleChange,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.earth.off(m.Events.Mouse.DragEnd,this.dragEnd,this),this.earth.off(m.Events.Earth.ScaleChange,this.scaleChange,this)},e.prototype.init=function(){this.initTiles(),this.initEvents()},e.prototype.isGround=function(){return!0},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="TileLayer",this.level0=4,this.baseMapIndex=0,this.baseMap=[{img:"http://115.236.87.26:8848/googleTiles/china_image/{l}/{r}/{c}.jpg",vec:"http://115.236.87.26:8848/googleTiles/china_vector/{l}/{r}/{c}.jpg",name:"\u5207\u7247",type:"16","default":"img"}]},e}(d["default"]);e["default"]=w,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(89),d=n(h),f=i(11),c=n(f),p=i(8),v=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i){var n=this;t.prototype.init.call(this,e,i),e.shapes.forEach(function(t){var e=new c["default"](t.x,t.y,t.z,t.EPSGType);e.changeEPSGType(p.Const.EPSGType.EPSGWeb),e.isNode=!0,n.points.push(e)},this),this.nodeUpdateFn=this.nodeUpdate.bind(this)},e.prototype.initDefaultGeo=function(e,i){t.prototype.initDefaultGeo.call(this,e,i),this.drawLine()},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(86),a=n(r),o=i(10),s=n(o),u=i(1),l=n(u),h=i(3),d=n(h),f=i(2),c=n(f),p=i(171),v=n(p),m=i(358),g=i(173),y=i(174),_=i(175),x=i(18),b=i(15),M=n(b),w=i(26),S=n(w),P=i(68),A=n(P),C=i(82),T=n(C),E=i(7),D=n(E),L=i(24),F=n(L),k=i(21),I=n(k),O=i(13),N=i(6),R=n(N),U=i(34),B=n(U),j=i(31),z=i(11),G=n(z),V=i(8),W=i(14),X=n(W),H=i(119),Y=n(H),q=i(4),Q=n(q),Z=function(t){function e(){return(0,l["default"])(this,e),(0,d["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.tempEuler=new Y["default"],this.tempVec=new Q["default"],this.visible=!1,this.userData.pause_time=R["default"].isEmpty(this.userData.pause_time)?"0":this.userData.pause_time,this.userData.fbx_speed=R["default"].isEmpty(this.userData.fbx_speed)?"0.15":this.userData.fbx_speed;var i=e.getService("FileService");i.getFile(t.data.fbx,t.jsType,R["default"].endWith(t.data.fbx,".F"),this.initFBX,this),R["default"].isEmpty(t.data.bg_high)||(t.shapes[0].z=(t.shapes[0].z||0)+parseFloat(t.data.bg_high));var n=new G["default"](t.shapes[0].x,t.shapes[0].y,t.shapes[0].z||0,t.shapes[0].EPSGType);if(n.changeEPSGType(V.Const.EPSGType.EPSGWeb),this.position.copy(n),this.userData.shape=[this.position.x,this.position.y,this.position.z],!R["default"].isEmpty(this.userData.repeat_rate)){var r=this.userData.repeat_rate.split(",");this.scale.set(r[0],r[1],r[2])}R["default"].isEmpty(this.userData.angle)||this.rotateZ(this.userData.angle/180*Math.PI)},e.prototype.initFBX=function(t){R["default"].isSuccess(t)&&t.shapes&&(void 0==this.geometry&&(this.geometry=new M["default"],this.geometry.computeBoundingSphere(),this.material=new S["default"]),"children"in t.shapes?this.initMeshArray(t.shapes):this.initMesh(t.shapes),this.rotateX(.5*Math.PI),this.visible=!0)},e.prototype.initAnimation=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;e.animationClips=[];var i=[];t.forEach(function(t){t.tracks.forEach(function(t){switch(t.className){case"VectorKeyframeTrack":i.push(new _.VectorKeyframeTrack(t.name,t.times,t.values));break;case"QuaternionKeyframeTrack":i.push(new y.QuaternionKeyframeTrack(t.name,t.times,t.values));break;case"NumberKeyframeTrack":i.push(new g.NumberKeyframeTrack(t.name,t.times,t.values))}}),e.animationClips.push(new v["default"](t.name,t.duration,i))}),e.mixer=new m.AnimationMixer(e);var n=e.mixer.clipAction(e.animationClips[0]);0==this.userData.pause_time&&(n.play(),this.earth.Api.Time.on(.1,this.update,this))},e.prototype.update=function(t){var e=this,i=this;this.traverse(function(t){if(t.mixer)if(i.userData.pause_time>0){var n=t.mixer.clipAction(t.animationClips[0]);n&&e.userData.pause_time>0&&(n.time>i.max?(i.earth.Api.Time.off(.1,i.update,i),n.time=i.max):n.time<i.min&&(i.earth.Api.Time.off(.1,i.update,i),n.time=i.min));var r=i.sort?-1:1;t.mixer.update(i.userData.fbx_speed*r)}else t.mixer.update(i.userData.fbx_speed)})},e.prototype.initMeshArray=function(t){var e=this;if(t.children){var i=new F["default"](new M["default"],new S["default"]),n=this;t.children.forEach(function(t){var r=e.initGeometry(t.geometry),a=e.initMaterial(t.material),o=new F["default"](r,a);o.ID=t.ID,o.name=t.name,o.userData=t.userData,i.add(o),o.userData.transformData.parentMatrixWorld=o.parent.matrix;var s=n.generateTransform(o.userData.transformData);o.applyMatrix(s),Array.isArray(t.children)&&t.children.forEach(function(t){var i=e.initGeometry(t.geometry),r=e.initMaterial(t.material),a=new F["default"](i,r);a.ID=t.ID,a.name=t.name,a.userData=t.userData,o.add(a),a.userData.transformData.parentMatrixWorld=a.parent.matrix;var s=n.generateTransform(a.userData.transformData);a.applyMatrix(s)})}),this.initAnimation(t.animations,i),n.add(i)}},e.prototype.initMesh=function(t){if(t.geometry){var e=this.initGeometry(t.geometry),i=this.initMaterial(t.material),n=new F["default"](e,i);this.initAnimation(t.animations,n),this.add(n)}},e.prototype.initGeometry=function(t){var e=new M["default"];return"BufferGeometry"==t.type&&t.attributes&&(0,s["default"])(t.attributes).map(function(i){t.attributes[i].array instanceof Float32Array?e.addAttribute(i,new x.Float32BufferAttribute(t.attributes[i].array,t.attributes[i].itemSize)):t.attributes[i].array instanceof Uint16Array&&e.addAttribute(i,new x.Uint16BufferAttribute(t.attributes[i].array,t.attributes[i].itemSize))}),e.computeBoundingSphere(),e},e.prototype.initMaterial=function(t){var e=void 0,i=this.getMaterialCfg();if(e="MeshLambertMaterial"==t.className?new A["default"](i):new T["default"](i),t.noConstructor.setValues){var n=this.initTexture(t.noConstructor.setValues);e.setValues(n)}return e},e.prototype.initTexture=function(t){var e=this,i={};return(0,s["default"])(t).map(function(n){if("object"===(0,a["default"])(t[n])){if("Texture"===t[n].className){var r=e.loadTexture(t[n].fileName);(0,s["default"])(t[n]).map(function(e){"className"!==e&&"fileName"!==e&&(r[e]=t[n][e])}),i[n]=r}}else i[n]=t[n]}),i},e.prototype.loadTexture=function(t){var e=this.userData.fbx.lastIndexOf("/");e<0&&(e=this.userData.fbx.lastIndexOf("\\"));var i=this.earth.userData.ResourcesIP+"/"+this.userData.fbx.slice(0,e+1)+t;return B["default"].createTexture(i)},e.prototype.changeColor=function(i,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.traverse(function(n){n instanceof e==0&&t.prototype.changeColor.call(r,i,n.material,a)})},e.prototype.changeOpacity=function(t,i){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={s:t},o={s:i};this.tween&&this.tween.stop(),this.tween=new j.Tween(a).to(o,1e3).onUpdate(function(){n.traverse(function(t){t instanceof e==0&&n.setOpacity(a.s,t.material)})}).onComplete(function(){n.tween.stop(),n.tween=null,r&&n.changeOpacity(i,t,r)}),this.tween.start()},e.prototype.resetOpacity=function(){var i=this;this.tween&&this.tween.stop(),this.traverse(function(n){n instanceof e==0&&t.prototype.resetOpacity.call(i,n.material)})},e.prototype.resetColor=function(){var i=this;this.traverse(function(n){n instanceof e==0&&t.prototype.resetColor.call(i,n.material)})},e.prototype.doAction=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.userData.pause_time>0&&(this.min=t,this.max=e,this.sort=i,this.traverse(function(n){if(n.mixer){var r=n.mixer.clipAction(n.animationClips[0]);r.time=i?e:t,r.play()}}),this.earth.Api.Time.on(.1,this.update,this))},e.prototype.generateTransform=function(t){var e=new X["default"],i=new X["default"],n=new X["default"],r=new X["default"],a=new X["default"],o=new X["default"],s=new X["default"],u=new X["default"],l=new X["default"],h=new X["default"],d=new X["default"],f=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(this.tempVec.fromArray(t.translation)),t.preRotation){var c=t.preRotation.map(D["default"].degToRad);c.push(t.eulerOrder),i.makeRotationFromEuler(this.tempEuler.fromArray(c))}if(t.rotation){var p=t.rotation.map(D["default"].degToRad);p.push(t.eulerOrder),n.makeRotationFromEuler(this.tempEuler.fromArray(p))}if(t.postRotation){var v=t.postRotation.map(D["default"].degToRad);v.push(t.eulerOrder),r.makeRotationFromEuler(this.tempEuler.fromArray(v))}t.scale&&a.scale(this.tempVec.fromArray(t.scale)),t.scalingOffset&&s.setPosition(this.tempVec.fromArray(t.scalingOffset)),t.scalingPivot&&o.setPosition(this.tempVec.fromArray(t.scalingPivot)),t.rotationOffset&&u.setPosition(this.tempVec.fromArray(t.rotationOffset)),t.rotationPivot&&l.setPosition(this.tempVec.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(h=t.parentMatrixWorld);var m=i.multiply(n).multiply(r),g=new X["default"];h.extractRotation(g);var y=new X["default"];y.copyPosition(h);var _=y.getInverse(y).multiply(h),x=g.getInverse(g).multiply(_),b=a,M=void 0;if(0==f)M=g.multiply(m).multiply(x).multiply(b);else if(1==f)M=g.multiply(x).multiply(m).multiply(b);else{var w=(new X["default"]).copy(a),S=x.multiply(w.getInverse(w));M=g.multiply(m).multiply(S).multiply(b)}var P=e.multiply(u).multiply(l).multiply(i).multiply(n).multiply(r).multiply(l.getInverse(l)).multiply(s).multiply(o).multiply(a).multiply(o.getInverse(o)),A=(new X["default"]).copyPosition(P),C=h.multiply(A);return d.copyPosition(C),P=d.multiply(M)},e.prototype.dispose=function(){this.earth.off(O.Events.Earth.Renderer,this.update,this),t.prototype.dispose.call(this)},e}(I["default"]);e["default"]=Z,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(18),c=i(15),p=n(c),v=i(93),m=n(v),g=i(61),y=n(g),_=i(12),x=n(_),b=i(11),M=n(b),w=i(8),S=function(t){function e(i,n){return(0,s["default"])(this,e),(0,l["default"])(this,t.call(this,null,null,i,n))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Line"},e.prototype.init=function(t,e){var i=this;if(t.shapes.position)this.earth=e,this.geometry=new p["default"],this.material=new m["default"](this.getMaterialCfg()),(0,a["default"])(t.shapes).map(function(e){i.geometry.addAttribute(e,(new f.BufferAttribute).copy(t.shapes[e]))}),this.transPosition(t);else{var n=[],r=[],o=new x["default"]("#"+(t.data.color||"ffffff"));t.position=t.position.changeEPSGType("3857"),t.shapes.forEach(function(e){var i=new M["default"](e.x,e.y,e.z,e.EPSGType||"4326");i.changeEPSGType(w.Const.EPSGType.EPSGWeb),i.sub(t.position),n.push(i.x,i.y,i.z),r.push(o.r,o.g,o.b)}),this.geometry=new p["default"],this.material=new m["default"](this.getMaterialCfg()),this.geometry.addAttribute("position",new f.Float32BufferAttribute(n,3)),this.geometry.addAttribute("color",new f.Float32BufferAttribute(r,3)),this.geometry.computeBoundingSphere(),this.transPosition(t)}},e.prototype.getMaterialCfg=function(){var t=1*(this.userData.opacity||1),e={color:"#"+(this.userData.color||"FFFFFF"),transparent:1!=t,opacity:t};return e},e.prototype.transPosition=function(t){t.position&&this.position.set(t.position.x,t.position.y,t.position.z)},e}(y["default"]);e["default"]=S,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(20),c=n(f),p=i(285),v=n(p),m=i(11),g=n(m),y=i(4),_=n(y),x=i(8),b=i(6),M=n(b),w=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:{}},n=arguments[1];(0,s["default"])(this,e);var r=(0,l["default"])(this,t.call(this));return r.toAssign(i.data),r.userData.lineWidth=M["default"].getDefaultNumber(r.userData.line_width,2),r.changePositionEPSGType(i),r.earth=n,r.initGeometry(i),r}return(0,d["default"])(e,t),e.prototype.changePositionEPSGType=function(t){if(t&&Array.isArray(t.shapes)){var e=[];t.shapes.forEach(function(t){if(t instanceof g["default"]==0){var i=t;t=new g["default"](i.x,i.y,i.z,i.EPSGType)}t.changeEPSGType(x.Const.EPSGType.EPSGWeb),e.push(t)},this),t.shapes=e}},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),(0,a["default"])(this.userData,{opacity:1,lineWidth:2,lineType:"NAVARROW",lineColor:"ff0000",isInner:!0}),this.type="MeshLine"},e.prototype.resetPointsGroup=function(t,e,i){if(e<t.length-1){var n=i.length>0?i[i.length-1]:null,r=t[e].clone(),a=t[e+1].clone();if(r.x==a.x&&r.y==a.y)if(null!=n)if(r.x==n.x&&r.y==n.y&&r.x==a.x&&r.y==a.y)i.push(r.clone()),this.resetPointsGroup(t,e+1,i);else{var o=[];this.lineSegments.push(o),o.push(n.clone()),o.push(r.clone()),this.resetPointsGroup(t,e+1,o)}else i.push(r.clone()),this.resetPointsGroup(t,e+1,i);else if(i.push(r.clone()),null!=n)if(r.x==n.x&&r.y==n.y){var s=[];s.push(r.clone()),this.lineSegments.push(s),this.resetPointsGroup(t,e+1,s)}else this.resetPointsGroup(t,e+1,i);else this.resetPointsGroup(t,e+1,i)}else if(e==t.length-1){var u=i.length>0?i[i.length-1]:null,l=t[e].clone();null!=u&&i.push(l.clone())}},e.prototype.resetInnerPointsGroup=function(t,e,i){if(e<t.length-1){var n=i.length>0?i[i.length-1]:null,r=t[e].clone(),a=t[e+1].clone();if(r.z==a.z)if(null==n)i.push(r.clone()),this.resetInnerPointsGroup(t,e+1,i);else if(n.z==r.z)i.push(r.clone()),this.resetInnerPointsGroup(t,e+1,i);else{i.push(r.clone());var o=[];o.push(r.clone()),this.lineSegments.push(o),this.resetInnerPointsGroup(t,e+1,o)}else if(null==n)i.push(r.clone()),this.resetInnerPointsGroup(t,e+1,i);else{i.push(r.clone());var s=[];s.push(r.clone()),this.lineSegments.push(s),this.resetInnerPointsGroup(t,e+1,s)}}else if(e==t.length-1){var u=i.length>0?i[i.length-1]:null,l=t[e].clone();null!=u&&i.push(l.clone())}},e.prototype.initGeometry=function(t){var e=this;this.lineSegments=[];var i=t.shapes,n=new Array;this.lineSegments.push(n),1==this.userData.isInner?this.resetInnerPointsGroup(i,0,n):this.resetPointsGroup(i,0,n);var r=this;this.lineSegments.forEach(function(t){var i=[];t.forEach(function(t){i.push(t.clone().changeEPSGType(x.Const.EPSGType.EPSGWeb))});var n=r.analyseRawPoints(i);n.forEach(function(t){var i={shapes:t};1==t.isCross?(i.up=new _["default"](0,1,0),i.billboard=!0):(i.up=new _["default"](0,0,1),i.billboard=!1),(0,a["default"])(i,{opacity:e.userData.opacity,lineWidth:e.userData.lineWidth,lineType:e.userData.lineType,lineColor:e.userData.lineColor});var n=new v["default"](i,r.earth);r.add(n)})})},e.prototype.analyseRawPoints=function(t){function e(t){t.length>1&&n.push(t)}for(var i,n=[],r=new _["default"](0,0,1),a=null,o=null,s=[],u=null,l=0;l<t.length;l++){if(u=t[l],u.groupID="1",u.index=l,a){var h=u.clone().sub(a),d=h.clone().length();if(i=h.clone().normalize(),Math.abs(i.clone().dot(r))>.65)e(s),s=[a,u],s.isCross=!0,e(s),s=[u];else if(o){var f=i.clone().dot(o);if(f<-.9)e(s),s=[a,u];else{if(!(d>.1))continue;s.push(u)}}else s.push(u)}else s.push(u);a=u.clone(),a.groupID=u.groupID,i&&(o=i.clone())}return e(s),n},e}(c["default"]);e["default"]=w,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(18),c=i(15),p=n(c),v=i(26),m=n(v),g=i(7),y=n(g),_=i(9),x=i(21),b=n(x),M=i(6),w=n(M),S=i(165),P=n(S),A=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.visible=!1;var i=e.getService("FileService");i.getFile(t.data.obj,t.jsType,w["default"].endWith(t.data.obj,".G"),this.initGeometry,this),i.getFile(t.data.mtl,"Mtl",w["default"].endWith(t.data.mtl,".M"),this.initMaterial,this),this.position.set(t.shapes[0].x,t.shapes[0].y,t.shapes[0].z||0),this.initShadow()},e.prototype.initGeometry=function(t){var e=this;if(w["default"].isSuccess(t)){if(t.shapes.length>1)return void console.warn("obj\u6a21\u578b\u6587\u4ef6\u5305\u542b\u591a\u4e2a\u5bf9\u8c61,\u65e0\u6cd5\u89e3\u6790.",this.userData);this.geometry=new p["default"],(0,a["default"])(t.shapes[0].geometry).map(function(i){e.geometry.addAttribute(i,(new f.BufferAttribute).copy(t.shapes[0].geometry[i]))}),this.geometry.attributes.normal.count<1&&this.geometry.computeVertexNormals(),this.hasVertexColors=t.shapes[0].geometry.color.length>0,this.materials=t.shapes[0].materials,this.createMaterials()}},e.prototype.createMaterials=function(){var t=this;if(this.mtl&&this.geometry){var e=[];if(this.materials.forEach(function(i){var n=t.mtl.create(i.name);n||(n=new m["default"](t.getMaterialCfg())),n.flatShading=!i.smooth,n.vertexColors=t.hasVertexColors?_.VertexColors:_.NoColors,e.push(n)}),e.length>1?(this.materials.forEach(function(e,i){t.geometry.addGroup(e.groupStart,e.groupCount,i)}),this.material=e):this.material=e[0],"0"!=this.userData.rotatex&&this.rotateX(Math.PI/2),this.visible=!0,!w["default"].isEmpty(this.userData.repeat_rate)){var i=this.userData.repeat_rate.split(",");this.scale.set(i[0],i[1],i[2])}w["default"].isEmpty(this.userData.angle)||this.rotateY(y["default"].degToRad(1*this.userData.angle)),this.initOffsetUpdate()}},e.prototype.initMaterial=function(t){w["default"].isSuccess(t)&&(this.mtl=new P["default"](t.shapes,this.getMaterialCfg()),this.createMaterials())},e.prototype.getMaterialCfg=function(){var e=t.prototype.getMaterialCfg.call(this);return e.light=this.userData.light,e.side=1*(this.userData.side||_.FrontSide),e.ResourcesIP=this.earth.userData.ResourcesIP,e.alphaTest=1*(this.userData.alpha_test||"0.01"),w["default"].isEmpty(this.userData.metalness)||(e.metalness=1*this.userData.metalness),w["default"].isEmpty(this.userData.roughness)||(e.roughness=1*this.userData.roughness),void 0!=this.userData.depthTest&&(e.depthTest=this.userData.depthTest),void 0!=this.userData.depthWrite&&(e.depthWrite=this.userData.depthWrite),e},e.prototype.initOffsetUpdate=function(){var t=this.userData.uvoffset;void 0!=t&&void 0!=this.material.map&&this.earth.Api.Time.on(.1,this.update,this)},e.prototype.dispose=function(){this.earth.Api.Time.off(.1,this.update,this),t.prototype.dispose.call(this)},e.prototype.update=function(e){var i=this,n=(this.userData.uv_speed||1)/1e3;"+"==this.userData.uv_direction?n:n*=-1,Array.isArray(this.material)?this.material.forEach(function(t){t.map&&(t.map.offset[i.userData.uvoffset]+=n)}):this.material.map.offset[this.userData.uvoffset]+=n,t.prototype.update.call(this,e)},e}(b["default"]);e["default"]=A,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(21),c=n(f),p=i(6),v=n(p),m=i(15),g=n(m),y=i(18),_=i(165),x=n(_),b=i(35),M=i(34),w=n(M),S=i(24),P=n(S),A=i(13),C=i(44),T=n(C),E=i(20),D=n(E),L=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.init=function(t,e){if(this.earth=e,this.userData.type=t.jsType,this.visible=!1,this.level=1,this.startNum=1,this.geometry=new g["default"],this.material=new b.MeshBasicMaterial,this.meshArray={},this.isFirst=!0,this.position.set(t.shapes[0].x,t.shapes[0].y,t.shapes[0].z||0),!v["default"].isEmpty(t.data.repeat_rate)){this.userData.repeat_rate=t.data.repeat_rate;var i=this.userData.repeat_rate.split(",");this.scale.set(i[0],i[1],i[2])}this.isLoad=!1;var n=e.getService("FileService");n.getOsgb(t.data.mtl,"Mtl",v["default"].endWith(t.data.mtl,".cfg"),this.initConfig,this),n.getOsgb(t.data.obj,this.userData.type,v["default"].endWith(t.data.obj,".C"),this.beforeInitGeometry.bind(this,1,!0),this),this.visible=!0},e.prototype.initConfig=function(t){if(t.shapes){var e=this.getDisConfig();try{this.userData.cfg=JSON.parse(t.shapes),this.userData.cfg.forEach(function(t){t.distance=e[t.level]||Number.MAX_VALUE}),this.earth.on(A.Events.Mouse.DragEnd,this.updateLod,this),this.earth.on(A.Events.Mouse.Rotate,this.updateLod,this),this.earth.on(A.Events.Earth.ZoomChange,this.updateLod,this)}catch(i){}}},e.prototype.initGeometry=function(t){if(t.shapes&&t.shapes.obj instanceof Array){var e=new g["default"];(0,a["default"])(t.shapes.obj[0].geometry).map(function(i){e.addAttribute(i,new y.BufferAttribute(t.shapes.obj[0].geometry[i].array,t.shapes.obj[0].geometry[i].itemSize))}),e.computeBoundingSphere();var i=this.initMaterial(t.shapes),n=new P["default"](e,i),r=new D["default"];return r.add(n),this.add(r),r}},e.prototype.initMaterial=function(t){if(t.mtl){var e=[],i=new x["default"](t.mtl);return(0,a["default"])(i.materialsInfo).map(function(n){var r=i.create(n);r.map=w["default"].createTexture(URL.createObjectURL(new Blob([t.images[n+".jpg"]],{type:"image/jpeg"}))),e.push(r)}),e[0]}return new b.MeshBasicMaterial},e.prototype.getDisConfig=function(){return{14:2800,15:2200,16:1700,17:1200,18:800,19:500,20:350,21:220}},e.prototype.updateLod=function(){if(this.removeOtherLevel(this.level),this.doFirstUpdate(),!this.isLoad&&this.userData.cfg)if(this.isLoad=!0,this.startNum=1,this.level=1,this.meshArray[""+this.level]&&this.meshArray[""+this.level].length>=1)this.isLoad=!1,this.changeLod(this.earth.getControl("ViewControl").camera);else{var t=this.earth.getService("FileService");t.getOsgb(this.userData.obj,this.userData.type,v["default"].endWith(this.userData.obj,".C"),this.beforeInitGeometry.bind(this,1,this.isFirst),this)}},e.prototype.removeOtherLevel=function(t){var e=this,i=this.startNum;if(this.children.forEach(function(n){var r=n.children[0];t==n.userData.level&&e.meshCanShow(r)&&(n.visible=!0,i--)}),!(i>0))for(var n=this.children.length-1;n>=0;n--){var r=this.children[n];r.userData.level!=t&&(r.visible=!1,w["default"].removeCache(r.children[0].material.map),this.remove(r),r.dispose())}},e.prototype.isInScreen=function(t){var e=!1;return this.traverse(function(i){if(i instanceof P["default"]&&T["default"].isPointInScreen(i,t))return void(e=!0)}),e},e.prototype.meshCanShow=function(t){var e=t.oldMaterial||t.material;if(e instanceof Array){var i=!0;return e.forEach(function(t){if(!t.map||!t.map.image)return void(i=!1)}),i}return!(!e.map||!e.map.image)},e.prototype.doFirstUpdate=function(){this.isFirst||(this.changeLod(this.earth.getControl("ViewControl").camera),this.isFirst=!1)},e.prototype.getLevelConfig=function(t){if(t==Number.MAX_VALUE)return{level:1};var e=1/0,i=null;return this.userData.cfg.forEach(function(n){var r=Math.abs(n.distance-t);e>r&&(i=n,e=r)}),i},e.prototype.changeLod=function(t){var e=this;if(this.userData.cfg){var i=Number.MAX_VALUE,n=this;this.isInScreen(t)&&this.traverse(function(e){if(e instanceof P["default"])return e.geometry.computeBoundingSphere(),i=n.position.clone().setZ(e.geometry.boundingSphere.center.z).distanceTo(t.position),void(n.isFirst=!0)});var r=this.getLevelConfig(i);if(r&&this.level!=r.level){this.level=r.level,this.isLoad=!0;var a=this.earth.getService("FileService");1==this.level?(this.startNum=1,this.meshArray[""+this.level]&&this.meshArray[""+this.level].length>=1?this.isLoad=!1:a.getOsgb(this.userData.obj,this.userData.type,v["default"].endWith(this.userData.obj,".C"),this.beforeInitGeometry.bind(this,1,!1),this)):(this.startNum=r.nodes.length,r.nodes.forEach(function(t){if(n.meshArray[""+n.level]&&n.meshArray[""+n.level].length>=1)e.isLoad=!1;else{var i=n.userData.obj.substr(0,e.userData.obj.lastIndexOf("/")),o=i+"/L"+r.level+"/"+t+"/"+t+".C";a.getOsgb(o,n.userData.type,v["default"].endWith(o,".C"),n.beforeInitGeometry.bind(e,n.level,!1),e)}},this))}}},e.prototype.beforeInitGeometry=function(t,e,i){var n=this.initGeometry(i);n&&(this.meshArray[""+t]||(this.meshArray[""+t]=[]),this.meshArray[""+t].push(n),n.userData.level=t,n.visible=t==this.level,this.isLoad=!1,e&&this.changeLod(this.earth.getControl("ViewControl").camera))},e}(c["default"]);e["default"]=L,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(161),d=n(h),f=i(8),c=i(11),p=n(c),v=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i){var n=this;t.prototype.init.call(this,e,i),e.shapes.forEach(function(t){var e=new p["default"](t.x,t.y,t.z,t.EPSGType);e.changeEPSGType(f.Const.EPSGType.EPSGWeb),n.points.push(e)})},e.prototype.initDefaultGeo=function(e,i){t.prototype.initDefaultGeo.call(this,e,i),this.drawLine()},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(21),d=n(h),f=i(67),c=n(f),p=i(8),v=i(11),m=n(v),g=i(113),y=i(35),_=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i){if(e.shapes.position)t.prototype.init.call(this,e,i);else{this.earth=i;var n=new c["default"];e.position=e.position.changeEPSGType("3857"),this.position.set(e.position.x,e.position.y,e.position.z),e.shapes.forEach(function(t,i){var r=new m["default"](t.x,t.y,t.z,t.EPSGType||"4326");r.changeEPSGType(p.Const.EPSGType.EPSGWeb),r.sub(e.position),0==i?n.moveTo(r.x,r.y):n.lineTo(r.x,r.y)});var r=n.toShapes(!0),a={amount:e.data.high||.1,bevelEnabled:!1};this.geometry=new g.ExtrudeBufferGeometry(r,a),this.material=new y.MeshLambertMaterial(this.getMaterialCfg())}},e}(d["default"]);e["default"]=_,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(21),c=n(f),p=i(15),v=n(p),m=i(18),g=i(9),y=i(6),_=n(y),x=i(201),b=n(x),M=i(7),w=n(M),S=i(35),P=i(13),A=function(t){
function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="VideoWall",this.isPlay=!1},e.prototype.init=function(t,e){var i=this;this.earth=e,this.userData.color=_["default"].getDefaultString(this.userData.color,"fff"),this.userData.video_url=_["default"].getDefaultString(this.userData.video_url,""),this.isStreamUrl=this.decodeStreamUrl(this.userData.video_url),this.geometry=new v["default"],this.material=new S.MeshBasicMaterial(this.getMaterialCfg()),this.material.side=g.DoubleSide,(0,a["default"])(t.shapes).map(function(e){i.geometry.addAttribute(e,(new m.BufferAttribute).copy(t.shapes[e]))}),this.transPosition(t)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.material.map.needsUpdate=!0,this.material.needsUpdate=!0},e.prototype.startVideo=function(){if(window.Hls&&!_["default"].isEmpty(this.userData.video_url)){if(this.createVideoElement(),1==this.isStreamUrl){var t=this;window.Hls.isSupported()&&(t.hls=new window.Hls,t.hls.loadSource(this.userData.video_url),t.hls.attachMedia(this.videoElement),t.hls.on(window.Hls.Events.MANIFEST_PARSED,function(){t.videoElement.play(),t.material.setValues({map:t.getVideoMaterial()}),t.earth.on(P.Events.Earth.Renderer,t.update,t)}))}else this.material.setValues({map:this.getVideoMaterial()}),this.material.needsUpdate=!0;this.isPlay=!0}},e.prototype.stopVideo=function(){this.hls&&(1==this.isStreamUrl&&(this.hls.stopLoad(),this.hls.detachMedia(),this.hls.destroy()),this.material.map=null,this.material.needsUpdate=!0,this.earth.off(P.Events.Earth.Renderer,this.update,this),this.isPlay=!1)},e.prototype.createVideoElement=function(){return this.videoElement||(1==this.isStreamUrl?(this.videoElement=document.createElement("video"),this.videoElement.id=w["default"].getUUID(7),this.videoElement.setAttribute("muted","true"),this.videoElement.setAttribute("preload","auto"),this.videoElement.setAttribute("autoplay","autoplay")):(this.videoElement=document.createElement("video"),this.videoElement.id=w["default"].getUUID(7),this.videoElement.setAttribute("controls","true"),this.videoElement.setAttribute("preload","auto"),this.videoElement.setAttribute("src",this.userData.video_url),this.videoElement.setAttribute("autoplay","autoplay"),this.videoElement.setAttribute("loop","loop"),this.videoElement.setAttribute("crossOrigin","anonymous"),this.videoElement.setAttribute("fluid","true"),this.videoElement.setAttribute("muted","true"))),this.videoElement.id},e.prototype.getVideoMaterial=function(){return new b["default"](this.videoElement)},e.prototype.decodeStreamUrl=function(t){var e=/.hls$|.m3u8$/i,i=t.match(e);return!(null===i||void 0===i)},e}(c["default"]);e["default"]=A,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(24),d=n(h),f=i(4),c=n(f),p=i(12),v=n(p),m=i(9),g=i(46),y=n(g),_=i(127),x=n(_),b=i(14),M=n(b),w=i(126),S=i(36),P=n(S),A=i(121),C=n(A),T=i(45),E=n(T),D=i(49),L=n(D),F=i(38),k=n(F),I=i(7),O=n(I),N=i(114),R=i(26),U=n(R),B=i(15),j=n(B),z=i(34),G=n(z),V=i(21),W=n(V),X=i(181),H=n(X),Y=i(112),q=n(Y),Q=i(5),Z=n(Q),K=i(58),J=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(t,e){this.earth=e,this.geometry=new j["default"],this.material=new U["default"],this.initShader(),this.initBasicEn(),this.initGeometry(t.shapes),this.earth.Api.Time.on(.15,this.update,this)},e.prototype.dispose=function(){this.earth.Api.Time.off(.15,this.update,this),t.prototype.dispose.call(this)},e.prototype.update=function(t){var e=this;this.children.forEach(function(t){if(t.material instanceof P["default"]){var i=t.material.uniforms.time.value;"number"==typeof i&&(t.material.uniforms.time.value+=e.options.speed/60)}})},e.prototype.initRender=function(t){var e=this;t.onBeforeRender=function(i,n,r){if(e.mirrorWorldPosition.setFromMatrixPosition(e.matrixWorld),e.cameraWorldPosition.setFromMatrixPosition(r.matrixWorld),e.rotationMatrix.extractRotation(e.matrixWorld),e.normal.set(0,0,1),e.normal.applyMatrix4(e.rotationMatrix),e.view.subVectors(e.mirrorWorldPosition,e.cameraWorldPosition),!(e.view.dot(e.normal)>0)){e.view.reflect(e.normal).negate(),e.view.add(e.mirrorWorldPosition),e.rotationMatrix.extractRotation(r.matrixWorld),e.lookAtPosition.set(0,0,-1),e.lookAtPosition.applyMatrix4(e.rotationMatrix),e.lookAtPosition.add(e.cameraWorldPosition),e.target.subVectors(e.mirrorWorldPosition,e.lookAtPosition),e.target.reflect(e.normal).negate(),e.target.add(e.mirrorWorldPosition),e.mirrorCamera.position.copy(e.view),e.mirrorCamera.up.set(0,0,1),e.mirrorCamera.up.applyMatrix4(e.rotationMatrix),e.mirrorCamera.up.reflect(e.normal),e.mirrorCamera.lookAt(e.target),e.mirrorCamera.far=r.far,e.mirrorCamera.updateMatrixWorld(),e.mirrorCamera.projectionMatrix.copy(r.projectionMatrix),e.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),e.textureMatrix.multiply(e.mirrorCamera.projectionMatrix),e.textureMatrix.multiply(e.mirrorCamera.matrixWorldInverse),e.mirrorPlane.setFromNormalAndCoplanarPoint(e.normal,e.mirrorWorldPosition),e.mirrorPlane.applyMatrix4(e.mirrorCamera.matrixWorldInverse),e.clipPlane.set(e.mirrorPlane.normal.x,e.mirrorPlane.normal.y,e.mirrorPlane.normal.z,e.mirrorPlane.constant);var a=e.mirrorCamera.projectionMatrix;e.q.x=(O["default"].sign(e.clipPlane.x)+a.elements[8])/a.elements[0],e.q.y=-1,e.q.z=(O["default"].sign(e.clipPlane.y)+a.elements[9])/a.elements[5],e.q.w=(1+a.elements[10])/a.elements[14],e.clipPlane.multiplyScalar(2/e.clipPlane.dot(e.q)),a.elements[2]=e.clipPlane.x,a.elements[6]=e.clipPlane.z+1-e.options.clipBias,a.elements[10]=e.clipPlane.y,a.elements[14]=e.clipPlane.w,e.options.eye.setFromMatrixPosition(r.matrixWorld);var o=i.getRenderTarget(),s=i.shadowMap.autoUpdate;if(e.visible=!1,i.shadowMap.autoUpdate=!1,!e.tempMesh){var u=new K.PlaneBufferGeometry(100,100),l=new U["default"]({map:e.renderTarget.texture});e.tempMesh=new d["default"](u,l),e.tempMesh.position.z+=10,t.add(e.tempMesh)}e.tempCamera=(new L["default"]).copy(e.mirrorCamera),e.tempCamera.up.set(0,1,0),e.tempCamera.position.copy(t.position);var h=t.position.clone();h.z+=5e3,e.tempCamera.lookAt(h),i.render(n,e.mirrorCamera,e.renderTarget,!0),e.visible=!0,i.shadowMap.autoUpdate=s,i.setRenderTarget(o)}}},e.prototype.initMaterial=function(){var t=new P["default"]({vertexShader:this.mirrorShader.vertexShader,fragmentShader:this.mirrorShader.fragmentShader,uniforms:y["default"].cloneUniforms(this.mirrorShader.uniforms),transparent:!0,lights:!0,side:this.options.side,fog:this.options.fog});return t.uniforms.textureMatrix.value=this.textureMatrix,t.uniforms.alpha.value=this.options.alpha,t.uniforms.time.value=this.options.time,this.options.normalSampler&&(t.uniforms.normalSampler.value=this.loadTexture(this.options.normalSampler)),t.uniforms.mirrorSampler.value=this.renderTarget,t.uniforms.sunColor.value=this.options.sunColor,t.uniforms.waterColor.value=this.options.waterColor,t.uniforms.sunDirection.value=this.options.sunDirection,t.uniforms.distortionScale.value=this.options.distortionScale,t.uniforms.eye.value=this.options.eye,t},e.prototype.initGeometry=function(t){for(var e=0;e<t.shape.curves.length;e++)t.shape.curves[e].v1=new Z["default"](t.shape.curves[e].v1.x,t.shape.curves[e].v1.y),t.shape.curves[e].v2=new Z["default"](t.shape.curves[e].v2.x,t.shape.curves[e].v2.y),t.shape.curves[e]=new q["default"](t.shape.curves[e].v1,t.shape.curves[e].v2);var i=(new H["default"]).copy(t.shape);i.curves=t.shape.curves;var n=new N.ShapeBufferGeometry(i),r=this.initMaterial(),a=new d["default"](n,r);a.position.set(t.centerPoint.x,t.centerPoint.y,t.centerPoint.z),this.add(a),this.initRender(a)},e.prototype.initBasicEn=function(){this.mirrorPlane=new C["default"],this.normal=new c["default"],this.mirrorWorldPosition=new c["default"],this.cameraWorldPosition=new c["default"],this.rotationMatrix=new M["default"],this.lookAtPosition=new c["default"](0,0,(-1)),this.clipPlane=new E["default"],this.view=new c["default"],this.target=new c["default"],this.q=new E["default"],this.textureMatrix=new M["default"],this.mirrorCamera=new L["default"];var t={minFilter:m.LinearFilter,magFilter:m.LinearFilter,format:m.RGBFormat,stencilBuffer:!1};this.renderTarget=new k["default"](this.options.width,this.options.height,t),O["default"].isPowerOfTwo(this.options.width)&&O["default"].isPowerOfTwo(this.options.height)||(this.renderTarget.texture.generateMipmaps=!1)},e.prototype.initShader=function(){this.mirrorShader={uniforms:y["default"].mergeUniforms([x["default"].fog,x["default"].lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new M["default"]},sunColor:{value:new v["default"]},sunDirection:{value:new c["default"](.70707,.70707,0)},eye:{value:new c["default"]},waterColor:{value:new v["default"](19055)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;",w.ShaderChunk.fog_pars_vertex,w.ShaderChunk.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",w.ShaderChunk.fog_vertex,w.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",w.ShaderChunk.common,w.ShaderChunk.packing,w.ShaderChunk.bsdfs,w.ShaderChunk.fog_pars_fragment,w.ShaderChunk.lights_pars_begin,w.ShaderChunk.shadowmap_pars_fragment,w.ShaderChunk.shadowmask_pars_fragment,"void main() {","\tvec4 noise = getNoise( worldPosition.xy * size );","\tvec3 surfaceNormal = normalize( noise.xyz * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xy * ( 0.001 + 1.0 / 10.0 ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",w.ShaderChunk.tonemapping_fragment,w.ShaderChunk.fog_fragment,"}"].join("\n")}},e.prototype.toAssign=function(e){t.prototype.toAssign.call(this,e),this.options||(this.options={}),this.options.width=void 0!=e.width?parseFloat(e.width):512,this.options.height=void 0!=e.height?parseFloat(e.height):512,this.options.clipBias=void 0!=e.clipBias?e.clipBias:0,this.options.alpha=void 0!=e.alpha?e.alpha:1,this.options.time=void 0!=e.time?e.time:0,this.options.normalSampler=void 0!=e.normal?e.normal:null,this.options.sunDirection=void 0!=e.sunDirection?e.sunDirection:new c["default"](.70707,.70707,0),this.options.sunColor=new v["default"](void 0!=e.sunColor?"#"+e.sunColor:16777210),this.options.waterColor=new v["default"](void 0!=e.color?"#"+e.color:19055),this.options.eye=void 0!=e.eye?e.eye:new c["default"](0,0,0),this.options.distortionScale=void 0!=e.distortion_scale?e.distortion_scale:3.7,this.options.side=void 0!=e.side?e.side:m.FrontSide,this.options.fog=void 0!=e.fog&&e.fog,this.options.speed=void 0!=e.speed?parseFloat(e.speed):2},e.prototype.loadTexture=function(t){0==/http/i.test(t)&&(t=this.earth.userData.ResourcesIP+"/"+t);var e=G["default"].createTexture(t);return e.wrapS=e.wrapT=m.RepeatWrapping,e},e}(W["default"]);e["default"]=J,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(630),l=n(u),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s["default"])(this,t),(0,a["default"])(this,{type:"NORMAL",width:128,height:128,lineColor:"ff0000",arrowHeightPercent:.4,arrowWidthPercent:.7,arrowPercent:.1,lineType:null,dashArray:[2,1],godHeightPercent:.5,godEdgePercent:.2,godArrowPercent:.3,godColor:"#33cc61",godEdgeColor:"#4a82d2",godArrowColor:"#F4FEFB",godArrowXScale:.6,godArrowWidthPercent:.07},e),this.materialInfo={offset:0,side:0},this.ctx=document.createElement("canvas").getContext("2d"),this.createLineStyle()}return t.prototype.createLineStyle=function(){switch(this.ctx.canvas.width=this.width,this.ctx.canvas.height=this.height,this.type){case"NORMAL":this.drawNormal();break;case"ARROW":this.drawArrow();break;case"NAVARROW":this.drawNavArrow()}},t.prototype.setMaterialInfo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.materialInfo.offset=t,this.materialInfo.side=e},t.prototype.drawNormal=function(){var t=this.dashArray.reduce(function(t,e){return t+e}),e=0,i=this;this.dashArray.forEach(function(n,r){r%2==0&&(i.ctx.fillStyle="#"+i.lineColor,i.ctx.fillRect(e/t*i.width,0,n/t*i.width,i.height)),e+=n}),this.setMaterialInfo(0)},t.prototype.drawArrow=function(){var t=(1-this.arrowHeightPercent)*this.height/2,e=this.height*this.arrowHeightPercent;this.ctx.beginPath(),this.ctx.moveTo(0,t);var i=this.width*(this.arrowWidthPercent-this.arrowPercent);this.ctx.lineTo(i,t),this.ctx.lineTo(this.width*this.arrowWidthPercent,t+e/2),this.ctx.lineTo(i,t+e),this.ctx.lineTo(0,t+e),this.ctx.lineTo(this.width*this.arrowPercent,t+e/2),this.ctx.closePath(),this.ctx.fillStyle="#"+this.lineColor,this.ctx.fill(),this.setMaterialInfo(-.25,2)},t.prototype.drawNavArrow=function(){this.ctx.fillStyle=this.godEdgeColor,this.ctx.fillRect(0,(1-this.godHeightPercent)*this.height/2,this.width,this.godHeightPercent*this.height),this.ctx.fillStyle=this.godColor;var t=(1-this.godHeightPercent+this.godEdgePercent)*this.height/2,e=(this.godHeightPercent-this.godEdgePercent)*this.height;this.ctx.fillRect(0,t,this.width,e),this.ctx.fillStyle="#ffffff",this.ctx.shadowOffsetX=-2,this.ctx.shadowOffsetY=2,this.ctx.shadowBlur=4,this.ctx.shadowColor="rgba(0,0,0,0.5)";var i={x:this.width/2,y:this.height/2},n=this.width*this.godArrowPercent,r=this.width*this.godArrowWidthPercent,a=this.width*(this.godArrowPercent-this.godArrowWidthPercent)*this.godArrowXScale,o=i.x-n/2*this.godArrowXScale,s=i.y-n/2;this.ctx.beginPath(),this.ctx.moveTo(o,s),this.ctx.lineTo(o+r,s),this.ctx.lineTo(o+r+a,s+n/2),this.ctx.lineTo(o+r,s+n),this.ctx.lineTo(o,s+n),this.ctx.lineTo(o+a,s+n/2),this.ctx.closePath(),this.ctx.fillStyle=this.godArrowColor,this.ctx.fill(),this.setMaterialInfo(-.25,2)},(0,l["default"])(t,[{key:"canvas",get:function(){return this.ctx.canvas}}]),t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(8),d=i(42),f=i(13),c=i(80),p=n(c),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.layerTask=h.Const.LayerMask.Three,n.earth.on(f.Events.Earth.Renderer,n.update,n),n.earth.on("removeClap",n.removeOne,n),n}return(0,l["default"])(e,t),e.prototype.doRenderEffect=function(t,e,i){"number"==typeof t.faceClip&&t.setFaceClap(this.camera.projectionMatrix,e,this.target,i)},e.prototype.clearRenderEffect=function(t){"number"==typeof t.faceClip&&t.clearFaceClap()},e.prototype.changeCameraPosition=function(t,e){this.initCamera();var i=t.earth.getSize(),n=i.width/Math.tan(Math.PI/18);this.camera.far=n+50,this.camera.position.set(t.earth.earthHandler.orbit.target.x,t.earth.earthHandler.orbit.target.y,n),this.camera.lookAt(t.earth.earthHandler.orbit.target.x,t.earth.earthHandler.orbit.target.y,0),this.camera.updateMatrix(),this.camera.updateMatrixWorld(!0),this.camera.updateProjectionMatrix(),this.initRenderMesh(t);var r=e.getAllMeshsNotGround(!1);this.initRenderBuffer(r)},e.prototype.update=function(t){var e=this,i=this.earth.getControl("LayerControl");if(i){var n=void 0;if(n=i.getLayersByType(d.ClapLayer),n.length<1){if(!this.isEmpty){var r=i.getAllMeshsNotGround(!1);r.forEach(function(t){Array.isArray(t.material)?t.material.forEach(function(t){e.clearRenderEffect(t)}):e.clearRenderEffect(t.material)})}return void(this.isEmpty=!0)}for(var a=!1,o=0;o<n.length&&!(a=n[o].visible&&n[o].children.length>0);o++);a&&(this.changeLayersMask(n),this.isEmpty=!1,this.changeCameraPosition(this.earth.getControl("ViewControl"),i))}},e.prototype.clearAll=function(t,e){var i=this,n=t.earth.getControl("LayerControl");if(n){var r=n.getLayersByType(d.ClapLayer);if(r.length>0){if(!this.isEmpty){var a=n.getAllMeshsNotGround(!1);a.forEach(function(t){Array.isArray(t.material)?t.material.forEach(function(t){i.clearRenderEffect(t)}):i.clearRenderEffect(t.material)})}return e&&(e.children=[]),void(this.isEmpty=!0)}}},e.prototype.removeOne=function(t){var e=this,i=this.earth.getControl("LayerControl"),n=i.getAllMeshsNotGround(!1);n.forEach(function(t){Array.isArray(t.material)?t.material.forEach(function(t){e.clearRenderEffect(t)}):e.clearRenderEffect(t.material)})},e}(p["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(80),d=n(h),f=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.apply(this,arguments));return i.layerList=[],i}return(0,l["default"])(e,t),e.prototype.addGroundLayer=function(t){this.layerList.push(t)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(35),d=i(24),f=n(d),c=i(163),p=n(c),v=i(8),m=i(13),g=i(80),y=n(g),_=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.layerTask=v.Const.LayerMask.Four,n.earth.on(m.Events.Earth.Renderer,n.update,n),n}return(0,l["default"])(e,t),e.prototype.doRenderEffect=function(t,e,i){t instanceof h.MeshBasicMaterial&&t.setDigArea(this.camera.projectionMatrix,e,this.target)},e.prototype.clearRenderEffect=function(t){t instanceof h.MeshBasicMaterial&&t.clearDigArea()},e.prototype.changeCameraPosition=function(t,e){this.initCamera();var i=this.earth.getSize(),n=i.width/Math.tan(Math.PI/18);this.camera.far=n+50,this.camera.position.set(t.earth.earthHandler.orbit.target.x,t.earth.earthHandler.orbit.target.y,n),this.camera.lookAt(t.earth.earthHandler.orbit.target.x,t.earth.earthHandler.orbit.target.y,0),this.camera.updateMatrix(),this.camera.updateMatrixWorld(!0),this.camera.updateProjectionMatrix(),this.initRenderMesh(t);var r=e.getAllSceneMeshs();this.initRenderBuffer(r)},e.prototype.update=function(t){var e=this,i=this.earth.getControl("LayerControl");if(i){var n=i.getLayersByType(p["default"]);if(n.length<1){if(!this.isEmpty){var r=i.getAllSceneMeshs();r.forEach(function(t){t instanceof f["default"]&&(Array.isArray(t.material)?t.material.forEach(function(t){e.clearRenderEffect(t)}):e.clearRenderEffect(t.material))})}return void(this.isEmpty=!0)}for(var a=!1,o=0;o<n.length&&!(a=n[o].visible&&n[o].children.length>0);o++);a&&(this.changeLayersMask(n),this.isEmpty=!1,this.changeCameraPosition(this.earth.getControl("ViewControl"),i))}},e}(y["default"]);e["default"]=_,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(8),d=i(42),f=i(13),c=i(80),p=n(c),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.layerTask=h.Const.LayerMask.Two,n.earth.on(f.Events.Earth.Renderer,n.update,n),n}return(0,l["default"])(e,t),e.prototype.doRenderEffect=function(t,e){"number"==typeof t.gridTint&&t.setGridTint(this.camera.projectionMatrix,e,this.target)},e.prototype.clearRenderEffect=function(t){"number"==typeof t.gridTint&&t.clearGridTint()},e.prototype.changeCameraPosition=function(t,e){this.initCamera();var i=t.earth.getSize(),n=i.width/Math.tan(Math.PI/10);this.camera.far=n+100,this.camera.position.set(t.earth.earthHandler.orbit.target.x,t.earth.earthHandler.orbit.target.y,n),this.camera.lookAt(t.earth.earthHandler.orbit.target.x,t.earth.earthHandler.orbit.target.y,0),this.camera.updateMatrix(),this.camera.updateMatrixWorld(!0),this.camera.updateProjectionMatrix(),this.initRenderMesh(t);var r=e.getAllSceneMeshs(!1);this.initRenderBuffer(r)},e.prototype.update=function(t){var e=this,i=this.earth.getControl("LayerControl");if(i){var n=void 0;if(n=i.getLayersByType(d.GridTintLayer),n.length<1){if(!this.isEmpty){var r=i.getAllSceneMeshs(!1);r.forEach(function(t){Array.isArray(t.material)?t.material.forEach(function(t){e.clearRenderEffect(t)}):e.clearRenderEffect(t.material)})}return void(this.isEmpty=!0)}for(var a=!1,o=0;o<n.length&&!(a=n[o].visible&&n[o].children.length>0);o++);a&&(this.changeLayersMask(n),this.isEmpty=!1,this.changeCameraPosition(this.earth.getControl("ViewControl"),i))}},e.prototype.clearAll=function(t,e){var i=this,n=t.earth.getControl("LayerControl");if(n){var r=n.getLayersByType(d.GridTintLayer);if(r.length>0){if(!this.isEmpty){var a=n.getAllMeshsNotGround(!1);a.forEach(function(t){Array.isArray(t.material)?t.material.forEach(function(t){i.clearRenderEffect(t)}):i.clearRenderEffect(t.material)})}return e.children=[],void(this.isEmpty=!0)}}},e.prototype.clearOne=function(t){},e}(p["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(42),d=i(13),f=i(80),c=n(f),p=i(160),v=n(p),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initLayer=function(){this.drawLayer||(this.drawLayer=new h.ActiveLayer({objType:"InspectArea",virtual:!0},this.earth),this.earth.getControl("LayerControl").addLayer(this.drawLayer),this.earth.on(d.Events.Earth.Renderer,this.update,this))},e.prototype.initRenderMesh=function(t){var e=this;t.forEach(function(t){if(t.matrixWorld){var i=[];e.drawLayer.children.forEach(function(e){e instanceof v["default"]&&i.push(e.getUniforms(t))}),e.doRenderEffect(t.material,i)}},this)},e.prototype.doRenderEffect=function(t,e){Array.isArray(t)?t.forEach(function(t){"number"==typeof t.inspectArea&&t.setInspectArea(e)}):"number"==typeof t.inspectArea&&t.setInspectArea(e)},e.prototype.clearRenderEffect=function(t){Array.isArray(t)?t.forEach(function(t){"number"==typeof t.inspectArea&&t.clearInspectArea()}):"number"==typeof t.inspectArea&&t.clearInspectArea()},e.prototype.update=function(t){if(this.viewControl||(this.viewControl=this.earth.getControl("ViewControl")),this.layerControl||(this.layerControl=this.earth.getControl("LayerControl")),this.drawLayer){var e=this.layerControl.getAllSceneMeshs(!1);this.initRenderMesh(e)}},e.prototype.add=function(t){return this.initLayer(),!(this.drawLayer.children.length>=3)&&(this.drawLayer.add(t),this.drawLayer.add(t.helper),!0)},e.prototype.remove=function(t){this.drawLayer&&(this.drawLayer.remove(t.helper),this.drawLayer.remove(t),this.drawLayer.children.length<1&&this.removeLayer())},e.prototype.clearAll=function(t,e){this.removeLayer()},e.prototype.removeLayer=function(){var t=this;if(this.drawLayer){this.layerControl.removeLayer(this.drawLayer),this.drawLayer=null;var e=this.layerControl.getAllSceneMeshs(!1);e.forEach(function(e){t.clearRenderEffect(e)})}},e}(c["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(325);Object.defineProperty(e,"ClapRender",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(328);Object.defineProperty(e,"GridTintRender",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(329);Object.defineProperty(e,"InspectRender",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(327);Object.defineProperty(e,"DigAreaRender",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(326);Object.defineProperty(e,"DemRender",{enumerable:!0,get:function(){return n(u)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(36),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.uniforms={inspectAreaFar:{value:0},inspectAreaNear:{value:0}},this.fragmentShader="\n        uniform float inspectAreaFar;\n        uniform float inspectAreaNear;\n        float LinearizeDepth(float depth){\n            float z = depth * 2.0 - 1.0;\n            float v = (2.0 * inspectAreaNear) / (inspectAreaFar + inspectAreaNear - z * (inspectAreaFar - inspectAreaNear));\n            return v;\n        }\n        void main() {\n            float depth = LinearizeDepth(gl_FragCoord.z);\n            gl_FragColor = vec4(depth,0.0,0.0, 1.0);\n        }"},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(43),c=n(f),p=i(16),v=i(7),m=n(v),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onAttributeService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.getEarthLayers=function(t,i,n,r){if(!i){var a=m["default"].getUUID();this.on(a,n,r);var o={method:p.Const.EventType.EarthLayers,action:"get",key:t,applyData:{fn:e.fnName,fnid:a}};this.worker.postMessage(o)}},e.prototype.getConfig=function(t,i,n,r,a){var o=m["default"].getUUID();this.on(o,r,a);var s={method:p.Const.EventType.EarthConfig,action:"get",key:t,build_id:i,floor_id:n,applyData:{fn:e.fnName,fnid:o}};this.worker.postMessage(s)},e.prototype.getPlaceMarker=function(t,i){var n=m["default"].getUUID();this.on(n,t,i);var r={method:p.Const.EventType.PlaceMarker,action:"get",applyData:{fn:e.fnName,fnid:n}};this.worker.postMessage(r)},e.prototype.addPlaceMarker=function(t,i,n){var r=m["default"].getUUID();this.on(r,t,n);var o={key:this.earth.userData.key,method:p.Const.EventType.PlaceMarker,action:"add",applyData:{fn:e.fnName,fnid:r}};(0,a["default"])(o,i),this.worker.postMessage(o)},e.prototype.deletePlaceMarker=function(t,i,n){var r=m["default"].getUUID();this.on(r,t,n);var a={method:p.Const.EventType.PlaceMarker,action:"delete",applyData:{fn:e.fnName,fnid:r},key:"id",keyValue:i};this.worker.postMessage(a)},e.prototype.getFlyData=function(t,i){var n=m["default"].getUUID();this.on(n,t,i);var r={method:p.Const.EventType.FlyData,action:"get",key:this.earth.userData.key,applyData:{fn:e.fnName,fnid:n}};this.worker.postMessage(r)},e.prototype.getFlyDataNodes=function(t,i,n){var r=m["default"].getUUID();this.on(r,i,n);var a={method:""+p.Const.EventType.FlyData,action:"getNodes",key:this.earth.userData.key,flymode_id:t,applyData:{fn:e.fnName,fnid:r}};this.worker.postMessage(a)},e.prototype.addFlyData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments[1],n=arguments[2],r=m["default"].getUUID();this.on(r,i,n);var o={method:p.Const.EventType.FlyData,action:"add",key:this.earth.userData.key,applyData:{fn:e.fnName,fnid:r}};(0,a["default"])(o,t),this.worker.postMessage(o)},e.prototype.deleteFlyData=function(t,i,n){var r=m["default"].getUUID();this.on(r,i,n);var a={method:p.Const.EventType.FlyData,action:"delete",id:t,key:this.earth.userData.key,applyData:{fn:e.fnName,fnid:r}};this.worker.postMessage(a)},e.prototype.onAttributeService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e}(c["default"]);e["default"]=g,g.fnName="AttributeService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(16),d=i(43),f=n(d),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.synCamera=function(t,i){var n={method:h.Const.EventType.SynCamera,userData:{info:t,size:i},applyData:{fn:e.fnName}};this.worker.postMessage(n,!1,0)},e}(f["default"]);e["default"]=c,c.fnName="CameraService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(43),d=n(h),f=i(7),c=n(f),p=i(16),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onFileService.bind(n)),n}return(0,l["default"])(e,t),e.prototype.getFile=function(t,i,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};0==/http/i.test(t)&&(t=this.earth.userData.ResourcesIP+"/"+t);var s=c["default"].getUUID();this.on(s,r,a);var u={method:p.Const.EventType.File,action:"get",url:t,type:i,gz:n,applyData:{fn:e.fnName,fnid:s,options:o}};this.worker.postMessage(u)},e.prototype.getOsgb=function(t,i,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};0==/http/i.test(t)&&(t=this.earth.userData.ResourcesIP+"/"+t);var s=c["default"].getUUID();
this.on(s,r,a);var u={method:p.Const.EventType.Osgb,action:"get",url:t,type:i,gz:n,applyData:{fn:e.fnName,fnid:s,options:o}};this.worker.postMessage(u)},e.prototype.onFileService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e}(d["default"]);e["default"]=v,v.fnName="FileService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(7),c=n(f),p=i(16),v=i(43),m=n(v),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onMarkerService.bind(n)),n.worker.addFn(e.fnSynName,n.onMarkerSynService.bind(n)),n.worker.addFn(e.fnPolySyncName,n.onMarkerPolySynService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.getMarker=function(t,i,n){var r=c["default"].getUUID();this.on(r,i,n);var a={method:p.Const.EventType.Marker,action:"get",json:t,applyData:{fn:e.fnName,fnid:r}};this.worker.postMessage(a)},e.prototype.synMarker=function(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments[4],o=arguments[5],s={method:p.Const.EventType.SynMarker,action:t,userData:{id:i,uuid:n,position:r,size:a,isTogether:o},applyData:{fn:e.fnSynName}};this.worker.postMessage(s,!1,0)},e.prototype.onMarkerService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e.prototype.onMarkerSynService=function(t){var e=[];t.values.forEach(function(t){var i={};i.id=t.id,i.show=t.show,e.push(i)}),this.fireEvent(t.uuid,e)},e.prototype.onMarkerPolySynService=function(t){var e={},i={},n={};(0,a["default"])(t.values).map(function(e){i[e]||(i[e]=[]),n[e]||(n[e]=new Array),t.values[e].forEach(function(t){var r={};r.id=t.id,r.show=!1,i[e].push(r),n[e].push(t.position)})}),e.info=i,e.points=n,this.fireEvent(t.uuid,e)},e.prototype.synClusterParam=function(t,e,i,n){var r={method:p.Const.EventType.ClusterParam,action:t,userData:{uuid:e,pxRange:i,minCluster:n}};this.worker.postMessage(r,!1,0)},e}(m["default"]);e["default"]=g,g.fnName="MarkerService",g.fnSynName="MarkerSynService",g.fnPolySyncName="MarkerPolySynService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(43),c=n(f),p=i(7),v=n(p),m=i(16),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onNavigateService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.getFloorNavDatas=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=v["default"].getUUID();this.on(r,t,n);var o={method:m.Const.EventType.NavData,action:"get",key:this.earth.userData.key,applyData:{fn:e.fnName,fnid:r}};(0,a["default"])(o,i),this.worker.postMessage(o)},e.prototype.onNavigateService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e}(c["default"]);e["default"]=g,g.fnName="NavigateService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(43),d=n(h),f=i(7),c=n(f),p=i(16),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onPoiService.bind(n)),n}return(0,l["default"])(e,t),e.prototype.getPois=function(t,i,n,r){var a=c["default"].getUUID();this.on(a,n,r);var o={method:p.Const.EventType.PoiData,action:"get",key:t,value:i,applyData:{fn:e.fnName,fnid:a}};this.worker.postMessage(o)},e.prototype.onPoiService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e}(d["default"]);e["default"]=v,v.fnName="PoiService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(16),c=i(43),p=n(c),v=i(6),m=n(v),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onRCService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.updateData=function(t){var i={method:f.Const.EventType.RCData,action:"update",datas:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.deleteData=function(t){var i={method:f.Const.EventType.RCData,action:"delete",datas:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.addData=function(t){var i={method:f.Const.EventType.RCData,action:"add",datas:t,applyData:{fn:e.fnName}};this.worker.postMessage(i)},e.prototype.refreshData=function(t,i,n,r,a){var o={method:f.Const.EventType.RCData,action:"get",objTypes:r,row:t,column:i,scale:n,conditions:a,applyData:{fn:e.fnName}};this.worker.postMessage(o)},e.prototype.refreshDBData=function(t,i){var n={method:f.Const.EventType.DBData,action:"get",objTypes:t,conditions:i,applyData:{fn:e.fnName}};this.worker.postMessage(n)},e.prototype.onRCService=function(t){var e=this;m["default"].isSuccess(t)&&t.values&&(0,a["default"])(t.values).map(function(i){var n=t.values[i];e.fireEvent(i,n,t.message)})},e}(p["default"]);e["default"]=g,g.fnName="RCService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(10),s=n(o),u=i(1),l=n(u),h=i(3),d=n(h),f=i(2),c=n(f),p=i(148),v=i(7),m=n(v),g=i(90),y=n(g),_=i(6),x=n(_),b=function(t){function e(i){(0,l["default"])(this,e);var n=(0,d["default"])(this,t.call(this));return n.fnSet={},n.sendDataList={},n.url=i,n.initSocket(),n}return(0,c["default"])(e,t),e.prototype.onOpen=function(t){var e=this;this.socket.binaryType="arraybuffer",(0,s["default"])(this.sendDataList).map(function(t){e.socket.send((0,a["default"])(e.sendDataList[t])),delete e.sendDataList[t]})},e.prototype.onMessage=function(t){var e=JSON.parse((0,p.inflate)(t.data,{to:"string"})),i=e.uuid;"notice"==i?this.fireEvent(e.message,e):(this.fnSet[i]&&this.fnSet[i](e),delete this.fnSet[i])},e.prototype.sendData=function(t,e){var i=m["default"].getUUID();return this.fnSet[i]=e,t.uuid=i,this.socket.readyState!=this.socket.OPEN?void(this.sendDataList[i]=t):void this.socket.send((0,a["default"])(t))},e.prototype.onError=function(){},e.prototype.onClose=function(){setTimeout(this.initSocket.bind(this),2e3)},e.prototype.initSocket=function(){this.socket=new WebSocket(this.url+"?token="+m["default"].getUUID()),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),setInterval(this.initHeartbeat.bind(this),9e3)},e.prototype.initHeartbeat=function(){if(null==this.timer){if(this.socket.readyState!=this.socket.OPEN)return void x["default"].warn("\u540e\u7aef\u670d\u52a1\u5df2\u65ad\u5f00");var t={method:"heart",uuid:m["default"].getUUID()};this.socket.send((0,a["default"])(t))}},e}(y["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(11),s=n(o),u=i(8),l=i(25),h=n(l),d=function f(t,e){(0,a["default"])(this,f),this.ScaleList=[1e4],this.DevicePixelRatio=1,this.RCScale=3779.52,this.CenterPoint=new s["default"],this.TileSize=256,this.LookAt=new s["default"],this.ClickColor="FF0000",this.ScaleList=t.Scale_List||this.ScaleList,this.RCScale=t.RC_Scale||this.RCScale,this.EngineIP=e.EngineIP,this.DatumPoint=new s["default"]((-20037508.342789),20037508.342789,0,u.Const.EPSGType.EPSGWeb),t.DatumPoint&&this.DatumPoint.set(t.DatumPoint.x,t.DatumPoint.y,0,t.DatumPoint.EPSGType),t.CenterPoint&&(t.CenterPoint.z<1&&(t.CenterPoint.z=1e3),this.CenterPoint.set(t.CenterPoint.x,t.CenterPoint.y,t.CenterPoint.z,t.CenterPoint.EPSGType)),t.LookAt?this.LookAt.set(t.LookAt.x,t.LookAt.y,0,t.LookAt.EPSGType):e.LookAt?this.LookAt.set(e.LookAt.x,e.LookAt.y,0,e.LookAt.EPSGType||u.Const.EPSGType.EPSG84):this.LookAt.set(t.CenterPoint.x,t.CenterPoint.y,0,t.CenterPoint.EPSGType),this.DevicePixelRatio=1,h["default"].initConfig(this)};e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(283),s=n(o),u=i(13),l=function(){function t(e){(0,a["default"])(this,t),this.typeList={},this.earth=e,this.initEvents()}return t.prototype.initEvents=function(){this.earth.on(u.Events.Mouse.Drag,this.synPosition,this),this.earth.on(u.Events.Earth.CameraChange,this.synPosition,this),this.earth.on(u.Events.Earth.CenterChange,this.synPosition,this),this.earth.on(u.Events.Earth.ZoomChange,this.synPosition,this),this.earth.on(u.Events.Earth.Resize,this.synPosition,this)},t.prototype.synPosition=function(){this.menu&&this.menu.sysnMenu()},t.prototype.add=function(t,e,i,n){this.typeList[t]||(this.typeList[t]={}),this.typeList[t][e]={html:i,cls:n}},t.prototype.addType=function(t,e,i){this.typeList[t]={html:e,cls:i}},t.prototype.getTypeMenu=function(t){return this.typeList[t]},t.prototype.removeType=function(t,e){e?this.typeList[t]&&delete this.typeList[t][e]:delete this.typeList[t]},t.prototype.close=function(){this.menu&&this.menu.dispose(),this.menu=null},t.prototype.show=function(t,e,i){var n=t.userData.objType;n||(n=t.parent.userData.objType);var r=t.userData.id,a=this.typeList[n];if(a){var o=a[r],u=a.html,l=a.cls;o&&(u=o.html,l=o.cls),this.menu&&this.menu.dispose(),this.menu=new s["default"](t,e,i,u,l,this),this.menu.show()}},t.prototype.projectToScreen=function(t,e,i){return t.clone().projectToScreen(e,i.width,i.height)},t}();e["default"]=l,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(4),l=n(u),h=i(287),d=n(h),f=i(13),c=i(106),p=n(c),v=i(5),m=n(v),g=function(){function t(e){(0,s["default"])(this,t),this.typeList={},this.displayPops={},this.earth=e,this.initEvents()}return t.prototype.add=function(t,e,i,n){this.typeList[t]||(this.typeList[t]={}),this.typeList[t][e]={fn:i,cls:n}},t.prototype.addType=function(t,e,i){this.typeList[t]={fn:e,cls:i}},t.prototype.display=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.typeList[t]&&this.typeList[t][e]&&(this.typeList[t][e].display=!0,this.typeList[t][e].once=n),this.show(i,!0)},t.prototype.removeType=function(t,e){var i=this;e?this.typeList[t]&&(delete this.typeList[t][e],this.displayPops[t+"@"+e]&&(this.displayPops[t+"@"+e].dispose(),delete this.displayPops[t+"@"+e])):(delete this.typeList[t],(0,a["default"])(this.displayPops).map(function(e){e.indexOf(t)!=-1&&(i.displayPops[e].dispose(),delete i.displayPops[e])})),this.pop&&(this.pop.dispose(),this.pop=null)},t.prototype.synPosition=function(){var t=this;this.pop&&this.pop.sysnPop(),(0,a["default"])(this.displayPops).map(function(e){t.displayPops[e].sysnPop()})},t.prototype.close=function(){var t=this;this.pop&&(this.pop.dispose(),this.pop=null),(0,a["default"])(this.typeList).map(function(e){(0,a["default"])(t.typeList[e]).map(function(i){var n=t.typeList[e][i];n.once&&(t.displayPops[e+"@"+i].dispose(),delete t.displayPops[e+"@"+i],delete t.typeList[e][i])})})},t.prototype.show=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.parent.userData.objType,n=t.userData.id;if(!this.displayPops[i+"@"+n]){var r=this.initPopObj(i,n);if(r){var a=this.getModelCenter(t),o=new d["default"](t,a.p,a.off,r.fn,r.cls,this);e?this.displayPops[i+"@"+n]=o:(this.pop&&this.pop.dispose(),this.pop=o),o.show()}}},t.prototype.initEvents=function(){this.earth.on(f.Events.Mouse.Drag,this.synPosition,this),this.earth.on(f.Events.Earth.CameraChange,this.synPosition,this),this.earth.on(f.Events.Earth.CenterChange,this.synPosition,this),this.earth.on(f.Events.Earth.ZoomChange,this.synPosition,this),this.earth.on(f.Events.Earth.Resize,this.synPosition,this)},t.prototype.getModelCenter=function(t){var e=t.scale,i=t.position.clone();if(t instanceof p["default"]){var n=t.getMarkerSize();return{p:i,off:new m["default"](n.width/2,0)}}var r=t.geometry.computeBoundingSphereBox.getCenter();if("1"==t.userData.rotatex){var a=new l["default"](r.x,r.z,r.y);a.multiply(e),i.add(a);var o=t.geometry.computeBoundingSphereBox.getSize().y/2;i.z+=o*e.z}else{r.multiply(e),i.add(r);var s=t.geometry.computeBoundingSphereBox.getSize().z/2;i.z+=s*e.z}return{p:i,off:new m["default"](0,0)}},t.prototype.initPopObj=function(t,e){var i=this.typeList[t];if(!i)return null;var n=i[e],r=i.fn,a=i.cls;return n&&(r=n.fn,a=n.cls),{fn:r,cls:a}},t}();e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(227),s=n(o);s["default"].defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";var u=function(){function t(){(0,a["default"])(this,t)}return t.get=function(t,e,i){s["default"].get(t,i).then(function(t){null!=e&&e(t.data)})["catch"](function(t){var i={success:!1,message:t.message};null!=e&&e(i)})},t.post=function(t,e,i,n){s["default"].post(t,e,n).then(function(t){null!=i&&i(t.data)})["catch"](function(t){var e={success:!1,message:t.message};null!=i&&i(e)})},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(90),d=n(h),f=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.apply(this,arguments));return i.methods={},i}return(0,l["default"])(e,t),e.prototype.add=function(t,e){this.methods[t]?console.error("\u6ce8\u518c\u65b9\u6cd5\u51b2\u7a81:"+t,e):this.methods[t]=e},e.prototype.to=function(t){return this.methods[t]},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(65),d=n(h),f=i(16),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(){this.routes.add(f.Const.EventType.EarthConfig,this.getData.bind(this)),this.routes.add(f.Const.EventType.EarthLayers,this.getData.bind(this)),this.routes.add(f.Const.EventType.MapConfig,this.getData.bind(this)),this.routes.add(f.Const.EventType.MapLayers,this.getData.bind(this)),this.routes.add(f.Const.EventType.PlaceMarker,this.getData.bind(this)),this.routes.add(f.Const.EventType.FlyData,this.getData.bind(this)),this.routes.add(f.Const.EventType.NavData,this.getData.bind(this))},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(169),c=n(f),p=i(16),v=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.init=function(){this.routes.add(p.Const.DrawEventType.WorkerHotInit,this.drawInit.bind(this)),this.routes.add(p.Const.DrawEventType.WorkerHotDraw,this.syncDraw.bind(this)),this.routes.add(p.Const.DrawEventType.WorkerHotSizeChange,this.drawResize.bind(this)),this.routes.add(p.Const.DrawEventType.WorkerHotAdd,this.add.bind(this)),this.routes.add(p.Const.DrawEventType.WorkerHotDel,this.del.bind(this)),this.routes.add(p.Const.DrawEventType.WorkerColorAdd,this.addColor.bind(this))},e.prototype.add=function(t,e){this.workDatas||(this.workDatas={}),this.workDatas[t.uuid]||(this.workDatas[t.uuid]={}),this.workDatas[t.uuid].point||(this.workDatas[t.uuid].point=[]),this.workDatas[t.uuid].point.push(t.data)},e.prototype.addColor=function(t,e){this.colorPaint||(this.colorPaint={}),this.colorPaint[t.uuid]||(this.colorPaint[t.uuid]=[]),this.colorPaint[t.uuid]=t.data},e.prototype.del=function(t,e){var i=this;(0,a["default"])(this.workDatas).map(function(e){t.uuid==e&&(i.workDatas[t.uuid]={})})},e.prototype.syncDraw=function(t,e){var i=this;if(this.workDatas&&this.workDatas[t.uuid]){var n=this.workDatas[t.uuid].canvas;if(n){var r=n.getContext("2d");r.clearRect(0,0,n.width,n.height);var a=t.center,o=t.scale,s=this.workDatas[t.uuid].point,u=1/0,l=0;s.forEach(function(t){l=Math.max(l,t.value),u=Math.min(u,t.value)}),s.forEach(function(t){var e=Math.floor(9e3*t.size/o),s=i.getDev(t.coord,a,n,o);r.beginPath(),r.globalAlpha=(t.value-u)/(l-u),r.arc(s.x,s.y,e,0,Math.PI/2,!0);var h=r.createRadialGradient(s.x,s.y,0,s.x,s.y,e);h.addColorStop(0,"rgba(0,0,0,1)"),h.addColorStop(1,"rgba(0,0,0,0)"),r.fillStyle=h,r.closePath(),r.fill()});for(var h=r.getImageData(0,0,n.width,n.height),d=h.data,f=this.colorPaint[t.uuid],c=3;c<d.length;c+=4){var p=d[c],v=4*p;0!=v&&(d[c-3]=f[v],d[c-2]=f[v+1],d[c-1]=f[v+2])}r.putImageData(h,0,0)}}},e}(c["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(104),p=n(c),v=i(16),m=i(65),g=r(m),y=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.init=function(){this.routes.add(v.Const.EventType.InnerData,this.getInnerData.bind(this)),this.routes.add(v.Const.EventType.InnerBusinessData,this.getInnerData.bind(this)),this.routes.add(v.Const.EventType.FloorData,this.getData.bind(this)),this.routes.add(v.Const.EventType.GdeFloorData,this.getData.bind(this))},e.prototype.transData=function(t,e){t&&t.forEach(function(t){if(p[t.jsType]){var i=new p[t.jsType](t);t.shapes=i.getAttributes(e)}})},e.prototype.getInnerData=function(t){var e=this;this.getData(t,function(t){var i=[];return t.values&&(0,o["default"])(t.values).map(function(n){var r=t.values[n];e.transData(r.children,i)}),i})},e}(g["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(47),a=n(r),o=i(10),s=n(o),u=i(1),l=n(u),h=i(3),d=n(h),f=i(2),c=n(f),p=i(65),v=n(p),m=i(16),g=i(4),y=n(g),_=i(355),x=i(356),b=function(t){function e(){(0,l["default"])(this,e);var i=(0,d["default"])(this,t.apply(this,arguments));return i.arrayColide={},i.arrayPolymerize={},i.lasthides={},i}return(0,c["default"])(e,t),e.prototype.init=function(){this.routes.add(m.Const.EventType.Marker,this.getMarker.bind(this)),this.routes.add(m.Const.EventType.SynMarker,this.synMarker.bind(this)),this.routes.add(m.Const.EventType.ClusterParam,this.synClusterParam.bind(this)),this.routes.on("CameraChange",this.synPosition,this)},e.prototype.synMarker=function(t){if(this.arrayColide[t.userData.uuid]||(this.arrayColide[t.userData.uuid]={}),this.arrayPolymerize[t.userData.uuid]||(this.arrayPolymerize[t.userData.uuid]={}),"add"==t.action){var e=t.userData.position,i={};i.position=new y["default"](e[0],e[1],e[2]),i.size=t.userData.size,i.isTogether=t.userData.isTogether,i.id=t.userData.id,1==t.userData.isTogether?this.arrayColide[t.userData.uuid][t.userData.id]=i:2==t.userData.isTogether&&(this.arrayPolymerize[t.userData.uuid][t.userData.id]=i)}else"remove"==t.action&&(this.remove(this.arrayColide,t.userData.id),this.remove(this.arrayPolymerize,t.userData.id))},e.prototype.getMarker=function(t){this.socket.sendData(t,this.getMarkerCallBack.bind(this,t))},e.prototype.synClusterParam=function(t){this.pxRange||(this.pxRange=1),this.minCluster||(this.minCluster=2),this.pxRange=t.userData.pxRange,this.minCluster=t.userData.minCluster},e.prototype.synPosition=function(t,e){this.doCollide(t,e),this.doPolymerize(t,e)},e.prototype.getMarkerCallBack=function(t,e){e.applyData=t.applyData;var i=e.values,n=this.dataURLtoBlob(i.bos);e.url=URL.createObjectURL(n),e.width=i.width,e.height=i.height,delete e.values,this.self.postMessage(e,[])},e.prototype.dataURLtoBlob=function(t){for(var e=t.split(","),i=e[0].match(/:(.*?);/)[1],n=atob(e[1]),r=n.length,a=new Uint8Array(r);r--;)a[r]=n.charCodeAt(r);return new Blob([a],{type:i})},e.prototype.remove=function(t,e){(0,s["default"])(t).map(function(i){(0,s["default"])(t[i]).map(function(n){t[i][n].id==e&&delete t[i][n]}),0==(0,s["default"])(t[i]).length&&delete t[i]})},e.prototype.doCollide=function(t,e){var i=this;if(0!=(0,s["default"])(this.arrayColide).length){var n=(0,_.collide)(this.arrayColide,t,e);(0,s["default"])(n).map(function(t){if(void 0==i.lasthides[t]&&(i.lasthides[t]=[]),(0,a["default"])(i.lasthides[t])!==(0,a["default"])(n[t])){var e=i.lasthides[t].filter(function(e){return!n[t].some(function(t){return t.id===e.id})});e.forEach(function(t){t.show=!0});var r=n[t].concat(e);if(!(r.length<1)){var o={applyData:{fn:"MarkerSynService"},values:r,uuid:t};i.self.postMessage(o),i.lasthides[t]=n[t]}}})}},e.prototype.doPolymerize=function(t,e){var i=this;if(0!=(0,s["default"])(this.arrayPolymerize).length){var n=(0,x.polymerize)(this.arrayPolymerize,t,e,this.pxRange,this.minCluster);(0,s["default"])(n).map(function(t){var e=n[t],r={applyData:{fn:"MarkerPolySynService"},values:e,uuid:t+"_cluster"};i.self.postMessage(r)})}},e}(v["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(1),o=r(a),s=i(3),u=r(s),l=i(2),h=r(l),d=i(170),f=r(d),c=i(148),p=i(16),v=i(162),m=n(v),g=function(t){function e(){return(0,o["default"])(this,e),(0,u["default"])(this,t.apply(this,arguments))}return(0,h["default"])(e,t),e.prototype.init=function(){this.routes.add(p.Const.EventType.Osgb,this.getFile.bind(this));var t=new Uint8Array([0,97,115,109,1,0,0,0,1,132,128,128,128,0,1,96,0,0,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,148,128,128,128,0,2,6,109,101,109,111,114,121,2,0,7,97,110,97,108,121,115,101,0,0,10,219,128,128,128,0,1,213,128,128,128,0,1,1,127,65,0,40,2,12,65,31,58,0,0,65,0,40,2,12,65,139,1,58,0,1,65,0,40,2,12,65,8,58,0,2,65,0,40,2,12,65,8,58,0,3,65,0,40,2,12,34,0,66,227,157,154,226,165,224,255,179,233,0,55,0,4,32,0,65,243,220,188,147,6,54,0,12,32,0,65,234,0,59,0,16,11,11,138,128,128,128,0,1,0,65,12,11,4,0,0,0,0]),e=new this.self.WebAssembly.Module(t);this.wasmInstance=new this.self.WebAssembly.Instance(e,{env:{}}),this.wasmInstance.exports.analyse(),this.length=18},e.prototype.inflate=function(t){return(0,c.inflate)(t,{to:"string"})},e.prototype.inflateOsgb=function(t){var e=0,i=this.ByteToInt(new Uint8Array(t,e,4));e+=4;var n=(0,c.inflate)(t.slice(e,e+i),{to:"string"});e+=i;var r=this.ByteToInt(new Uint8Array(t,e,4));e+=4;var a=(0,c.inflate)(t.slice(e,e+r),{to:"string"});e+=r;var o={};return this.inflateJpgs(t.slice(e),o),{shapes:{mtl:n,obj:a,jpgs:o}}},e.prototype.inflateJpgs=function(t,e){var i=0,n=this.ByteToInt(new Uint8Array(t,i,4));i+=4;var r=this.ByteToInt(new Uint8Array(t,i,4));i+=4;var a=this.Utf8ArrayToStr(new Uint8Array(t,i,r));i+=r;var o=t.slice(i,i+n);i+=n,e[a+".jpg"]=o,i<t.byteLength&&this.inflateJpgs(t.slice(i),e)},e.prototype.getFile=function(t){var e=this,i=new XMLHttpRequest;t.gz&&(i.responseType="arraybuffer"),i.open(t.action,t.url);var n={success:!1,message:"",values:null,shapes:null,applyData:t.applyData};i.onload=function(r){var a=t.gz?r.target.response:r.target.responseText,o=[];if(m[t.type]){if(n.success=!0,t.gz)if("Mtl"===t.type){a=e.inflate(a);var s=new m[t.type](a,t.applyData.options);n.shapes=s.getAttributes(o)}else{a=e.inflateOsgb(a);var u=new m.Obj(a.shapes.obj),l=new m.Mtl(a.shapes.mtl);n.shapes={obj:u.getAttributes(o),mtl:l.getAttributes(o),images:a.shapes.jpgs}}}else console.warn("\u6a21\u578b\u89e3\u6790\u4e0d\u5b58\u5728:"+t.type),n.message="\u6a21\u578b\u89e3\u6790\u4e0d\u5b58\u5728:"+t.type;i.onload=null,e.self.postMessage(n,o)},i.onerror=function(){n.message="\u8bbf\u95ee\u51fa\u9519:"+t.url,e.self.postMessage(n,[])},i.send()},e.prototype.ByteToInt=function(t){return t.length<1?0:(255&t[0])<<24|(255&t[1])<<16|(255&t[2])<<8|255&t[3]},e.prototype.Utf8ArrayToStr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s="";for(n=t.length||t.byteLength,i=0;i<n;)switch(r=t[i++],r>>4){case 7:s+=String.fromCharCode(r);break;case 13:a=t[i++],s+=String.fromCharCode((31&r)<<6|63&a);break;case 14:a=t[i++],o=t[i++],s+=String.fromCharCode((15&r)<<12|(63&a)<<6|(63&o)<<0);break;default:s+=String.fromCharCode(r)}return""==s?e:s},e}(f["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(65),d=n(h),f=i(16),c=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(){this.routes.add(f.Const.EventType.PoiData,this.getData.bind(this))},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(104),p=n(c),v=i(65),m=r(v),g=i(16),y=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.init=function(){this.socket.on("RCData",this.updateRCData,this),this.routes.add(g.Const.EventType.RCData,this.getRCData.bind(this)),this.routes.add(g.Const.EventType.RC2DData,this.getData.bind(this)),this.routes.add(g.Const.EventType.DBData,this.getDBData.bind(this))},e.prototype.updateRCData=function(t){var e=this;t.applyData={fn:"RCService"};var i=[];t.values&&(0,o["default"])(t.values).map(function(n){var r=t.values[n];e.transData(r.add,i),e.transData(r.update,i)}),this.self.postMessage(t,i)},e.prototype.transData=function(t,e){t&&t.forEach(function(t){if(p[t.jsType]){var i=new p[t.jsType](t);t.shapes=i.getAttributes(e)}})},e.prototype.getRCData=function(t){var e=this;this.getData(t,function(t){var i=[];return t.values&&(0,o["default"])(t.values).map(function(n){var r=t.values[n];e.transData(r.add,i),e.transData(r.update,i)}),i})},e.prototype.getDBData=function(t){this.getRCData(t)},e}(m["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(49),s=n(o),u=i(4),l=n(u),h=i(16),d=function(){function t(e,i,n){(0,a["default"])(this,t),n.add(h.Const.EventType.SynCamera,this.synCamera.bind(this)),this.routes=n,this.camera=new s["default"]}return t.prototype.synCamera=function(t){var e=t.userData.info,i=t.userData.size;this.camera.aspect=e.aspect,this.camera.fov=e.fov,this.camera.far=e.far,this.camera.near=e.near,this.camera.up.set(e.up.x,e.up.y,e.up.z),this.camera.updateProjectionMatrix();var n=new l["default"](e.position[0],e.position[1],e.position[2]),r=new l["default"](e.target[0],e.target[1],e.target[2]);this.camera.position.copy(n),this.camera.lookAt(r),this.routes.fireEvent("CameraChange",this.camera,i)},t}();e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(16),c=i(169),p=n(c),v=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.num=3,i}return(0,d["default"])(e,t),e.prototype.init=function(){this.routes.add(f.Const.DrawEventType.WorkerRoadInit,this.drawInit.bind(this)),this.routes.add(f.Const.DrawEventType.WorkerRoadAdd,this.add.bind(this)),this.routes.add(f.Const.DrawEventType.WorkerRoadDel,this.del.bind(this)),this.routes.add(f.Const.DrawEventType.WorkerRoadDraw,this.syncDraw.bind(this)),this.routes.add(f.Const.DrawEventType.WorkerRoadSizeChange,this.drawResize.bind(this))},e.prototype.add=function(t,e){this.workDatas||(this.workDatas={}),this.workDatas[t.uuid]||(this.workDatas[t.uuid]={}),this.workDatas[t.uuid].arrays||(this.workDatas[t.uuid].arrays=[]),this.workDatas[t.uuid].arrays.push(t.data)},e.prototype.del=function(t,e){var i=this;(0,a["default"])(this.workDatas).map(function(e){if(t.uuid==e){var n=i.workDatas[t.uuid].arrays;n.splice(n.findIndex(function(e){return e.id==t.data.id}),1)}})},e.prototype.syncDraw=function(t,e){if(this.workDatas&&this.workDatas[t.uuid]){var i=this.workDatas[t.uuid].canvas;if(i){var n=i.getContext("2d");n.clearRect(0,0,i.width,i.height);for(var r=this.workDatas[t.uuid].arrays,a=t.center,o=t.scale,s=0;s<=this.num;s++)this.doDraw(n,r,a,o,i,s)}}},e.prototype.doDraw=function(t,e,i,n,r,a){var o=this;e.forEach(function(e){e.roadXY.forEach(function(s){t.beginPath(),t.strokeStyle="#"+e.color,0==a?(t.globalAlpha=.6,t.lineWidth=9e3*e.lineWidth/n,t.lineCap="round"):1==a?(t.globalAlpha=.4,t.lineWidth=4*e.lineWidth*9e3/n,t.lineCap="round"):2==a&&(t.globalAlpha=.2,t.lineWidth=6*e.lineWidth*9e3/n,t.lineCap="round"),t.lineWidth<1&&(t.lineWidth=1);var u=o.getDev(s[0],i,r,n),l=o.getDev(s[1],i,r,n);t.moveTo(u.x,u.y),t.lineTo(l.x,l.y),t.stroke(),t.closePath()})})},e}(p["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(345);Object.defineProperty(e,"Attr",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(348);Object.defineProperty(e,"Marker",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(351);Object.defineProperty(e,"RC",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(170);Object.defineProperty(e,"File",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(352);Object.defineProperty(e,"SynCamera",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(350);Object.defineProperty(e,"Poi",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(347);Object.defineProperty(e,"InnerData",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(353);Object.defineProperty(e,"Traffic",{enumerable:!0,get:function(){return n(d)["default"]}});var f=i(346);Object.defineProperty(e,"Hot",{enumerable:!0,get:function(){return n(f)["default"]}});var c=i(349);Object.defineProperty(e,"Osgb",{enumerable:!0,get:function(){return n(c)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,i,n){var r=n.clone().projectToScreen(e,i.width,i.height),a=t.size,o={};return o.x=r.x,o.y=r.y,o.width=a.width,o.height=a.height,
o.id=t.id,o}function a(t,e){var i=void 0,n=void 0,r=void 0,a=void 0;return i=t.x+t.width>=e.x+e.width?t.x+t.width:e.x+e.width,n=t.y+t.height>=e.y+e.height?t.y+t.height:e.y+e.height,r=t.x<=e.x?t.x:e.x,a=t.y<=e.y?t.y:e.y,i-r<=t.width+e.width&&n-a<=t.height+e.height}function o(t,e){for(var i=0;i<t.length;i++)if(e==t[i].id)return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.collide=void 0;var s=i(10),u=n(s),l=i(44),h=n(l);e.collide=function(t,e,i){var n={},s=[],l=[];(0,u["default"])(t).map(function(e){n[e]=[],(0,u["default"])(t[e]).map(function(i){t[e][i].uuid=e,s.push(t[e][i])})});for(var d=0;d<s.length;d++){if(1!=s[d].isTogether)return;var f=s[d].position;if(!o(l,s[d].id)&&h["default"].isPointInScreen(f,e))for(var c=0;c<s.length;c++)if(s[d].id!=s[c].id){var p=s[c].position;if(h["default"].isPointInScreen(p,e)){var v=r(s[d],e,i,f),m=r(s[c],e,i,p);if(a(v,m)){var g={};g.id=s[c].id,g.show=!1,l.push(g),n[s[c].uuid].push(g)}}}}return n}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,i){return i.clone().projectToScreen(t,e.width,e.height)}function a(t,e){for(var i=0;i<t.length;i++)if(e==t[i].id)return!0;return!1}function o(t,e,i){return t.distanceTo(e)<i}function s(t,e){var i={};i.id=e.id,i.position=e.position,t.push(i)}function u(t,e){var i=!1;return(0,h["default"])(t).map(function(n){a(t[n],e)&&(i=!0)}),i}Object.defineProperty(e,"__esModule",{value:!0}),e.polymerize=void 0;var l=i(10),h=n(l),d=i(44),f=n(d);e.polymerize=function(t,e,i,n,a){var l={},d={};return(0,h["default"])(t).map(function(e){l[e]=[],d[e]=[],(0,h["default"])(t[e]).map(function(i){d[e].push(t[e][i])})}),(0,h["default"])(d).map(function(t){for(var h=d[t],c=0;c<h.length;c++){if(2!=h[c].isTogether)return;var p=h[c].position;if(!u(l[t],h[c].id)){var v=[];if(f["default"].isPointInScreen(p,e))for(var m=0;m<h.length;m++)if(h[c].id!=h[m].id&&!u(l[t],h[m].id)){var g=h[m].position;if(f["default"].isPointInScreen(g,e)){var y=r(e,i,p),_=r(e,i,g);o(y,_,n)&&s(v,h[m])}}s(v,h[c]),v.length>a&&(l[t]||(l[t]={}),l[t][h[c].id]=v)}}}),l}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(9),s=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,a["default"])(this,t),this.mixer=e,this.clip=i,this.localRoot=n;for(var r=i.tracks,s=r.length,u=new Array(s),l={endingStart:o.ZeroCurvatureEnding,endingEnd:o.ZeroCurvatureEnding},h=0;h<s;h++){var d=r[h].createInterpolant(null);u[h]=d,d.settings=l}this.interpolantSettings=l,this.interpolants=u,this.propertyBindings=new Array(s),this.cacheIndex=null,this.byClipCacheIndex=null,this.timeScaleInterpolant=null,this.weightInterpolant=null,this.loop=o.LoopRepeat,this.loopCount=-1,this.startTime=null,this.time=0,this.timeScale=1,this.effectiveTimeScale=1,this.weight=1,this.effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return t.prototype.play=function(){return this.mixer.activateAction(this),this},t.prototype.stop=function(){return this.mixer.deactivateAction(this),this.reset()},t.prototype.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this.loopCount=-1,this.startTime=null,this.stopFading().stopWarping()},t.prototype.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this.startTime&&this.mixer.isActiveAction(this)},t.prototype.isScheduled=function(){return this.mixer.isActiveAction(this)},t.prototype.startAt=function(t){return this.startTime=t,this},t.prototype.setLoop=function(t,e){return this.loop=t,this.repetitions=e,this},t.prototype.setEffectiveWeight=function(t){return this.weight=t,this.effectiveWeight=this.enabled?t:0,this.stopFading()},t.prototype.getEffectiveWeight=function(){return this.effectiveWeight},t.prototype.fadeIn=function(t){return this.scheduleFading(t,0,1)},t.prototype.fadeOut=function(t){return this.scheduleFading(t,1,0)},t.prototype.crossFadeFrom=function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this.clip.duration,r=t._clip.duration,a=r/n,o=n/r;t.warp(1,a,e),this.warp(o,1,e)}return this},t.prototype.crossFadeTo=function(t,e,i){return t.crossFadeFrom(this,e,i)},t.prototype.stopFading=function(){var t=this.weightInterpolant;return null!==t&&(this.weightInterpolant=null,this.mixer.takeBackControlInterpolant(t)),this},t.prototype.setEffectiveTimeScale=function(t){return this.timeScale=t,this.effectiveTimeScale=this.paused?0:t,this.stopWarping()},t.prototype.getEffectiveTimeScale=function(){return this.effectiveTimeScale},t.prototype.setDuration=function(t){return this.timeScale=this.clip.duration/t,this.stopWarping()},t.prototype.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},t.prototype.halt=function(t){return this.warp(this.effectiveTimeScale,0,t)},t.prototype.warp=function(t,e,i){var n=this.mixer,r=n.time,a=this.timeScaleInterpolant,o=this.timeScale;null===a&&(a=n.lendControlInterpolant(),this.timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=r,s[1]=r+i,u[0]=t/o,u[1]=e/o,this},t.prototype.stopWarping=function(){var t=this.timeScaleInterpolant;return null!==t&&(this.timeScaleInterpolant=null,this.mixer.takeBackControlInterpolant(t)),this},t.prototype.scheduleFading=function(t,e,i){var n=this.mixer,r=n.time,a=this.weightInterpolant;null===a&&(a=n.lendControlInterpolant(),this.weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=i,this},t.prototype.update=function(t,e,i,n){if(!this.enabled)return void this.updateWeight(t);var r=this.startTime;if(null!==r){var a=(t-r)*i;if(a<0||0===i)return;this.startTime=null,e=i*a}e*=this.updateTimeScale(t);var o=this.updateTime(e),s=this.updateWeight(t);if(s>0)for(var u=this.interpolants,l=this.propertyBindings,h=0,d=u.length;h!==d;++h)u[h].evaluate(o),l[h].accumulate(n,s)},t.prototype.updateWeight=function(t){var e=0;if(this.enabled){e=this.weight;var i=this.weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this.effectiveWeight=e,e},t.prototype.updateTimeScale=function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this.timeScaleInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this.effectiveTimeScale=e,e},t.prototype.updateTime=function(t){var e=this.time+t,i=this.clip.duration,n=this.loop,r=this.loopCount,a=n===o.LoopPingPong;if(0===t)return r===-1?e:a&&1===(1&r)?i-e:e;if(n===o.LoopOnce){r===-1&&(this.loopCount=0,this.setEndings(!0,!0,!1));t:{if(e>=i)e=i;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.mixer.fireEvent("finished",{type:"finished",action:this,direction:t<0?-1:1})}}else{if(r===-1&&(t>=0?(r=0,this.setEndings(!0,0===this.repetitions,a)):this.setEndings(0===this.repetitions,!0,a)),e>=i||e<0){var s=Math.floor(e/i);e-=i*s,r+=Math.abs(s);var u=this.repetitions-r;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this.mixer.fireEvent("finished",{type:"finished",action:this,direction:t>0?1:-1});else{if(1===u){var l=t<0;this.setEndings(l,!l,a)}else this.setEndings(!1,!1,a);this.loopCount=r,this.mixer.fireEvent("loop",{type:"loop",action:this,loopDelta:s})}}if(a&&1===(1&r))return this.time=e,i-e}return this.time=e,e},t.prototype.setEndings=function(t,e,i){var n=this.interpolantSettings;i?(n.endingStart=o.ZeroSlopeEnding,n.endingEnd=o.ZeroSlopeEnding):(t?n.endingStart=this.zeroSlopeAtStart?o.ZeroSlopeEnding:o.ZeroCurvatureEnding:n.endingStart=o.WrapAroundEnding,e?n.endingEnd=this.zeroSlopeAtEnd?o.ZeroSlopeEnding:o.ZeroCurvatureEnding:n.endingEnd=o.WrapAroundEnding)},t}();e["default"]=s,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationMixer=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(171),d=n(h),f=i(357),c=n(f),p=i(90),v=n(p),m=i(7),g=n(m),y=i(122),_=i(360),x=n(_),b=i(359),M=n(b);e.AnimationMixer=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.root=i,n.initMemoryManager(),n.accuIndex=0,n.time=0,n.timeScale=1,n.controlInterpolantsResultBuffer=new Float32Array(1),n}return(0,l["default"])(e,t),e.prototype.bindAction=function(t,e){var i=t.localRoot||this.root,n=t.clip.tracks,r=n.length,a=t.propertyBindings,o=t.interpolants,s=i.uuid,u=this.bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var h=0;h!==r;++h){var d=n[h],f=d.name,c=l[f];if(void 0!==c)a[h]=c;else{if(c=a[h],void 0!==c){null===c.cacheIndex&&(++c.referenceCount,this.addInactiveBinding(c,s,f));continue}var p=e&&e.propertyBindings[h].binding.parsedPath;c=new x["default"](M["default"].create(i,f,p),d.ValueTypeName,d.getValueSize()),++c.referenceCount,this.addInactiveBinding(c,s,f),a[h]=c}o[h].resultBuffer=c.buffer}},e.prototype.activateAction=function(t){if(!this.isActiveAction(t)){if(null===t.cacheIndex){var e=(t.localRoot||this.root).uuid,i=t.clip.uuid,n=this.actionsByClip[i];this.bindAction(t,n&&n.knownActions[0]),this.addInactiveAction(t,i,e)}for(var r=t.propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0===s.useCount++&&(this.lendBinding(s),s.saveOriginalState())}this.lendAction(t)}},e.prototype.deactivateAction=function(t){if(this.isActiveAction(t)){for(var e=t.propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.useCount&&(r.restoreOriginalState(),this.takeBackBinding(r))}this.takeBackAction(t)}},e.prototype.initMemoryManager=function(){this.actions=[],this.nActiveActions=0,this.actionsByClip={},this.bindings=[],this.nActiveBindings=0,this.bindingsByRootAndName={},this.controlInterpolants=[],this.nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t.actions.length},get inUse(){return t.nActiveActions}},bindings:{get total(){return t.bindings.length},get inUse(){return t.nActiveBindings}},controlInterpolants:{get total(){return t.controlInterpolants.length},get inUse(){return t.nActiveControlInterpolants}}}},e.prototype.isActiveAction=function(t){var e=t.cacheIndex;return null!==e&&e<this.nActiveActions},e.prototype.addInactiveAction=function(t,e,i){var n=this.actions,r=this.actionsByClip,a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t.byClipCacheIndex=0,r[e]=a;else{var o=a.knownActions;t.byClipCacheIndex=o.length,o.push(t)}t.cacheIndex=n.length,n.push(t),a.actionByRoot[i]=t},e.prototype.removeInactiveAction=function(t){var e=this.actions,i=e[e.length-1],n=t.cacheIndex;i.cacheIndex=n,e[n]=i,e.pop(),t.cacheIndex=null;var r=t.clip.uuid,a=this.actionsByClip,o=a[r],s=o.knownActions,u=s[s.length-1],l=t.byClipCacheIndex;u.byClipCacheIndex=l,s[l]=u,s.pop(),t.byClipCacheIndex=null;var h=o.actionByRoot,d=(t.localRoot||this.root).uuid;delete h[d],0===s.length&&delete a[r],this.removeInactiveBindingsForAction(t)},e.prototype.removeInactiveBindingsForAction=function(t){for(var e=t.propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.referenceCount&&this.removeInactiveBinding(r)}},e.prototype.lendAction=function(t){var e=this.actions,i=t.cacheIndex,n=this.nActiveActions++,r=e[n];t.cacheIndex=n,e[n]=t,r.cacheIndex=i,e[i]=r},e.prototype.takeBackAction=function(t){var e=this.actions,i=t.cacheIndex,n=--this.nActiveActions,r=e[n];t.cacheIndex=n,e[n]=t,r.cacheIndex=i,e[i]=r},e.prototype.addInactiveBinding=function(t,e,i){var n=this.bindingsByRootAndName,r=n[e],a=this.bindings;void 0===r&&(r={},n[e]=r),r[i]=t,t.cacheIndex=a.length,a.push(t)},e.prototype.removeInactiveBinding=function(t){var e=this.bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,a=this.bindingsByRootAndName,o=a[n],s=e[e.length-1],u=t.cacheIndex;s.cacheIndex=u,e[u]=s,e.pop(),delete o[r];t:{for(var l in o)break t;delete a[n]}},e.prototype.lendBinding=function(t){var e=this.bindings,i=t.cacheIndex,n=this.nActiveBindings++,r=e[n];t.cacheIndex=n,e[n]=t,r.cacheIndex=i,e[i]=r},e.prototype.takeBackBinding=function(t){var e=this.bindings,i=t.cacheIndex,n=--this.nActiveBindings,r=e[n];t.cacheIndex=n,e[n]=t,r.cacheIndex=i,e[i]=r},e.prototype.lendControlInterpolant=function(){var t=this.controlInterpolants,e=this.nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new y.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this.controlInterpolantsResultBuffer),i._cachedIndex=e,t[e]=i),i},e.prototype.takeBackControlInterpolant=function(t){var e=this.controlInterpolants,i=t._cachedIndex,n=--this.nActiveControlInterpolants,r=e[n];t._cachedIndex=n,e[n]=t,r._cachedIndex=i,e[i]=r},e.prototype.clipAction=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root,i=e,n=i.uuid,r="string"==typeof t?d["default"].findByName(i,t):t,a=null!==r?r.uuid:t,o=this.actionsByClip[a],s=null;if(void 0!==o){var u=o.actionByRoot[n];if(void 0!==u)return u;s=o.knownActions[0],null===r&&(r=s.clip)}if(null===r)return null;var l=new c["default"](this,r,e);return this.bindAction(l,s),this.addInactiveAction(l,a,n),l},e.prototype.existingAction=function(t,e){var i=e||this.root,n=i.uuid,r="string"==typeof t?d["default"].findByName(i,t):t,a=r?r.uuid:t,o=this.actionsByClip[a];return void 0!==o?o.actionByRoot[n]||null:null},e.prototype.stopAllAction=function(){var t=this.actions,e=this.nActiveActions,i=this.bindings,n=this.nActiveBindings;this.nActiveActions=0,this.nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(var a=0;a!==n;++a)i[a].useCount=0;return this},e.prototype.update=function(t){t*=this.timeScale;for(var e=this.actions,i=this.nActiveActions,n=this.time+=t,r=g["default"].sign(t),a=this.accuIndex^=1,o=0;o!==i;++o){var s=e[o];s.update(n,t,r,a)}for(var u=this.bindings,l=this.nActiveBindings,h=0;h!==l;++h)u[h].apply(a);return this},e.prototype.getRoot=function(){return this.root},e.prototype.uncacheClip=function(t){var e=this.actions,i=t.uuid,n=this.actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this.deactivateAction(u);var l=u.cacheIndex,h=e[e.length-1];u.cacheIndex=null,u.byClipCacheIndex=null,h.cacheIndex=l,e[l]=h,e.pop(),this.removeInactiveBindingsForAction(u)}delete n[i]}},e.prototype.uncacheRoot=function(t){var e=t.uuid,i=this.actionsByClip;for(var n in i){var r=i[n].actionByRoot,a=r[e];void 0!==a&&(this.deactivateAction(a),this.removeInactiveAction(a))}var o=this.bindingsByRootAndName,s=o[e];if(void 0!==s)for(var u in s){var l=s[u];l.restoreOriginalState(),this.removeInactiveBinding(l)}},e.prototype.uncacheAction=function(t,e){var i=this.existingAction(t,e);null!==i&&(this.deactivateAction(i),this.removeInactiveAction(i))},e}(v["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Composite=e["default"]=void 0;var r=i(1),a=n(r),o="\\[\\]\\.:\\/",s=function(){},u=function(){},l=function(){function t(e,i,n){(0,a["default"])(this,t),this.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},this.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},this.path=i,this.parsedPath=n||t.parseTrackName(i),this.node=t.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e;var r=this;this.GetterByBindingType=[function(t,e){t[e]=r.node[r.propertyName]},function(t,e){for(var i=r.resolvedProperty,n=0,a=i.length;n!==a;++n)t[e++]=i[n]},function(t,e){t[e]=r.resolvedProperty[r.propertyIndex]},function(t,e){r.resolvedProperty.toArray(t,e)}],this.SetterByBindingTypeAndVersioning=[[function(t,e){r.targetObject[r.propertyName]=t[e]},function(t,e){r.targetObject[r.propertyName]=t[e],r.targetObject.needsUpdate=!0},function(t,e){r.targetObject[r.propertyName]=t[e],r.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=r.resolvedProperty,n=0,a=i.length;n!==a;++n)i[n]=t[e++]},function(t,e){for(var i=r.resolvedProperty,n=0,a=i.length;n!==a;++n)i[n]=t[e++];r.targetObject.needsUpdate=!0},function(t,e){for(var i=r.resolvedProperty,n=0,a=i.length;n!==a;++n)i[n]=t[e++];r.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){r.resolvedProperty[r.propertyIndex]=t[e]},function(t,e){r.resolvedProperty[r.propertyIndex]=t[e],r.targetObject.needsUpdate=!0},function(t,e){r.resolvedProperty[r.propertyIndex]=t[e],r.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){r.resolvedProperty.fromArray(t,e)},function(t,e){r.resolvedProperty.fromArray(t,e),r.targetObject.needsUpdate=!0},function(t,e){r.resolvedProperty.fromArray(t,e),r.targetObject.matrixWorldNeedsUpdate=!0}]],this.getValue=this.getValue_unbound,this.setValue=this.setValue_unbound}return t.prototype.getValue_unbound=function(t,e){this.bind(),this.getValue(t,e)},t.prototype.setValue_unbound=function(t,e){this.bind(),this.setValue(t,e)},t.prototype.bind=function(){var e=this.node,i=this.parsedPath,n=i.objectName,r=i.propertyName,a=i.propertyIndex;if(e||(e=t.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=e),this.getValue=s,this.setValue=u,!e)return void console.error("PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){var o=i.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var l=0;l<e.length;l++)if(e[l].name===o){o=l;break}break;default:if(void 0===e[n])return void console.error("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var h=e[r];if(void 0===h){var d=i.nodeName;return void console.error("PropertyBinding: Trying to update property for track: "+d+"."+r+" but it wasn't found.",e)}var f=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?f=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(f=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(var p=0;p<this.node.geometry.morphAttributes.position.length;p++)if(e.geometry.morphAttributes.position[p].name===a){a=p;break}}else{if(!e.geometry.morphTargets)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(var v=0;v<this.node.geometry.morphTargets.length;v++)if(e.geometry.morphTargets[v].name===a){a=v;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=a}else void 0!==h.fromArray&&void 0!==h.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(c=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][f]},t.prototype.unbind=function(){this.node=null,this.getValue=this.getValue_unbound,this.setValue=this.setValue_unbound},t.create=function(e,i,n){return e&&e.isAnimationObjectGroup?new t.Composite(e,i,n):new t(e,i,n)},t.sanitizeNodeName=function(t){var e=new RegExp("["+o+"]","g");return t.replace(/\s/g,"_").replace(e,"")},t.parseTrackName=function(t){var e="[^"+o+"]",i="[^"+o.replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",e),r=/(WCOD+)?/.source.replace("WCOD",i),a=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),s=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),u=new RegExp("^"+n+r+a+s+"$"),l=["material","materials","bones"],h=u.exec(t);if(!h)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var d={nodeName:h[2],objectName:h[3],objectIndex:h[4],propertyName:h[5],propertyIndex:h[6]},f=d.nodeName&&d.nodeName.lastIndexOf(".");if(void 0!==f&&f!==-1){var c=d.nodeName.substring(f+1);l.indexOf(c)!==-1&&(d.nodeName=d.nodeName.substring(0,f),d.objectName=c)}if(null===d.propertyName||0===d.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return d},t.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){var n=function a(t){for(var i=0;i<t.length;i++){var n=t[i];if(n.name===e||n.uuid===e)return n;var r=a(n.children);if(r)return r}return null},r=n(t.children);if(r)return r}return null},t}();e["default"]=l,l.Composite=h;var h=e.Composite=function(){function t(e,i,n){(0,a["default"])(this,t);var r=n||l.parseTrackName(i);this.targetGroup=e,this.bindings=e.subscribe(i,r)}return t.prototype.getValue=function(t,e){this.bind();var i=this.targetGroup.nCachedObjects_,n=this.bindings[i];void 0!==n&&n.getValue(t,e)},t.prototype.setValue=function(t,e){for(var i=this.bindings,n=this.targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},t.prototype.bind=function(){for(var t=this.bindings,e=this.targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},t.prototype.unbind=function(){for(var t=this.bindings,e=this.targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()},t}()},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(60),s=n(o),u=function(){function t(e,i,n){(0,a["default"])(this,t),this.binding=e,this.valueSize=n;var r=Float64Array,o=void 0;switch(i){case"quaternion":o=this.slerp;break;case"string":case"bool":r=Array,o=this.select;break;default:o=this.lerp}this.buffer=new r(4*n),this.mixBufferRegion=o,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}return t.prototype.accumulate=function(t,e){var i=this.buffer,n=this.valueSize,r=t*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)i[r+o]=i[o];a=e}else{a+=e;var s=e/a;this.mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=a},t.prototype.apply=function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*e;this.mixBufferRegion(i,n,o,1-r,e)}for(var s=e,u=e+e;s!==u;++s)if(i[s]!==i[s+e]){a.setValue(i,n);break}},t.prototype.saveOriginalState=function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var r=i,a=n;r!==a;++r)e[r]=e[n+r%i];this.cumulativeWeight=0},t.prototype.restoreOriginalState=function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},t.prototype.select=function(t,e,i,n,r){if(n>=.5)for(var a=0;a!==r;++a)t[e+a]=t[i+a]},t.prototype.slerp=function(t,e,i,n){s["default"].slerpFlat(t,e,t,e,t,i,n)},t.prototype.lerp=function(t,e,i,n,r){for(var a=1-n,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[i+o]*n}},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanKeyframeTrack=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(56),d=n(h),f=i(9);e.BooleanKeyframeTrack=function(t){function e(i,n,r){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,i,n,r))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(e,i,n,r){this.ValueTypeName="bool",this.ValueBufferType=Array,this.DefaultInterpolation=f.InterpolateDiscrete,this.InterpolantFactoryMethodLinear=void 0,this.InterpolantFactoryMethodSmooth=void 0,t.prototype.initAttributes.call(this,e,i,n,r)},e}(d["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ColorKeyframeTrack=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(56),d=n(h);e.ColorKeyframeTrack=function(t){function e(i,n,r){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,i,n,r))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(e,i,n,r){this.ValueTypeName="color",t.prototype.initAttributes.call(this,e,i,n,r)},e}(d["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.StringKeyframeTrack=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(56),d=n(h),f=i(9);e.StringKeyframeTrack=function(t){function e(i,n,r){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,i,n,r))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(e,i,n,r){this.ValueTypeName="string",this.ValueBufferType=Array,this.DefaultInterpolation=f.InterpolateDiscrete,this.InterpolantFactoryMethodLinear=void 0,this.InterpolantFactoryMethodSmooth=void 0,t.prototype.initAttributes.call(this,e,i,n,r)},e}(d["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(5),s=n(o),u=function(){function t(){(0,a["default"])(this,t),this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}return t.prototype.computeGroups=function(t){for(var e=void 0,i=[],n=void 0,r=t.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!=n&&(n=o.materialIndex,void 0!=e&&(e.count=3*a-e.start,i.push(e)),e={start:3*a,materialIndex:n})}void 0!=e&&(e.count=3*a-e.start,i.push(e)),this.groups=i},t.prototype.fromGeometry=function(t){var e=t.faces,i=t.vertices,n=t.faceVertexUvs,r=n[0]&&n[0].length>0,a=n[1]&&n[1].length>0,o=t.morphTargets,u=o.length,l=void 0;if(u>0){l=[];for(var h=0;h<u;h++)l[h]=[];this.morphTargets.position=l}var d=t.morphNormals,f=d.length,c=void 0;if(f>0){c=[];for(var p=0;p<f;p++)c[p]=[];this.morphTargets.normal=c}for(var v=t.skinIndices,m=t.skinWeights,g=v.length==i.length,y=m.length==i.length,_=0;_<e.length;_++){var x=e[_];this.vertices.push(i[x.a],i[x.b],i[x.c]);var b=x.vertexNormals;if(3==b.length)this.normals.push(b[0],b[1],b[2]);else{var M=x.normal;this.normals.push(M,M,M)}var w=x.vertexColors;if(3==w.length)this.colors.push(w[0],w[1],w[2]);else{var S=x.color;this.colors.push(S,S,S)}if(r){var P=n[0][_];void 0!=P?this.uvs.push(P[0],P[1],P[2]):this.uvs.push(new s["default"],new s["default"],new s["default"])}if(a){var A=n[1][_];void 0!=A?this.uvs2.push(A[0],A[1],A[2]):this.uvs2.push(new s["default"],new s["default"],new s["default"])}for(var C=0;C<u;C++){var T=o[C].vertices;l[C].push(T[x.a],T[x.b],T[x.c])}for(var E=0;E<f;E++){var D=d[E].vertexNormals[_];c[E].push(D.a,D.b,D.c)}g&&this.skinIndices.push(v[x.a],v[x.b],v[x.c]),y&&this.skinWeights.push(m[x.a],m[x.b],m[x.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(18),d=function(t){function e(i,n,r,o){(0,a["default"])(this,e),"number"==typeof r&&(o=r,r=!1);var u=(0,s["default"])(this,t.call(this,i,n,r));return u.meshPerAttribute=o||1,u}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},e}(h.BufferAttribute);e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t),this.mask=1}return t.prototype.set=function(t){this.mask=1<<t|0},t.prototype.enable=function(t){this.mask|=1<<t|0},t.prototype.toggle=function(t){this.mask^=1<<t|0},t.prototype.disable=function(t){this.mask&=~(1<<t|0)},t.prototype.test=function(t){return 0!=(this.mask&t.mask)},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(369),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setPositions=function(e){if(e){for(var i=e.length-3,n=new Float32Array(2*i),r=0;r<i;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return t.prototype.setPositions.call(this,n),this.addAttribute("originPosition",e),this}},e.prototype.setColors=function(e){if(e){for(var i=e.length-3,n=new Float32Array(2*i),r=0;r<i;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return t.prototype.setColors.call(this,n),this}},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(135),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(36),c=n(f),p=i(127),v=n(p),m=i(46),g=n(m),y=i(5),_=n(y),x={lineWidth:{value:1},resolution:{value:new _["default"](1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},b={uniforms:g["default"].mergeUniforms([v["default"].common,v["default"].fog,x]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\t\tuniform float lineWidth;\n\t\tuniform vec2 resolution;\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\t\tvarying vec2 vUv;\n\t\t#ifdef USE_DASH\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\t\t#endif\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; \n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; \n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\t\t}\n\t\tvoid main() {\n\t\t\t#ifdef USE_COLOR\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\t\t\t#endif\n\t\t\t#ifdef USE_DASH\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t#endif\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\t\t\tvUv = uv;\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\t\tif ( perspective ) {\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\t\t\t\t\ttrimSegment( start, end );\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\t\t\t\t\ttrimSegment( end, start );\n\t\t\t\t}\n\t\t\t}\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\t\t\tif ( position.y < 0.0 ) {\n\t\t\t\toffset += - dir;\n\t\t\t} else if ( position.y > 1.0 ) {\n\t\t\t\toffset += dir;\n\t\t\t}\n\t\t\toffset *= lineWidth;\n\t\t\toffset /= resolution.y;\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\t\t\toffset *= clip.w;\n\t\t\tclip.xy += offset;\n\t\t\tgl_Position = clip;\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; \n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\t\t}\n\t\t",
fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\t#ifdef USE_DASH\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\t\t#endif\n\t\tvarying float vLineDistance;\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\t#include <clipping_planes_fragment>\n\t\t\t#ifdef USE_DASH\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; \n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; \n\t\t\t#endif\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\t\t\t}\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t}\n\t\t"},M=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,{type:"LineMaterial",uniforms:g["default"].cloneUniforms(b.uniforms),vertexShader:b.vertexShader,fragmentShader:b.fragmentShader}));return n.dashed=!1,(0,a["default"])(n,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}}}),n.setValues(i),n}return(0,d["default"])(e,t),e}(c["default"]);e["default"]=M,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(380),d=n(h),f=i(69),c=n(f),p=i(50),v=n(p),m=i(4),g=n(m),y=i(18),_=i(177),x=n(_),b=i(109),M=n(b),w=i(66),S=n(w),P=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.call(this));i.computeBoundingBox3=new c["default"],i.computeBoundingSphereVector3=new g["default"],i.type="LineSegmentsGeometry";var n=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],r=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],o=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];return i.setIndex(o),i.addAttribute("position",new y.Float32BufferAttribute(n,3)),i.addAttribute("uv",new y.Float32BufferAttribute(r,2)),i}return(0,l["default"])(e,t),e.prototype.applyMatrix=function(t){var e=this.attributes.instanceStart,i=this.attributes.instanceEnd;return void 0!=e&&(t.applyToBufferAttribute(e),t.applyToBufferAttribute(i),e.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},e.prototype.setPositions=function(t){var e=void 0;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var i=new M["default"](e,6,1);return this.addAttribute("instanceStart",new S["default"](i,3,0)),this.addAttribute("instanceEnd",new S["default"](i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this.updateID(),this},e.prototype.setColors=function(t){var e=void 0;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var i=new M["default"](e,6,1);return this.addAttribute("instanceColorStart",new S["default"](i,3,0)),this.addAttribute("instanceColorEnd",new S["default"](i,3,3)),this},e.prototype.fromWireframeGeometry=function(t){return this.setPositions(t.attributes.position.array),this},e.prototype.fromEdgesGeometry=function(t){return this.setPositions(t.attributes.position.array),this},e.prototype.fromMesh=function(t){return this.fromWireframeGeometry(new d["default"](t.geometry)),this},e.prototype.fromLineSegements=function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},e.prototype.computeBoundingBox=function(){null==this.boundingBox&&(this.boundingBox=new c["default"]);var t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!=t&&void 0!=e&&(this.boundingBox.setFromBufferAttribute(t),this.computeBoundingBox3.setFromBufferAttribute(e),this.boundingBox.union(this.computeBoundingBox3))},e.prototype.computeBoundingSphere=function(){null==this.boundingSphere&&(this.boundingSphere=new v["default"]),null==this.boundingBox&&this.computeBoundingBox();var t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!=t&&void 0!=e){var i=this.boundingSphere.center;this.boundingBox.getCenter(i);for(var n=0,r=0,a=t.count;r<a;r++)this.computeBoundingSphereVector3.fromBufferAttribute(t,r),n=Math.max(n,i.distanceToSquared(this.computeBoundingSphereVector3)),this.computeBoundingSphereVector3.fromBufferAttribute(e,r),n=Math.max(n,i.distanceToSquared(this.computeBoundingSphereVector3));this.boundingSphere.radius=Math.sqrt(n)}},e}(x["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(4),s=n(o),u=i(371),l=n(u),h=function(){function t(e,i,n,r,o){(0,a["default"])(this,t),this.degree=e,this.knots=i,this.controlPoints=[],this.startKnot=r||0,this.endKnot=o||this.knots.length-1}return t.prototype.getPoints=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},t.prototype.getPoint=function(t){var e=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=l["default"].calcBSplinePoint(this.degree,this.knots,this.controlPoints,e);return 1!=i.w&&i.divideScalar(i.w),new s["default"](i.x,i.y,i.z)},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(45),s=n(o),u=function(){function t(){(0,a["default"])(this,t)}return t.calcBSplinePoint=function(t,e,i,n){for(var r=this.findSpan(t,n,e),a=this.calcBasisFunctions(r,n,t,e),o=new s["default"](0,0,0,0),u=0;u<=t;++u){var l=i[r-t+u],h=a[u],d=l.w*h;o.x+=l.x*d,o.y+=l.y*d,o.z+=l.z*d,o.w+=l.w*h}return o},t.calcBasisFunctions=function(t,e,i,n){var r=[],a=[],o=[];r[0]=1;for(var s=1;s<=i;++s){a[s]=e-n[t+1-s],o[s]=n[t+s]-e;for(var u=0,l=0;l<s;++l){var h=o[l+1],d=a[s-l],f=r[l]/(h+d);r[l]=u+h*f,u=d*f}r[s]=u}return r},t.findSpan=function(t,e,i){var n=i.length-t-1;if(e>=i[n])return n-1;if(e<=i[t])return t;for(var r=t,a=n,o=Math.floor((r+a)/2);e<i[o]||e>=i[o+1];)e<i[o]?a=o:r=o,o=Math.floor((r+a)/2);return o},t}();e["default"]=u,t.exports=e["default"]},function(t,e){"use strict";function i(t,e,i,n,r){var a,o;if(r===E(t,e,i,n)>0)for(a=e;a<i;a+=n)o=A(a,t[a],t[a+1],o);else for(a=i-n;a>=e;a-=n)o=A(a,t[a],t[a+1],o);return o&&x(o,o.next)&&(C(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);var i,n=t;do if(i=!1,n.steiner||!x(n,n.next)&&0!==_(n.prev,n,n.next))n=n.next;else{if(C(n),n=e=n.prev,n===n.next)break;i=!0}while(i||n!=e);return e}function r(t,e,i,l,h,d,f){if(t){!f&&d&&c(t,l,h,d);for(var p,v,m=t;t.prev!=t.next;)if(p=t.prev,v=t.next,d?o(t,l,h,d):a(t))e.push(p.i/i),e.push(t.i/i),e.push(v.i/i),C(t),t=v.next,m=v.next;else if(t=v,t===m){f?1===f?(t=s(t,e,i),r(t,e,i,l,h,d,2)):2===f&&u(t,e,i,l,h,d):r(n(t),e,i,l,h,d,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(_(e,i,n)>=0)return!1;for(var r=t.next.next;r!=t.prev;){if(g(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&_(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function o(t,e,i,n){var r=t.prev,a=t,o=t.next;if(_(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,u=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,l=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,h=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,d=v(s,u,e,i,n),f=v(l,h,e,i,n),c=t.nextZ;c&&c.z<=f;){if(c!=t.prev&&c!=t.next&&g(r.x,r.y,a.x,a.y,o.x,o.y,c.x,c.y)&&_(c.prev,c,c.next)>=0)return!1;c=c.nextZ}for(c=t.prevZ;c&&c.z>=d;){if(c!=t.prev&&c!=t.next&&g(r.x,r.y,a.x,a.y,o.x,o.y,c.x,c.y)&&_(c.prev,c,c.next)>=0)return!1;c=c.prevZ}return!0}function s(t,e,i){var n=t;do{var r=n.prev,a=n.next.next;!x(r,a)&&b(r,n,n.next,a)&&w(r,a)&&w(a,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(a.i/i),C(n),C(n.next),n=t=a),n=n.next}while(n!=t);return n}function u(t,e,i,a,o,s){var u=t;do{for(var l=u.next.next;l!=u.prev;){if(u.i!=l.i&&y(u,l)){var h=P(u,l);return u=n(u,u.next),h=n(h,h.next),r(u,e,i,a,o,s),void r(h,e,i,a,o,s)}l=l.next}u=u.next}while(u!=t)}function l(t,e,r,a){var o,s,u,l,f,c=[];for(o=0,s=e.length;o<s;o++)u=e[o]*a,l=o<s-1?e[o+1]*a:t.length,f=i(t,u,l,a,!1),f===f.next&&(f.steiner=!0),c.push(m(f));for(c.sort(h),o=0;o<c.length;o++)d(c[o],r),r=n(r,r.next);return r}function h(t,e){return t.x-e.x}function d(t,e){if(e=f(t,e)){var i=P(e,t);n(i,i.next)}}function f(t,e){var i,n=e,r=t.x,a=t.y,o=-(1/0);do{if(a<=n.y&&a>=n.next.y&&n.next.y!=n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if(o=s,s===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!=e);if(!i)return null;if(r===o)return i.prev;var u,l=i,h=i.x,d=i.y,f=1/0;for(n=i.next;n!=l;)r>=n.x&&n.x>=h&&r!=n.x&&g(a<d?r:o,a,h,d,a<d?o:r,a,n.x,n.y)&&(u=Math.abs(a-n.y)/(r-n.x),(u<f||u===f&&n.x>i.x)&&w(n,t)&&(i=n,f=u)),n=n.next;return i}function c(t,e,i,n){var r=t;do null===r.z&&(r.z=v(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!=t);r.prevZ.nextZ=null,r.prevZ=null,p(r)}function p(t){var e,i,n,r,a,o,s,u,l=1;do{for(i=t,t=null,a=null,o=0;i;){for(o++,n=i,s=0,e=0;e<l&&(s++,n=n.nextZ,n);e++);for(u=l;s>0||u>0&&n;)0!=s&&(0===u||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,u--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=n}a.nextZ=null,l*=2}while(o>1);return t}function v(t,e,i,n,r){return t=32767*(t-i)*r,e=32767*(e-n)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function m(t){var e=t,i=t;do e.x<i.x&&(i=e),e=e.next;while(e!=t);return i}function g(t,e,i,n,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(n-s)-(i-o)*(e-s)>=0&&(i-o)*(a-s)-(r-o)*(n-s)>=0}function y(t,e){return t.next.i!=e.i&&t.prev.i!=e.i&&!M(t,e)&&w(t,e)&&w(e,t)&&S(t,e)}function _(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,i,n){return!!(x(t,e)&&x(i,n)||x(t,n)&&x(i,e))||_(t,e,i)>0!=_(t,e,n)>0&&_(i,n,t)>0!=_(i,n,e)>0}function M(t,e){var i=t;do{if(i.i!=t.i&&i.next.i!=t.i&&i.i!=e.i&&i.next.i!=e.i&&b(i,i.next,t,e))return!0;i=i.next}while(i!=t);return!1}function w(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function S(t,e){var i=t,n=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do i.y>a!=i.next.y>a&&i.next.y!=i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!=t);return n}function P(t,e){var i=new T(t.i,t.x,t.y),n=new T(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function A(t,e,i,n){var r=new T(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function T(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,i,n){for(var r=0,a=e,o=i-n;a<i;a+=n)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}Object.defineProperty(e,"__esModule",{value:!0});e.Earcut={triangulate:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=e&&e.length,o=a?e[0]*n:t.length,s=i(t,0,o,n,!0),u=[];if(!s)return u;var h,d,f,c,p,v,m;if(a&&(s=l(t,e,s,n)),t.length>80*n){h=f=t[0],d=c=t[1];for(var g=n;g<o;g+=n)p=t[g],v=t[g+1],p<h&&(h=p),v<d&&(d=v),p>f&&(f=p),v>c&&(c=v);m=Math.max(f-h,c-d),m=0!=m?1/m:0}return r(s,u,n,h,d,m),u}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(57),d=n(h),f=i(112),c=n(f),p=i(182),v=n(p),m=i(375),g=n(m),y=i(183),_=n(y),x=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1},e.prototype.add=function(t){this.curves.push(t)},e.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new c["default"](e,t))},e.prototype.getPoint=function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var r=i[n]-e,a=this.curves[n],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}n++}return null},e.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},e.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},e.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},e.prototype.getSpacedPoints=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},e.prototype.getPoints=function(){for(var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,i=[],n=0,r=this.curves;n<r.length;n++)for(var a=r[n],o=a instanceof v["default"]?2*e:a instanceof c["default"]||a instanceof g["default"]?1:a instanceof _["default"]?e*a.points.length:e,s=a.getPoints(o),u=0;u<s.length;u++){var l=s[u];t&&t.equals(l)||(i.push(l),t=l)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.curves=[];for(var i=0,n=e.curves.length;i<n;i++){var r=e.curves[i];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},e}(d["default"]);e["default"]=x,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(5),d=n(h),f=i(57),c=n(f),p=i(111),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new d["default"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d["default"],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new d["default"],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new d["default"];(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));return u.type="CubicBezierCurve",u.v0=i,u.v1=n,u.v2=r,u.v3=o,u}return(0,l["default"])(e,t),e.prototype.getPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d["default"],i=this.v0,n=this.v1,r=this.v2,a=this.v3;return e.set((0,p.CubicBezier)(t,i.x,n.x,r.x,a.x),(0,p.CubicBezier)(t,i.y,n.y,r.y,a.y)),e},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},e}(c["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(57),d=n(h),f=i(4),c=n(f),p=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c["default"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"];(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this));return r.type="LineCurve3",r.v1=i,r.v2=n,r}return(0,l["default"])(e,t),e.prototype.getPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"];return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},e.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(57),d=n(h),f=i(5),c=n(f),p=i(111),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c["default"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new c["default"];(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o.type="QuadraticBezierCurve",o.v0=i,o.v1=n,o.v2=r,o}return(0,l["default"])(e,t),e.prototype.getPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c["default"],i=this.v0,n=this.v1,r=this.v2;return e.set((0,p.QuadraticBezier)(t,i.x,n.x,r.x),(0,p.QuadraticBezier)(t,i.y,n.y,r.y)),e},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.material=i,n.render=function(){},n}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.CircleBufferGeometry=e.CircleGeometry=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(23),d=n(h),f=i(15),c=n(f),p=i(18),v=i(4),m=n(v),g=i(5),y=n(g),_=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));return u.type="CircleGeometry",u.parameters={radius:i,segments:n,thetaStart:r,thetaLength:o},u.fromBufferGeometry(new x(i,n,r,o)),u.mergeVertices(),u}return(0,l["default"])(e,t),e}(d["default"]),x=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));u.type="CircleBufferGeometry",u.parameters={radius:i,segments:n,thetaStart:r,thetaLength:o},i=i||1,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI;var l,h,d=[],f=[],c=[],v=[],g=new m["default"],_=new y["default"];for(f.push(0,0,0),c.push(0,0,1),v.push(.5,.5),h=0,l=3;h<=n;h++,l+=3){var x=r+h/n*o;g.x=i*Math.cos(x),g.y=i*Math.sin(x),f.push(g.x,g.y,g.z),c.push(0,0,1),_.x=(f[l]/i+1)/2,_.y=(f[l+1]/i+1)/2,v.push(_.x,_.y)}for(l=1;l<=n;l++)d.push(l,l+1,0);return u.setIndex(d),u.addAttribute("position",new p.Float32BufferAttribute(f,3)),u.addAttribute("normal",new p.Float32BufferAttribute(c,3)),u.addAttribute("uv",new p.Float32BufferAttribute(v,2)),u}return(0,l["default"])(e,t),e}(c["default"]);e.CircleGeometry=_,e.CircleBufferGeometry=x},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.SphereBufferGeometry=e.SphereGeometry=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(23),d=n(h),f=i(15),c=n(f),p=i(4),v=n(p),m=i(18),g=function(t){function e(i,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,a["default"])(this,e);var d=(0,s["default"])(this,t.call(this));return d.type="SphereGeometry",d.parameters={radius:i,widthSegments:n,heightSegments:r,phiStart:o,phiLength:u,thetaStart:l,thetaLength:h},d.fromBufferGeometry(new y(i,n,r,o,u,l,h)),d.mergeVertices(),d}return(0,l["default"])(e,t),e}(d["default"]),y=function(t){function e(i,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,a["default"])(this,e);var d=(0,s["default"])(this,t.call(this));d.type="SphereBufferGeometry",d.parameters={radius:i,widthSegments:n,heightSegments:r,phiStart:o,phiLength:u,thetaStart:l,thetaLength:h},i=i||1,n=Math.max(3,Math.floor(n)||8),r=Math.max(2,Math.floor(r)||6),o=o,u=u,l=l,h=h;var f,c,p=l+h,g=0,y=[],_=new v["default"],x=new v["default"],b=[],M=[],w=[],S=[];for(c=0;c<=r;c++){var P=[],A=c/r;for(f=0;f<=n;f++){var C=f/n;_.x=-i*Math.cos(o+C*u)*Math.sin(l+A*h),_.y=i*Math.cos(l+A*h),_.z=i*Math.sin(o+C*u)*Math.sin(l+A*h),M.push(_.x,_.y,_.z),x.set(_.x,_.y,_.z).normalize(),w.push(x.x,x.y,x.z),S.push(C,1-A),P.push(g++)}y.push(P)}for(c=0;c<r;c++)for(f=0;f<n;f++){var T=y[c][f+1],E=y[c][f],D=y[c+1][f],L=y[c+1][f+1];(0!==c||l>0)&&b.push(T,E,L),(c!==r-1||p<Math.PI)&&b.push(E,D,L)}return d.setIndex(b),d.addAttribute("position",new m.Float32BufferAttribute(M,3)),d.addAttribute("normal",new m.Float32BufferAttribute(w,3)),d.addAttribute("uv",new m.Float32BufferAttribute(S,2)),d}return(0,l["default"])(e,t),e}(c["default"]);e.SphereGeometry=g,e.SphereBufferGeometry=y},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(15),d=n(h),f=i(18),c=i(4),p=n(c),v=i(23),m=n(v),g=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));n.type="WireframeGeometry";var r=[],o=void 0,u=void 0,l=void 0,h=void 0,c=void 0,v=[0,0],g={},y=void 0,_=void 0,x=void 0,b=void 0,M=["a","b","c"],w=void 0;if(i instanceof m["default"]){var S=i.faces;for(o=0,l=S.length;o<l;o++){var P=S[o];for(u=0;u<3;u++)_=P[M[u]],x=P[M[(u+1)%3]],v[0]=Math.min(_,x),v[1]=Math.max(_,x),b=v[0]+","+v[1],void 0==g[b]&&(g[b]={index1:v[0],index2:v[1]})}for(b in g)y=g[b],w=i.vertices[y.index1],r.push(w.x,w.y,w.z),w=i.vertices[y.index2],r.push(w.x,w.y,w.z)}else if(i instanceof d["default"]){var A=void 0,C=void 0,T=void 0,E=void 0,D=void 0,L=void 0,F=void 0,k=void 0;if(w=new p["default"],null!=i.index){for(A=i.attributes.position,C=i.index,T=i.groups,0==T.length&&(T=[{start:0,count:C.count,materialIndex:0}]),h=0,c=T.length;h<c;++h)for(E=T[h],D=E.start,L=E.count,o=D,l=D+L;o<l;o+=3)for(u=0;u<3;u++)_=C.getX(o+u),x=C.getX(o+(u+1)%3),v[0]=Math.min(_,x),v[1]=Math.max(_,x),b=v[0]+","+v[1],void 0==g[b]&&(g[b]={index1:v[0],index2:v[1]});for(b in g)y=g[b],w.fromBufferAttribute(A,y.index1),r.push(w.x,w.y,w.z),w.fromBufferAttribute(A,y.index2),r.push(w.x,w.y,w.z)}else for(A=i.attributes.position,o=0,l=A.count/3;o<l;o++)for(u=0;u<3;u++)F=3*o+u,w.fromBufferAttribute(A,F),r.push(w.x,w.y,w.z),k=3*o+(u+1)%3,w.fromBufferAttribute(A,k),r.push(w.x,w.y,w.z)}return n.addAttribute("position",new f.Float32BufferAttribute(r,3)),n}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.CameraHelper=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(18),d=i(15),f=n(d),c=i(93),p=n(c),v=i(12),m=n(v),g=i(4),y=n(g),_=i(193),x=n(_),b=i(9),M=i(108),w=n(M);e.CameraHelper=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,null,null));return n.vertices=[],n.colors=[],n.pointMap={},n.camera=i,n.vector=new y["default"],n.vCamera=new w["default"],n.initLines(),n}return(0,l["default"])(e,t),e.prototype.initDefaultGeo=function(t,e){this.geometry=new f["default"],this.material=new p["default"]({color:16777215,vertexColors:b.FaceColors})},e.prototype.initLines=function(){var t=new m["default"](16755200),e=new m["default"](16711680),i=new m["default"](43775),n=new m["default"](16777215),r=new m["default"](3355443);this.addLine("n1","n2",t),this.addLine("n2","n4",t),this.addLine("n4","n3",t),this.addLine("n3","n1",t),this.addLine("f1","f2",t),this.addLine("f2","f4",t),this.addLine("f4","f3",t),this.addLine("f3","f1",t),this.addLine("n1","f1",t),this.addLine("n2","f2",t),this.addLine("n3","f3",t),this.addLine("n4","f4",t),this.addLine("p","n1",e),this.addLine("p","n2",e),this.addLine("p","n3",e),this.addLine("p","n4",e),this.addLine("u1","u2",i),this.addLine("u2","u3",i),this.addLine("u3","u1",i),this.addLine("c","t",n),this.addLine("p","c",r),this.addLine("cn1","cn2",r),this.addLine("cn3","cn4",r),this.addLine("cf1","cf2",r),this.addLine("cf3","cf4",r),this.geometry.addAttribute("position",new h.Float32BufferAttribute(this.vertices,3)),this.geometry.addAttribute("color",new h.Float32BufferAttribute(this.colors,3)),this.matrix=this.camera.matrixWorld,this.vector=new y["default"],this.matrixAutoUpdate=!1},e.prototype.addLine=function(t,e,i){this.addPoint(t,i),this.addPoint(e,i)},e.prototype.addPoint=function(t,e){this.vertices.push(0,0,0),this.colors.push(e.r,e.g,e.b),void 0==this.pointMap[t]&&(this.pointMap[t]=[]),this.pointMap[t].push(this.vertices.length/3-1)},e.prototype.setPoint=function(t,e,i,n){this.vector.set(e,i,n),this.vector.unproject(this.vCamera);var r=this.pointMap[t];if(void 0!=r)for(var a=this.geometry.getAttribute("position"),o=0,s=r.length;o<s;o++)a.setXYZ(r[o],this.vector.x,this.vector.y,this.vector.z)},e.prototype.update=function(){this.vCamera.projectionMatrix.copy(this.camera.projectionMatrix);var t=1,e=1;this.setPoint("c",0,0,-1),this.setPoint("t",0,0,1),this.setPoint("n1",-t,-e,-1),this.setPoint("n2",t,-e,-1),this.setPoint("n3",-t,e,-1),this.setPoint("n4",t,e,-1),this.setPoint("f1",-t,-e,1),this.setPoint("f2",t,-e,1),this.setPoint("f3",-t,e,1),this.setPoint("f4",t,e,1),this.setPoint("u1",.7*t,1.1*e,-1),this.setPoint("u2",.7*-t,1.1*e,-1),this.setPoint("u3",0,2*e,-1),this.setPoint("cf1",-t,0,1),this.setPoint("cf2",t,0,1),this.setPoint("cf3",0,-e,1),this.setPoint("cf4",0,e,1),this.setPoint("cn1",-t,0,-1),this.setPoint("cn2",t,0,-1),this.setPoint("cn3",0,-e,-1),this.setPoint("cn4",0,e,-1),this.geometry.getAttribute("position").needsUpdate=!0},e}(x["default"])},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(115),d=n(h),f=i(81),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.call(this,new c["default"]((-1024),1024,1024,(-1024),1,500)))}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(59),d=n(h),f=i(4),c=n(f),p=i(12),v=n(p),m=function(t){function e(i,n,r){(0,a["default"])(this,e);var o=(0,s["default"])(this,t.call(this,i,r));return o.type="HemisphereLight",o.castShadow=void 0,o.position=new c["default"](0,1,0),o.updateMatrix(),o.groundColor=new v["default"](n),o}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(59),d=n(h),f=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this,i,n));return u.type="RectAreaLight",u.width=r,u.height=o,u}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(93),d=n(h),f=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.type="LineDashedMaterial",n.scale=1,n.dashSize=3,n.gapSize=1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(26),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setDigArea=function(t,e,i){},e.prototype.clearDigArea=function(){},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(9),c=i(5),p=n(c),v=i(12),m=n(v),g=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.defines={MATCAP:""},n.type="MeshMatcapMaterial",n.color=new m["default"](16777215),n.matcap=null,n.map=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=f.TangentSpaceNormalMap,n.normalScale=new p["default"](1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.lights=!1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(9),c=i(5),p=n(c),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,
s["default"])(this,t.call(this));return n.type="MeshNormalMaterial",n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=f.TangentSpaceNormalMap,n.normalScale=new p["default"](1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLineWidth=1,n.fog=!1,n.lights=!1,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLineWidth=e.wireframeLineWidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(118),d=n(h),f=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.defines={PHYSICAL:""},n.type="MeshPhysicalMaterial",n.reflectivity=.5,n.clearCoat=0,n.clearCoatRoughness=0,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(82),d=n(h),f=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.defines={TOON:""},n.type="MeshToonMaterial",n.gradientMap=null,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(32),d=n(h),f=i(12),c=n(f),p=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n.type="ShadowMaterial",n.color=new c["default"](0),n.transparent=!0,n.setValues(i),n}return(0,l["default"])(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,a["default"])(this,t),this.radius=e,this.phi=i,this.theta=n,this}return t.prototype.set=function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},t.prototype.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},t.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},t.prototype.setFromCartesianCoords=function(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),0==this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(s["default"].clamp(e/this.radius,-1,1))),this},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(83),d=n(h),f=i(9),c=function(t){function e(i,n,r,o){(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this,i,n,r,o));return u._weightPrev=-0,u._offsetPrev=-0,u._weightNext=-0,u._offsetNext=-0,u.DefaultSettings={endingStart:f.ZeroCurvatureEnding,endingEnd:f.ZeroCurvatureEnding},u}return(0,l["default"])(e,t),e.prototype.interpolate=function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=s-o,l=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,c=(i-e)/(n-e),p=c*c,v=p*c,m=-d*v+2*d*p-d*c,g=(1+d)*v+(-1.5-2*d)*p+(-.5+d)*c+1,y=(-1-f)*v+(1.5+f)*p+.5*c,_=f*v-f*p,x=0;x!==o;++x)r[x]=m*a[l+x]+g*a[u+x]+y*a[s+x]+_*a[h+x];return r},e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(83),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.interpolate=function(t){return this.copySampleValue(t-1)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(83),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.interpolate=function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=s-o,l=(i-e)/(n-e),h=1-l,d=0;d!==o;++d)r[d]=a[u+d]*h+a[s+d]*l;return r},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(83),d=n(h),f=i(60),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.interpolate=function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=(i-e)/(n-e),l=s+o;s!==l;s+=4)c["default"].slerpFlat(r,0,a,s-o,a,s,u);return r},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Bone",this.isBone=!0},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(20),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Group"},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(61),d=n(h),f=function(t){function e(i,n){(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this,i,n,null));return r.type="LineLoop",r}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(14),s=n(o),u=function(){function t(e,i){if((0,a["default"])(this,t),e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===i)this.calculateInverses();else if(this.bones.length===i.length)this.boneInverses=i.slice(0);else{console.warn("Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new s["default"])}}return t.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new s["default"];this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},t.prototype.pose=function(){var t=void 0,e=void 0,i=void 0;for(e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},t.prototype.getBoneByName=function(t){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e];if(n.name===t)return n}},t.prototype.update=function(){for(var t=new s["default"],e=new s["default"],i=this.bones,n=this.boneInverses,r=this.boneMatrices,a=this.boneTexture,o=0,u=i.length;o<u;o++){var l=i[o]?i[o].matrixWorld:e;t.multiplyMatrices(l,n[o]),t.toArray(r,16*o)}void 0!==a&&(a.needsUpdate=!0)},t.prototype.clone=function(){return new t(this.bones,this.boneInverses)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(9),s=i(38),u=n(s),l=i(402),h=i(196),d=n(h),f=i(124),c=function(){function t(e,i){if((0,a["default"])(this,t),this.renderer=e,void 0===i){var n={minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBAFormat,stencilBuffer:!1},r=e.getDrawingBufferSize();i=new u["default"](r.width,r.height,n),i.texture.name="EffectComposer.rt1"}this.renderTarget1=i,this.renderTarget2=i.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],this.copyPass=new d["default"](f.CopyShader)}return t.prototype.swapBuffers=function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},t.prototype.addPass=function(t){this.passes.push(t);var e=this.renderer.getDrawingBufferSize();t.setSize(e.width,e.height)},t.prototype.isHasPass=function(t){var e=!1;return this.passes.forEach(function(i){if(i instanceof t)return void(e=!0)}),e},t.prototype.insertPass=function(t,e){this.passes.splice(e,0,t)},t.prototype.render=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!1,i=void 0,n=void 0,r=this.passes.length;for(n=0;n<r;n++)if(i=this.passes[n],0!=i.enabled){if(i.render(this.renderer,this.writeBuffer,this.readBuffer,t,e),i.needsSwap){if(e){var a=this.renderer.context;a.stencilFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),a.stencilFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}i instanceof l.MaskPass?e=!0:i instanceof l.ClearMaskPass&&(e=!1)}},t.prototype.reset=function(t){if(void 0===t){var e=this.renderer.getDrawingBufferSize();t=this.renderTarget1.clone(),t.setSize(e.width,e.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},t.prototype.setSize=function(t,e){t*=2,e*=2,this.renderTarget1.setSize(t,e),this.renderTarget2.setSize(t,e);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(t,e)},t}();e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ClearMaskPass=e.MaskPass=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(84),d=n(h),f=function(t){function e(i,n){(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this));return r.scene=i,r.camera=n,r.clear=!0,r.needsSwap=!1,r.inverse=!1,r}return(0,l["default"])(e,t),e.prototype.render=function(t,e,i,n,r){var a=t.context,o=t.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);var s,u;this.inverse?(s=0,u=1):(s=1,u=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,s,4294967295),o.buffers.stencil.setClear(u),t.render(this.scene,this.camera,i,this.clear),t.render(this.scene,this.camera,e,this.clear),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP)},e}(d["default"]),c=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.call(this));return i.needsSwap=!1,i}return(0,l["default"])(e,t),e.prototype.render=function(t,e,i,n,r){t.state.buffers.stencil.setTest(!1)},e}(d["default"]);e.MaskPass=f,e.ClearMaskPass=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(81),d=n(h),f=i(58),c=i(26),p=n(c),v=i(117),m=n(v),g=i(36),y=n(g),_=i(12),x=n(_),b=i(14),M=n(b),w=i(5),S=n(w),P=i(4),A=n(P),C=i(61),T=n(C),E=i(24),D=n(E),L=i(195),F=n(L),k=i(46),I=n(k),O=i(38),N=n(O),R=i(95),U=n(R),B=i(9),j=i(84),z=n(j),G=i(124),V=function(t){function e(){function i(t,e){var i=e.isPerspectiveCamera?"perspective":"orthographic";return t.replace(/DEPTH_TO_VIEW_Z/g,i+"DepthToViewZ")}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new S["default"](256,256),r=arguments[1],o=arguments[2],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];(0,a["default"])(this,e);var l=(0,s["default"])(this,t.call(this));l.renderScene=r,l.renderCamera=o,l.selectedObjects=u,l.visibleEdgeColor=new x["default"](1,0,0),l.hiddenEdgeColor=new x["default"](0,0,0),l.edgeGlow=0,l.usePatternTexture=!1,l.edgeThickness=1,l.edgeStrength=3,l.downSampleRatio=2,l.pulsePeriod=2,l.resolution=n;var h={minFilter:B.LinearFilter,magFilter:B.LinearFilter,format:B.RGBAFormat},c=Math.round(l.resolution.x/l.downSampleRatio),v=Math.round(l.resolution.y/l.downSampleRatio);l.maskBufferMaterial=new p["default"]({color:16777215}),l.maskBufferMaterial.side=B.DoubleSide,l.renderTargetMaskBuffer=new N["default"](l.resolution.x,l.resolution.y,h),l.renderTargetMaskBuffer.texture.name="OutlinePass.mask",l.renderTargetMaskBuffer.texture.generateMipmaps=!1,l.depthMaterial=new m["default"],l.depthMaterial.side=B.DoubleSide,l.depthMaterial.depthPacking=B.RGBADepthPacking,l.depthMaterial.blending=B.NoBlending,l.prepareMaskMaterial=l.getPrepareMaskMaterial(),l.prepareMaskMaterial.side=B.DoubleSide,l.prepareMaskMaterial.fragmentShader=i(l.prepareMaskMaterial.fragmentShader,l.renderCamera),l.renderTargetDepthBuffer=new N["default"](l.resolution.x,l.resolution.y,h),l.renderTargetDepthBuffer.texture.name="OutlinePass.depth",l.renderTargetDepthBuffer.texture.generateMipmaps=!1,l.renderTargetMaskDownSampleBuffer=new N["default"](c,v,h),l.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",l.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,l.renderTargetBlurBuffer1=new N["default"](c,v,h),l.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",l.renderTargetBlurBuffer1.texture.generateMipmaps=!1,l.renderTargetBlurBuffer2=new N["default"](Math.round(c/2),Math.round(v/2),h),l.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",l.renderTargetBlurBuffer2.texture.generateMipmaps=!1,l.edgeDetectionMaterial=l.getEdgeDetectionMaterial(),l.renderTargetEdgeBuffer1=new N["default"](c,v,h),l.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",l.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,l.renderTargetEdgeBuffer2=new N["default"](Math.round(c/2),Math.round(v/2),h),l.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",l.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;var g=4,_=4;l.separableBlurMaterial1=l.getSeperableBlurMaterial(g),l.separableBlurMaterial1.uniforms.texSize.value=new S["default"](c,v),l.separableBlurMaterial1.uniforms.kernelRadius.value=1,l.separableBlurMaterial2=l.getSeperableBlurMaterial(_),l.separableBlurMaterial2.uniforms.texSize.value=new S["default"](Math.round(c/2),Math.round(v/2)),l.separableBlurMaterial2.uniforms.kernelRadius.value=_,l.overlayMaterial=l.getOverlayMaterial();var b=G.CopyShader;return l.copyUniforms=I["default"].cloneUniforms(b.uniforms),l.copyUniforms.opacity.value=1,l.materialCopy=new y["default"]({uniforms:l.copyUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,blending:B.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),l.enabled=!0,l.needsSwap=!1,l.oldClearColor=new x["default"],l.oldClearAlpha=1,l.camera=new d["default"]((-1),1,1,(-1),0,1),l.scene=new U["default"],l.quad=new D["default"](new f.PlaneBufferGeometry(2,2),null),l.quad.frustumCulled=!1,l.scene.add(l.quad),l.tempPulseColor1=new x["default"],l.tempPulseColor2=new x["default"],l.textureMatrix=new M["default"],l}return(0,l["default"])(e,t),e.prototype.dispose=function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},e.prototype.setSize=function(t,e){this.renderTargetMaskBuffer.setSize(t,e);var i=Math.round(t/this.downSampleRatio),n=Math.round(e/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,n),this.renderTargetBlurBuffer1.setSize(i,n),this.renderTargetEdgeBuffer1.setSize(i,n),this.separableBlurMaterial1.uniforms.texSize.value=new S["default"](i,n),i=Math.round(i/2),n=Math.round(n/2),this.renderTargetBlurBuffer2.setSize(i,n),this.renderTargetEdgeBuffer2.setSize(i,n),this.separableBlurMaterial2.uniforms.texSize.value=new S["default"](i,n)},e.prototype.changeVisibilityOfSelectedObjects=function(t){function e(e){e instanceof D["default"]&&(t?(e.visible=e.userData.oldVisible,delete e.userData.oldVisible):(e.userData.oldVisible=e.visible,e.visible=t))}for(var i=0;i<this.selectedObjects.length;i++){var n=this.selectedObjects[i];n.traverse(e)}},e.prototype.changeVisibilityOfNonSelectedObjects=function(t){function e(t){t instanceof D["default"]&&n.push(t)}function i(e){if(e instanceof D["default"]||e instanceof T["default"]||e instanceof F["default"]){for(var i=!1,r=0;r<n.length;r++){var a=n[r].id;if(a===e.id){i=!0;break}}if(!i){var o=e.visible;t&&!e.bVisible||(e.visible=t),e.bVisible=o}}}for(var n=[],r=0;r<this.selectedObjects.length;r++){var a=this.selectedObjects[r];a.traverse(e)}this.renderScene.traverse(i)},e.prototype.updateTextureMatrix=function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},e.prototype.render=function(t,e,i,n,r){if(this.selectedObjects.length>0){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var a=t.autoClear;t.autoClear=!1,r&&t.context.disable(t.context.STENCIL_TEST),t.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var o=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,t.render(this.renderScene,this.renderCamera,this.renderTargetDepthBuffer,!0),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new S["default"](this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,t.render(this.renderScene,this.renderCamera,this.renderTargetMaskBuffer,!0),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=o,this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,t.render(this.scene,this.camera,this.renderTargetMaskDownSampleBuffer,!0),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.quad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new S["default"](this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,t.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=new S["default"](1,0),this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,t.render(this.scene,this.camera,this.renderTargetBlurBuffer1,!0),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=new S["default"](0,1),t.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=new S["default"](1,0),t.render(this.scene,this.camera,this.renderTargetBlurBuffer2,!0),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=new S["default"](0,1),t.render(this.scene,this.camera,this.renderTargetEdgeBuffer2,!0),this.quad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,r&&t.context.enable(t.context.STENCIL_TEST),t.render(this.scene,this.camera,i,!1),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=a}this.renderToScreen&&(this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,t.render(this.scene,this.camera))},e.prototype.getPrepareMaskMaterial=function(){return new y["default"]({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new S["default"](.5,.5)},textureMatrix:{value:new M["default"]}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},e.prototype.getEdgeDetectionMaterial=function(){return new y["default"]({uniforms:{maskTexture:{value:null},texSize:{value:new S["default"](.5,.5)},visibleEdgeColor:{value:new A["default"](1,0,0)},hiddenEdgeColor:{value:new A["default"](0,0,0)}},vertexShader:"varying vec2 vUv;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\t\tuniform sampler2D maskTexture;\t\t\t\t\tuniform vec2 texSize;\t\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t\t}"})},e.prototype.getSeperableBlurMaterial=function(t){return new y["default"]({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new S["default"](.5,.5)},direction:{value:new S["default"](.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\t\tvarying vec2 vUv;\t\t\t\t\tuniform sampler2D colorTexture;\t\t\t\t\tuniform vec2 texSize;\t\t\t\t\tuniform vec2 direction;\t\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t\t}\t\t\t\t\tvoid main() {\t\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t\t}\t\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t\t}"})},e.prototype.getOverlayMaterial=function(){return new y["default"]({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\t\tuniform sampler2D maskTexture;\t\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\t\tuniform sampler2D patternTexture;\t\t\t\t\tuniform float edgeStrength;\t\t\t\t\tuniform float edgeGlow;\t\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t\t}",blending:B.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})},e}(z["default"]);e["default"]=V,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(84),d=n(h),f=function(t){function e(i,n,r){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,a["default"])(this,e);var l=(0,s["default"])(this,t.call(this));return l.scene=i,l.camera=n,l.overrideMaterial=r,l.clearColor=o,l.clearAlpha=u,l.clear=!0,l.clearDepth=!1,l.needsSwap=!1,l}return(0,l["default"])(e,t),e.prototype.render=function(t,e,i,n,r){var a=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var o,s;this.clearColor&&(o=t.getClearColor().getHex(),s=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.render(this.scene,this.camera,this.renderToScreen?null:i,this.clear),this.clearColor&&t.setClearColor(o,s),this.scene.overrideMaterial=null,t.autoClear=a},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(81),d=n(h),f=i(58),c=i(26),p=n(c),v=i(36),m=n(v),g=i(12),y=n(g),_=i(5),x=n(_),b=i(4),M=n(b),w=i(24),S=n(w),P=i(46),A=n(P),C=i(38),T=n(C),E=i(95),D=n(E),L=i(9),F=i(84),k=n(F),I=i(124),O=i(407),N=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments[2],o=arguments[3];(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));u.strength=n,u.radius=r,u.threshold=o,u.resolution=void 0!==i?new x["default"](i.x,i.y):new x["default"](256,256),u.clearColor=new y["default"](0,0,0);var l={minFilter:L.LinearFilter,magFilter:L.LinearFilter,format:L.RGBAFormat};u.renderTargetsHorizontal=[],u.renderTargetsVertical=[],u.nMips=5;var h=Math.round(u.resolution.x/2),c=Math.round(u.resolution.y/2);u.renderTargetBright=new T["default"](h,c,l),u.renderTargetBright.texture.name="UnrealBloomPass.bright",u.renderTargetBright.texture.generateMipmaps=!1;for(var v=0;v<u.nMips;v++){var g=new T["default"](h,c,l);g.texture.name="UnrealBloomPass.h"+v,g.texture.generateMipmaps=!1,u.renderTargetsHorizontal.push(g);var _=new T["default"](h,c,l);_.texture.name="UnrealBloomPass.v"+v,_.texture.generateMipmaps=!1,u.renderTargetsVertical.push(_),h=Math.round(h/2),c=Math.round(c/2)}var b=O.LuminosityHighPassShader;u.highPassUniforms=A["default"].cloneUniforms(b.uniforms),u.highPassUniforms.luminosityThreshold.value=o,u.highPassUniforms.smoothWidth.value=.01,u.materialHighPassFilter=new m["default"]({uniforms:u.highPassUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,defines:{}}),u.separableBlurMaterials=[];for(var w=[3,5,7,9,11],h=Math.round(u.resolution.x/2),c=Math.round(u.resolution.y/2),v=0;v<u.nMips;v++)u.separableBlurMaterials.push(u.getSeperableBlurMaterial(w[v])),
u.separableBlurMaterials[v].uniforms.texSize.value=new x["default"](h,c),h=Math.round(h/2),c=Math.round(c/2);u.compositeMaterial=u.getCompositeMaterial(u.nMips),u.compositeMaterial.uniforms.blurTexture1.value=u.renderTargetsVertical[0].texture,u.compositeMaterial.uniforms.blurTexture2.value=u.renderTargetsVertical[1].texture,u.compositeMaterial.uniforms.blurTexture3.value=u.renderTargetsVertical[2].texture,u.compositeMaterial.uniforms.blurTexture4.value=u.renderTargetsVertical[3].texture,u.compositeMaterial.uniforms.blurTexture5.value=u.renderTargetsVertical[4].texture,u.compositeMaterial.uniforms.bloomStrength.value=n,u.compositeMaterial.uniforms.bloomRadius.value=.1,u.compositeMaterial.needsUpdate=!0;var P=[1,.8,.6,.4,.2];u.compositeMaterial.uniforms.bloomFactors.value=P,u.bloomTintColors=[new M["default"](1,1,1),new M["default"](1,1,1),new M["default"](1,1,1),new M["default"](1,1,1),new M["default"](1,1,1)],u.compositeMaterial.uniforms.bloomTintColors.value=u.bloomTintColors;var C=I.CopyShader;return u.copyUniforms=A["default"].cloneUniforms(C.uniforms),u.copyUniforms.opacity.value=1,u.materialCopy=new m["default"]({uniforms:u.copyUniforms,vertexShader:C.vertexShader,fragmentShader:C.fragmentShader,blending:L.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),u.enabled=!0,u.needsSwap=!1,u.oldClearColor=new y["default"],u.oldClearAlpha=1,u.camera=new d["default"]((-1),1,1,(-1),0,1),u.scene=new D["default"],u.basic=new p["default"],u.quad=new S["default"](new f.PlaneBufferGeometry(2,2),null),u.quad.frustumCulled=!1,u.scene.add(u.quad),u}return(0,l["default"])(e,t),e.prototype.dispose=function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(var t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},e.prototype.setSize=function(t,e){var i=Math.round(t/2),n=Math.round(e/2);this.renderTargetBright.setSize(i,n);for(var r=0;r<this.nMips;r++)this.renderTargetsHorizontal[r].setSize(i,n),this.renderTargetsVertical[r].setSize(i,n),this.separableBlurMaterials[r].uniforms.texSize.value=new x["default"](i,n),i=Math.round(i/2),n=Math.round(n/2)},e.prototype.render=function(t,e,i,n,r){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var a=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),r&&t.context.disable(t.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=i.texture,t.render(this.scene,this.camera,void 0,!0)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.quad.material=this.materialHighPassFilter,t.render(this.scene,this.camera,this.renderTargetBright,!0);for(var o=this.renderTargetBright,s=0;s<this.nMips;s++)this.quad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=o.texture,this.separableBlurMaterials[s].uniforms.direction.value=new x["default"](1,0),t.render(this.scene,this.camera,this.renderTargetsHorizontal[s],!0),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=new x["default"](0,1),t.render(this.scene,this.camera,this.renderTargetsVertical[s],!0),o=this.renderTargetsVertical[s];this.quad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.render(this.scene,this.camera,this.renderTargetsHorizontal[0],!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,r&&t.context.enable(t.context.STENCIL_TEST),this.renderToScreen?t.render(this.scene,this.camera,void 0,!1):t.render(this.scene,this.camera,i,!1),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=a},e.prototype.getSeperableBlurMaterial=function(t){return new m["default"]({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new x["default"](.5,.5)},direction:{value:new x["default"](.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\t\tvarying vec2 vUv;\n\t\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\t\tuniform vec2 texSize;\t\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t\t}\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t\t}\t\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t\t}"})},e.prototype.getCompositeMaterial=function(t){return new m["default"]({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\t\tuniform float bloomStrength;\t\t\t\t\tuniform float bloomRadius;\t\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t\t}"})},e}(k["default"]);e["default"]=N,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.FXAAShader=void 0;var r=i(5),a=n(r);e.FXAAShader={uniforms:{tDiffuse:{value:null},resolution:{value:new a["default"](1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","#define FXAA_GREEN_AS_LUMA 1","#ifndef FXAA_PC_CONSOLE","    #define FXAA_PC_CONSOLE 0","#endif","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","#ifndef FXAA_GREEN_AS_LUMA","    #define FXAA_GREEN_AS_LUMA 0","#endif","#ifndef FXAA_EARLY_EXIT","    #define FXAA_EARLY_EXIT 1","#endif","#ifndef FXAA_DISCARD","    #define FXAA_DISCARD 0","#endif","#ifndef FXAA_FAST_PIXEL_OFFSET","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","#ifndef FXAA_GATHER4_ALPHA","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","#ifndef FXAA_QUALITY_PRESET","    #define FXAA_QUALITY_PRESET 12","#endif","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","#if (FXAA_GLSL_120 == 1)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","#if (FXAA_GLSL_130 == 1)","    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","#if (FXAA_PC == 1)","FxaaFloat4 FxaaPixelShader(","    FxaaFloat2 pos,","    FxaaFloat4 fxaaConsolePosPos,","    FxaaTex tex,","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    FxaaFloat2 fxaaQualityRcpFrame,","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    FxaaFloat fxaaQualitySubpix,","    FxaaFloat fxaaQualityEdgeThreshold,","    FxaaFloat fxaaQualityEdgeThresholdMin,","    FxaaFloat fxaaConsoleEdgeSharpness,","    FxaaFloat fxaaConsoleEdgeThreshold,","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    FxaaFloat4 fxaaConsole360ConstDir",") {","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","                    }","                    #endif","                }","                #endif","            }","            #endif","        }","        #endif","    }","    #endif","                        }","                        #endif","                    }","                    #endif","                }","                #endif","            }","            #endif","        }","        #endif","    }","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")
}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.LuminosityHighPassShader=void 0;var r=i(12),a=n(r);e.LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{type:"t",value:null},luminosityThreshold:{type:"f",value:1},smoothWidth:{type:"f",value:1},defaultColor:{type:"c",value:new a["default"](0)},defaultOpacity:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(365),s=n(o),u=i(177),l=n(u),h=i(109),d=n(h),f=i(66),c=n(f),p=i(377),v=n(p),m=i(59),g=n(m),y=i(93),_=n(y),x=i(385),b=n(x),M=i(26),w=n(M),S=i(117),P=n(S),A=i(188),C=n(A),T=i(68),E=n(T),D=i(387),L=n(D),F=i(388),k=n(F),I=i(82),O=n(I),N=i(389),R=n(N),U=i(118),B=n(U),j=i(390),z=n(j),G=i(189),V=n(G),W=i(190),X=n(W),H=i(36),Y=n(H),q=i(391),Q=n(q),Z=i(191),K=n(Z),J=i(120),$=n(J),tt=i(7),et=n(tt),it=i(14),nt=n(it),rt=i(4),at=n(rt),ot=i(45),st=n(ot),ut=i(61),lt=n(ut),ht=i(399),dt=n(ht),ft=i(193),ct=n(ft),pt=i(24),vt=n(pt),mt=i(123),gt=n(mt),yt=i(195),_t=n(yt),xt=i(569),bt=n(xt),Mt=i(128),wt=n(Mt),St=i(129),Pt=n(St),At=i(199),Ct=n(At),Tt=i(9),Et=i(197),Dt=i(46),Lt=n(Dt),Ft=i(546),kt=n(Ft),It=i(547),Ot=n(It),Nt=i(548),Rt=n(Nt),Ut=i(549),Bt=n(Ut),jt=i(550),zt=n(jt),Gt=i(551),Vt=n(Gt),Wt=i(552),Xt=n(Wt),Ht=i(553),Yt=n(Ht),qt=i(554),Qt=n(qt),Zt=i(555),Kt=n(Zt),Jt=i(557),$t=n(Jt),te=i(558),ee=n(te),ie=i(560),ne=n(ie),re=i(561),ae=n(re),oe=i(562),se=i(563),ue=i(565),le=n(ue),he=i(566),de=i(567),fe=n(de),ce=i(198),pe=i(568),ve=n(pe),me=i(38),ge=n(me),ye=i(125),_e=n(ye),xe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a["default"])(this,t),this.params=e,this.domElement=document.createElement("canvas");var i=this.initContextAttributes(e);if(this.onContextLostFn=this.onContextLost.bind(this),this.onContextRestoreFn=this.onContextRestore.bind(this),this.domElement.addEventListener("webglcontextlost",this.onContextLostFn,!1),this.domElement.addEventListener("webglcontextrestored",this.onContextRestoreFn,!1),this.gl=this.domElement.getContext("webgl",i)||this.domElement.getContext("experimental-webgl",i),null==this.gl)throw new Error("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301WebGL\u529f\u80fd,\u8bf7\u4f7f\u7528\u6700\u65b0\u7248\u672c\u6d4f\u89c8\u5668,\u63a8\u8350\u4f7f\u7528Chrome69+");void 0==this.gl.getShaderPrecisionFormat&&(this.gl.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),this.initAttributes(),this.initGLContext()}return t.prototype.initAttributes=function(){this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=1.5,this.gammaInput=!0,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Tt.LinearToneMapping,this.toneMappingExposure=1.5,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.currentScissor=new st["default"],this.currentViewport=new st["default"],this.scissor=new st["default"](0,0,this.domElement.width,this.domElement.height),this.viewport=new st["default"](0,0,this.domElement.width,this.domElement.height),this.pixelRatio=1,this.frustum=new $["default"],this.clipping=new Vt["default"],this.clippingEnabled=!1,this.projScreenMatrix=new nt["default"],this.vector3=new at["default"],this.animation=new kt["default"],this.currentGeometryProgram={geometry:null,program:null,wireframe:!1}},t.prototype.onContextLost=function(t){t.preventDefault(),this.isContextLost=!0},t.prototype.onContextRestore=function(){this.isContextLost=!1,this.initGLContext()},t.prototype.initContextAttributes=function(t){this.premultipliedAlpha=void 0==t.premultipliedAlpha||t.premultipliedAlpha;var e=t.alpha||!1,i=void 0==t.depth||t.depth,n=void 0==t.stencil||t.stencil,r=t.antialias||!1,a=t.preserveDrawingBuffer||!1,o=t.powerPreference||"default",s={alpha:e,depth:i,stencil:n,antialias:r,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:a,powerPreference:o};return s},t.prototype.initGLContext=function(){this.extensions=new Xt["default"](this.gl),this.extensions.get("WEBGL_depth_texture"),this.extensions.get("OES_texture_float"),this.extensions.get("OES_texture_half_float"),this.extensions.get("OES_texture_half_float_linear"),this.extensions.get("OES_standard_derivatives"),this.extensions.get("OES_element_index_uint"),this.extensions.get("ANGLE_instanced_arrays"),this.extensions.get("OES_texture_float_linear"),this.utils=new ve["default"](this.gl,this.extensions),this.capabilities=new zt["default"](this.gl,this.extensions,this.params),this.state=new he.WebGLState(this.gl,this.extensions,this.utils,this.capabilities),this.state.scissor(this.currentScissor.copy(this.scissor).multiplyScalar(this.pixelRatio)),this.state.viewport(this.currentViewport.copy(this.viewport).multiplyScalar(this.pixelRatio)),this.info=new Kt["default"](this.gl),this.properties=new ae["default"],this.textures=new fe["default"](this.gl,this.extensions,this.state,this.properties,this.capabilities,this.utils,this.info),this.attributes=new Ot["default"](this.gl),this.geometries=new Yt["default"](this.gl,this.attributes,this.info),this.objects=new ee["default"](this.geometries,this.info),this.morphtargets=new $t["default"](this.gl),this.programCache=new ne["default"](this,this.extensions,this.capabilities),this.renderLists=new oe.WebGLRenderLists,this.renderStates=new se.WebGLRenderStates,this.background=new Rt["default"](this,this.state,this.objects,this.premultipliedAlpha),this.bufferRenderer=new Bt["default"](this.gl,this.extensions,this.info,this.capabilities),this.indexedBufferRenderer=new Qt["default"](this.gl,this.extensions,this.info,this.capabilities),this.info.programs=this.programCache.programs,this.shadowMap=new le["default"](this,this.objects,this.capabilities.maxTextureSize)},t.prototype.getDrawingBufferSize=function(){return{width:this.domElement.width*this.pixelRatio,height:this.domElement.height*this.pixelRatio}},t.prototype.setDrawingBufferSize=function(t,e,i){this.pixelRatio=i,this.setSize(t,e,!1)},t.prototype.setPixelRatio=function(t){this.pixelRatio=t,this.setSize(this.domElement.width,this.domElement.height,!1)},t.prototype.setScissor=function(t,e,i,n){this.scissor.set(t,this.domElement.height-e-n,i,n),this.state.scissor(this.currentScissor.copy(this.scissor).multiplyScalar(this.pixelRatio))},t.prototype.setScissorTest=function(t){this.state.setScissorTest(this.scissorTest=t)},t.prototype.getClearColor=function(){return this.background.getClearColor()},t.prototype.setClearColor=function(t,e){this.background.setClearColor(t,e)},t.prototype.getClearAlpha=function(){return this.background.getClearAlpha()},t.prototype.setClearAlpha=function(t){this.background.setClearAlpha(t)},t.prototype.setSize=function(t,e,i){this.domElement.width=t,this.domElement.height=e,i&&(this.domElement.style.width=t+"px",this.domElement.style.height=e+"px"),this.setViewport(0,0,t,e)},t.prototype.setViewport=function(t,e,i,n){this.viewport.set(t,this.domElement.height-e-n,i,n),this.state.viewport(this.currentViewport.copy(this.viewport).multiplyScalar(this.pixelRatio))},t.prototype.clear=function(t,e,i){var n=0;(void 0==t||t)&&(n|=this.gl.COLOR_BUFFER_BIT),(void 0==e||e)&&(n|=this.gl.DEPTH_BUFFER_BIT),(void 0==i||i)&&(n|=this.gl.STENCIL_BUFFER_BIT),this.gl.clear(n)},t.prototype.clearColor=function(){this.clear(!0,!1,!1)},t.prototype.clearDepth=function(){this.clear(!1,!0,!1)},t.prototype.clearStencil=function(){this.clear(!1,!1,!0)},t.prototype.dispose=function(){this.isContextLost=!0,this.domElement.removeEventListener("webglcontextlost",this.onContextLostFn,!1),this.domElement.removeEventListener("webglcontextrestored",this.onContextRestoreFn,!1),this.renderLists.dispose(),this.renderStates.dispose(),this.properties.dispose(),this.objects.dispose(),this.animation.stop()},t.prototype.onMaterialDispose=function(t){var e=t;e.off("dispose",this.onMaterialDispose,this),this.deallocateMaterial(e)},t.prototype.deallocateMaterial=function(t){this.releaseMaterialProgramReference(t),this.properties.remove(t)},t.prototype.releaseMaterialProgramReference=function(t){var e=this.properties.get(t).program;t.program=void 0,void 0!=e&&this.programCache.releaseProgram(e)},t.prototype.renderObjectImmediate=function(t,e){var i=this;t.render(function(t){i.renderBufferImmediate(t,e)})},t.prototype.renderBufferImmediate=function(t,e){this.state.initAttributes();var i=this.properties.get(t);t.hasPositions&&!i.position&&(i.position=this.gl.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=this.gl.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=this.gl.createBuffer()),t.hasColors&&!i.color&&(i.color=this.gl.createBuffer());var n=e.getAttributes();t.hasPositions&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i.position),this.gl.bufferData(this.gl.ARRAY_BUFFER,t.positionArray,this.gl.DYNAMIC_DRAW),this.state.enableAttribute(n.position),this.gl.vertexAttribPointer(n.position,3,this.gl.FLOAT,!1,0,0)),t.hasNormals&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i.normal),this.gl.bufferData(this.gl.ARRAY_BUFFER,t.normalArray,this.gl.DYNAMIC_DRAW),this.state.enableAttribute(n.normal),this.gl.vertexAttribPointer(n.normal,3,this.gl.FLOAT,!1,0,0)),t.hasUvs&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,t.uvArray,this.gl.DYNAMIC_DRAW),this.state.enableAttribute(n.uv),this.gl.vertexAttribPointer(n.uv,2,this.gl.FLOAT,!1,0,0)),t.hasColors&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i.color),this.gl.bufferData(this.gl.ARRAY_BUFFER,t.colorArray,this.gl.DYNAMIC_DRAW),this.state.enableAttribute(n.color),this.gl.vertexAttribPointer(n.color,3,this.gl.FLOAT,!1,0,0)),this.state.disableUnusedAttributes(),this.gl.drawArrays(this.gl.TRIANGLES,0,t.count),t.count=0},t.prototype.renderBufferDirect=function(t,e,i,n,r,a){var o=r instanceof vt["default"]&&r.normalMatrix.determinant()<0;this.state.setMaterial(n,o);var s=this.setProgram(t,e,n,r),u=!1;this.currentGeometryProgram.geometry==i.id&&this.currentGeometryProgram.program==s.id&&this.currentGeometryProgram.wireframe==(1==n.wireframe)||(this.currentGeometryProgram.geometry=i.id,this.currentGeometryProgram.program=s.id,this.currentGeometryProgram.wireframe=1==n.wireframe,u=!0),r.morphTargetInfluences&&(this.morphtargets.update(r,i,n,s),u=!0);var h=i.index,d=i.attributes.position,f=1;1==n.wireframe&&(h=this.geometries.getWireframeAttribute(i),f=2);var c=void 0,p=this.bufferRenderer;null!=h&&(c=this.attributes.get(h),p=this.indexedBufferRenderer,p.setIndex(c)),u&&(this.setupVertexAttributes(n,s,i),null!=h&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,c.buffer));var v=1/0;null!=h?v=h.count:void 0!=d&&(v=d.count);var m=i.drawRange.start*f,g=i.drawRange.count*f,y=null!=a?a.start*f:0,_=null!=a?a.count*f:1/0,x=Math.max(m,y),b=Math.min(v,m+g,y+_)-1,M=Math.max(0,b-x+1);if(0!=M){if(r instanceof vt["default"])if(1==n.wireframe)this.state.setLineWidth(n.wireframeLineWidth*this.pixelRatio),p.setMode(this.gl.LINES);else switch(r.drawMode){case Tt.TrianglesDrawMode:p.setMode(this.gl.TRIANGLES);break;case Tt.TriangleStripDrawMode:p.setMode(this.gl.TRIANGLE_STRIP);break;case Tt.TriangleFanDrawMode:p.setMode(this.gl.TRIANGLE_FAN)}else if(r instanceof lt["default"]){var w=n.lineWidth;void 0==w&&(w=1),this.state.setLineWidth(w*this.pixelRatio),r instanceof ct["default"]?p.setMode(this.gl.LINES):r instanceof dt["default"]?p.setMode(this.gl.LINE_LOOP):p.setMode(this.gl.LINE_STRIP)}else r instanceof gt["default"]?p.setMode(this.gl.POINTS):r instanceof _t["default"]&&p.setMode(this.gl.TRIANGLES);i instanceof l["default"]?i.maxInstancedCount>0&&p.renderInstances(i,x,M):p.render(x,M)}},t.prototype.setupVertexAttributes=function(t,e,i){this.state.initAttributes();var n=i.attributes,r=e.getAttributes(),a=t.defaultAttributeValues;for(var o in r){var u=r[o];if(u>=0){var l=n[o];if(void 0!=l){var h=l.normalized,f=l.itemSize,p=this.attributes.get(l);if(void 0==p)continue;var v=p.buffer,m=p.type,g=p.bytesPerElement;if(l instanceof c["default"]){var y=l.data,_=y.stride,x=l.offset;y instanceof d["default"]?(this.state.enableAttributeAndDivisor(u,y.meshPerAttribute),i.maxInstancedCount=y.meshPerAttribute*y.count):this.state.enableAttribute(u),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,v),this.gl.vertexAttribPointer(u,f,m,h,_*g,x*g)}else l instanceof s["default"]?(this.state.enableAttributeAndDivisor(u,l.meshPerAttribute),i.maxInstancedCount=l.meshPerAttribute*l.count):this.state.enableAttribute(u),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,v),this.gl.vertexAttribPointer(u,f,m,h,0,0)}else if(void 0!=a){var b=a[o];if(void 0!=b)switch(b.length){case 2:this.gl.vertexAttrib2fv(u,b);break;case 3:this.gl.vertexAttrib3fv(u,b);break;case 4:this.gl.vertexAttrib4fv(u,b);break;default:this.gl.vertexAttrib1fv(u,b)}}}}this.state.disableUnusedAttributes()},t.prototype.compile=function(t,e){this.currentRenderState=this.renderStates.get(t,e),this.currentRenderState.init(),t.traverse(function(t){t instanceof g["default"]&&(this.currentRenderState.pushLight(t),t.castShadow&&this.currentRenderState.pushShadow(t))}),this.currentRenderState.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var i=0;i<e.material.length;i++)this.initMaterial(e.material[i],t.fog,e),console.log(e.material);else console.log(e.material),this.initMaterial(e.material,t.fog,e)})},t.prototype.render=function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.isContextLost){this.currentGeometryProgram.geometry=null,this.currentGeometryProgram.program=null,this.currentGeometryProgram.wireframe=!1,this.currentMaterialId=-1,this.currentCamera=null,1==t.autoUpdate&&t.updateMatrixWorld(),null==e.parent&&e.updateMatrixWorld(),this.currentRenderState=this.renderStates.get(t,e),this.currentRenderState.init(),t.onBeforeRender(this,t,e,i),this.projScreenMatrix.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.frustum.setFromMatrix(this.projScreenMatrix),this.localClippingEnabled=this.localClippingEnabled,this.clippingEnabled=this.clipping.init(this.clippingPlanes,this.localClippingEnabled,e),this.currentRenderList=this.renderLists.get(t,e),this.currentRenderList.init(),this.projectObject(t,e,this.sortObjects),1==this.sortObjects&&this.currentRenderList.sort(),this.clippingEnabled&&this.clipping.beginShadows();var r=this.currentRenderState.state.shadowsArray;this.shadowMap.render(r,t,e),this.currentRenderState.setupLights(e),this.clippingEnabled&&this.clipping.endShadows(),this.info.autoReset&&this.info.reset(),this.setRenderTarget(i),this.background.render(this.currentRenderList,t,e,n);var a=this.currentRenderList.opaque,o=this.currentRenderList.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&this.renderObjects(a,t,e,s),o.length&&this.renderObjects(o,t,e,s)}else a.length&&this.renderObjects(a,t,e),o.length&&this.renderObjects(o,t,e);i&&this.textures.updateRenderTargetMipmap(i),this.state.buffers.depth.setTest(!0),this.state.buffers.depth.setMask(!0),this.state.buffers.color.setMask(!0),this.state.setPolygonOffset(!1),t.onAfterRender(this,t,e),this.currentRenderList=null,this.currentRenderState=null}},t.prototype.projectObject=function(t,e,i){if(0!=t.visible){var n=t.layers.test(e.layers);if(n)if(t instanceof g["default"])this.currentRenderState.pushLight(t),t.castShadow&&this.currentRenderState.pushShadow(t);else if(t instanceof _t["default"]){if(!t.frustumCulled||this.frustum.intersectsSprite(t)){i&&this.vector3.setFromMatrixPosition(t.matrixWorld).applyMatrix4(this.projScreenMatrix);var r=this.objects.update(t),a=t.material;this.currentRenderList.push(t,r,a,this.vector3.z,null)}}else if(t instanceof v["default"])i&&this.vector3.setFromMatrixPosition(t.matrixWorld).applyMatrix4(this.projScreenMatrix),this.currentRenderList.push(t,null,t.material,this.vector3.z,null);else if((t instanceof vt["default"]||t instanceof lt["default"]||t instanceof gt["default"])&&("SkinnedMesh"==t.type&&t.skeleton.update(),!t.frustumCulled||this.frustum.intersectsObject(t))){i&&this.vector3.setFromMatrixPosition(t.matrixWorld).applyMatrix4(this.projScreenMatrix);var o=this.objects.update(t),s=t.material;if(Array.isArray(s))for(var u=o.groups,l=0,h=u.length;l<h;l++){var d=u[l],f=s[d.materialIndex];f&&f.visible&&this.currentRenderList.push(t,o,f,this.vector3.z,d)}else s.visible&&this.currentRenderList.push(t,o,s,this.vector3.z,null)}for(var c=t.children,p=0,m=c.length;p<m;p++)this.projectObject(c[p],e,i)}},t.prototype.renderObjects=function(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,u=o.geometry,l=void 0==n?o.material:n,h=o.group;if("ArrayCamera"==i.type){this.currentArrayCamera=i;for(var d=i.cameras,f=0,c=d.length;f<c;f++){var p=d[f];if(s.layers.test(p.layers)){if("viewport"in p)this.state.viewport(this.currentViewport.copy(p.viewport));else{var v=p.bounds,m=v.x*this.domElement.width,g=v.y*this.domElement.height,y=v.z*this.domElement.width,_=v.w*this.domElement.height;this.state.viewport(this.currentViewport.set(m,g,y,_).multiplyScalar(this.pixelRatio))}this.currentRenderState.setupLights(p),this.renderObject(s,e,p,u,l,h)}}}else this.currentArrayCamera=null,this.renderObject(s,e,i,u,l,h)}},t.prototype.renderObject=function(t,e,i,n,r,a){if(t.onBeforeRender(this,e,i,n,r,a),this.currentRenderState=this.renderStates.get(e,this.currentArrayCamera||i),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t instanceof v["default"]){this.state.setMaterial(r);var o=this.setProgram(i,e.fog,r,t);this.currentGeometryProgram.geometry=null,this.currentGeometryProgram.program=null,this.currentGeometryProgram.wireframe=!1,this.renderObjectImmediate(t,o)}else this.renderBufferDirect(i,e.fog,n,r,t,a);t.onAfterRender(this,e,i,n,r,a),this.currentRenderState=this.renderStates.get(e,this.currentArrayCamera||i)},t.prototype.initMaterial=function(t,e,i){var n=this.properties.get(t),r=this.currentRenderState.state.lights,a=this.currentRenderState.state.shadowsArray,o=n.lightsHash,s=r.state.hash,u=this.programCache.getParameters(t,r.state,a,e,this.clipping.numPlanes,this.clipping.numIntersection,i),l=this.programCache.getProgramCode(t,u),h=n.program,d=!0;if(void 0==h)t.on("dispose",this.onMaterialDispose,this);else if(h.code!=l)this.releaseMaterialProgramReference(t);else if(o.stateID!=s.stateID||o.directionalLength!=s.directionalLength||o.pointLength!=s.pointLength||o.spotLength!=s.spotLength||o.rectAreaLength!=s.rectAreaLength||o.hemiLength!=s.hemiLength||o.shadowsLength!=s.shadowsLength)o.stateID=s.stateID,o.directionalLength=s.directionalLength,o.pointLength=s.pointLength,o.spotLength=s.spotLength,o.rectAreaLength=s.rectAreaLength,o.hemiLength=s.hemiLength,o.shadowsLength=s.shadowsLength,d=!1;else{if(void 0!=u.shaderID)return;d=!1}if(d){if(u.shaderID){var f=Et.ShaderLib[u.shaderID];n.shader={name:t.type,uniforms:Lt["default"].cloneUniforms(f.uniforms),vertexShader:f.vertexShader,fragmentShader:f.fragmentShader}}else n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(n.shader,this),l=this.programCache.getProgramCode(t,u),h=this.programCache.acquireProgram(t,n.shader,u,l),n.program=h,t.program=h}var c=h.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<this.maxMorphTargets;p++)c["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var v=0;v<this.maxMorphNormals;v++)c["morphNormal"+v]>=0&&t.numSupportedMorphNormals++}var m=n.shader.uniforms;(t instanceof Y["default"]||t instanceof X["default"])&&1!=t.clipping||(n.numClippingPlanes=this.clipping.numPlanes,n.numIntersection=this.clipping.numIntersection,m.clippingPlanes=this.clipping.uniform),n.fog=e,void 0==o&&(n.lightsHash=o={}),o.stateID=s.stateID,o.directionalLength=s.directionalLength,o.pointLength=s.pointLength,o.spotLength=s.spotLength,o.rectAreaLength=s.rectAreaLength,o.hemiLength=s.hemiLength,o.shadowsLength=s.shadowsLength,t.lights&&(m.ambientLightColor.value=r.state.ambient,m.directionalLights.value=r.state.directional,m.spotLights.value=r.state.spot,m.rectAreaLights.value=r.state.rectArea,m.pointLights.value=r.state.point,m.hemisphereLights.value=r.state.hemi,m.directionalShadowMap.value=r.state.directionalShadowMap,m.directionalShadowMatrix.value=r.state.directionalShadowMatrix,m.spotShadowMap.value=r.state.spotShadowMap,m.spotShadowMatrix.value=r.state.spotShadowMatrix,m.pointShadowMap.value=r.state.pointShadowMap,m.pointShadowMatrix.value=r.state.pointShadowMatrix);var g=n.program.getUniforms(),y=ce.WebGLUniforms.seqWithValue(g.seq,m);n.uniformsList=y},t.prototype.setProgram=function(t,e,i,n){this.usedTextureUnits=0;var r=this.properties.get(i),a=this.currentRenderState.state.lights,o=r.lightsHash,s=a.state.hash;if(this.clippingEnabled&&(this.localClippingEnabled||t!=this.currentCamera)){var u=t==this.currentCamera&&i.id==this.currentMaterialId;this.clipping.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,u)}0==i.needsUpdate&&(void 0==r.program?i.needsUpdate=!0:i.fog&&r.fog!=e?i.needsUpdate=!0:!i.lights||o.stateID==s.stateID&&o.directionalLength==s.directionalLength&&o.pointLength==s.pointLength&&o.spotLength==s.spotLength&&o.rectAreaLength==s.rectAreaLength&&o.hemiLength==s.hemiLength&&o.shadowsLength==s.shadowsLength?void 0==r.numClippingPlanes||r.numClippingPlanes==this.clipping.numPlanes&&r.numIntersection==this.clipping.numIntersection||(i.needsUpdate=!0):i.needsUpdate=!0),i.needsUpdate&&(this.initMaterial(i,e,n),i.needsUpdate=!1);var l=!1,h=!1,d=!1,f=r.program,c=f.getUniforms(),p=r.shader.uniforms;if(this.state.useProgram(f.program)&&(l=!0,h=!0,d=!0),i.id!=this.currentMaterialId&&(this.currentMaterialId=i.id,h=!0),l||this.currentCamera!=t){if(c.setValue(this.gl,"projectionMatrix",t.projectionMatrix),this.capabilities.logarithmicDepthBuffer&&c.setValue(this.gl,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),this.currentCamera!=t&&(this.currentCamera=t,h=!0,d=!0),i instanceof Y["default"]||i instanceof O["default"]||i instanceof B["default"]||i.envMap){var v=c.map.cameraPosition;void 0!=v&&v.setValue(this.gl,this.vector3.setFromMatrixPosition(t.matrixWorld))}(i instanceof O["default"]||i instanceof E["default"]||i instanceof w["default"]||i instanceof B["default"]||i instanceof Y["default"]||i.skinning)&&c.setValue(this.gl,"viewMatrix",t.matrixWorldInverse)}if(i.skinning){c.setOptional(this.gl,n,"bindMatrix"),c.setOptional(this.gl,n,"bindMatrixInverse");var m=n.skeleton;if(m){var g=m.bones;if(this.capabilities.floatVertexTextures){if(void 0==m.boneTexture){var y=Math.sqrt(4*g.length);y=et["default"].ceilPowerOfTwo(y),y=Math.max(y,4);var x=new Float32Array(y*y*4);x.set(m.boneMatrices);var M=new Ct["default"](x,y,y,Tt.RGBAFormat,Tt.FloatType);M.needsUpdate=!0,m.boneMatrices=x,m.boneTexture=M,m.boneTextureSize=y}c.setValue(this.gl,"boneTexture",m.boneTexture),c.setValue(this.gl,"boneTextureSize",m.boneTextureSize)}else c.setOptional(this.gl,m,"boneMatrices")}}return h&&(c.setValue(this.gl,"toneMappingExposure",this.toneMappingExposure),c.setValue(this.gl,"toneMappingWhitePoint",this.toneMappingWhitePoint),i.lights&&this.markUniformsLightsNeedsUpdate(p,d),e&&i.fog&&this.refreshUniformsFog(p,e),i instanceof w["default"]?this.refreshUniformsCommon(p,i):i instanceof E["default"]?(this.refreshUniformsCommon(p,i),this.refreshUniformsLambert(p,i)):i instanceof O["default"]?(this.refreshUniformsCommon(p,i),i instanceof z["default"]?this.refreshUniformsToon(p,i):this.refreshUniformsPhong(p,i)):i instanceof B["default"]?(this.refreshUniformsCommon(p,i),i instanceof R["default"]?this.refreshUniformsPhysical(p,i):this.refreshUniformsStandard(p,i)):i instanceof L["default"]?(this.refreshUniformsCommon(p,i),this.refreshUniformsMatcap(p,i)):i instanceof P["default"]?(this.refreshUniformsCommon(p,i),this.refreshUniformsDepth(p,i)):i instanceof C["default"]?(this.refreshUniformsCommon(p,i),this.refreshUniformsDistance(p,i)):i instanceof k["default"]?(this.refreshUniformsCommon(p,i),this.refreshUniformsNormal(p,i)):i instanceof _["default"]?(this.refreshUniformsLine(p,i),i instanceof b["default"]&&this.refreshUniformsDash(p,i)):i instanceof V["default"]?this.refreshUniformsPoints(p,i):i instanceof K["default"]?this.refreshUniformsSprites(p,i):i instanceof Q["default"]&&(p.color.value=i.color,p.opacity.value=i.opacity),this.refreshUniformsInspectArea(p,i),this.refreshUniformsGridTint(p,i),this.refreshUniformsFaceClap(p,i),this.refreshUniformsDigArea(p,i),ce.WebGLUniforms.upload(this.gl,r.uniformsList,p,this)),i instanceof Y["default"]&&1==i.uniformsNeedUpdate&&(ce.WebGLUniforms.upload(this.gl,r.uniformsList,p,this),i.uniformsNeedUpdate=!1),i instanceof K["default"]&&c.setValue(this.gl,"center",n.center),c.setValue(this.gl,"modelViewMatrix",n.modelViewMatrix),c.setValue(this.gl,"normalMatrix",n.normalMatrix),c.setValue(this.gl,"modelMatrix",n.matrixWorld),f},t.prototype.refreshUniformsInspectArea=function(t,e){if(void 0!=t.inspectArea){t.inspectArea.value=e.inspectArea;for(var i=0;i<t.inspectArea.value;i++)t["inspectAreaProjection"+i].value=e["inspectAreaProjection"+i],t["inspectAreaModelView"+i].value=e["inspectAreaModelView"+i],t["inspectAreaTexture"+i].value=e["inspectAreaTexture"+i],t["inspectAreaNear"+i].value=e["inspectAreaNear"+i],t["inspectAreaFar"+i].value=e["inspectAreaFar"+i]}},t.prototype.refreshUniformsGridTint=function(t,e){void 0!=t.gridTint&&(1==e.gridTint?(t.gridTint.value=e.gridTint,t.gridTintProjection.value=e.gridTintProjection,t.gridTintModelView.value=e.gridTintModelView,t.gridTintTexture.value=e.gridTintTexture):t.gridTint.value=e.gridTint)},t.prototype.refreshUniformsFaceClap=function(t,e){void 0!=t.faceClip&&(1==e.faceClip?(t.faceClip.value=e.faceClip,t.faceClipProjection.value=e.faceClipProjection,t.faceClipModelView.value=e.faceClipModelView,t.faceClipTexture.value=e.faceClipTexture,t.faceClipRotateX.value=e.faceClipRotateX):t.faceClip.value=e.faceClip)},t.prototype.refreshUniformsDigArea=function(t,e){void 0!=t.digAreaGrid&&(1==e.digAreaGrid?(t.digAreaGrid.value=e.digAreaGrid,t.digAreaProjectionMatrix.value=e.digAreaProjectionMatrix,t.digAreaModelViewMatrix.value=e.digAreaModelViewMatrix,t.digAreaTexture.value=e.digAreaTexture):t.digAreaGrid.value=e.digAreaGrid)},t.prototype.refreshUniformsCommon=function(t,e){t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof Pt["default"]==1?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=this.properties.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),"number"==typeof e.gradual&&void 0!=t.gradual&&(t.gradual.value=e.gradual?e.gradual:0,t.gradualHigh.value=e.gradualHigh,t.gradualTexture.value=e.gradualTexture);var i=void 0;e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!=i&&(i instanceof ge["default"]&&(i=i.texture),1==i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))},t.prototype.refreshUniformsLine=function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity},t.prototype.refreshUniformsDash=function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale},t.prototype.refreshUniformsPoints=function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*this.pixelRatio,t.scale.value=.5*this.domElement.height,t.map.value=e.map,null!=e.map&&(1==e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))},t.prototype.refreshUniformsSprites=function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.rotation.value=e.rotation,t.map.value=e.map,null!=e.map&&(1==e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))},t.prototype.refreshUniformsFog=function(t,e){t.fogColor.value=e.color,e instanceof bt["default"]?(t.fogNear.value=e.near,t.fogFar.value=e.far):e instanceof wt["default"]&&(t.fogDensity.value=e.density)},t.prototype.refreshUniformsLambert=function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)},t.prototype.refreshUniformsPhong=function(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side==Tt.BackSide&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side==Tt.BackSide&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)},t.prototype.refreshUniformsToon=function(t,e){this.refreshUniformsPhong(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)},t.prototype.refreshUniformsStandard=function(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side==Tt.BackSide&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side==Tt.BackSide&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)},t.prototype.refreshUniformsPhysical=function(t,e){this.refreshUniformsStandard(t,e),t.reflectivity.value=e.reflectivity,t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness},t.prototype.refreshUniformsMatcap=function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side==Tt.BackSide&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side==Tt.BackSide&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)},t.prototype.refreshUniformsDepth=function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)},t.prototype.refreshUniformsDistance=function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),
t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance},t.prototype.refreshUniformsNormal=function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side==Tt.BackSide&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side==Tt.BackSide&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)},t.prototype.markUniformsLightsNeedsUpdate=function(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e},t.prototype.allocTextureUnit=function(){var t=this.usedTextureUnits;return this.usedTextureUnits+=1,t},t.prototype.setTexture2D=function(t,e){t instanceof ge["default"]&&(t=t.texture),this.textures.setTexture2D(t,e)},t.prototype.setTexture3D=function(t,e){this.textures.setTexture3D(t,e)},t.prototype.setTexture=function(t,e){this.textures.setTexture2D(t,e)},t.prototype.setTextureCube=function(t,e){t instanceof _e["default"]&&(t=t.texture),t instanceof Pt["default"]||Array.isArray(t.image)&&6==t.image.length?this.textures.setTextureCube(t,e):this.textures.setTextureCubeDynamic(t,e)},t.prototype.setFramebuffer=function(t){this.framebuffer=t},t.prototype.getRenderTarget=function(){return this.currentRenderTarget},t.prototype.setRenderTarget=function(t){this.currentRenderTarget=t,t&&void 0==this.properties.get(t).__webglFramebuffer&&this.textures.setupRenderTarget(t);var e=this.framebuffer,i=!1;if(t){var n=this.properties.get(t).__webglFramebuffer;t instanceof _e["default"]?(e=n[t.activeCubeFace],i=!0):e=n,this.currentViewport.copy(t.viewport),this.currentScissor.copy(t.scissor),this.currentScissorTest=t.scissorTest}else this.currentViewport.copy(this.viewport).multiplyScalar(this.pixelRatio),this.currentScissor.copy(this.scissor).multiplyScalar(this.pixelRatio),this.currentScissorTest=this.scissorTest;if(this.currentFramebuffer!=e&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.currentFramebuffer=e),this.state.viewport(this.currentViewport),this.state.scissor(this.currentScissor),this.state.setScissorTest(this.currentScissorTest),i){var r=this.properties.get(t.texture);this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},t.prototype.readRenderTargetPixels=function(t,e,i,n,r,a){var o=this.properties.get(t).__webglFramebuffer;if(o){var s=!1;o!=this.currentFramebuffer&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,o),s=!0);try{var u=t.texture,l=u.format,h=u.type;if(l!=Tt.RGBAFormat&&this.utils.convert(l)!=this.gl.getParameter(this.gl.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h==Tt.UnsignedByteType||this.utils.convert(h)==this.gl.getParameter(this.gl.IMPLEMENTATION_COLOR_READ_TYPE)||h==Tt.FloatType&&(this.capabilities.isWebGL2||this.extensions.get("OES_texture_float")||this.extensions.get("WEBGL_color_buffer_float"))||h==Tt.HalfFloatType&&(this.capabilities.isWebGL2?this.extensions.get("EXT_color_buffer_float"):this.extensions.get("EXT_color_buffer_half_float"))))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER)==this.gl.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&this.gl.readPixels(e,i,n,r,this.utils.convert(l),this.utils.convert(h),a):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.currentFramebuffer)}}},t.prototype.copyFramebufferToTexture=function(t,e,i){var n=e.image.width,r=e.image.height,a=this.utils.convert(e.format);this.setTexture2D(e,0),this.gl.copyTexImage2D(this.gl.TEXTURE_2D,i||0,a,t.x,t.y,n,r,0)},t.prototype.copyTextureToTexture=function(t,e,i,n){var r=e.image.width,a=e.image.height,o=this.utils.convert(i.format),s=this.utils.convert(i.type);this.setTexture2D(i,0),e instanceof Ct["default"]?this.gl.texSubImage2D(this.gl.TEXTURE_2D,n||0,t.x,t.y,r,a,o,s,e.image.data):this.gl.texSubImage2D(this.gl.TEXTURE_2D,n||0,t.x,t.y,o,s,e.image)},t}();e["default"]=xe,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvec3 transformed = vec3( position );\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvec3 objectNormal = vec3( normal );\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]='\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t// this is intended to be used on spot and point lights who are represented as luminous intensity\n\t// but who must be converted to luminous irradiance for surface lighting calculation\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance > 0.0 ) {\n\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\n\t// Original approximation by Christophe Schlick \'94\n\t// float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} // validated\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disney\u2019s reparameterization\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\t// geometry term (normalized) = G(l)\u22c5G(v) / 4(n\u22c5l)(n\u22c5v)\n\t// also see #12151\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disney\u2019s reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); // UE4\'s roughness\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\n/*\n\t// alternate method of adjusting for horizon clipping (see referece)\n\t// refactoring required\n\tfloat len = length( vectorFormFactor );\n\tfloat z = vectorFormFactor.z / len;\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\t// tabulated horizon-clipped sphere, apparently...\n\tvec2 uv = vec2( z * 0.5 + 0.5, len );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\tfloat scale = texture2D( ltc_2, uv ).w;\n\n\tfloat result = len * scale;\n*/\n\n\treturn vec3( result );\n\n}\n\n// End Rect Area Light\n\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n\treturn specularColor * AB.x + AB.y;\n\n} // validated\n\n\nfloat G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float faceClip;\nuniform sampler2D faceClipTexture;\nuniform mat4 faceClipProjection;\nuniform mat4 faceClipModelView;\nuniform float faceClipRotateX;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(faceClip==1.0){\n    vec3 tmpPosition = position;\n    vec4 clapVec = faceClipProjection * faceClipModelView * vec4( position, 1.0 );\n    vec3 v_clapCoord = (clapVec.xyz/clapVec.w)/2.0 + 0.5;\n    clapVec /= clapVec.w;\n    bool blend = (clapVec[0] < -1.0 || clapVec[0] > 1.0 || clapVec[1] < -1.0 || clapVec[1] > 1.0 || clapVec[2] < -1.0 || clapVec[2] > 1.0);\n    if(blend==false)\n    {\n        vec4 tmpColor = texture2D(faceClipTexture,v_clapCoord.xy);\n        if((tmpColor.r==1.0&&tmpColor.g==1.0&&tmpColor.b==1.0) == false){\n            if(faceClipRotateX == 1.0)\n            {\n                tmpPosition.y = min(position.y,tmpColor.r*255.0);\n            }\n            else\n            {   \n                tmpPosition.z = min(position.z,tmpColor.r*255.0);\n            }\n        }\n    }\n    gl_Position =  projectionMatrix * modelViewMatrix * vec4( tmpPosition, 1.0 );\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if NUM_CLIPPING_PLANES > 0\n\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",t.exports=e["default"]},425,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n#define cubeUV_textureSize (1024.0)\n\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\n\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\t// Clamp the value to the max mip level counts. hard coded to 6 mips\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\n\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\t// float powScale = exp2(roughnessLevel + mipLevel);\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\t// float scale =  1.0 / exp2(roughnessLevel + 2.0 + mipLevel);\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\t// float mipOffset = 0.75*(1.0 - 1.0/exp2(mipLevel))/exp2(roughnessLevel);\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\n\tfloat rcpPowScale = 1.0 / powScale;\n\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\n\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\n\t// round to nearest mipmap if we are not interpolating.\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\n\t// Tri linear interpolation.\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\n\tvec4 result = mix(color10, color20, t);\n\n\treturn vec4(result.rgb, 1.0);\n}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvec3 transformedNormal = normalMatrix * objectNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(digAreaGrid==1.0){\n    bool outside = (digAreaPosition.x < -1.0 || digAreaPosition.x > 1.0 || digAreaPosition.y < -1.0 || digAreaPosition.y > 1.0 || digAreaPosition.z < -1.0 || digAreaPosition.z > 1.0);\n    if(outside==false){\n        vec4 ac = texture2D(digAreaTexture, digAreaShadowCoord.xy);       \n        if(ac.x==1.0&&ac.y==1.0&&ac.z==1.0){ //\u5982\u679c\u5728\u754c\u5916\uff0c\u5219\u91c7\u7528\u81ea\u8eab\u7684\u989c\u8272\n            gl_FragColor =  gl_FragColor;\n        }else {\n            discard;\n        }\n    }\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform sampler2D digAreaTexture;\nuniform float digAreaGrid;\nvarying vec4 digAreaPosition;\nvarying vec3 digAreaShadowCoord;",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float digAreaGrid;\nuniform mat4 digAreaProjectionMatrix;\nuniform mat4 digAreaModelViewMatrix;\nvarying vec4 digAreaPosition;\nvarying vec3 digAreaShadowCoord;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(digAreaGrid==1.0){\n    digAreaPosition = digAreaProjectionMatrix * digAreaModelViewMatrix * vec4( position, 1.0 );\n    digAreaShadowCoord = (digAreaPosition.xyz/digAreaPosition.w)/2.0 + 0.5;\n    digAreaPosition /= digAreaPosition.w;\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( DITHERING )\n\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( DITHERING )\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";
Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\tvec2 sampleUV;\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\tenvColor = envMapTexelToLinear( envColor );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n\n#ifdef USE_ENVMAP\n\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\n\tvec3 getLightProbeIndirectIrradiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\n\t// taken from here: http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\n\t\t//float envMapWidth = pow( 2.0, maxMIPLevelScalar );\n\t\t//float desiredMIPLevel = log2( envMapWidth * sqrt( 3.0 ) ) - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\n\t\t// clamp to allowable LOD ranges.\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_FOG\n\n\tfogDepth = -mvPosition.z;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef TOON\n\n\tuniform sampler2D gradientMap;\n\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t\t// dotNL will be from -1.0 to 1.0\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t\t#ifdef USE_GRADIENTMAP\n\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t\t#else\n\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t\t#endif\n\n\n\t}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(gradual>1.0){\n    gl_FragColor = vec4(gl_FragColor.r * v_GradualColor.r ,gl_FragColor.g * v_GradualColor.g,gl_FragColor.b * v_GradualColor.b,gl_FragColor.a);\n}else if(gradual>0.0){\n    gl_FragColor = vec4(gl_FragColor.r,gl_FragColor.g,gl_FragColor.b,gl_FragColor.a*v_GradualPercent);\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n    uniform float gradual;\n    varying float v_GradualPercent;\n    varying vec4 v_GradualColor;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float gradual;\nuniform float gradualHigh;\nvarying float v_GradualPercent;\nvarying vec4 v_GradualColor;\nuniform sampler2D gradualTexture;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(gradual>1.0){\n     v_GradualColor = texture2D(gradualTexture, vec2(position.z / 255.0, 0.0));\n}else if(gradual>0.0){\n     v_GradualPercent = position.z / gradualHigh;\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(gridTint==1.0){\n    bool outside = (gridTintPosition.x < -1.0 || gridTintPosition.x > 1.0 || gridTintPosition.y < -1.0 || gridTintPosition.y > 1.0 || gridTintPosition.z < -1.0 || gridTintPosition.z > 1.0);\n    if(outside==false){\n        vec4 ac = texture2D(gridTintTexture, gridTintShadowCoord.xy);\n        gl_FragColor = gl_FragColor * ac;\n    }\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float gridTint;\nuniform sampler2D gridTintTexture;\nvarying vec4 gridTintPosition;\nvarying vec3 gridTintShadowCoord;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float gridTint;\nuniform mat4 gridTintProjection;\nuniform mat4 gridTintModelView;\nvarying vec4 gridTintPosition;\nvarying vec3 gridTintShadowCoord;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(gridTint==1.0){\n    gridTintPosition = gridTintProjection * gridTintModelView * vec4( position, 1.0 );\n    gridTintShadowCoord = (gridTintPosition.xyz/gridTintPosition.w)/2.0 + 0.5;\n    gridTintPosition /= gridTintPosition.w;\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(inspectArea>0.0){\n    bool blend = (inspectAreaPosition0.x < -1.0 || inspectAreaPosition0.x > 1.0 || inspectAreaPosition0.y < -1.0 || inspectAreaPosition0.y > 1.0 || inspectAreaPosition0.z < -1.0 || inspectAreaPosition0.z > 1.0);\n    if(blend==false){\n        vec4 rgbaDepth = texture2D(inspectAreaTexture0,inspectAreaShadowCoord0.xy);\n        float depth = LinearizeDepth(inspectAreaShadowCoord0.z,inspectAreaFar0,inspectAreaNear0)-0.005;\n        vec4 color = vec4(1.0,0.0,0.0,1.0); \n        float z = inspectAreaShadowCoord0.z/inspectAreaPosition0.w;\n        if(z<0.0){\n            color = gl_FragColor;\n        }else if(rgbaDepth.r>=depth){\n            color = vec4(0.0,1.0,0.0,1.0);\n        }\n        gl_FragColor = gl_FragColor*color;\n    }\n}\nif(inspectArea>1.0){\n    bool blend = (inspectAreaPosition1.x < -1.0 || inspectAreaPosition1.x > 1.0 || inspectAreaPosition1.y < -1.0 || inspectAreaPosition1.y > 1.0 || inspectAreaPosition1.z < -1.0 || inspectAreaPosition1.z > 1.0);\n    if(blend==false){\n        vec4 rgbaDepth = texture2D(inspectAreaTexture1,inspectAreaShadowCoord1.xy);\n        float depth = LinearizeDepth(inspectAreaShadowCoord1.z,inspectAreaFar1,inspectAreaNear1)-0.005;\n        vec4 color = vec4(1.0,0.0,0.0,1.0); \n        float z = inspectAreaShadowCoord1.z/inspectAreaPosition1.w;\n        if(z<0.0){\n            color = gl_FragColor;\n        }else if(rgbaDepth.r>=depth){\n            color = vec4(0.0,1.0,0.0,1.0);\n        }\n        gl_FragColor = gl_FragColor*color;\n    }\n}\nif(inspectArea>2.0){\n    bool blend = (inspectAreaPosition2.x < -1.0 || inspectAreaPosition2.x > 1.0 || inspectAreaPosition2.y < -1.0 || inspectAreaPosition2.y > 1.0 || inspectAreaPosition2.z < -1.0 || inspectAreaPosition2.z > 1.0);\n    if(blend==false){\n        vec4 rgbaDepth = texture2D(inspectAreaTexture2,inspectAreaShadowCoord2.xy);\n        float depth = LinearizeDepth(inspectAreaShadowCoord2.z,inspectAreaFar2,inspectAreaNear2)-0.005;\n        vec4 color = vec4(1.0,0.0,0.0,1.0); \n        float z = inspectAreaShadowCoord2.z/inspectAreaPosition2.w;\n        if(z<0.0){\n            color = gl_FragColor;\n        }else if(rgbaDepth.r>=depth){\n            color = vec4(0.0,1.0,0.0,1.0);\n        }\n        gl_FragColor = gl_FragColor*color;\n    }\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform sampler2D inspectAreaTexture0;\nuniform sampler2D inspectAreaTexture1;\nuniform sampler2D inspectAreaTexture2;\nuniform float inspectAreaNear0;\nuniform float inspectAreaNear1;\nuniform float inspectAreaNear2;\nuniform float inspectAreaFar0;\nuniform float inspectAreaFar1;\nuniform float inspectAreaFar2;\nuniform float inspectArea;\nvarying vec4 inspectAreaPosition0;\nvarying vec3 inspectAreaShadowCoord0;\nvarying vec4 inspectAreaPosition1;\nvarying vec3 inspectAreaShadowCoord1;\nvarying vec4 inspectAreaPosition2;\nvarying vec3 inspectAreaShadowCoord2;\nvec4 pack (float depth) {\n    const vec4 bitShift = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n    const vec4 bitMask = vec4(1.0/256.0, 1.0/256.0, 1.0/256.0, 0.0);\n    vec4 rgbaDepth = fract(depth * bitShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n}\nfloat unpack(const in vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(1.0, 1.0/256.0, 1.0/(256.0*256.0), 1.0/(256.0*256.0*256.0));\n    return dot(rgbaDepth, bitShift);\n}\nfloat LinearizeDepth(float depth,float far,float near){\n    float z = depth * 2.0 - 1.0;\n    float v = (2.0 * near) / (far + near - z * (far - near));\n    return v;\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float inspectArea;\nuniform mat4 inspectAreaProjection0;\nuniform mat4 inspectAreaModelView0;\nuniform mat4 inspectAreaProjection1;\nuniform mat4 inspectAreaModelView1;\nuniform mat4 inspectAreaProjection2;\nuniform mat4 inspectAreaModelView2;\nvarying vec4 inspectAreaPosition0;\nvarying vec3 inspectAreaShadowCoord0;\nvarying vec4 inspectAreaPosition1;\nvarying vec3 inspectAreaShadowCoord1;\nvarying vec4 inspectAreaPosition2;\nvarying vec3 inspectAreaShadowCoord2;\nvec4 pack (float depth) {\n    const vec4 bitShift = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n    const vec4 bitMask = vec4(1.0/256.0, 1.0/256.0, 1.0/256.0, 0.0);\n    vec4 rgbaDepth = fract(depth * bitShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n}\nfloat unpack(const in vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(1.0, 1.0/256.0, 1.0/(256.0*256.0), 1.0/(256.0*256.0*256.0));\n    return dot(rgbaDepth, bitShift);\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nif(inspectArea>0.0){\n    inspectAreaPosition0 = inspectAreaProjection0 * inspectAreaModelView0 * vec4( position, 1.0 );\n    inspectAreaShadowCoord0 = (inspectAreaPosition0.xyz/inspectAreaPosition0.w)/2.0 + 0.5;\n    inspectAreaPosition0 /= inspectAreaPosition0.w;\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_LIGHTMAP\n\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tirradiance += getLightProbeIndirectIrradiance( /*lightProbe,*/ geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\n#endif\n\n/*\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\t// TODO (abelnation): implement\n\n\t}\n\n#endif\n*/\n\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 ambientLightColor;\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n\n\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n\n\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltc_1; // RGBA Float\n\tuniform sampler2D ltc_2; // RGBA Float\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n\n\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",
t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct BlinnPhongMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t#ifdef TOON\n\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#else\n\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\n\t#endif\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat ); // Burley clearcoat model\n\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nstruct PhysicalMaterial {\n\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight; // counterclockwise\n\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\t#ifndef STANDARD\n\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\n\t#endif\n\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\n\t#ifndef STANDARD\n\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\n\t#endif\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\n\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n\t#else\n\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\tgl_Position.z *= gl_Position.w;\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MAP\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MAP\n\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MORPHNORMALS\n\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_MORPHTARGETS\n\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_NORMALMAP\n\n\t#ifdef OBJECTSPACE_NORMALMAP\n\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n\n\t\t#ifdef FLIP_SIDED\n\n\t\t\tnormal = - normal;\n\n\t\t#endif\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\tnormal = normalize( normalMatrix * normal );\n\n\t#else // tangent-space normal map\n\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t#ifdef OBJECTSPACE_NORMALMAP\n\n\t\tuniform mat3 normalMatrix;\n\n\t#else\n\n\t\t// Per-Pixel Tangent Space Normal Mapping\n\t\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t\treturn normalize( tsn * mapN );\n\n\t\t}\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\ngl_Position = projectionMatrix * mvPosition;\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): create uniforms for area light shadows\n\n\t#endif\n\t*/\n\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\n\t\tvec2 f = fract( uv * size + 0.5 );\n\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\n\t\treturn c;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//  y Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV = abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim    := ( 4 , 2 )\n\t\t//  # #\t\tcenter := ( 1 , 1 )\n\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale := 0.5 / dim\n\t\t// translate := ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\n\t\t// dp = normalized distance from light to fragment position\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n\t\tdp += shadowBias;\n\n\t\t// bd3D = base direction 3D\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update shadow for Area light\n\n\t#endif\n\t*/\n\n\t#endif\n\n\treturn shadow;\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n#endif\n",
t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( TONE_MAPPING )\n\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\n\t// John Hable's filmic operator from Uncharted 2 video game\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n\n// source: https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = uv2;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n#endif\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\nvoid main() {\n\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; // set z to camera.far\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV;\n\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\n\tvLineDistance = scale * lineDistance;\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <gradual_pars_fragment>\n#include <inspectarea_pars_fragment>\n#include <digArea_pars_fragment>\n#include <gridtint_pars_fragment>\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <gradual_fragment>\n\t#include <inspectarea_fragment>\n\t#include <digArea_fragment>\n    #include <gridtint_fragment>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <gradual_pars_vertex>\n#include <inspectarea_pars_vertex>\n#include <clap_pars_vertex>\n#include <digArea_pars_vertex>\n#include <gridtint_pars_vertex>\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <gradual_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n    #include <inspectarea_vertex>\n\t#include <clap_vertex>\n\t#include <digArea_vertex>\n\t#include <gridtint_vertex>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\n\n#ifdef DOUBLE_SIDED\n\n\tvarying vec3 vLightBack;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <gradual_pars_fragment>\n#include <inspectarea_pars_fragment>\n#include <digArea_pars_fragment>\n#include <gridtint_pars_fragment>\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n    #include <gradual_fragment>\n\t#include <inspectarea_fragment>\n\t#include <digArea_fragment>\n\t#include <gridtint_fragment>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define LAMBERT\n\nvarying vec3 vLightFront;\n\n#ifdef DOUBLE_SIDED\n\n\tvarying vec3 vLightBack;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <gradual_pars_vertex>\n#include <inspectarea_pars_vertex>\n#include <clap_pars_vertex>\n#include <digArea_pars_vertex>\n#include <gridtint_pars_vertex>\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n    #include <gradual_vertex>\n    #include <inspectarea_vertex>\n\t#include <clap_vertex>\n\t#include <digArea_vertex>\n\t#include <gridtint_vertex>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <gradual_pars_fragment>\n#include <inspectarea_pars_fragment>\n#include <digArea_pars_fragment>\n#include <gridtint_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n    #include <gradual_fragment>\n\t#include <inspectarea_fragment>\n\t#include <digArea_fragment>\n    #include <gridtint_fragment>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <gradual_pars_vertex>\n#include <inspectarea_pars_vertex>\n#include <clap_pars_vertex>\n#include <digArea_pars_vertex>\n#include <gridtint_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <gradual_vertex>\n\t#include <fog_vertex>\n\t#include <inspectarea_vertex>\n\t#include <clap_vertex>\n\t#include <digArea_vertex>\n\t#include <gridtint_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <gradual_pars_fragment>\n#include <inspectarea_pars_fragment>\n#include <digArea_pars_fragment>\n#include <gridtint_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\t#include <gradual_fragment>\n\t#include <inspectarea_fragment>\n\t#include <digArea_fragment>\n\t#include <gridtint_fragment>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <gradual_pars_vertex>\n#include <inspectarea_pars_vertex>\n#include <clap_pars_vertex>\n#include <digArea_pars_vertex>\n#include <gridtint_pars_vertex>\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <gradual_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\t#include <inspectarea_vertex>\n\t#include <clap_vertex>\n\t#include <digArea_vertex>\n\t#include <gridtint_vertex>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define PHYSICAL\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <gradual_pars_fragment>\n#include <inspectarea_pars_fragment>\n#include <digArea_pars_fragment>\n#include <gridtint_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\t#include <gradual_fragment>\n\t#include <inspectarea_fragment>\n\t#include <digArea_fragment>\n\t#include <gridtint_fragment>\n\t\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define PHYSICAL\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <gradual_pars_vertex>\n#include <inspectarea_pars_vertex>\n#include <clap_pars_vertex>\n#include <digArea_pars_vertex>\n#include <gridtint_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\t#include <gradual_vertex>\n\t#include <inspectarea_vertex>\n\t#include <clap_vertex>\n\t#include <digArea_vertex>\n\t#include <gridtint_vertex>\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n\nvoid main() {\n\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",
t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <fog_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t)}return t.prototype.onAnimationFrame=function(t,e){this.isAnimating&&(this.animationLoop(t,e),this.context.requestAnimationFrame(this.onAnimationFrame))},t.prototype.start=function(){this.isAnimating||this.animationLoop&&(this.context.requestAnimationFrame(this.onAnimationFrame),this.isAnimating=!0)},t.prototype.stop=function(){this.isAnimating=!1},t.prototype.setAnimationLoop=function(t){this.animationLoop=t},t.prototype.setContext=function(t){this.context=t},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(66),s=n(o),u=function(){function t(e){(0,a["default"])(this,t),this.buffers=new window.WeakMap,this.gl=e}return t.prototype.createBuffer=function(t,e){var i=t.array,n=t.dynamic?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,r=this.gl.createBuffer();this.gl.bindBuffer(e,r),this.gl.bufferData(e,i,n),t.onUploadCallback();var a=this.gl.FLOAT;return i instanceof Float32Array?a=this.gl.FLOAT:i instanceof Float64Array||(i instanceof Uint16Array?a=this.gl.UNSIGNED_SHORT:i instanceof Int16Array?a=this.gl.SHORT:i instanceof Uint32Array?a=this.gl.UNSIGNED_INT:i instanceof Int32Array?a=this.gl.INT:i instanceof Int8Array?a=this.gl.BYTE:i instanceof Uint8Array&&(a=this.gl.UNSIGNED_BYTE)),{buffer:r,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}},t.prototype.updateBuffer=function(t,e,i){var n=e.array,r=e.updateRange;this.gl.bindBuffer(i,t),0==e.dynamic?this.gl.bufferData(i,n,this.gl.STATIC_DRAW):r.count==-1?this.gl.bufferSubData(i,0,n):0==r.count||(this.gl.bufferSubData(i,r.offset*n.BYTES_PER_ELEMENT,n.subarray(r.offset,r.offset+r.count)),r.count=-1)},t.prototype.get=function(t){return t instanceof s["default"]&&(t=t.data),this.buffers.get(t)},t.prototype.remove=function(t){t instanceof s["default"]&&(t=t.data);var e=this.buffers.get(t);e&&(this.gl.deleteBuffer(e.buffer),this.buffers["delete"](t))},t.prototype.update=function(t,e){t instanceof s["default"]&&(t=t.data);var i=this.buffers.get(t);void 0==i?this.buffers.set(t,this.createBuffer(t,e)):i.version<t.version&&(this.updateBuffer(i.buffer,t,e),i.version=t.version)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(12),s=n(o),u=i(58),l=i(24),h=n(l),d=i(92),f=i(197),c=i(9),p=i(36),v=n(p),m=i(46),g=n(m),y=i(129),_=n(y),x=i(125),b=n(x),M=i(27),w=n(M),S=function(){function t(e,i,n,r){(0,a["default"])(this,t),this.renderer=e,this.state=i,this.objects=n,this.premultipliedAlpha=r,this.clearColor=new s["default"](0),this.clearAlpha=0,this.planeMesh,this.boxMesh,this.currentBackground=null,this.currentBackgroundVersion=0}return t.prototype.render=function(t,e,i,n){var r=e.background;if(null==r?(this.setClear(this.clearColor,this.clearAlpha),this.currentBackground=null,this.currentBackgroundVersion=0):r instanceof s["default"]&&(this.setClear(r,1),n=!0,this.currentBackground=null,this.currentBackgroundVersion=0),(this.renderer.autoClear||n)&&this.renderer.clear(this.renderer.autoClearColor,this.renderer.autoClearDepth,this.renderer.autoClearStencil),r instanceof _["default"]||r instanceof b["default"]){void 0==this.boxMesh&&(this.boxMesh=new h["default"](new d.BoxBufferGeometry(1,1,1),new v["default"]({type:"BackgroundCubeMaterial",uniforms:g["default"].cloneUniforms(f.ShaderLib.cube.uniforms),vertexShader:f.ShaderLib.cube.vertexShader,fragmentShader:f.ShaderLib.cube.fragmentShader,side:c.BackSide,depthTest:!0,depthWrite:!1,fog:!1})),this.boxMesh.geometry.removeAttribute("normal"),this.boxMesh.geometry.removeAttribute("uv"),this.boxMesh.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(this.boxMesh.material,"map",{get:function(){return this.uniforms.tCube.value}}),this.objects.update(this.boxMesh));var a=r instanceof b["default"]?r.texture:r;this.boxMesh.material.uniforms.tCube.value=a,this.boxMesh.material.uniforms.tFlip.value=r instanceof b["default"]?1:-1,this.currentBackground==r&&this.currentBackgroundVersion==a.version||(this.boxMesh.material.needsUpdate=!0,this.currentBackground=r,this.currentBackgroundVersion=a.version),t.unshift(this.boxMesh,this.boxMesh.geometry,this.boxMesh.material,0,null)}else r instanceof w["default"]&&(void 0==this.planeMesh&&(this.planeMesh=new h["default"](new u.PlaneBufferGeometry(2,2),new v["default"]({type:"BackgroundMaterial",uniforms:g["default"].cloneUniforms(f.ShaderLib.background.uniforms),vertexShader:f.ShaderLib.background.vertexShader,fragmentShader:f.ShaderLib.background.fragmentShader,side:c.FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),this.planeMesh.geometry.removeAttribute("normal"),Object.defineProperty(this.planeMesh.material,"map",{get:function(){return this.uniforms.t2D.value}}),this.objects.update(this.planeMesh)),this.planeMesh.material.uniforms.t2D.value=r,1==r.matrixAutoUpdate&&r.updateMatrix(),this.planeMesh.material.uniforms.uvTransform.value.copy(r.matrix),this.currentBackground==r&&this.currentBackgroundVersion==r.version||(this.planeMesh.material.needsUpdate=!0,this.currentBackground=r,this.currentBackgroundVersion=r.version),t.unshift(this.planeMesh,this.planeMesh.geometry,this.planeMesh.material,0,null))},t.prototype.setClear=function(t,e){this.state.buffers.color.setClear(t.r,t.g,t.b,e,this.premultipliedAlpha)},t.prototype.getClearColor=function(){return this.clearColor},t.prototype.setClearColor=function(t,e){this.clearColor.set(t),this.clearAlpha=void 0!=e?e:1,this.setClear(this.clearColor,this.clearAlpha)},t.prototype.getClearAlpha=function(){return this.clearAlpha},t.prototype.setClearAlpha=function(t){this.clearAlpha=t,this.setClear(this.clearColor,this.clearAlpha)},t}();e["default"]=S,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i,n,r){(0,a["default"])(this,t),this.gl=e,this.extensions=i,this.info=n,this.capabilities=r}return t.prototype.setMode=function(t){this.mode=t},t.prototype.render=function(t,e){this.gl.drawArrays(this.mode,t,e),this.info.update(e,this.mode)},t.prototype.renderInstances=function(t,e,i){var n=void 0;if(this.capabilities.isWebGL2)n=this.gl;else if(n=this.extensions.get("ANGLE_instanced_arrays"),null==n)return;n[this.capabilities.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](this.mode,e,i,t.maxInstancedCount),this.info.update(i,this.mode,t.maxInstancedCount)},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i,n){(0,a["default"])(this,t),this.gl=e,this.extensions=i,this.initAttributes(n)}return t.prototype.getMaxAnisotropy=function(){if(void 0!=this.maxAnisotropy)return this.maxAnisotropy;var t=this.extensions.get("EXT_texture_filter_anisotropic");return null!=t?this.maxAnisotropy=this.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):this.maxAnisotropy=0,this.maxAnisotropy},t.prototype.getMaxPrecision=function(t){if("highp"==t){if(this.gl.getShaderPrecisionFormat(this.gl.VERTEX_SHADER,this.gl.HIGH_FLOAT).precision>0&&this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"==t&&this.gl.getShaderPrecisionFormat(this.gl.VERTEX_SHADER,this.gl.MEDIUM_FLOAT).precision>0&&this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.MEDIUM_FLOAT).precision>0?"mediump":"lowp"},t.prototype.initAttributes=function(t){var e=void 0!=t.precision?t.precision:"highp",i=this.getMaxPrecision(e);i!=e&&(e=i);var n=1==t.logarithmicDepthBuffer,r=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),a=this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),o=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),s=this.gl.getParameter(this.gl.MAX_CUBE_MAP_TEXTURE_SIZE),u=this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),l=this.gl.getParameter(this.gl.MAX_VERTEX_UNIFORM_VECTORS),h=this.gl.getParameter(this.gl.MAX_VARYING_VECTORS),d=this.gl.getParameter(this.gl.MAX_FRAGMENT_UNIFORM_VECTORS),f=a>0,c=!!this.extensions.get("OES_texture_float"),p=f&&c;this.precision=e,this.logarithmicDepthBuffer=n,this.maxTextures=r,this.maxVertexTextures=a,this.maxTextureSize=o,this.maxCubemapSize=s,this.maxAttributes=u,this.maxVertexUniforms=l,this.maxVaryings=h,this.maxFragmentUniforms=d,this.vertexTextures=f,this.floatFragmentTextures=c,this.floatVertexTextures=p},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(121),s=n(o),u=i(37),l=n(u),h=function(){function t(){(0,a["default"])(this,t),this.uniform={value:null,needsUpdate:!1},this.globalState=null,this.numGlobalPlanes=0,this.localClippingEnabled=!1,this.renderingShadows=!1,this.plane=new s["default"],this.viewNormalMatrix=new l["default"]}return t.prototype.init=function(t,e,i){var n=0!=t.length||e||0!=this.numGlobalPlanes||this.localClippingEnabled;return this.localClippingEnabled=e,this.globalState=this.projectPlanes(t,i,0),this.numGlobalPlanes=t.length,n},t.prototype.beginShadows=function(){this.renderingShadows=!0,this.projectPlanes(null)},t.prototype.endShadows=function(){this.renderingShadows=!1,this.resetGlobalState()},t.prototype.setState=function(t,e,i,n,r,a){if(!this.localClippingEnabled||null==t||0==t.length||this.renderingShadows&&!i)this.renderingShadows?this.projectPlanes(null):this.resetGlobalState();else{var o=this.renderingShadows?0:this.numGlobalPlanes,s=4*o,u=r.clippingState||null;this.uniform.value=u,u=this.projectPlanes(t,n,s,a);for(var l=0;l!=s;++l)u[l]=this.globalState[l];r.clippingState=u,this.numIntersection=e?this.numPlanes:0,this.numPlanes+=o}},t.prototype.resetGlobalState=function(){this.uniform.value!=this.globalState&&(this.uniform.value=this.globalState,this.uniform.needsUpdate=this.numGlobalPlanes>0),this.numPlanes=this.numGlobalPlanes,this.numIntersection=0},t.prototype.projectPlanes=function(t,e,i,n){var r=null!=t?t.length:0,a=null;if(0!=r){if(a=this.uniform.value,1!=n||null==a){var o=i+4*r,s=e.matrixWorldInverse;this.viewNormalMatrix.getNormalMatrix(s),(null==a||a.length<o)&&(a=new Float32Array(o));for(var u=0,l=i;u!=r;++u,l+=4)this.plane.copy(t[u]).applyMatrix4(s,this.viewNormalMatrix),this.plane.normal.toArray(a,l),a[l+3]=this.plane.constant}this.uniform.value=a,this.uniform.needsUpdate=!0}return this.numPlanes=r,a},t}();e["default"]=h,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.extensions={},this.gl=e}return t.prototype.get=function(t){if(void 0!=this.extensions[t])return this.extensions[t];var e=void 0;switch(t){case"WEBGL_depth_texture":e=this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=this.gl.getExtension("WEBGL_compressed_texture_s3tc")||this.gl.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||this.gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=this.gl.getExtension("WEBGL_compressed_texture_pvrtc")||this.gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=this.gl.getExtension(t)}return this.extensions[t]=e,e},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(15),s=n(o),u=i(18),l=i(7),h=n(l),d=i(23),f=n(d),c=function(){function t(e,i,n){(0,a["default"])(this,t),this.gl=e,this.attributes=i,this.info=n,this.geometries={},this.wireframeAttributes={}}return t.prototype.onGeometryDispose=function(t){var e=t,i=this.geometries[e.id];if(i){null!=i.index&&this.attributes.remove(i.index);for(var n in i.attributes)this.attributes.remove(i.attributes[n])}if(e.off("dispose",this.onGeometryDispose,this),delete this.geometries[e.id],i){var r=this.wireframeAttributes[i.id];r&&(this.attributes.remove(r),delete this.wireframeAttributes[i.id])}this.info.memory.geometries--},t.prototype.get=function(t,e){var i=this.geometries[e.id];return i?i:(e.on("dispose",this.onGeometryDispose,this),e instanceof s["default"]?i=e:e instanceof f["default"]&&(void 0==e._bufferGeometry&&(e._bufferGeometry=(new s["default"]).setFromObject(t)),i=e._bufferGeometry),this.geometries[e.id]=i,this.info.memory.geometries++,i)},t.prototype.update=function(t){var e=t.index,i=t.attributes;null!=e&&this.attributes.update(e,this.gl.ELEMENT_ARRAY_BUFFER);for(var n in i)this.attributes.update(i[n],this.gl.ARRAY_BUFFER);var r=t.morphAttributes;for(var a in r)for(var o=r[a],s=0,u=o.length;s<u;s++)this.attributes.update(o[s],this.gl.ARRAY_BUFFER)},t.prototype.getWireframeAttribute=function(t){var e=this.wireframeAttributes[t.id];if(e)return e;var i=[],n=t.index,r=t.attributes;if(null!=n)for(var a=n.array,o=0,s=a.length;o<s;o+=3){var l=a[o+0],d=a[o+1],f=a[o+2];i.push(l,d,d,f,f,l)}else for(var c=r.position.array,p=0,v=c.length/3-1;p<v;p+=3){var m=p+0,g=p+1,y=p+2;i.push(m,g,g,y,y,m)}return e=new(h["default"].arrayMax(i)>65535?u.Uint32BufferAttribute:u.Uint16BufferAttribute)(i,1),this.attributes.update(e,this.gl.ELEMENT_ARRAY_BUFFER),this.wireframeAttributes[t.id]=e,e},t}();e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e,i,n,r){(0,a["default"])(this,t),this.gl=e,this.extensions=i,this.info=n,this.capabilities=r}return t.prototype.setMode=function(t){this.mode=t},t.prototype.setIndex=function(t){this.type=t.type,this.bytesPerElement=t.bytesPerElement},t.prototype.render=function(t,e){this.gl.drawElements(this.mode,e,this.type,t*this.bytesPerElement),this.info.update(e,this.mode)},t.prototype.renderInstances=function(t,e,i){var n=void 0;n=this.capabilities.isWebGL2?this.gl:this.extensions.get("ANGLE_instanced_arrays"),n&&(n[this.capabilities.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](this.mode,i,this.type,e*this.bytesPerElement,t.maxInstancedCount),this.info.update(i,this.mode,t.maxInstancedCount))},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.autoReset=!0,this.memory={geometries:0,textures:0},this.render={frame:0,calls:0,triangles:0,points:0,lines:0},this.gl=e,this.geometries=0,this.textures=0,this.frame=0,this.calls=0,this.triangles=0,this.points=0,this.lines=0,this.memory={geometries:this.geometries,textures:this.textures},this.render={frame:this.frame,calls:this.calls,triangles:this.triangles,points:this.points,lines:this.lines}}return t.prototype.update=function(t,e,i){switch(i=i||1,this.calls++,e){case this.gl.TRIANGLES:this.triangles+=i*(t/3);break;case this.gl.TRIANGLE_STRIP:case this.gl.TRIANGLE_FAN:this.triangles+=i*(t-2);break;case this.gl.LINES:this.lines+=i*(t/2);break;case this.gl.LINE_STRIP:this.lines+=i*(t-1);break;case this.gl.LINE_LOOP:this.lines+=i*t;break;case this.gl.POINTS:this.points+=i*t}},t.prototype.reset=function(){this.frame++,this.calls=0,this.triangles=0,this.points=0,this.lines=0},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLLights=e.UniformsCache=e["default"]=void 0;var r=i(1),a=n(r),o=i(5),s=n(o),u=i(12),l=n(u),h=i(4),d=n(h),f=i(14),c=n(f),p=i(184),v=n(p),m=i(185),g=n(m),y=i(186),_=n(y),x=i(116),b=n(x),M=i(384),w=n(M),S=i(383),P=n(S),A=function(){function t(){(0,a["default"])(this,t),this.count=0,this.cache=new C,this.state={id:this.count++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},this.vector3=new d["default"],this.matrix4=new c["default"],this.matrix42=new c["default"]}return t.prototype.setup=function(t,e,i){for(var n=0,r=0,a=0,o=0,s=0,u=0,l=0,h=0,d=i.matrixWorldInverse,f=0,c=t.length;f<c;f++){var p=t[f],m=p.color,y=p.intensity,x=p.distance,M=p.shadow&&p.shadow.map?p.shadow.map.texture:null;if(p instanceof v["default"])n+=m.r*y,r+=m.g*y,a+=m.b*y;else if(p instanceof g["default"]){var S=this.cache.get(p);if(S.color.copy(p.color).multiplyScalar(p.intensity),S.direction.setFromMatrixPosition(p.matrixWorld),this.vector3.setFromMatrixPosition(p.target.matrixWorld),S.direction.sub(this.vector3),S.direction.transformDirection(d),S.shadow=p.castShadow,p.castShadow){var A=p.shadow;S.shadowBias=A.bias,S.shadowRadius=A.radius,S.shadowMapSize=A.mapSize}this.state.directionalShadowMap[o]=M,this.state.directionalShadowMatrix[o]=p.shadow.matrix,this.state.directional[o]=S,o++}else if(p instanceof _["default"]){var C=this.cache.get(p);if(C.position.setFromMatrixPosition(p.matrixWorld),C.position.applyMatrix4(d),C.color.copy(m).multiplyScalar(y),C.distance=x,C.direction.setFromMatrixPosition(p.matrixWorld),this.vector3.setFromMatrixPosition(p.target.matrixWorld),C.direction.sub(this.vector3),C.direction.transformDirection(d),C.coneCos=Math.cos(p.angle),C.penumbraCos=Math.cos(p.angle*(1-p.penumbra)),C.decay=p.decay,C.shadow=p.castShadow,p.castShadow){var T=p.shadow;C.shadowBias=T.bias,C.shadowRadius=T.radius,C.shadowMapSize=T.mapSize}this.state.spotShadowMap[u]=M,this.state.spotShadowMatrix[u]=p.shadow.matrix,this.state.spot[u]=C,u++}else if(p instanceof w["default"]){var E=this.cache.get(p);E.color.copy(m).multiplyScalar(y),E.position.setFromMatrixPosition(p.matrixWorld),E.position.applyMatrix4(d),this.matrix42.identity(),this.matrix4.copy(p.matrixWorld),this.matrix4.premultiply(d),this.matrix42.extractRotation(this.matrix4),E.halfWidth.set(.5*p.width,0,0),E.halfHeight.set(0,.5*p.height,0),E.halfWidth.applyMatrix4(this.matrix42),E.halfHeight.applyMatrix4(this.matrix42),this.state.rectArea[l]=E,l++}else if(p instanceof b["default"]){var D=this.cache.get(p);if(D.position.setFromMatrixPosition(p.matrixWorld),D.position.applyMatrix4(d),D.color.copy(p.color).multiplyScalar(p.intensity),D.distance=p.distance,D.decay=p.decay,D.shadow=p.castShadow,p.castShadow){var L=p.shadow;D.shadowBias=L.bias,D.shadowRadius=L.radius,D.shadowMapSize=L.mapSize,D.shadowCameraNear=L.camera.near,D.shadowCameraFar=L.camera.far}this.state.pointShadowMap[s]=M,this.state.pointShadowMatrix[s]=p.shadow.matrix,this.state.point[s]=D,s++}else if(p instanceof P["default"]){var F=this.cache.get(p);F.direction.setFromMatrixPosition(p.matrixWorld),F.direction.transformDirection(d),F.direction.normalize(),F.skyColor.copy(p.color).multiplyScalar(y),F.groundColor.copy(p.groundColor).multiplyScalar(y),this.state.hemi[h]=F,h++}}this.state.ambient[0]=n,this.state.ambient[1]=r,this.state.ambient[2]=a,this.state.directional.length=o,this.state.spot.length=u,this.state.rectArea.length=l,this.state.point.length=s,this.state.hemi.length=h,this.state.hash.stateID=this.state.id,this.state.hash.directionalLength=o,this.state.hash.pointLength=s,this.state.hash.spotLength=u,this.state.hash.rectAreaLength=l,this.state.hash.hemiLength=h,this.state.hash.shadowsLength=e.length},t}();e["default"]=A;var C=function(){function t(){(0,a["default"])(this,t),this.lights={}}return t.prototype.get=function(t){if(void 0!=this.lights[t.id])return this.lights[t.id];var e=void 0;switch(t.type){case"DirectionalLight":e={direction:new d["default"],color:new l["default"],shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new s["default"]};break;case"SpotLight":e={position:new d["default"],direction:new d["default"],color:new l["default"],distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new s["default"]};break;case"PointLight":e={position:new d["default"],color:new l["default"],distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new s["default"],shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":e={direction:new d["default"],skyColor:new l["default"],groundColor:new l["default"]};break;case"RectAreaLight":e={color:new l["default"],position:new d["default"],halfWidth:new d["default"],halfHeight:new d["default"]}}return this.lights[t.id]=e,e},t}();e.UniformsCache=C,e.WebGLLights=A},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.gl=e,this.influencesList={},this.morphInfluences=new Float32Array(8)}return t.prototype.absNumericalSort=function(t,e){return Math.abs(e[1])-Math.abs(t[1])},t.prototype.update=function(t,e,i,n){var r=t.morphTargetInfluences,a=r.length,o=this.influencesList[e.id];if(void 0==o){o=[];for(var s=0;s<a;s++)o[s]=[s,0];this.influencesList[e.id]=o}for(var u=i.morphTargets&&e.morphAttributes.position,l=i.morphNormals&&e.morphAttributes.normal,h=0;h<a;h++){var d=o[h];0!=d[1]&&(u&&e.removeAttribute("morphTarget"+h),l&&e.removeAttribute("morphNormal"+h))}for(var f=0;f<a;f++){var c=o[f];c[0]=f,c[1]=r[f]}o.sort(this.absNumericalSort);for(var p=0;p<8;p++){var v=o[p];if(v){var m=v[0],g=v[1];if(g){u&&e.addAttribute("morphTarget"+p,u[m]),l&&e.addAttribute("morphNormal"+p,l[m]),this.morphInfluences[p]=g;continue}}this.morphInfluences[p]=0}n.getUniforms().setValue(this.gl,"morphTargetInfluences",this.morphInfluences)},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(23),s=n(o),u=function(){function t(e,i){(0,a["default"])(this,t),this.updateList={},this.geometries=e,this.info=i}return t.prototype.update=function(t){var e=this.info.render.frame,i=t.geometry,n=this.geometries.get(t,i);return this.updateList[n.id]!=e&&(i instanceof s["default"]&&n.updateFromObject(t),this.geometries.update(n),this.updateList[n.id]=e),n},t.prototype.dispose=function(){this.updateList={}},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(9),s=i(198),u=i(126),l=i(564),h=i(190),d=n(h),f=i(36),c=n(f),p=0,v=function(){function t(e,i,n,r,s,h,f){(0,a["default"])(this,t),this.renderer=e,this.extensions=i,this.code=n,this.material=r,this.shader=s,this.parameters=h,this.capabilities=f,this.gl=e.gl;var v=r.defines,m=s.vertexShader,g=s.fragmentShader,y="SHADOWMAP_TYPE_BASIC";h.shadowMapType==o.PCFShadowMap?y="SHADOWMAP_TYPE_PCF":h.shadowMapType==o.PCFSoftShadowMap&&(y="SHADOWMAP_TYPE_PCF_SOFT");var _="ENVMAP_TYPE_CUBE",x="ENVMAP_MODE_REFLECTION",b="ENVMAP_BLENDING_MULTIPLY";if(h.envMap){switch(r.envMap.mapping){case o.CubeReflectionMapping:case o.CubeRefractionMapping:_="ENVMAP_TYPE_CUBE";break;case o.CubeUVReflectionMapping:case o.CubeUVRefractionMapping:_="ENVMAP_TYPE_CUBE_UV";break;case o.EquirectangularReflectionMapping:case o.EquirectangularRefractionMapping:_="ENVMAP_TYPE_EQUIREC";break;case o.SphericalReflectionMapping:_="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case o.CubeRefractionMapping:case o.EquirectangularRefractionMapping:x="ENVMAP_MODE_REFRACTION"}switch(r.combine){case o.MultiplyOperation:b="ENVMAP_BLENDING_MULTIPLY";break;case o.MixOperation:b="ENVMAP_BLENDING_MIX";break;case o.AddOperation:b="ENVMAP_BLENDING_ADD"}}var M=e.gammaFactor>0?e.gammaFactor:1,w=f.isWebGL2?"":this.generateExtensions(r.extensions,h,i),S=this.generateDefines(v),P=this.gl.createProgram(),A=void 0,C=void 0;if(r instanceof d["default"]?(A=[S].filter(this.filterEmptyLine).join("\n"),A.length>0&&(A+="\n"),C=[w,S].filter(this.filterEmptyLine).join("\n"),C.length>0&&(C+="\n")):(A=["precision "+h.precision+" float;","precision "+h.precision+" int;","#define SHADER_NAME "+s.name,S,h.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+M,"#define MAX_BONES "+h.maxBones,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+x:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.normalMap&&h.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",h.displacementMap&&h.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.vertexColors?"#define USE_COLOR":"",h.flatShading?"#define FLAT_SHADED":"",h.skinning?"#define USE_SKINNING":"",h.useVertexTexture?"#define BONE_TEXTURE":"",h.morphTargets?"#define USE_MORPHTARGETS":"",h.morphNormals&&0==h.flatShading?"#define USE_MORPHNORMALS":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"",h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+y:"",h.sizeAttenuation?"#define USE_SIZEATTENUATION":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&(f.isWebGL2||i.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(this.filterEmptyLine).join("\n"),
C=[w,"precision "+h.precision+" float;","precision "+h.precision+" int;","#define SHADER_NAME "+s.name,S,h.alphaTest?"#define ALPHATEST "+h.alphaTest+(h.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+M,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.matcap?"#define USE_MATCAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+_:"",h.envMap?"#define "+x:"",h.envMap?"#define "+b:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.normalMap&&h.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.vertexColors?"#define USE_COLOR":"",h.gradientMap?"#define USE_GRADIENTMAP":"",h.flatShading?"#define FLAT_SHADED":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"",h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+y:"",h.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",h.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&(f.isWebGL2||i.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",h.envMap&&(f.isWebGL2||i.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",h.toneMapping!=o.NoToneMapping?"#define TONE_MAPPING":"",h.toneMapping!=o.NoToneMapping?u.ShaderChunk.tonemapping_pars_fragment:"",h.toneMapping!=o.NoToneMapping?this.getToneMappingFunction("toneMapping",h.toneMapping):"",h.dithering?"#define DITHERING":"",h.outputEncoding||h.mapEncoding||h.matcapEncoding||h.envMapEncoding||h.emissiveMapEncoding?u.ShaderChunk.encodings_pars_fragment:"",h.mapEncoding?this.getTexelDecodingFunction("mapTexelToLinear",h.mapEncoding):"",h.matcapEncoding?this.getTexelDecodingFunction("matcapTexelToLinear",h.matcapEncoding):"",h.envMapEncoding?this.getTexelDecodingFunction("envMapTexelToLinear",h.envMapEncoding):"",h.emissiveMapEncoding?this.getTexelDecodingFunction("emissiveMapTexelToLinear",h.emissiveMapEncoding):"",h.outputEncoding?this.getTexelEncodingFunction("linearToOutputTexel",h.outputEncoding):"",h.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(this.filterEmptyLine).join("\n")),m=this.parseIncludes(m),m=this.replaceLightNums(m,h),m=this.replaceClippingPlaneNums(m,h),g=this.parseIncludes(g),g=this.replaceLightNums(g,h),g=this.replaceClippingPlaneNums(g,h),m=this.unrollLoops(m),g=this.unrollLoops(g),f.isWebGL2&&!(r instanceof d["default"])){var T=!1,E=/^\s*#version\s+300\s+es\s*\n/;r instanceof c["default"]&&null!=m.match(E)&&null!=g.match(E)&&(T=!0,m=m.replace(E,""),g=g.replace(E,"")),A=["#version 300 es\n","#define attribute in","#define letying out","#define texture2D texture"].join("\n")+"\n"+A,C=["#version 300 es\n","#define letying in",T?"":"out highp vec4 pc_fragColor;",T?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+C}var D=A+m,L=C+g,F=new l.WebGLShader(this.gl,this.gl.VERTEX_SHADER,D),k=new l.WebGLShader(this.gl,this.gl.FRAGMENT_SHADER,L);this.gl.attachShader(P,F),this.gl.attachShader(P,k),void 0!=r.index0AttributeName?this.gl.bindAttribLocation(P,0,r.index0AttributeName):1==h.morphTargets&&this.gl.bindAttribLocation(P,0,"position"),this.gl.linkProgram(P);var I=this.gl.getProgramInfoLog(P).trim(),O=this.gl.getShaderInfoLog(F).trim(),N=this.gl.getShaderInfoLog(k).trim(),R=!0,U=!0;return 0==this.gl.getProgramParameter(P,this.gl.LINK_STATUS)?R=!1:""!=I||""!=O&&""!=N||(U=!1),U&&(this.diagnostics={runnable:R,material:r,programLog:I,vertexShader:{log:O,prefix:A},fragmentShader:{log:N,prefix:C}}),this.gl.deleteShader(F),this.gl.deleteShader(k),this.name=s.name,this.id=p++,this.code=n,this.usedTimes=1,this.program=P,this.vertexShader=F,this.fragmentShader=k,this}return t.prototype.getEncodingComponents=function(t){switch(t){case o.LinearEncoding:return["Linear","( value )"];case o.sRGBEncoding:return["sRGB","( value )"];case o.RGBEEncoding:return["RGBE","( value )"];case o.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case o.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case o.RGBDEncoding:return["RGBD","( value, 256.0 )"];case o.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}},t.prototype.getTexelDecodingFunction=function(t,e){var i=this.getEncodingComponents(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"},t.prototype.getTexelEncodingFunction=function(t,e){var i=this.getEncodingComponents(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"},t.prototype.getToneMappingFunction=function(t,e){var i=void 0;switch(e){case o.LinearToneMapping:i="Linear";break;case o.ReinhardToneMapping:i="Reinhard";break;case o.Uncharted2ToneMapping:i="Uncharted2";break;case o.CineonToneMapping:i="OptimizedCineon";break;case o.ACESFilmicToneMapping:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"},t.prototype.generateExtensions=function(t,e,i){t=t||{};var n=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap&&!e.objectSpaceNormalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(this.filterEmptyLine).join("\n")},t.prototype.generateDefines=function(t){var e=[];for(var i in t){var n=t[i];0!=n&&e.push("#define "+i+" "+n)}return e.join("\n")},t.prototype.fetchAttributeLocations=function(t,e){for(var i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<n;r++){var a=t.getActiveAttrib(e,r),o=a.name;i[o]=t.getAttribLocation(e,o)}return i},t.prototype.filterEmptyLine=function(t){return""!=t},t.prototype.replaceLightNums=function(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)},t.prototype.replaceClippingPlaneNums=function(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)},t.prototype.parseIncludes=function(t){function e(t,e){var i=u.ShaderChunk[e];if(void 0==i)throw new Error("Can not resolve #include <"+e+">");return n.parseIncludes(i)}var i=/^[ \t]*#include +<([\w\d.\/]+)>/gm,n=this;return t.replace(i,e)},t.prototype.unrollLoops=function(t){function e(t,e,i,n){for(var r="",a=parseInt(e);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]");return r}var i=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(i,e)},t.prototype.getUniforms=function(){return void 0==this.cachedUniforms&&(this.cachedUniforms=new s.WebGLUniforms(this.gl,this.program,this.renderer)),this.cachedUniforms},t.prototype.getAttributes=function(){return void 0==this.cachedAttributes&&(this.cachedAttributes=this.fetchAttributeLocations(this.gl,this.program)),this.cachedAttributes},t.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.program=void 0},t}();e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(559),s=n(o),u=i(9),l=i(27),h=n(l),d=i(38),f=n(d),c=i(194),p=n(c),v=i(128),m=n(v),g=function(){function t(e,i,n){(0,a["default"])(this,t),this.renderer=e,this.extensions=i,this.capabilities=n,this.programs=[],this.shaderIDs={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},this.parameterNames=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"]}return t.prototype.allocateBones=function(t){var e=t.skeleton,i=e.bones;if(this.capabilities.floatVertexTextures)return 1024;var n=this.capabilities.maxVertexUniforms,r=Math.floor((n-20)/4),a=Math.min(r,i.length);return a<i.length?0:a},t.prototype.getTextureEncodingFromMap=function(t,e){var i=void 0;return t?t instanceof h["default"]?i=t.encoding:t instanceof f["default"]&&(i=t.texture.encoding):i=u.LinearEncoding,i==u.LinearEncoding&&e&&(i=u.GammaEncoding),i},t.prototype.getParameters=function(t,e,i,n,r,a,o){var s=this.shaderIDs[t.type],l=o instanceof p["default"]?this.allocateBones(o):0,h=this.capabilities.precision;null!=t.precision&&(h=this.capabilities.getMaxPrecision(t.precision),h!=t.precision&&console.warn("WebGLProgram.getParameters:",t.precision,"not supported, using",h,"instead."));var d=this.renderer.getRenderTarget(),f={shaderID:s,precision:h,supportsVertexTextures:this.capabilities.vertexTextures,outputEncoding:this.getTextureEncodingFromMap(d?d.texture:null,this.renderer.gammaOutput),map:!!t.map,mapEncoding:this.getTextureEncodingFromMap(t.map,this.renderer.gammaInput),matcap:!!t.matcap,matcapEncoding:this.getTextureEncodingFromMap(t.matcap,this.renderer.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:this.getTextureEncodingFromMap(t.envMap,this.renderer.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping==u.CubeUVReflectionMapping||t.envMap.mapping==u.CubeUVRefractionMapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:this.getTextureEncodingFromMap(t.emissiveMap,this.renderer.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType==u.ObjectSpaceNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!n,useFog:t.fog,fogExp:n instanceof m["default"],flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:this.capabilities.logarithmicDepthBuffer,skinning:t.skinning&&l>0,maxBones:l,useVertexTexture:this.capabilities.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:this.renderer.maxMorphTargets,maxMorphNormals:this.renderer.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:r,numClipIntersection:a,dithering:t.dithering,shadowMapEnabled:this.renderer.shadowMap.enabled&&o.receiveShadow&&i.length>0,shadowMapType:this.renderer.shadowMap.type,toneMapping:this.renderer.toneMapping,physicallyCorrectLights:this.renderer.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side==u.DoubleSide,flipSided:t.side==u.BackSide,depthPacking:void 0!=t.depthPacking&&t.depthPacking};return f},t.prototype.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!=t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var r=0;r<this.parameterNames.length;r++)i.push(e[this.parameterNames[r]]);return i.push(t.onBeforeCompile.toString()),i.push(this.renderer.gammaOutput),i.push(this.renderer.gammaFactor),i.join()},t.prototype.acquireProgram=function(t,e,i,n){for(var r=void 0,a=0,o=this.programs.length;a<o;a++){var u=this.programs[a];if(u.code==n){r=u,++r.usedTimes;break}}return void 0==r&&(r=new s["default"](this.renderer,this.extensions,n,t,e,i,this.capabilities),this.programs.push(r)),r},t.prototype.releaseProgram=function(t){if(0==--t.usedTimes){var e=this.programs.indexOf(t);this.programs[e]=this.programs[this.programs.length-1],this.programs.pop(),t.destroy()}},t}();e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t),this.properties=new window.WeakMap}return t.prototype.get=function(t){var e=this.properties.get(t);return void 0==e&&(e={},this.properties.set(t,e)),e},t.prototype.remove=function(t){this.properties["delete"](t)},t.prototype.update=function(t,e,i){this.properties.get(t)[e]=i},t.prototype.dispose=function(){this.properties=new window.WeakMap},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLRenderLists=e.WebGLRenderList=void 0;var r=i(1),a=n(r),o=function(){function t(){(0,a["default"])(this,t),this.lists={}}return t.prototype.get=function(t,e){var i=this.lists[t.id],n=void 0;return void 0==i?(n=new s,this.lists[t.id]={},this.lists[t.id][e.id]=n):(n=i[e.id],void 0==n&&(n=new s,i[e.id]=n)),n},t.prototype.dispose=function(){this.lists={}},t}(),s=function(){function t(){(0,a["default"])(this,t),this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparent=[]}return t.prototype.init=function(){this.renderItemsIndex=0,this.opaque.length=0,this.transparent.length=0},t.prototype.getNextRenderItem=function(t,e,i,n,r){var a=this.renderItems[this.renderItemsIndex];return void 0==a?(a={id:t.id,object:t,geometry:e,material:i,program:i.program,renderOrder:t.renderOrder,z:n,group:r},this.renderItems[this.renderItemsIndex]=a):(a.id=t.id,a.object=t,a.geometry=e,a.material=i,a.program=i.program,a.renderOrder=t.renderOrder,a.z=n,a.group=r),this.renderItemsIndex++,a},t.prototype.push=function(t,e,i,n,r){var a=this.getNextRenderItem(t,e,i,n,r);(1==i.transparent?this.transparent:this.opaque).push(a)},t.prototype.unshift=function(t,e,i,n,r){var a=this.getNextRenderItem(t,e,i,n,r);(1==i.transparent?this.transparent:this.opaque).unshift(a)},t.prototype.sort=function(){this.opaque.length>1&&this.opaque.sort(this.painterSortStable),this.transparent.length>1&&this.transparent.sort(this.reversePainterSortStable)},t.prototype.painterSortStable=function(t,e){return t.renderOrder!=e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!=e.program?t.program.id-e.program.id:t.material.id!=e.material.id?t.material.id-e.material.id:t.z!=e.z?t.z-e.z:t.id-e.id},t.prototype.reversePainterSortStable=function(t,e){return t.renderOrder!=e.renderOrder?t.renderOrder-e.renderOrder:t.z!=e.z?e.z-t.z:t.id-e.id},t}();e.WebGLRenderList=s,e.WebGLRenderLists=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLRenderStates=e.WebGLRenderState=void 0;var r=i(1),a=n(r),o=i(556),s=n(o),u=function(){function t(){(0,a["default"])(this,t),this.renderStates={}}return t.prototype.get=function(t,e){var i;return void 0==this.renderStates[t.id]?(i=new l,this.renderStates[t.id]={},this.renderStates[t.id][e.id]=i):void 0==this.renderStates[t.id][e.id]?(i=new l,this.renderStates[t.id][e.id]=i):i=this.renderStates[t.id][e.id],i},t.prototype.dispose=function(){this.renderStates={}},t}(),l=function(){function t(){(0,a["default"])(this,t),this.lights=new s["default"],this.lightsArray=[],this.shadowsArray=[],this.state={lightsArray:this.lightsArray,shadowsArray:this.shadowsArray,lights:this.lights}}return t.prototype.init=function(){this.lightsArray.length=0,this.shadowsArray.length=0},t.prototype.pushLight=function(t){this.lightsArray.push(t)},t.prototype.pushShadow=function(t){this.shadowsArray.push(t)},t.prototype.setupLights=function(t){this.lights.setup(this.lightsArray,this.shadowsArray,t)},t}();e.WebGLRenderState=l,e.WebGLRenderStates=u},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLShader=void 0;var r=i(1),a=n(r);e.WebGLShader=function(){function t(e,i,n){(0,a["default"])(this,t),this.gl=e,this.type=i,this.string=n;var r=this.gl.createShader(this.type);return this.gl.shaderSource(r,this.string),this.gl.compileShader(r),0==this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS),""!=this.gl.getShaderInfoLog(r),r}return t.prototype.addLineNumbers=function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")},t}()},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(15),s=n(o),u=i(23),l=n(u),h=i(116),d=n(h),f=i(187),c=n(f),p=i(117),v=n(p),m=i(188),g=n(m),y=i(120),_=n(y),x=i(14),b=n(x),M=i(5),w=n(M),S=i(4),P=n(S),A=i(45),C=n(A),T=i(61),E=n(T),D=i(24),L=n(D),F=i(123),k=n(F),I=i(194),O=n(I),N=i(9),R=i(38),U=n(R),B=function(){function t(e,i,n){(0,a["default"])(this,t),this.renderer=e,this.objects=i,this.maxTextureSize=n,this.frustum=new _["default"],this.projScreenMatrix=new b["default"],this.shadowMapSize=new w["default"],this.maxShadowMapSize=new w["default"](n,n),this.lookTarget=new P["default"],this.lightPositionWorld=new P["default"],this.MorphingFlag=1,this.SkinningFlag=2,this.NumberOfMaterialVariants=(this.MorphingFlag|this.SkinningFlag)+1,this.depthMaterials=new Array(this.NumberOfMaterialVariants),this.distanceMaterials=new Array(this.NumberOfMaterialVariants),this.materialCache={},this.shadowSide={0:N.BackSide,1:N.FrontSide,2:N.DoubleSide},this.cubeDirections=[new P["default"](1,0,0),new P["default"]((-1),0,0),new P["default"](0,0,1),new P["default"](0,0,(-1)),new P["default"](0,1,0),new P["default"](0,(-1),0)],this.cubeUps=[new P["default"](0,1,0),new P["default"](0,1,0),new P["default"](0,1,0),new P["default"](0,1,0),new P["default"](0,0,1),new P["default"](0,0,(-1))],this.cube2DViewPorts=[new C["default"],new C["default"],new C["default"],new C["default"],new C["default"],new C["default"]];for(var r=0;r!=this.NumberOfMaterialVariants;++r){var o=0!=(r&this.MorphingFlag),s=0!=(r&this.SkinningFlag),u=new v["default"]({depthPacking:N.RGBADepthPacking,morphTargets:o,skinning:s});this.depthMaterials[r]=u;var l=new g["default"]({morphTargets:o,skinning:s});this.distanceMaterials[r]=l}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=N.PCFShadowMap}return t.prototype.render=function(t,e,i){if(0!=this.enabled&&(0!=this.autoUpdate||0!=this.needsUpdate)&&0!=t.length){var n=this.renderer.gl,r=this.renderer.state;r.disable(n.BLEND),r.buffers.color.setClear(1,1,1,1),r.buffers.depth.setTest(!0),r.setScissorTest(!1);for(var a=void 0,o=0,s=t.length;o<s;o++){var u=t[o],l=u.shadow;if(void 0!=l){var h=l.camera;this.shadowMapSize.copy(l.mapSize),this.shadowMapSize.min(this.maxShadowMapSize);var f=u instanceof d["default"]==1;if(f){var p=this.shadowMapSize.x,v=this.shadowMapSize.y;this.cube2DViewPorts[0].set(2*p,v,p,v),this.cube2DViewPorts[1].set(0,v,p,v),this.cube2DViewPorts[2].set(3*p,v,p,v),this.cube2DViewPorts[3].set(p,v,p,v),this.cube2DViewPorts[4].set(3*p,0,p,v),this.cube2DViewPorts[5].set(p,0,p,v),this.shadowMapSize.x*=4,this.shadowMapSize.y*=2}if(null==l.map){var m={minFilter:N.NearestFilter,magFilter:N.NearestFilter,format:N.RGBAFormat};l.map=new U["default"](this.shadowMapSize.x,this.shadowMapSize.y,m),h.updateProjectionMatrix()}l instanceof c["default"]&&l.update(u);var g=l.map,y=l.matrix;this.lightPositionWorld.setFromMatrixPosition(u.matrixWorld),h.position.copy(this.lightPositionWorld),f?(a=6,y.makeTranslation(-this.lightPositionWorld.x,-this.lightPositionWorld.y,-this.lightPositionWorld.z)):(a=1,this.lookTarget.setFromMatrixPosition(u.target.matrixWorld),h.lookAt(this.lookTarget),h.updateMatrixWorld(),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(h.projectionMatrix),y.multiply(h.matrixWorldInverse)),this.renderer.setRenderTarget(g),this.renderer.clear();for(var _=0;_<a;_++){if(f){this.lookTarget.copy(h.position),this.lookTarget.add(this.cubeDirections[_]),h.up.copy(this.cubeUps[_]),h.lookAt(this.lookTarget),h.updateMatrixWorld();var x=this.cube2DViewPorts[_];r.viewport(x)}this.projScreenMatrix.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),this.frustum.setFromMatrix(this.projScreenMatrix),this.renderObject(e,i,h,f)}}}this.needsUpdate=!1}},t.prototype.getDepthMaterial=function(t,e,i,n,r,a){var o=t.geometry,u=null,h=this.depthMaterials,d=t.customDepthMaterial;if(i&&(h=this.distanceMaterials,d=t.customDistanceMaterial),d)u=d;else{var f=!1;e.morphTargets&&(o instanceof s["default"]?f=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:o instanceof l["default"]&&(f=o.morphTargets&&o.morphTargets.length>0));var c=t instanceof O["default"]&&e.skinning,p=0;f&&(p|=this.MorphingFlag),c&&(p|=this.SkinningFlag),u=h[p]}if(this.renderer.localClippingEnabled&&1==e.clipShadows&&0!=e.clippingPlanes.length){var v=u.id,m=e.id,y=this.materialCache[v];void 0==y&&(y={},this.materialCache[v]=y);var _=y[m];void 0==_&&(_=u.clone(),y[m]=_),u=_}return u.visible=e.visible,u.wireframe=e.wireframe,u.side=null!=e.shadowSide?e.shadowSide:this.shadowSide[e.side],u.clipShadows=e.clipShadows,u.clippingPlanes=e.clippingPlanes,u.clipIntersection=e.clipIntersection,u.wireframeLineWidth=e.wireframeLineWidth,u.lineWidth=e.lineWidth,i&&u instanceof g["default"]&&(u.referencePosition.copy(n),u.nearDistance=r,u.farDistance=a),u},t.prototype.renderObject=function(t,e,i,n){if(0!=t.visible){var r=t.layers.test(e.layers);if(r&&(t instanceof L["default"]||t instanceof E["default"]||t instanceof k["default"])&&t.castShadow&&(!t.frustumCulled||this.frustum.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld);var a=this.objects.update(t),o=t.material;if(Array.isArray(o))for(var s=a.groups,u=0,l=s.length;u<l;u++){var h=s[u],d=o[h.materialIndex];if(d&&d.visible){var f=this.getDepthMaterial(t,d,n,this.lightPositionWorld,i.near,i.far);this.renderer.renderBufferDirect(i,null,a,f,t,h)}}else if(o.visible){var c=this.getDepthMaterial(t,o,n,this.lightPositionWorld,i.near,i.far);this.renderer.renderBufferDirect(i,null,a,c,t,null)}}for(var p=t.children,v=0,m=p.length;v<m;v++)this.renderObject(p[v],e,i,n)}},t}();e["default"]=B,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.StencilBuffer=e.DepthBuffer=e.ColorBuffer=e.WebGLState=void 0;var r=i(1),a=n(r),o=i(45),s=n(o),u=i(9),l=function(){function t(e,i,n,r){(0,a["default"])(this,t),this.gl=e,this.extensions=i,this.utils=n,this.capabilities=r,this.enabledCapabilities={},this.colorBuffer=new h(e,this),this.depthBuffer=new d(e,this),this.stencilBuffer=new f(e,this),this.buffers={color:this.colorBuffer,depth:this.depthBuffer,stencil:this.stencilBuffer},this.maxVertexAttributes=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.newAttributes=new Uint8Array(this.maxVertexAttributes),this.enabledAttributes=new Uint8Array(this.maxVertexAttributes),this.attributeDivisors=new Uint8Array(this.maxVertexAttributes),this.compressedTextureFormats=null,this.currentProgram=null,this.currentBlendingEnabled=null,this.currentBlending=null,this.currentBlendEquation=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendEquationAlpha=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=!1,this.currentFlipSided=null,this.currentCullFace=null,this.currentLineWidth=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.maxTextures=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.lineWidthAvailable=!1,this.version=0,this.glVersion=e.getParameter(e.VERSION),this.currentTextureSlot=null,this.currentBoundTextures={},this.emptyTextures={},this.initAttributes(),this.glVersion.indexOf("WebGL")!=-1?(this.version=parseFloat(/^WebGL\ ([0-9])/.exec(this.glVersion)[1]),this.lineWidthAvailable=this.version>=1):this.glVersion.indexOf("OpenGL ES")!=-1&&(this.version=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(this.glVersion)[1]),this.lineWidthAvailable=this.version>=2),this.emptyTextures[e.TEXTURE_2D]=this.createTexture(e.TEXTURE_2D,e.TEXTURE_2D,1),this.emptyTextures[e.TEXTURE_CUBE_MAP]=this.createTexture(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),this.colorBuffer.setClear(0,0,0,1),this.depthBuffer.setClear(1),this.stencilBuffer.setClear(0),this.enable(e.DEPTH_TEST),this.depthBuffer.setFunc(u.LessEqualDepth),this.setFlipSided(!1),this.setCullFace(u.CullFaceBack),this.enable(e.CULL_FACE),this.setBlending(u.NoBlending)}return t.prototype.enable=function(t){1!=this.enabledCapabilities[t]&&(this.gl.enable(t),this.enabledCapabilities[t]=!0)},t.prototype.disable=function(t){0!=this.enabledCapabilities[t]&&(this.gl.disable(t),this.enabledCapabilities[t]=!1)},t.prototype.createTexture=function(t,e,i){var n=new Uint8Array(4),r=this.gl.createTexture();this.gl.bindTexture(t,r),this.gl.texParameteri(t,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(t,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);for(var a=0;a<i;a++)this.gl.texImage2D(e+a,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n);return r},t.prototype.initAttributes=function(){this.currentScissor=new s["default"],this.currentViewport=new s["default"]},t.prototype.scissor=function(t){0==this.currentScissor.equals(t)&&(this.gl.scissor(t.x,t.y,t.z,t.w),this.currentScissor.copy(t))},t.prototype.viewport=function(t){0==this.currentViewport.equals(t)&&(this.gl.viewport(t.x,t.y,t.z,t.w),this.currentViewport.copy(t))},t.prototype.enableAttribute=function(t){this.enableAttributeAndDivisor(t,0)},t.prototype.enableAttributeAndDivisor=function(t,e){if(this.newAttributes[t]=1,0==this.enabledAttributes[t]&&(this.gl.enableVertexAttribArray(t),this.enabledAttributes[t]=1),this.attributeDivisors[t]!=e){var i=this.capabilities.isWebGL2?this.gl:this.extensions.get("ANGLE_instanced_arrays");i[this.capabilities.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](t,e),this.attributeDivisors[t]=e}},t.prototype.disableUnusedAttributes=function(){for(var t=0,e=this.enabledAttributes.length;t!=e;++t)this.enabledAttributes[t]!=this.newAttributes[t]&&(this.gl.disableVertexAttribArray(t),this.enabledAttributes[t]=0)},t.prototype.getCompressedTextureFormats=function(){if(null==this.compressedTextureFormats&&(this.compressedTextureFormats=[],this.extensions.get("WEBGL_compressed_texture_pvrtc")||this.extensions.get("WEBGL_compressed_texture_s3tc")||this.extensions.get("WEBGL_compressed_texture_etc1")||this.extensions.get("WEBGL_compressed_texture_astc")))for(var t=this.gl.getParameter(this.gl.COMPRESSED_TEXTURE_FORMATS),e=0;e<t.length;e++)this.compressedTextureFormats.push(t[e]);return this.compressedTextureFormats},t.prototype.useProgram=function(t){return this.currentProgram!=t&&(this.gl.useProgram(t),this.currentProgram=t,!0)},t.prototype.setBlending=function(t,e,i,n,r,a,o,s){if(t==u.NoBlending)return void(this.currentBlendingEnabled&&(this.disable(this.gl.BLEND),this.currentBlendingEnabled=!1));if(this.currentBlendingEnabled||(this.enable(this.gl.BLEND),this.currentBlendingEnabled=!0),t==u.CustomBlending)r=r||e,a=a||i,o=o||n,e==this.currentBlendEquation&&r==this.currentBlendEquationAlpha||(this.gl.blendEquationSeparate(this.utils.convert(e),this.utils.convert(r)),this.currentBlendEquation=e,this.currentBlendEquationAlpha=r),i==this.currentBlendSrc&&n==this.currentBlendDst&&a==this.currentBlendSrcAlpha&&o==this.currentBlendDstAlpha||(this.gl.blendFuncSeparate(this.utils.convert(i),this.utils.convert(n),this.utils.convert(a),this.utils.convert(o)),this.currentBlendSrc=i,this.currentBlendDst=n,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=o),this.currentBlending=t,this.currentPremultipledAlpha=null;else if(t!=this.currentBlending||s!=this.currentPremultipledAlpha){if(this.currentBlendEquation==u.AddEquation&&this.currentBlendEquationAlpha==u.AddEquation||(this.gl.blendEquation(this.gl.FUNC_ADD),this.currentBlendEquation=u.AddEquation,this.currentBlendEquationAlpha=u.AddEquation),s)switch(t){case u.NormalBlending:this.gl.blendFuncSeparate(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);break;case u.AdditiveBlending:this.gl.blendFunc(this.gl.ONE,this.gl.ONE);break;case u.SubtractiveBlending:this.gl.blendFuncSeparate(this.gl.ZERO,this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE_MINUS_SRC_ALPHA);break;case u.MultiplyBlending:this.gl.blendFuncSeparate(this.gl.ZERO,this.gl.SRC_COLOR,this.gl.ZERO,this.gl.SRC_ALPHA);break;default:console.error("WebGLState: Invalid blending: ",t)}else switch(t){case u.NormalBlending:this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);break;case u.AdditiveBlending:this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE);break;case u.SubtractiveBlending:this.gl.blendFunc(this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR);break;case u.MultiplyBlending:this.gl.blendFunc(this.gl.ZERO,this.gl.SRC_COLOR);break;default:console.error("WebGLState: Invalid blending: ",t)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=t,this.currentPremultipledAlpha=s}},t.prototype.setMaterial=function(t,e){t.side==u.DoubleSide?this.disable(this.gl.CULL_FACE):this.enable(this.gl.CULL_FACE);var i=t.side==u.BackSide;e&&(i=!i),this.setFlipSided(i),t.blending==u.NormalBlending&&0==t.transparent?this.setBlending(u.NoBlending):this.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),this.depthBuffer.setFunc(t.depthFunc),this.depthBuffer.setTest(t.depthTest),this.depthBuffer.setMask(t.depthWrite),this.colorBuffer.setMask(t.colorWrite),this.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},t.prototype.setFlipSided=function(t){this.currentFlipSided!=t&&(t?this.gl.frontFace(this.gl.CW):this.gl.frontFace(this.gl.CCW),this.currentFlipSided=t)},t.prototype.setCullFace=function(t){t!=u.CullFaceNone?(this.enable(this.gl.CULL_FACE),t!=this.currentCullFace&&(t==u.CullFaceBack?this.gl.cullFace(this.gl.BACK):t==u.CullFaceFront?this.gl.cullFace(this.gl.FRONT):this.gl.cullFace(this.gl.FRONT_AND_BACK))):this.disable(this.gl.CULL_FACE),this.currentCullFace=t},t.prototype.setLineWidth=function(t){t!=this.currentLineWidth&&(this.lineWidthAvailable&&this.gl.lineWidth(t),
this.currentLineWidth=t)},t.prototype.setPolygonOffset=function(t,e,i){t?(this.enable(this.gl.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor==e&&this.currentPolygonOffsetUnits==i||(this.gl.polygonOffset(e,i),this.currentPolygonOffsetFactor=e,this.currentPolygonOffsetUnits=i)):this.disable(this.gl.POLYGON_OFFSET_FILL)},t.prototype.setScissorTest=function(t){t?this.enable(this.gl.SCISSOR_TEST):this.disable(this.gl.SCISSOR_TEST)},t.prototype.activeTexture=function(t){void 0==t&&(t=this.gl.TEXTURE0+this.maxTextures-1),this.currentTextureSlot!=t&&(this.gl.activeTexture(t),this.currentTextureSlot=t)},t.prototype.bindTexture=function(t,e){null==this.currentTextureSlot&&this.activeTexture();var i=this.currentBoundTextures[this.currentTextureSlot];void 0==i&&(i={type:void 0,texture:void 0},this.currentBoundTextures[this.currentTextureSlot]=i),i.type==t&&i.texture==e||(this.gl.bindTexture(t,e||this.emptyTextures[t]),i.type=t,i.texture=e)},t.prototype.compressedTexImage2D=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];try{this.gl.compressedTexImage2D.apply(this.gl,arguments)}catch(n){console.error("WebGLState:",n)}},t.prototype.texImage2D=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];try{this.gl.texImage2D.apply(this.gl,arguments)}catch(n){console.error("WebGLState:",n)}},t.prototype.texImage3D=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];try{this.gl.texImage3D.apply(this.gl,arguments)}catch(n){}},t.prototype.reset=function(){for(var t=0;t<this.enabledAttributes.length;t++)1==this.enabledAttributes[t]&&(this.gl.disableVertexAttribArray(t),this.enabledAttributes[t]=0);this.enabledCapabilities={},this.compressedTextureFormats=null,this.currentTextureSlot=null,this.currentBoundTextures={},this.currentProgram=null,this.currentBlending=null,this.currentFlipSided=null,this.currentCullFace=null,this.colorBuffer.reset(),this.depthBuffer.reset(),this.stencilBuffer.reset()},t}(),h=function(){function t(e,i){(0,a["default"])(this,t),this.locked=!1,this.color=new s["default"],this.currentColorMask=null,this.currentColorClear=new s["default"](0,0,0,0),this.gl=e,this.state=i}return t.prototype.setMask=function(t){this.currentColorMask==t||this.locked||(this.gl.colorMask(t,t,t,t),this.currentColorMask=t)},t.prototype.setLocked=function(t){this.locked=t},t.prototype.setClear=function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];1==r&&(t*=n,e*=n,i*=n),this.color.set(t,e,i,n),0==this.currentColorClear.equals(this.color)&&(this.gl.clearColor(t,e,i,n),this.currentColorClear.copy(this.color))},t.prototype.reset=function(){this.locked=!1,this.currentColorMask=null,this.currentColorClear.set(-1,0,0,0)},t}(),d=function(){function t(e,i){(0,a["default"])(this,t),this.locked=!1,this.currentDepthMask=null,this.currentDepthFunc=null,this.currentDepthClear=null,this.gl=e,this.state=i}return t.prototype.setTest=function(t){t?this.state.enable(this.gl.DEPTH_TEST):this.state.disable(this.gl.DEPTH_TEST)},t.prototype.setMask=function(t){this.currentDepthMask==t||this.locked||(this.gl.depthMask(t),this.currentDepthMask=t)},t.prototype.setFunc=function(t){if(this.currentDepthFunc!=t){if(t)switch(t){case u.NeverDepth:this.gl.depthFunc(this.gl.NEVER);break;case u.AlwaysDepth:this.gl.depthFunc(this.gl.ALWAYS);break;case u.LessDepth:this.gl.depthFunc(this.gl.LESS);break;case u.LessEqualDepth:this.gl.depthFunc(this.gl.LEQUAL);break;case u.EqualDepth:this.gl.depthFunc(this.gl.EQUAL);break;case u.GreaterEqualDepth:this.gl.depthFunc(this.gl.GEQUAL);break;case u.GreaterDepth:this.gl.depthFunc(this.gl.GREATER);break;case u.NotEqualDepth:this.gl.depthFunc(this.gl.NOTEQUAL);break;default:this.gl.depthFunc(this.gl.LEQUAL)}else this.gl.depthFunc(this.gl.LEQUAL);this.currentDepthFunc=t}},t.prototype.setLocked=function(t){this.locked=t},t.prototype.setClear=function(t){this.currentDepthClear!=t&&(this.gl.clearDepth(t),this.currentDepthClear=t)},t.prototype.reset=function(){this.locked=!1,this.currentDepthMask=null,this.currentDepthFunc=null,this.currentDepthClear=null},t}(),f=function(){function t(e,i){(0,a["default"])(this,t),this.locked=!1,this.currentStencilMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilClear=null,this.gl=e,this.state=i}return t.prototype.setTest=function(t){t?this.state.enable(this.gl.STENCIL_TEST):this.state.disable(this.gl.STENCIL_TEST)},t.prototype.setMask=function(t){this.currentStencilMask==t||this.locked||(this.gl.stencilMask(t),this.currentStencilMask=t)},t.prototype.setFunc=function(t,e,i){this.currentStencilFunc==t&&this.currentStencilRef==e&&this.currentStencilFuncMask==i||(this.gl.stencilFunc(t,e,i),this.currentStencilFunc=t,this.currentStencilRef=e,this.currentStencilFuncMask=i)},t.prototype.setOp=function(t,e,i){this.currentStencilFail==t&&this.currentStencilZFail==e&&this.currentStencilZPass==i||(this.gl.stencilOp(t,e,i),this.currentStencilFail=t,this.currentStencilZFail=e,this.currentStencilZPass=i)},t.prototype.setLocked=function(t){this.locked=t},t.prototype.setClear=function(t){this.currentStencilClear!=t&&(this.gl.clearStencil(t),this.currentStencilClear=t)},t.prototype.reset=function(){this.locked=!1,this.currentStencilMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilClear=null},t}();e.WebGLState=l,e.ColorBuffer=h,e.DepthBuffer=d,e.StencilBuffer=f},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(7),s=n(o),u=i(9),l=i(201),h=n(l),d=i(125),f=n(d),c=i(199),p=n(c),v=i(200),m=n(v),g=i(571),y=n(g),_=i(570),x=n(_),b=function(){function t(e,i,n,r,o,s,u){(0,a["default"])(this,t),this._gl=e,this.extensions=i,this.state=n,this.properties=r,this.capabilities=o,this.utils=s,this.info=u,this._videoTextures={}}return t.prototype.clampToMaxSize=function(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var i=e/Math.max(t.width,t.height),n=document.createElement("canvas");n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i);var r=n.getContext("2d");return r.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),n}return t},t.prototype.isPowerOfTwo=function(t){return s["default"].isPowerOfTwo(t.width)&&s["default"].isPowerOfTwo(t.height)},t.prototype.makePowerOfTwo=function(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap){void 0==this._canvas&&(this._canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),this._canvas.width=s["default"].floorPowerOfTwo(t.width),this._canvas.height=s["default"].floorPowerOfTwo(t.height);var e=this._canvas.getContext("2d");return e.drawImage(t,0,0,this._canvas.width,this._canvas.height),this._canvas}return t},t.prototype.textureNeedsPowerOfTwo=function(t){return!this.capabilities.isWebGL2&&(t.wrapS!=u.ClampToEdgeWrapping||t.wrapT!=u.ClampToEdgeWrapping||t.minFilter!=u.NearestFilter&&t.minFilter!=u.LinearFilter)},t.prototype.textureNeedsGenerateMipmaps=function(t,e){return t.generateMipmaps&&e&&t.minFilter!=u.NearestFilter&&t.minFilter!=u.LinearFilter},t.prototype.generateMipmap=function(t,e,i,n){this._gl.generateMipmap(t);var r=this.properties.get(e);r.__maxMipLevel=Math.log(Math.max(i,n))*Math.LOG2E},t.prototype.getInternalFormat=function(t,e){if(!this.capabilities.isWebGL2)return t;if(t==this._gl.RED){if(e==this._gl.FLOAT)return this._gl.R32F;if(e==this._gl.HALF_FLOAT)return this._gl.R16F;if(e==this._gl.UNSIGNED_BYTE)return this._gl.R8}if(t==this._gl.RGB){if(e==this._gl.FLOAT)return this._gl.RGB32F;if(e==this._gl.HALF_FLOAT)return this._gl.RGB16F;if(e==this._gl.UNSIGNED_BYTE)return this._gl.RGB8}if(t==this._gl.RGBA){if(e==this._gl.FLOAT)return this._gl.RGBA32F;if(e==this._gl.HALF_FLOAT)return this._gl.RGBA16F;if(e==this._gl.UNSIGNED_BYTE)return this._gl.RGBA8}return t},t.prototype.filterFallback=function(t){return t==u.NearestFilter||t==u.NearestMipMapNearestFilter||t==u.NearestMipMapLinearFilter?this._gl.NEAREST:this._gl.LINEAR},t.prototype.onTextureDispose=function(t){var e=t;e.off("dispose",this.onTextureDispose,this),this.deallocateTexture(e),e instanceof h["default"]&&delete this._videoTextures[e.id],this.info.memory.textures--},t.prototype.onRenderTargetDispose=function(t){var e=t;e.off("dispose",this.onRenderTargetDispose,this),this.deallocateRenderTarget(e),this.info.memory.textures--},t.prototype.deallocateTexture=function(t){var e=this.properties.get(t);if(t.image&&e.__image__webglTextureCube)this._gl.deleteTexture(e.__image__webglTextureCube);else{if(void 0==e.__webglInit)return;this._gl.deleteTexture(e.__webglTexture)}this.properties.remove(t)},t.prototype.deallocateRenderTarget=function(t){var e=this.properties.get(t),i=this.properties.get(t.texture);if(t){if(void 0!=i.__webglTexture&&this._gl.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t instanceof f["default"])for(var n=0;n<6;n++)this._gl.deleteFramebuffer(e.__webglFramebuffer[n]),e.__webglDepthbuffer&&this._gl.deleteRenderbuffer(e.__webglDepthbuffer[n]);else this._gl.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&this._gl.deleteRenderbuffer(e.__webglDepthbuffer);this.properties.remove(t.texture),this.properties.remove(t)}},t.prototype.setTexture2D=function(t,e){var i=this.properties.get(t);if(t instanceof h["default"]&&this.updateVideoTexture(t),t.version>0&&i.__version!=t.version){var n=t.image;if(void 0==n)console.warn("WebGLRenderer: Texture marked for update but image is undefined");else if(0!=n.complete)return void this.uploadTexture(i,t,e)}this.state.activeTexture(this._gl.TEXTURE0+e),this.state.bindTexture(this._gl.TEXTURE_2D,i.__webglTexture)},t.prototype.setTexture3D=function(t,e){var i=this.properties.get(t);return t.version>0&&i.__version!=t.version?void this.uploadTexture(i,t,e):(this.state.activeTexture(this._gl.TEXTURE0+e),void this.state.bindTexture(this._gl.TEXTURE_3D,i.__webglTexture))},t.prototype.setTextureCube=function(t,e){var i=this.properties.get(t);if(6==t.image.length)if(t.version>0&&i.__version!=t.version){i.__image__webglTextureCube||(t.on("dispose",this.onTextureDispose,this),i.__image__webglTextureCube=this._gl.createTexture(),this.info.memory.textures++),this.state.activeTexture(this._gl.TEXTURE0+e),this.state.bindTexture(this._gl.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var n=t&&t instanceof x["default"],r=t.image[0]&&t.image[0]instanceof p["default"],a=[],o=0;o<6;o++)n||r?a[o]=r?t.image[o].image:t.image[o]:a[o]=this.clampToMaxSize(t.image[o],this.capabilities.maxCubemapSize);var s=a[0],l=this.isPowerOfTwo(s),h=this.utils.convert(t.format),d=this.utils.convert(t.type),f=this.getInternalFormat(h,d);this.setTextureParameters(this._gl.TEXTURE_CUBE_MAP,t,l);for(var c=0;c<6;c++)if(n)for(var v,m=a[c].mipmaps,g=0,y=m.length;g<y;g++)v=m[g],t.format!=u.RGBAFormat&&t.format!=u.RGBFormat?this.state.getCompressedTextureFormats().indexOf(h)>-1&&this.state.compressedTexImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+c,g,f,v.width,v.height,0,v.data):this.state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+c,g,f,v.width,v.height,0,h,d,v.data);else r?this.state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,f,a[c].width,a[c].height,0,h,d,a[c].data):this.state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,f,h,d,a[c]);n?i.__maxMipLevel=m.length-1:i.__maxMipLevel=0,this.textureNeedsGenerateMipmaps(t,l)&&this.generateMipmap(this._gl.TEXTURE_CUBE_MAP,t,s.width,s.height),i.__version=t.version,t.onUpdate&&t.onUpdate(t)}else this.state.activeTexture(this._gl.TEXTURE0+e),this.state.bindTexture(this._gl.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)},t.prototype.setTextureCubeDynamic=function(t,e){this.state.activeTexture(this._gl.TEXTURE0+e),this.state.bindTexture(this._gl.TEXTURE_CUBE_MAP,this.properties.get(t).__webglTexture)},t.prototype.setTextureParameters=function(t,e,i){var n=void 0;if(i?(this._gl.texParameteri(t,this._gl.TEXTURE_WRAP_S,this.utils.convert(e.wrapS)),this._gl.texParameteri(t,this._gl.TEXTURE_WRAP_T,this.utils.convert(e.wrapT)),this._gl.texParameteri(t,this._gl.TEXTURE_MAG_FILTER,this.utils.convert(e.magFilter)),this._gl.texParameteri(t,this._gl.TEXTURE_MIN_FILTER,this.utils.convert(e.minFilter))):(this._gl.texParameteri(t,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(t,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),e.wrapS!=u.ClampToEdgeWrapping||e.wrapT!=u.ClampToEdgeWrapping,this._gl.texParameteri(t,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(e.magFilter)),this._gl.texParameteri(t,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(e.minFilter)),e.minFilter!=u.NearestFilter&&e.minFilter!=u.LinearFilter),n=this.extensions.get("EXT_texture_filter_anisotropic")){if(e.type==u.FloatType&&null==this.extensions.get("OES_texture_float_linear"))return;if(e.type==u.HalfFloatType&&null==(this.capabilities.isWebGL2||this.extensions.get("OES_texture_half_float_linear")))return;(e.anisotropy>1||this.properties.get(e).__currentAnisotropy)&&(this._gl.texParameterf(t,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,this.capabilities.getMaxAnisotropy())),this.properties.get(e).__currentAnisotropy=e.anisotropy)}},t.prototype.uploadTexture=function(t,e,i){var n=void 0;n=e instanceof m["default"]?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D,void 0==t.__webglInit&&(t.__webglInit=!0,e.on("dispose",this.onTextureDispose,this),t.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this.state.activeTexture(this._gl.TEXTURE0+i),this.state.bindTexture(n,t.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,e.unpackAlignment);var r=this.clampToMaxSize(e.image,this.capabilities.maxTextureSize);this.textureNeedsPowerOfTwo(e)&&0==this.isPowerOfTwo(r)&&(r=this.makePowerOfTwo(r));var a=this.isPowerOfTwo(r),o=this.utils.convert(e.format),s=this.utils.convert(e.type),l=this.getInternalFormat(o,s);this.setTextureParameters(n,e,a);var h=void 0,d=e.mipmaps;if(e instanceof y["default"]){if(l=this._gl.DEPTH_COMPONENT,e.type==u.FloatType){if(!this.capabilities.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");l=this._gl.DEPTH_COMPONENT32F}else this.capabilities.isWebGL2&&(l=this._gl.DEPTH_COMPONENT16);e.format==u.DepthFormat&&l==this._gl.DEPTH_COMPONENT&&e.type!=u.UnsignedShortType&&e.type!=u.UnsignedIntType&&(e.type=u.UnsignedShortType,s=this.utils.convert(e.type)),e.format==u.DepthStencilFormat&&(l=this._gl.DEPTH_STENCIL,e.type!=u.UnsignedInt248Type&&(e.type=u.UnsignedInt248Type,s=this.utils.convert(e.type))),this.state.texImage2D(this._gl.TEXTURE_2D,0,l,r.width,r.height,0,o,s,null)}else if(e instanceof p["default"])if(d.length>0&&a){for(var f=0,c=d.length;f<c;f++)h=d[f],this.state.texImage2D(this._gl.TEXTURE_2D,f,l,h.width,h.height,0,o,s,h.data);e.generateMipmaps=!1,t.__maxMipLevel=d.length-1}else this.state.texImage2D(this._gl.TEXTURE_2D,0,l,r.width,r.height,0,o,s,r.data),t.__maxMipLevel=0;else if(e instanceof x["default"]){for(var v=0,g=d.length;v<g;v++)h=d[v],e.format!=u.RGBAFormat&&e.format!=u.RGBFormat?this.state.getCompressedTextureFormats().indexOf(o)>-1&&this.state.compressedTexImage2D(this._gl.TEXTURE_2D,v,l,h.width,h.height,0,h.data):this.state.texImage2D(this._gl.TEXTURE_2D,v,l,h.width,h.height,0,o,s,h.data);t.__maxMipLevel=d.length-1}else if(e instanceof m["default"])this.state.texImage3D(this._gl.TEXTURE_3D,0,l,r.width,r.height,r.depth,0,o,s,r.data),t.__maxMipLevel=0;else if(d.length>0&&a){for(var _=0,b=d.length;_<b;_++)h=d[_],this.state.texImage2D(this._gl.TEXTURE_2D,_,l,o,s,h);e.generateMipmaps=!1,t.__maxMipLevel=d.length-1}else this.state.texImage2D(this._gl.TEXTURE_2D,0,l,o,s,r),t.__maxMipLevel=0;this.textureNeedsGenerateMipmaps(e,a)&&this.generateMipmap(this._gl.TEXTURE_2D,e,r.width,r.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)},t.prototype.setupFrameBufferTexture=function(t,e,i,n){var r=this.utils.convert(e.texture.format),a=this.utils.convert(e.texture.type),o=this.getInternalFormat(r,a);this.state.texImage2D(n,0,o,e.width,e.height,0,r,a,null),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,t),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,i,n,this.properties.get(e.texture).__webglTexture,0),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)},t.prototype.setupRenderBufferStorage=function(t,e){this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,e.width,e.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_STENCIL,e.width,e.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.RENDERBUFFER,t)):this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.RGBA4,e.width,e.height),this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null)},t.prototype.setupDepthTexture=function(t,e){var i=e instanceof f["default"];if(i)throw new Error("Depth Texture with cube render targets is not supported");if(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,t),!(e.depthTexture instanceof y["default"]))throw new Error("renderTarget.depthTexture must be an instance of DepthTexture");this.properties.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width==e.width&&e.depthTexture.image.height==e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),this.setTexture2D(e.depthTexture,0);var n=this.properties.get(e.depthTexture).__webglTexture;if(e.depthTexture.format==u.DepthFormat)this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,n,0);else{if(e.depthTexture.format!=u.DepthStencilFormat)throw new Error("Unknown depthTexture format");this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.TEXTURE_2D,n,0)}},t.prototype.setupDepthRenderbuffer=function(t){var e=this.properties.get(t),i=t instanceof f["default"]==1;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");this.setupDepthTexture(e.__webglFramebuffer,t)}else if(i){e.__webglDepthbuffer=[];for(var n=0;n<6;n++)this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e.__webglFramebuffer[n]),e.__webglDepthbuffer[n]=this._gl.createRenderbuffer(),this.setupRenderBufferStorage(e.__webglDepthbuffer[n],t)}else this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=this._gl.createRenderbuffer(),this.setupRenderBufferStorage(e.__webglDepthbuffer,t);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)},t.prototype.setupRenderTarget=function(t){var e=this.properties.get(t),i=this.properties.get(t.texture);t.on("dispose",this.onRenderTargetDispose,this),i.__webglTexture=this._gl.createTexture(),this.info.memory.textures++;var n=t instanceof f["default"]==1,r=this.isPowerOfTwo(t);if(n){e.__webglFramebuffer=[];for(var a=0;a<6;a++)e.__webglFramebuffer[a]=this._gl.createFramebuffer()}else e.__webglFramebuffer=this._gl.createFramebuffer();if(n){this.state.bindTexture(this._gl.TEXTURE_CUBE_MAP,i.__webglTexture),this.setTextureParameters(this._gl.TEXTURE_CUBE_MAP,t.texture,r);for(var o=0;o<6;o++)this.setupFrameBufferTexture(e.__webglFramebuffer[o],t,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+o);this.textureNeedsGenerateMipmaps(t.texture,r)&&this.generateMipmap(this._gl.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),this.state.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)}else this.state.bindTexture(this._gl.TEXTURE_2D,i.__webglTexture),this.setTextureParameters(this._gl.TEXTURE_2D,t.texture,r),this.setupFrameBufferTexture(e.__webglFramebuffer,t,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D),this.textureNeedsGenerateMipmaps(t.texture,r)&&this.generateMipmap(this._gl.TEXTURE_2D,t.texture,t.width,t.height),this.state.bindTexture(this._gl.TEXTURE_2D,null);t.depthBuffer&&this.setupDepthRenderbuffer(t)},t.prototype.updateRenderTargetMipmap=function(t){var e=t.texture,i=this.isPowerOfTwo(t);if(this.textureNeedsGenerateMipmaps(e,i)){var n=t instanceof f["default"]?this._gl.TEXTURE_CUBE_MAP:this._gl.TEXTURE_2D,r=this.properties.get(e).__webglTexture;this.state.bindTexture(n,r),this.generateMipmap(n,e,t.width,t.height),this.state.bindTexture(n,null)}},t.prototype.updateVideoTexture=function(t){var e=t.id,i=this.info.render.frame;this._videoTextures[e]!=i&&(this._videoTextures[e]=i,t.update())},t}();e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(9),s=function(){function t(e,i){(0,a["default"])(this,t),this.gl=e,this.extensions=i}return t.prototype.convert=function(t){var e=void 0;if(t==o.RepeatWrapping)return this.gl.REPEAT;if(t==o.ClampToEdgeWrapping)return this.gl.CLAMP_TO_EDGE;if(t==o.MirroredRepeatWrapping)return this.gl.MIRRORED_REPEAT;if(t==o.NearestFilter)return this.gl.NEAREST;if(t==o.NearestMipMapNearestFilter)return this.gl.NEAREST_MIPMAP_NEAREST;if(t==o.NearestMipMapLinearFilter)return this.gl.NEAREST_MIPMAP_LINEAR;if(t==o.LinearFilter)return this.gl.LINEAR;if(t==o.LinearMipMapNearestFilter)return this.gl.LINEAR_MIPMAP_NEAREST;if(t==o.LinearMipMapLinearFilter)return this.gl.LINEAR_MIPMAP_LINEAR;if(t==o.UnsignedByteType)return this.gl.UNSIGNED_BYTE;if(t==o.UnsignedShort4444Type)return this.gl.UNSIGNED_SHORT_4_4_4_4;if(t==o.UnsignedShort5551Type)return this.gl.UNSIGNED_SHORT_5_5_5_1;if(t==o.UnsignedShort565Type)return this.gl.UNSIGNED_SHORT_5_6_5;if(t==o.ByteType)return this.gl.BYTE;if(t==o.ShortType)return this.gl.SHORT;if(t==o.UnsignedShortType)return this.gl.UNSIGNED_SHORT;if(t==o.IntType)return this.gl.INT;if(t==o.UnsignedIntType)return this.gl.UNSIGNED_INT;if(t==o.FloatType)return this.gl.FLOAT;if(t==o.HalfFloatType&&(e=this.extensions.get("OES_texture_half_float"),null!=e))return e.HALF_FLOAT_OES;if(t==o.AlphaFormat)return this.gl.ALPHA;if(t==o.RGBFormat)return this.gl.RGB;if(t==o.RGBAFormat)return this.gl.RGBA;if(t==o.LuminanceFormat)return this.gl.LUMINANCE;if(t==o.LuminanceAlphaFormat)return this.gl.LUMINANCE_ALPHA;if(t==o.DepthFormat)return this.gl.DEPTH_COMPONENT;if(t==o.DepthStencilFormat)return this.gl.DEPTH_STENCIL;if(t==o.AddEquation)return this.gl.FUNC_ADD;if(t==o.SubtractEquation)return this.gl.FUNC_SUBTRACT;if(t==o.ReverseSubtractEquation)return this.gl.FUNC_REVERSE_SUBTRACT;if(t==o.ZeroFactor)return this.gl.ZERO;if(t==o.OneFactor)return this.gl.ONE;if(t==o.SrcColorFactor)return this.gl.SRC_COLOR;if(t==o.OneMinusSrcColorFactor)return this.gl.ONE_MINUS_SRC_COLOR;if(t==o.SrcAlphaFactor)return this.gl.SRC_ALPHA;if(t==o.OneMinusSrcAlphaFactor)return this.gl.ONE_MINUS_SRC_ALPHA;if(t==o.DstAlphaFactor)return this.gl.DST_ALPHA;if(t==o.OneMinusDstAlphaFactor)return this.gl.ONE_MINUS_DST_ALPHA;if(t==o.DstColorFactor)return this.gl.DST_COLOR;if(t==o.OneMinusDstColorFactor)return this.gl.ONE_MINUS_DST_COLOR;if(t==o.SrcAlphaSaturateFactor)return this.gl.SRC_ALPHA_SATURATE;if((t==o.RGB_S3TC_DXT1_Format||t==o.RGBA_S3TC_DXT1_Format||t==o.RGBA_S3TC_DXT3_Format||t==o.RGBA_S3TC_DXT5_Format)&&(e=this.extensions.get("WEBGL_compressed_texture_s3tc"),null!=e)){if(t==o.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t==o.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t==o.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t==o.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t==o.RGB_PVRTC_4BPPV1_Format||t==o.RGB_PVRTC_2BPPV1_Format||t==o.RGBA_PVRTC_4BPPV1_Format||t==o.RGBA_PVRTC_2BPPV1_Format)&&(e=this.extensions.get("WEBGL_compressed_texture_pvrtc"),null!=e)){if(t==o.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t==o.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t==o.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t==o.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t==o.RGB_ETC1_Format&&(e=this.extensions.get("WEBGL_compressed_texture_etc1"),null!=e))return e.COMPRESSED_RGB_ETC1_WEBGL;if((t==o.RGBA_ASTC_4x4_Format||t==o.RGBA_ASTC_5x4_Format||t==o.RGBA_ASTC_5x5_Format||t==o.RGBA_ASTC_6x5_Format||t==o.RGBA_ASTC_6x6_Format||t==o.RGBA_ASTC_8x5_Format||t==o.RGBA_ASTC_8x6_Format||t==o.RGBA_ASTC_8x8_Format||t==o.RGBA_ASTC_10x5_Format||t==o.RGBA_ASTC_10x6_Format||t==o.RGBA_ASTC_10x8_Format||t==o.RGBA_ASTC_10x10_Format||t==o.RGBA_ASTC_12x10_Format||t==o.RGBA_ASTC_12x12_Format)&&(e=this.extensions.get("WEBGL_compressed_texture_astc"),null!=e))return t;if((t==o.MinEquation||t==o.MaxEquation)&&(e=this.extensions.get("EXT_blend_minmax"),null!=e)){if(t==o.MinEquation)return e.MIN_EXT;if(t==o.MaxEquation)return e.MAX_EXT}return t==o.UnsignedInt248Type&&(e=this.extensions.get("WEBGL_depth_texture"),null!=e)?e.UNSIGNED_INT_24_8_WEBGL:0},t}();e["default"]=s,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(12),s=n(o),u=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,a["default"])(this,t),this.color=new s["default"](e),this.near=i,this.far=n}return t.prototype.clone=function(){return new t(this.color.getHex(),this.near,this.far)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(27),d=n(h),f=function(t){function e(i,n,r,o,u,l,h,d,f,c,p,v){(0,a["default"])(this,e);var m=(0,s["default"])(this,t.call(this,null,l,h,d,f,c,o,u,p,v));return m.image={width:n,height:r},m.mipmaps=i,m.flipY=!1,m.generateMipmaps=!1,m}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(27),d=n(h),f=i(9),c=function(t){function e(i,n,r,o,u,l,h,d,c,p){if((0,a["default"])(this,e),p=void 0!=p?p:f.DepthFormat,p!=f.DepthFormat&&p!=f.DepthStencilFormat)throw new Error("DepthTexture format must be either DepthFormat or DepthStencilFormat");void 0===r&&p===f.DepthFormat&&(r=f.UnsignedShortType),void 0===r&&p===f.DepthStencilFormat&&(r=f.UnsignedInt248Type);var v=(0,s["default"])(this,t.call(this,null,o,u,l,h,d,p,r,c));return v.image={width:i,height:n},v.magFilter=void 0!=h?h:f.NearestFilter,v.minFilter=void 0!=d?d:f.NearestFilter,v.flipY=!1,v.generateMipmaps=!1,v}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=function(){function t(){(0,s["default"])(this,t)}return t.init=function(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=255,this.canvas.height=1)},t.makeColorBar=function(t){if(!t)return null;this.init();var e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=1;var i=0,n=e.createLinearGradient(0,0,255,1);return(0,a["default"])(t).map(function(e){i<255&&n.addColorStop(parseInt(e)/255,t[e])}),e.fillStyle=n,e.strokeStyle=n,e.fillRect(0,0,200,1),this.canvas.toDataURL("image/png",1)},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(85),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="Group"},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(17),o=r(a),s=i(10),u=r(s),l=i(1),h=r(l),d=i(3),f=r(d),c=i(2),p=r(c),v=i(22),m=r(v),g=i(620),y=r(g),_=i(28),x=i(132),b=r(x),M=i(6),w=r(M),S=i(598),P=n(S),A=i(206),C=n(A),T=i(589),E=n(T),D=i(207),L=r(D),F=function(t){function e(){return(0,h["default"])(this,e),(0,f["default"])(this,t.apply(this,arguments))}return(0,p["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.services={},this.controls={}},e.prototype.getControl=function(t){return this.controls[t]},e.prototype.getSize=function(){var t=this.width||this.userData.dom.offsetWidth;t<1&&(t=parseInt(this.userData.dom.style.width));var e=this.height||this.userData.dom.offsetHeight;return e<1&&(e=parseInt(this.userData.dom.style.height)),{width:t,height:e}},e.prototype.setSize=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.width=t,this.height=e,i&&(this.userData.dom.style.height=e+"px",this.userData.dom.style.width=e+"px"),this.changeSize()},e.prototype.setHandler=function(t){null!=this.mapHandler&&this.mapHandler.dispose(),this.mapHandler=t,this.fireEvent(_.Events.Map.HandlerChange,this)},e.prototype.initApis=function(){var t=this;(0,u["default"])(E).map(function(e){t[e]=new E[e](t)},this)},e.prototype.initServices=function(){var t=this;this.services.WorkerService=new L["default"](this.userData.EngineIP),(0,u["default"])(C).map(function(e){t.services[e]=new C[e](t)},this)},e.prototype.initControls=function(){var t=this;(0,u["default"])(P).map(function(e){t.controls[e]=new P[e](t)},this)},e.prototype.getService=function(t){return this.services[t]},e.prototype.show=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.getControl("ViewControl");e.run(t),window.dispatchEvent(new Event("resize"))},e.prototype.open=function(){var t=this.getService(C.AttributeService.fnName);t.getConfig(this.userData.key,this.loadConfig,this)},e.prototype.loadConfig=function(t){w["default"].isSuccess(t)&&(this.confg=new y["default"](t.values,this.userData),this.initControls(),this.setHandler(new b["default"](this)))},e.prototype.changeSize=function(){this.fireEvent(_.Events.Map.Resize,this)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.initApis(),this.initServices(),window.addEventListener("resize",this.changeSize.bind(this),!1),window.doGiswayEngineOverride&&window.doGiswayEngineOverride(this,"map"),window.doGiswayEnginePlus&&window.doGiswayEnginePlus(this,"map")},e.prototype.changeConfig=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o["default"])(this.userData,e),(0,u["default"])(this.controls).map(function(e){t.controls[e].dispose()}),this.controls={},this.open()},e}(m["default"]);e["default"]=F,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);
return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(588),h=n(l),d=function f(t){var e=this;(0,u["default"])(this,f),(0,o["default"])(h).map(function(i){e[i]=new h[i](t)})};e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=i(97),c=n(f),p=i(8),v=i(31),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.flyTo=function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=this.map.getControl("ViewControl"),r=n.target.clone();t.changeEPSGType(p.Const.EPSGType.EPSGWeb);var a={x:r.x,y:r.y},o={x:t.x,y:t.y};this.tween=new v.Tween(a).to(o,i).onUpdate(function(){n.flyTo(new c["default"](a.x,a.y,p.Const.EPSGType.EPSGWeb))}).onComplete(function(){e.tween.stop(),e.tween=null}),this.tween.start()},e.prototype.lookAt=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.map.getControl("LayerControl"),r=n.getLayer(t),a=r.getModel(e);if(a){var o=(new c["default"]).copy(a.position);if(o.EPSGType=p.Const.EPSGType.EPSGWeb,this.flyTo(o),i){var s=this.map.getControl("SelectControl");s.doUnSelect(),s.doSelect(a)}}},e.prototype.info=function(){var t=this.map.getControl("ViewControl"),e=(new c["default"]).set(t.target.x,t.target.y,p.Const.EPSGType.EPSGWeb);return{target:e}},e.prototype.setTouchMode=function(t){var e=this.map.getControl("MouseControl");e.setButtonType(t)},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=i(605),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.drawPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.map.setHandler(new c["default"](this.map));var i=this.map.getControl("DrawControl");i.drawPoint(t,e)},e.prototype.drawLine=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.map.setHandler(new c["default"](this.map));var i=this.map.getControl("DrawControl");i.drawLine(t,e)},e.prototype.drawPolygon=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];this.map.setHandler(new c["default"](this.map));var i=this.map.getControl("DrawControl");i.drawPolygon(t,e)},e.prototype.drawCircle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=new c["default"](this.map);i.scale.enablePan=!1,this.map.setHandler(i);var n=this.map.getControl("DrawControl");n.drawCircle(t,e)},e.prototype.drawRect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=new c["default"](this.map);i.scale.enablePan=!1,this.map.setHandler(i);var n=this.map.getControl("DrawControl");n.drawRect(t,e)},e.prototype.clear=function(){var t=this.map.getControl("DrawControl");t.clear()},e.prototype.listenGeoClick=function(t){var e=this.map.getControl("DrawControl");e.listenGeoClick({markers:[t]})},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(71),p=n(c),v=i(33),m=r(v),g=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.addLayer=function(t){var e=this.map.getControl("LayerControl");e.addLayer(t)},e.prototype.removeLayer=function(t){var e=this.map.getControl("LayerControl");e.removeLayer(t)},e.prototype.getLayer=function(t){var e=this.map.getControl("LayerControl");return e.getLayer(t)},e.prototype.init=function(){var t=this;(0,o["default"])(p).map(function(e){t[e]=p[e]})},e}(m["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.getArea=function(t){var e=0,i="\u5e73\u65b9\u7c73";if(t.length<3)return{area:e,unit:i};for(var n=t[0],r=1;r<t.length-1;r++){var a=t[r],o=t[r+1],s=n.distanceTo(a),u=a.distanceTo(o),l=o.distanceTo(n),h=(s+u+l)/2,d=Math.sqrt(h*(h-s)*(h-u)*(h-l));e+=d}return e>=1e6&&(i="\u5e73\u65b9\u516c\u91cc",e/=1e6),{area:parseFloat(e.toFixed(2)),unit:i}},e.prototype.getDistance=function(t){if(t.length<2)return{length:0,unit:"\u7c73"};for(var e=0,i=0;i<t.length-1;i++)e+=t[i].distanceTo(t[i+1]);return e>1e3?{distance:(e/1e3).toFixed(2),unit:"\u516c\u91cc"}:{distance:e.toFixed(2),unit:"\u7c73"}},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setMenu=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=this.map.getControl("SelectControl");n.menuHelper.addType(t,e,i)},e.prototype.clear=function(t,e){var i=this.map.getControl("SelectControl");i.menuHelper.removeType(t,e)},e.prototype.setObjMenu=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=this.map.getControl("SelectControl");r.menuHelper.add(t,e,i,n)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.getSelectObjects=function(){var t=this.map.getControl("SelectControl");return t.selectList},e.prototype.doMove=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.map.getControl("EditControl"),i=this.getSelectObjects();if(!(i.length<1)){var n=this.map.getControl("SelectControl");n.doUnSelect(),i.forEach(function(t){e.add(t,t.position.clone())});var r=this.map.Api.Type.EditHandler;this.map.setHandler(new r(this.map)),t&&this.map.Api.Type.Helper.warn("\u6309Esc\u952e\u53d6\u6d88\u79fb\u52a8")}},e.prototype.doEdit=function(){this.doMove(!1);var t=this.map.getControl("EditControl");t.finish()},e.prototype.doDelete=function(t){var e=this.getSelectObjects(),i=this.map.getControl("EditControl");i.remove(e);var n=this.map.getControl("SelectControl");n.doUnSelect()},e.prototype.doAdd=function(t,e){var i=this.map.getService("RCService");i.addData(t.getInfo(e))},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.getFloorNavDatas=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2],n=this.map.getService("NavigateService");n.getFloorNavDatas(t,e,i)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setObjPop=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=this.map.getControl("SelectControl");r.popHelper.add(t,e,i,n)},e.prototype.setPop=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=this.map.getControl("SelectControl");n.popHelper.addType(t,e,i)},e.prototype.show=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.map.getControl("SelectControl");n.popHelper.show(this.initShowData(t,e),i)},e.prototype.display=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.map.getControl("SelectControl");n.popHelper.display(t,e,this.initShowData(t,e),i)},e.prototype.clear=function(t,e){var i=this.map.getControl("SelectControl");i.popHelper.removeType(t,e)},e.prototype.initShowData=function(t,e){var i=this.map.getControl("LayerControl"),n=i.getLayer(t);return n.getModel(e)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.print=function(){var t=this.map.getControl("ViewControl"),e=t.domCanvasElement.childNodes;e.forEach(function(t){t.toDataURL("image/jpeg",1)});var i=window.open("about:blank");i.document.body.style.margin="0";var n=new Image;n.onload=function(){i.print(),i.close()},i.document.body.appendChild(n)},e.prototype.full=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=document.webkitIsFullScreen;if(!e&&t){var i=document.documentElement;i.requestFullscreen&&i.requestFullscreen()||i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}e&&!t&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():"")},e.prototype.photo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.map.getControl("ViewControl"),n=i.domElement.toDataURL("image/jpeg",e);return t&&t(n),n},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(33),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.open=function(){},e.prototype.close=function(){},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(33),c=n(f),p=i(28),v=function(t){function e(){(0,s["default"])(this,e);var i=(0,l["default"])(this,t.apply(this,arguments));return i.timeCache={},i}return(0,d["default"])(e,t),e.prototype.on=function(t,e,i){this.timeCache[t]||(this.timeCache[t]={t:0,fns:[]}),this.timeCache[t].fns.push({f:e,s:i})},e.prototype.off=function(t,e,i){if(this.timeCache[t]){for(var n in this.timeCache[t].fns)if(this.timeCache[t].fns[n].f==e&&this.timeCache[t].fns[n].s==i){this.timeCache[t].fns.splice(n,1);break}this.timeCache[t].fns.length<1&&delete this.timeCache[t]}},e.prototype.fireTimer=function(t){var e=this,i=(new Date).getTime();(0,a["default"])(this.timeCache).map(function(n){0==e.timeCache[n].t?e.timeCache[n].t=i:i-e.timeCache[n].t>=1e3*parseFloat(n)&&(e.timeCache[n].fns.forEach(function(i){i.f.call(i.s,t,e.map)}),e.timeCache[n].t=i)})},e.prototype.init=function(){this.map.on(p.Events.Map.Renderer,this.fireTimer,this)},e}(c["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(1),o=r(a),s=i(3),u=r(s),l=i(2),h=r(l),d=i(131),f=r(d),c=i(130),p=r(c),v=i(33),m=r(v),g=i(97),y=r(g),_=i(606),x=r(_),b=i(6),M=r(b),w=i(64),S=r(w),P=i(205),A=n(P),C=function(t){function e(){(0,o["default"])(this,e);var i=(0,u["default"])(this,t.apply(this,arguments));return i.Polyline=f["default"],i.Polygon=p["default"],i.Point=y["default"],i.EditHandler=x["default"],i.Helper=M["default"],i.Size=S["default"],i.Models=A,i}return(0,h["default"])(e,t),e}(m["default"]);e["default"]=C,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(576);Object.defineProperty(e,"Camera",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(578);Object.defineProperty(e,"Layers",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(580);Object.defineProperty(e,"Menus",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(581);Object.defineProperty(e,"MeshInfo",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(583);Object.defineProperty(e,"Pop",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(585);Object.defineProperty(e,"Street",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(587);Object.defineProperty(e,"Type",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(577);Object.defineProperty(e,"Draws",{enumerable:!0,get:function(){return n(d)["default"]}});var f=i(579);Object.defineProperty(e,"Measure",{enumerable:!0,get:function(){return n(f)["default"]}});var c=i(584);Object.defineProperty(e,"Screen",{enumerable:!0,get:function(){return n(c)["default"]}});var p=i(582);Object.defineProperty(e,"Navigate",{enumerable:!0,get:function(){return n(p)["default"]}});var v=i(586);Object.defineProperty(e,"Time",{enumerable:!0,get:function(){return n(v)["default"]}})},[681,575],function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(51),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.setDefault=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="default"},e.prototype.setPointer=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="pointer"},e.prototype.setText=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="text"},e.prototype.setCrosshair=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="crosshair"},e.prototype.setMove=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="move"},e.prototype.setEResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="e-resize"},e.prototype.setNeResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="ne-resize"},e.prototype.setNwResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="nw-resize"},e.prototype.setNResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="n-resize"},e.prototype.setSeResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="se-resize"},e.prototype.setSwResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="sw-resize"},e.prototype.setSResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="s-resize"},e.prototype.setWResize=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="w-resize"},e.prototype.setWait=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor=" wait"},e.prototype.setHelp=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.style.cursor="help"},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r,a=i(17),o=n(a),s=i(1),u=n(s),l=i(3),h=n(l),d=i(2),f=n(d),c=i(11),p=n(c),v=i(6),m=n(v),g=i(7),y=n(g),_=i(51),x=n(_),b=i(599),M=n(b),w=i(131),S=n(w),P=i(132),A=n(P),C=i(71),T=i(133),E=n(T),D=i(28),L=i(130),F=n(L),k=i(4),I=n(k),O=i(107),N=n(O);!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Polygon=2]="Polygon",t[t.Circle=3]="Circle",t[t.Rect=4]="Rect"}(r||(r={}));var R=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.drawPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];m["default"].warn("\u5355\u51fb\u5f00\u59cb\u6807\u70b9,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Point,this.cursorControl.setCrosshair(),void 0==t.isPoint&&(t.isPoint=!0),(0,o["default"])(this.cfg,this.defaultCfg,{id:y["default"].getUUID()},t),this.fn=e},e.prototype.drawLine=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];m["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Line,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:y["default"].getUUID()},t),this.fn=e},e.prototype.drawPolygon=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];m["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Polygon,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:y["default"].getUUID()},t),this.fn=e},e.prototype.drawCircle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];m["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Circle,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:y["default"].getUUID()},t),this.fn=e},e.prototype.drawRect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];m["default"].warn("\u5355\u51fb\u5f00\u59cb,\u53f3\u952e\u7ed3\u675f,ESC\u53d6\u6d88\u7ed8\u5236"),this.initLayer(),this.drawMode=r.Rect,this.cursorControl.setCrosshair(),(0,o["default"])(this.cfg,this.defaultCfg,{id:y["default"].getUUID()},t),this.fn=e},e.prototype.click=function(t){var e=this.scaleControl.getMousePoint(t,this.scaleControl.scale),i=new p["default"](e.x,e.y,0,e.EPSGType);if(this.drawMode==r.Point)this.doPoint(i,this.cfg.isPoint,!0);else if(this.drawMode==r.Line||this.drawMode==r.Polygon){this.cfg.isPoint&&this.doPoint(i,this.cfg.isPoint,!1);var n=this.drawMode==r.Line?new S["default"]({data:this.cfg},this.map):new F["default"]({data:this.cfg},this.map);this.coordinate.drawObj?this.coordinate.drawObj.addPoint(i,!0):(this.activeLayer.add(n),n.addPoint(i,!0),this.coordinate.drawObj=n,this.coordinate.drawObj.position=(new I["default"]).copy(i))}this.fn&&this.fn({coordinate:this.coordinate,markerLayer:this.markerLayer,type:"click"})},e.prototype.doPoint=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var n=new E["default"]({data:{icon:this.cfg.pointUrl,id:y["default"].getUUID()},shapes:[{x:t.x,y:t.y,EPSGType:t.EPSGType}]},this.map);this.coordinate.markers.push(n),this.markerLayer.add(n)}i&&(this.fn&&this.fn({point:t,markerLayer:this.markerLayer}),this.endDraw())},e.prototype.move=function(t){if((this.drawMode==r.Polygon||this.drawMode==r.Line)&&this.coordinate.drawObj){var e=this.scaleControl.getMousePoint(t,this.scaleControl.scale),i=new p["default"](e.x,e.y,0,e.EPSGType);this.coordinate.drawObj.updatePoint(i),this.fn&&this.fn({coordinate:this.coordinate,point:e,markerLayer:this.markerLayer,type:"move"})}},e.prototype.rightClick=function(){(this.coordinate.drawObj&&this.drawMode==r.Line||this.drawMode==r.Polygon)&&(this.coordinate.drawObj.endPoint(),this.fn&&this.fn({coordinate:this.coordinate,markerLayer:this.markerLayer,type:"rightClick"})),this.endDraw()},e.prototype.keyUp=function(t){27==t.keyCode&&(this.listenGeoClick(this.coordinate),this.endDraw())},e.prototype.drag=function(t){var e=this.scaleControl.getMousePoint(t,this.scaleControl.scale),i=new p["default"](e.x,e.y,0,e.EPSGType);if(this.drawMode==r.Circle)if(this.coordinate.drawObj)this.coordinate.drawObj.updatePoint(i);else{(0,o["default"])(this.cfg,{point:i});var n=new M["default"]({data:this.cfg},this.map);this.activeLayer.add(n),this.coordinate.drawObj=n}else if(this.drawMode==r.Rect)if(this.coordinate.drawObj){var a=new N["default"];a.setFromPoints([this.firstPoint,i]),this.coordinate.drawObj.updatePoints([this.firstPoint,new p["default"](a.min.x,a.min.y,0,"3857"),i,new p["default"](a.max.x,a.max.y,0,"3857"),this.firstPoint])}else{var s=new F["default"]({data:this.cfg},this.map);s.updatePoints([i,i,i,i,i]),this.coordinate.drawObj=s,this.activeLayer.add(s),this.firstPoint=i}this.fn&&this.fn({coordinate:this.coordinate,markerLayer:this.markerLayer,type:"drag"})},e.prototype.dragEnd=function(){this.drawMode!=r.Circle&&this.drawMode!=r.Rect||this.endDraw()},e.prototype.endDraw=function(){this.fn=null,this.scaleControl.enablePan=!0,this.firstPoint=null,this.map.setHandler(new A["default"](this.map)),this.cursorControl.setDefault(),this.coordinate={markers:[],drawObj:null,cfg:{}},this.cfg={}},e.prototype.listenGeoClick=function(t){var e=this;t&&(t.markers&&t.markers.forEach(function(t){e.markerLayer.remove(t)},this),t.drawObj&&this.activeLayer.remove(t.drawObj))},e.prototype.clear=function(){this.endDraw(),this.markerLayer&&(this.markerLayer.removeAll(),this.layerControl.removeLayer(this.markerLayer),this.markerLayer=void 0),this.activeLayer&&(this.activeLayer.removeAll(),this.layerControl.removeLayer(this.activeLayer),this.activeLayer=void 0)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.map.off(D.Events.Mouse.Click,this.click,this),this.map.off(D.Events.Mouse.Move,this.move,this),this.map.off(D.Events.Mouse.RightClick,this.rightClick,this),this.map.off(D.Events.Mouse.KeyUp,this.keyUp,this),this.map.off(D.Events.Mouse.Drag,this.drag,this),this.map.off(D.Events.Mouse.DragEnd,this.dragEnd,this)},e.prototype.register=function(){this.map.on(D.Events.Mouse.Click,this.click,this),this.map.on(D.Events.Mouse.Move,this.move,this),this.map.on(D.Events.Mouse.RightClick,this.rightClick,this),this.map.on(D.Events.Mouse.KeyUp,this.keyUp,this),this.map.on(D.Events.Mouse.Drag,this.drag,this),this.map.on(D.Events.Mouse.DragEnd,this.dragEnd,this)},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.cfg={},this.defaultCfg={isPoint:!1,font_size:14,font_color:"f5f5f5",pointUrl:"./images/default/point.png"},this.coordinate={markers:[],drawObj:null,cfg:{}}},e.prototype.initComponent=function(){this.layerControl=this.map.getControl("LayerControl"),this.scaleControl=this.map.getControl("ScaleControl"),this.cursorControl=this.map.getControl("CursorControl")},e.prototype.initLayer=function(){this.markerLayer||(this.markerLayer=new C.MarkerLayer({objType:"\u6807\u6ce8\u56fe\u5c42",canSelect:!0},this.map),this.layerControl.addLayer(this.markerLayer)),this.activeLayer||(this.activeLayer=new C.DrawLayer({objType:"\u7ed8\u5236\u56fe\u5c42",canSelect:!0},this.map),this.layerControl.addLayer(this.activeLayer))},e}(x["default"]);e["default"]=R,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(51),c=n(f),p=i(28),v=i(132),m=n(v),g=i(134),y=n(g),_=i(5),x=n(_),b=function(t){function e(){return(0,s["default"])(this,e),(0,l["default"])(this,t.apply(this,arguments))}return(0,d["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.editList=[]},e.prototype.add=function(t,e){this.editList.push({model:t,point:e,pos:t.position.clone()}),t.click()},e.prototype.remove=function(t){if(!(t.length<1)){var e=[];t.forEach(function(t){(0,a["default"])(t.parent.typeInfos).map(function(i){e.push({objType:i,id:t.userData.id})})});var i=this.map.getService(y["default"].fnName);i.deleteData(e)}},e.prototype.click=function(t,e){this.finish(),e.setHandler(new m["default"](e))},e.prototype.finish=function(){var t=[];this.editList.forEach(function(e){e.model.saveState(),e.model.unClick(),t.push(e.model.getInfo())});var e=this.map.getService(y["default"].fnName);e.updateData(t),this.editList=[]},e.prototype.move=function(t,e){var i=t.offsetX||t.layerX||t.pageX,n=t.offsetY||t.layerY||t.pageY,r=[];this.editList.forEach(function(t){r.push(t.model)});for(var a=new x["default"](i,n),o=this.editList.length-1;o>=0;o--)this.editList[o].model.move(a)},e.prototype.keyUp=function(t,e){27==t.keyCode&&(this.editList.forEach(function(t){t.model.position.copy(t.point)}),this.editList=[],e.setHandler(new m["default"](e)))},e.prototype.register=function(){this.map.on(p.Events.Mouse.Click,this.click,this),this.map.on(p.Events.Mouse.Move,this.move,this),this.map.on(p.Events.Mouse.KeyUp,this.keyUp,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.map.off(p.Events.Mouse.Click,this.click,this),this.map.off(p.Events.Mouse.Move,this.move,this),this.map.off(p.Events.Mouse.KeyUp,this.keyUp,this)},e}(c["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var a=i(10),o=r(a),s=i(1),u=r(s),l=i(3),h=r(l),d=i(2),f=r(d),c=i(6),p=r(c),v=i(51),m=r(v),g=i(611),y=r(g),_=i(206),x=i(28),b=i(610),M=r(b),w=i(71),S=n(w),P=function(t){function e(){return(0,u["default"])(this,e),(0,h["default"])(this,t.apply(this,arguments))}return(0,f["default"])(e,t),e.prototype.addLayer=function(t){t.userData.PObjType&&this.layerSet[t.userData.PObjType]?this.layerSet[t.userData.PObjType].childLayer.push(t):this.layerSet[t.userData.objType]=t;var e=this.map.getControl("ViewControl");e.canvas.add(t)},e.prototype.getLayer=function(t){var e=this,i=void 0;return(0,o["default"])(this.layerSet).map(function(n){n==t&&(i=e.layerSet[n]),e.layerSet[n].typeInfos&&(0,o["default"])(e.layerSet[n].typeInfos).map(function(r){t==r&&(i=e.layerSet[n])})}),i},e.prototype.removeLayer=function(t){var e=this.map.getControl("ViewControl");delete this.layerSet[t.userData.objType],this.layerSet[t.userData.PObjType]&&p["default"].listSplice(this.layerSet[t.userData.PObjType].childLayer,t),e.canvas.remove(t),t.dispose()},e.prototype.getSelectMeshs=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[];(0,o["default"])(this.layerSet).map(function(t){var a=i.layerSet[t];a.getAllMeshs(r,n,e)});for(var a=0;a<r.length;a++)if(r[a].isInside(t.x,t.y))return r[a];return null},e.prototype.loadLayers=function(){var t=this,e=this.map.getService(_.AttributeService.fnName);e.getLayers(this.map.userData.key,function(e){p["default"].isSuccess(e)&&(t.initBGTiles(),t.initLayers(e.values),t.map.fireEvent(x.Events.Map.Finish,t.map))},this)},e.prototype.initLayers=function(t){var e=this,i={};t.forEach(function(t){i[t.layer_name]||(i[t.layer_name]={}),i[t.layer_name][t.id]=t}),(0,o["default"])(i).map(function(t){var n=new S[t]({objTypes:i[t],objType:t},e.map);e.addLayer(n)});var n=new M["default"]({objType:"\u9009\u4e2d\u56fe\u5c42"},this.map);this.addLayer(n),this.scaleChange()},e.prototype.initBGTiles=function(){if(1!=this.map.userData.hideBGTile){var t={objType:"\u5e95\u56fe"};this.map.userData.baseMap&&(t.baseMap=this.map.userData.baseMap);var e=new y["default"](t,this.map);this.addLayer(e)}},e.prototype.dragEnd=function(){var t=this;(0,o["default"])(this.layerSet).map(function(e){t.layerSet[e].dragEnd()})},e.prototype.drag=function(t){var e=this;(0,o["default"])(this.layerSet).map(function(i){e.layerSet[i].drag(t)})},e.prototype.scaleChange=function(){var t=this;(0,o["default"])(this.layerSet).map(function(e){t.layerSet[e].scaleChange()})},e.prototype.resizeChange=function(){var t=this;(0,o["default"])(this.layerSet).map(function(e){t.layerSet[e].resizeChange()})},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.layerSet={}},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.loadLayers(),this.map.on(x.Events.Map.CenterChanged,this.dragEnd,this),this.map.on(x.Events.Map.CenterChange,this.drag,this),this.map.on(x.Events.Map.ScaleChange,this.scaleChange,this),this.map.on(x.Events.Map.Resize,this.resizeChange,this)},e.prototype.dispose=function(){var e=this;this.map.off(x.Events.Map.CenterChange,this.drag,this),this.map.off(x.Events.Map.CenterChanged,this.dragEnd,this),this.map.off(x.Events.Map.ScaleChange,this.scaleChange,this),this.map.off(x.Events.Map.Resize,this.resizeChange,this),t.prototype.dispose.call(this),(0,o["default"])(this.layerSet).map(function(t){e.removeLayer(e.layerSet[t])})},e}(m["default"]);e["default"]=P,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(51),d=n(h),f=i(6),c=n(f),p=i(28),v=i(5),m=n(v),g=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.doMouseDown=function(t){this.isRightDown=2==t.button,this.isMouseDown=!0,this.isMouseMove=!1,this.isRotate=!1,this.oldPoint=new m["default"](t.clientX,t.clientY),this.map.fireEvent(p.Events.Mouse.Down,t,this.map)},e.prototype.doMouseMove=function(t){if(this.map.fireEvent(p.Events.Mouse.Move,t,this.map),this.isMouseDown){var e=new m["default"](t.clientX,t.clientY);this.isMouseMove=!this.oldPoint.equals(e),this.isRightDown&&this.isMouseMove?(this.isRotate=!0,this.map.fireEvent(p.Events.Mouse.Rotate,t,this.map)):this.map.fireEvent(p.Events.Mouse.Drag,t,this.map)}},e.prototype.doMouseUp=function(t){if(this.map.fireEvent(p.Events.Mouse.Up,t,this.map),this.isMouseDown)if(this.isRightDown)this.map.fireEvent(p.Events.Mouse.RightClick,t,this.map);else if(this.isMouseMove)this.map.fireEvent(p.Events.Mouse.DragEnd,t,this.map);else{var e=(new Date).getTime();if(void 0==this.lastClickTime)this.lastClickTime=e,this.map.fireEvent(p.Events.Mouse.Click,t,this.map);else{var i=e-this.lastClickTime;i<360?this.map.fireEvent(p.Events.Mouse.DBClick,t,this.map):(this.map.fireEvent(p.Events.Mouse.Click,t,this.map),this.lastClickTime=e)}}this.isMouseDown=!1},e.prototype.doMouseWheel=function(t){this.map.fireEvent(p.Events.Mouse.Wheel,t,this.map)},e.prototype.doKeyDown=function(t){this.map.fireEvent(p.Events.Mouse.KeyDown,t,this.map);
},e.prototype.doKeyUp=function(t){this.map.fireEvent(p.Events.Mouse.KeyUp,t,this.map)},e.prototype.doContextMenu=function(t){c["default"].stopEvents(t)},e.prototype.initMouseEvents=function(){if(c["default"].isPC()){var t=this.map.getControl("ViewControl");t.domCanvasElement.addEventListener("mousedown",this.doMouseDownFn),t.domCanvasElement.addEventListener("mousemove",this.doMouseMoveFn),t.domCanvasElement.addEventListener("mouseup",this.doMouseUpFn),t.domCanvasElement.addEventListener("mouseout",this.doMouseUpFn),t.domCanvasElement.addEventListener("wheel",this.doMouseWheelFn),window.addEventListener("keydown",this.doKeyDownFn),window.addEventListener("keyup",this.doKeyUpFn),this.hideSysContextMenu()}},e.prototype.showSysContextMenu=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.removeEventListener("contextmenu",this.doContextMenu)},e.prototype.hideSysContextMenu=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.addEventListener("contextmenu",this.doContextMenu)},e.prototype.initTouchEvents=function(){c["default"].isPC()},e.prototype.removeEvents=function(){var t=this.map.getControl("ViewControl");t.domCanvasElement.removeEventListener("mousedown",this.doMouseDownFn),t.domCanvasElement.removeEventListener("mousemove",this.doMouseMoveFn),t.domCanvasElement.removeEventListener("mouseup",this.doMouseUpFn),t.domCanvasElement.removeEventListener("wheel",this.doMouseWheelFn),t.domCanvasElement.removeEventListener("contextmenu",this.doContextMenu),window.removeEventListener("keydown",this.doKeyDownFn),window.removeEventListener("keyup",this.doKeyUpFn)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.doMouseDownFn=this.doMouseDown.bind(this),this.doMouseMoveFn=this.doMouseMove.bind(this),this.doMouseUpFn=this.doMouseUp.bind(this),this.doMouseWheelFn=this.doMouseWheel.bind(this),this.doKeyDownFn=this.doKeyDown.bind(this),this.doKeyUpFn=this.doKeyUp.bind(this),this.initMouseEvents(),this.initTouchEvents()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.removeEvents()},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(51),d=n(h),f=i(5),c=n(f),p=i(28),v=i(25),m=n(v),g=i(8),y=function(t){function e(){(0,a["default"])(this,e);var i=(0,s["default"])(this,t.apply(this,arguments));return i.scaleNum=18,i.oldPoint=new c["default"],i.movePoint=new c["default"],i.enablePan=!0,i}return(0,l["default"])(e,t),e.prototype.getMousePoint=function(t,e){var i=this.map.getControl("ViewControl"),n=t.layerX,r=t.layerY,a=this.map.getSize(),o=new c["default"](n-a.width/2,a.height/2-r),s=m["default"].getResolution(e);return o.multiplyScalar(s),i.target.clone().add(o)},e.prototype.wheel=function(t){if(!(Math.abs(t.wheelDelta)>200)){var e=this.map.getControl("ViewControl"),i=this.getMousePoint(t,this.scale);t.wheelDelta<0?this.scaleNum>0&&this.scaleNum--:this.scaleNum<this.map.confg.ScaleList.length-1&&this.scaleNum++;var n=this.map.confg.ScaleList[this.scaleNum],r=this.getMousePoint(t,n);r.sub(i),e.target.sub(r),this.oldTarget=e.target.clone(),this.initRightScale()}},e.prototype.dragEnd=function(t,e){var i=e.getControl("ViewControl");this.oldTarget.equals(i.target)||(this.oldTarget=i.target.clone(),e.fireEvent(p.Events.Map.CenterChanged,this.oldTarget,e))},e.prototype.down=function(t){this.oldPoint.set(t.clientX,t.clientY)},e.prototype.drag=function(t){if(this.enablePan){var e=this.map.getControl("ViewControl"),i=m["default"].getResolution(this.scale);this.movePoint.set(t.clientX,t.clientY);var n=this.movePoint.sub(this.oldPoint),r=n.clone().multiplyScalar(i);e.target.set(this.oldTarget.x-r.x,this.oldTarget.y+r.y,g.Const.EPSGType.EPSGWeb),this.map.fireEvent(p.Events.Map.CenterChange,n)}},e.prototype.setScale=function(t){this.scale!=t&&(this.scale=t,this.map.fireEvent(p.Events.Map.ScaleChange,this.scale,this.map))},e.prototype.initRightScale=function(){this.setScale(this.map.confg.ScaleList[this.scaleNum]);var t=m["default"].getResolution(this.scale);this.map.fireEvent(p.Events.Map.ZoomChange,t,this.map)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this);var e=this.map.getControl("ViewControl");this.oldTarget=e.target.clone(),this.scaleNum=18,this.initRightScale()},e.prototype.register=function(){this.map.on(p.Events.Mouse.Wheel,this.wheel,this),this.map.on(p.Events.Mouse.DragEnd,this.dragEnd,this),this.map.on(p.Events.Mouse.Drag,this.drag,this),this.map.on(p.Events.Mouse.Down,this.down,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.map.off(p.Events.Mouse.Wheel,this.wheel,this),this.map.off(p.Events.Mouse.DragEnd,this.dragEnd,this),this.map.off(p.Events.Mouse.Drag,this.drag,this),this.map.off(p.Events.Mouse.Down,this.down,this)},e}(d["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(51),d=n(h),f=i(28),c=i(621),p=n(c),v=i(622),m=n(v),g=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.toAssign=function(e){t.prototype.toAssign.call(this,e),this.selectList=[],this.menuHelper=new p["default"],this.popHelper=new m["default"](this.map)},e.prototype.register=function(){this.map.on(f.Events.Mouse.Click,this.click,this),this.map.on(f.Events.Mouse.RightClick,this.rightClick,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.map.off(f.Events.Mouse.Click,this.click,this),this.map.off(f.Events.Mouse.RightClick,this.rightClick,this)},e.prototype.doSelect=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||this.doUnSelect(),t&&(this.selectList.push(t),t.click())},e.prototype.doUnSelect=function(){this.selectList.forEach(function(t){t.unClick()}),this.selectList=[]},e.prototype.click=function(t,e){var i=e.getControl("LayerControl"),n=t.offsetX||t.layerX,r=t.offsetY||t.layerY,a=i.getSelectMeshs({x:n,y:r},!0);return this.doSelect(a,t.shiftKey),a?(this.popHelper.show(a),a):null},e.prototype.rightClick=function(t,e){var i=e.getControl("LayerControl"),n=t.offsetX||t.layerX||t.pageX,r=t.offsetY||t.layerY||t.pageY,a=this.click(t,e);if(a||(a=i.getSelectMeshs({x:n,y:r},!1)),a){var o=this.map.getControl("ScaleControl"),s=o.getMousePoint(t,o.scale);this.menuHelper.show(a,s)}},e}(d["default"]);e["default"]=g,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(51),d=n(h),f=i(203),c=n(f),p=i(202),v=n(p),m=i(176),g=n(m),y=i(8),_=i(28),x=i(31),b=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initCanvas=function(){this.target=this.map.confg.LookAt.changeEPSGType(y.Const.EPSGType.EPSGWeb),this.canvas=new c["default"],this.canvasRenderer=new v["default"]({antialias:!0}),this.domCanvasElement=this.canvasRenderer.domElement,this.domCanvasElement.style.position="absolute",this.map.userData.dom.appendChild(this.domCanvasElement)},e.prototype.updateView=function(){this.canvasRenderer.render(this.canvas,this.map);var t=this.clock.getDelta();x.TweenEx.update(t),this.map.fireEvent(_.Events.Map.Renderer,t,this.map),requestAnimationFrame(this.updateView.bind(this))},e.prototype.flyTo=function(t){this.target.copy(t),this.map.fireEvent(_.Events.Mouse.DragEnd,null,this.map)},e.prototype.run=function(t){this.canvasRenderer.isContextLost=!t},e.prototype.initSize=function(){var t=this.map.getSize();this.canvasRenderer.setSize(t.width,t.height,!0)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.canvasRenderer.dispose(),this.map.userData.dom.removeChild(this.domCanvasElement),this.map.off(_.Events.Map.Resize,this.initSize,this)},e.prototype.initComponent=function(){t.prototype.initComponent.call(this),this.initCanvas(),this.initSize(),this.clock=new g["default"],this.updateView(),this.map.on(_.Events.Map.Resize,this.initSize,this)},e}(d["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(597);Object.defineProperty(e,"ViewControl",{enumerable:!0,get:function(){return n(r)["default"]}});var a=i(590);Object.defineProperty(e,"CursorControl",{enumerable:!0,get:function(){return n(a)["default"]}});var o=i(594);Object.defineProperty(e,"MouseControl",{enumerable:!0,get:function(){return n(o)["default"]}});var s=i(595);Object.defineProperty(e,"ScaleControl",{enumerable:!0,get:function(){return n(s)["default"]}});var u=i(593);Object.defineProperty(e,"LayerControl",{enumerable:!0,get:function(){return n(u)["default"]}});var l=i(596);Object.defineProperty(e,"SelectControl",{enumerable:!0,get:function(){return n(l)["default"]}});var h=i(591);Object.defineProperty(e,"DrawControl",{enumerable:!0,get:function(){return n(h)["default"]}});var d=i(592);Object.defineProperty(e,"EditControl",{enumerable:!0,get:function(){return n(d)["default"]}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(96),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this.fillColor=this.userData.color||"0078D7",this.opacity=this.userData.opacity||.8,this.radius=this.userData.radius||1,this.centerPoint=this.userData.point},e.prototype.draw=function(t){t.beginPath(),t.globalAlpha=this.opacity;var e=this.projectToScreen(this.centerPoint),i=void 0;if(this.borderPoint){var n=this.projectToScreen(this.borderPoint);i=e.distanceTo(n)}else i=this.radius;t.arc(e.x,e.y,i,0,2*Math.PI,!0),t.stroke(),t.closePath(),t.fillStyle="#"+this.fillColor,t.fill()},e.prototype.updatePoint=function(t){this.borderPoint=t,this.radius=this.centerPoint.distanceTo(t),this.parent&&(this.parent.needsUpdate=!0)},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(64),s=n(o),u=function(){function t(e,i,n){(0,a["default"])(this,t),this.marker=i,this.img=new Image,this.img.src=e,this.img.crossOrigin="*",this.size=n}return t.prototype.updateConfig=function(){},t.prototype.isComplete=function(){return this.img.complete},t.prototype.getSize=function(){return this.size?this.size:new s["default"](this.img.width,this.img.height)},t.prototype.draw=function(t,e){try{var i=this.getSize();t.save(),t.translate(e.x,e.y),t.rotate(this.marker.rotateAngle*Math.PI/180),t.translate(-e.x,-e.y),t.drawImage(this.img,e.x,e.y,i.width,i.height),t.restore()}catch(n){}},t.prototype.setUrl=function(t){this.img.src=t},t.prototype.reDraw=function(){this.marker.parent.needsUpdate=!0},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(6),s=n(o),u=function(){function t(e,i,n){(0,a["default"])(this,t),this.width=0,this.height=0,this.offX=0,this.offY=0,this.markerService=i.getService("MarkerService"),this.marker=n,this.img=new Image,this.loadImg(e,i)}return t.prototype.updateConfig=function(){this.loadImg(this.marker.userData,this.map)},t.prototype.loadImg=function(t,e){if(!s["default"].isEmpty(t.offsetxy)){var i=t.offsetxy.split(",");this.offX=parseInt(i[0]),this.offY=parseInt(i[1])}this.map=e;var n={};n.edgeColor=t.edge_color,n.fillColor=t.fill_color,n.fontColor=t.font_color,n.fontFace=t.font_face,n.fontSize=t.font_size,n.isBold=t.is_bold,n.labelStr=t.name,this.markerService.getMarker(n,this.getImgLabelBack,this)},t.prototype.isComplete=function(){return!s["default"].isEmpty(this.img.src)&&this.img.complete},t.prototype.initConfig=function(t){this.width=t.width,this.height=t.height},t.prototype.getImgLabelBack=function(t){var e=this;this.img.onload=function(){e.marker.parent&&(e.marker.parent.needsUpdate=!0)},this.img.src=t.url,this.initConfig(t)},t.prototype.draw=function(t,e,i){try{var n=0;void 0!=i&&0==this.offX&&(n=1.1*i.getSize().width),t.save(),t.translate(e.x,e.y),t.rotate(this.marker.rotateAngle*Math.PI/180),t.translate(-e.x,-e.y),t.drawImage(this.img,e.x+this.offX+n,e.y+this.offY,this.width,this.height),t.restore()}catch(r){}},t}();e["default"]=u,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=function(t){function e(i,n,r,o,u){(0,a["default"])(this,e);var l=(0,s["default"])(this,t.call(this));return l.model=i,l.html=r,l.point=n,l.helper=u,l.initHtmls(r,o),l.initEvents(),l}return(0,l["default"])(e,t),e.prototype.initEvents=function(){this.clickFn=this.click.bind(this),window.document.body.addEventListener("click",this.clickFn)},e.prototype.initHtmls=function(t,e){this.div=document.createElement("div"),this.div.className=e,this.div.style.position="absolute",this.div.style.display="none",this.div.appendChild(t),this.div.style.backgroundColor="#FFFFFF",this.div.style.border="1px solid red"},e.prototype.show=function(t){this.div.style.left=t.x+2+"px",this.div.style.top=t.y+"px",this.div.style.display="block",window.document.body.appendChild(this.div),this.initBinds(this.html)},e.prototype.initBinds=function(t){t.event&&(t["on"+t.event.type]=t.event.fn.bind(null,this.model,this.point));for(var e=0;e<t.children.length;e++)this.initBinds(t.children[e])},e.prototype.click=function(){this.dispose()},e.prototype.dispose=function(){window.document.body.removeChild(this.div),window.document.body.removeEventListener("click",this.clickFn),this.helper.menu=null},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(22),d=n(h),f=i(28),c=i(4),p=n(c),v=function(t){function e(i,n,r,o){(0,a["default"])(this,e);var u=(0,s["default"])(this,t.call(this));return u.model=i,u.helper=o,u.initHtmls(n,r),u.initEvents(),u}return(0,l["default"])(e,t),e.prototype.initEvents=function(){this.helper.map.on(f.Events.Mouse.Click,this.click,this)},e.prototype.initHtmls=function(t,e){this.div=document.createElement("div"),this.div.className=e,this.div.style.position="absolute",this.div.style.display="none",t&&t(this.div,this.model)},e.prototype.show=function(){this.div.style.display="block",window.document.body.appendChild(this.div),this.sysnPop()},e.prototype.sysnPop=function(){this.div.style.display="block",window.document.body.appendChild(this.div);var t=this.getModelCenter(this.model);this.div.style.left=t.x-this.div.clientWidth/2+"px",this.div.style.top=t.y-this.div.clientHeight+"px"},e.prototype.click=function(){this.dispose()},e.prototype.getModelCenter=function(t){var e=t.points,i=[],n=[];e.forEach(function(e){var r=t.projectToScreen(e);i.push(r.x),n.push(r.y)});var r=i.sort(function(t,e){return t-e}),a=n.sort(function(t,e){return t-e}),o=new p["default"]((r[0]+r[r.length-1])/2,a[0],0);return o},e.prototype.dispose=function(){window.document.body.removeChild(this.div),this.helper.map.off(f.Events.Mouse.Click,this.click,this),this.helper.pop=null},e}(d["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(96),d=n(h),f=i(6),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.position.copy(e.point),this.img=new Image,this.loadImg(e)},e.prototype.loadImg=function(t){var e=this;this.img.onload=function(){e.parent&&(e.parent.needsUpdate=!0)},this.img.src=t.url},e.prototype.isComplete=function(){return!c["default"].isEmpty(this.img.src)&&this.img.complete},e.prototype.draw=function(t){if(this.isComplete){var e=this.projectToScreen(this.position),i=this.map.confg.TileSize/2;t.drawImage(this.img,e.x-i,e.y-i,this.map.confg.TileSize,this.map.confg.TileSize)}},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.map=e,this.scale=this.map.getControl("ScaleControl");var i=this.map.getControl("DrawControl");this.scale.register(),i.register()}return t.prototype.dispose=function(){this.scale.dispose();var t=this.map.getControl("DrawControl");t.dispose()},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=function(){function t(e){(0,a["default"])(this,t),this.map=e;var i=this.map.getControl("ScaleControl"),n=this.map.getControl("EditControl");i.register(),n.register(),this.map.on("dispose",this.dispose,this)}return t.prototype.dispose=function(){var t=this.map.getControl("ScaleControl"),e=this.map.getControl("EditControl");t.dispose(),e.dispose(),this.map.off("dispose",this.dispose)},t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(70),d=n(h),f=i(5),c=n(f),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.scaleChange=function(){this.drag(new c["default"]),this.dragEnd()},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(71),d=i(85),f=n(d),c=i(16),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.add=function(e){return t.prototype.add.call(this,e),this.workerServer.synAddHotWorker(e.userData,this.uuid),this},e.prototype.synWorkerDraw=function(){this.workerServer.syncDraw(this.uuid,c.Const.DrawEventType.WorkerHotDraw)},e.prototype.remove=function(e){return t.prototype.remove.call(this,e),this.workerServer.synDelWorker(e.userData,this.uuid,c.Const.DrawEventType.WorkerHotDel),this},e.prototype.setData=function(t){var e=this;t.forEach(function(t){var i=new f["default"];i.userData=t,e.add(i)})},e.prototype.resizeChange=function(){var t=this.map.getSize();this.workerServer.reSize(t,this.uuid,c.Const.DrawEventType.WorkerHotSizeChange),this.synWorkerDraw()},e.prototype.synCtxToWorker=function(t){if(!this.isFirstCanvas){var e=t.transferControlToOffscreen();this.workerServer.synCtxToWorker(e,this.uuid,c.Const.DrawEventType.WorkerHotInit),this.isFirstCanvas=!0}},e.prototype.setColorPaint=function(t){var e=this.getColorPaint(t);this.workerServer.setColorPaintWorker(e,this.uuid)},e.prototype.getColorPaint=function(t){if(!t)return[];var e=document.createElement("canvas"),i=e.getContext("2d");e.width=256,e.height=1;var n=i.createLinearGradient(0,0,256,1);return t.forEach(function(e,i){n.addColorStop((i+1)/t.length,e)}),i.fillStyle=n,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},e}(h.WorkerLayer);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(70),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.userData.canSelect=!0,this.type="MeshLayer"},e.prototype.dragEnd=function(){t.prototype.dragEnd.call(this),this.doDragend()},e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(70),d=n(h),f=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e}(d["default"]);e["default"]=f,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(25),d=n(h),f=i(6),c=n(f),p=i(70),v=n(p),m=i(604),g=n(m),y=i(8),_=i(11),x=n(_),b=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.changeType=function(t,e){this.baseMapIndex=t,this.dataType=this.baseMap[this.baseMapIndex].type,this.baseMapName=c["default"].isEmpty(e)?this.baseMap[this.baseMapIndex]["default"]:e},e.prototype.init=function(){this.changeType(0),this._imagesSet={},this.drag()},e.prototype.drag=function(){var t=this.map.getControl("ScaleControl"),e=this.map.getControl("ViewControl"),i=this.map.getSize(),n=d["default"].getR10(e.target.y,t.scale),r=d["default"].getC10(e.target.x,t.scale),a=Math.ceil(i.width/512),o=Math.ceil(i.height/512),s=n-o,u=r-a,l=n+o,h=r+a;this.clearImageStatus();for(var f=u;f<=h;f++)for(var c=s;c<=l;c++)if(this._imagesSet[t.scaleNum+"_"+c+"_"+f])this._imagesSet[t.scaleNum+"_"+c+"_"+f].status=!0;else{var p=this.createTile(t,c,f);this.add(p)}this.moveImageNotUse(),this.needsUpdate=!0},e.prototype.clearImageStatus=function(){for(var t in this._imagesSet)this._imagesSet[t].status=!1},e.prototype.moveImageNotUse=function(){for(var t in this._imagesSet)0==this._imagesSet[t].status&&(this.remove(this._imagesSet[t].value),delete this._imagesSet[t])},e.prototype.createTile=function(t,e,i){var n={},r=t.scaleNum,a=t.scale;n.url=this.getURL(r,e,i),n.tileRC={l:r,r:e,c:i};var o=d["default"].getCDevX(i,a),s=d["default"].getRDevY(e,a),u=new x["default"](o,s,0,y.Const.EPSGType.EPSGWeb);n.point=u;var l=new g["default"](n,this.map);return this._imagesSet[r+"_"+e+"_"+i]={value:l,status:!0},l},e.prototype.getLevel=function(t){return"10"==this.dataType?t:t<10?"L0"+t:"L"+t},e.prototype.getURL=function(t,e,i){var n=this.baseMap[this.baseMapIndex][this.baseMapName];if("10"==this.dataType)n=n.replace("{r}",e).replace("{c}",i).replace("{l}",t);else{var r=this.getLevel(t);n=n.replace("{r}",d["default"].getR16(e)).replace("{c}",d["default"].getC16(i)).replace("{l}",r)}return n},e.prototype.isGround=function(){return!0},e.prototype.initAttributes=function(){t.prototype.initAttributes.call(this),this.type="TileLayer",this.baseMapIndex=0,this.baseMap=[{img:"http://115.236.87.26:8848/googleTiles/china_image/{l}/{r}/{c}.jpg",vec:"http://115.236.87.26:8848/googleTiles/china_vector/{l}/{r}/{c}.jpg",name:"\u5207\u7247",type:"16","default":"img"}]},e}(v["default"]);e["default"]=b,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(71),d=i(85),f=n(d),c=i(16),p=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.add=function(e){return t.prototype.add.call(this,e),this.workerServer.synAddRoadWorker(e.userData,this.uuid),this},e.prototype.remove=function(e){return t.prototype.remove.call(this,e),this.workerServer.synDelWorker(e.userData,this.uuid,c.Const.DrawEventType.WorkerRoadDel),this},e.prototype.synWorkerDraw=function(){this.workerServer.syncDraw(this.uuid,c.Const.DrawEventType.WorkerRoadDraw)},e.prototype.setData=function(t){var e=this;t.forEach(function(t){var i=new f["default"];i.userData=t,e.add(i)})},e.prototype.resizeChange=function(){var t=this.map.getSize();this.workerServer.reSize(t,this.uuid,c.Const.DrawEventType.WorkerRoadSizeChange),this.synWorkerDraw()},e.prototype.synCtxToWorker=function(t){if(!this.isFirstCanvas){var e=t.transferControlToOffscreen();this.workerServer.synCtxToWorker(e,this.uuid,c.Const.DrawEventType.WorkerRoadInit),this.isFirstCanvas=!0}},e}(h.WorkerLayer);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(70),d=n(h),f=i(5),c=n(f),p=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];(0,a["default"])(this,e);var r=(0,s["default"])(this,t.call(this,i,n));return r.isFirstCanvas=!1,r.workerServer=r.map.getService("WorkerService"),r}return(0,l["default"])(e,t),e.prototype.add=function(e){return t.prototype.add.call(this,e),this},e.prototype.scaleChange=function(){this.drag(new c["default"]),this.dragEnd()},e.prototype.resizeChange=function(){},e.prototype.remove=function(e){return t.prototype.remove.call(this,e),this},e.prototype.synWorkerDraw=function(){},e.prototype.isWorkerDraw=function(){return!0},e.prototype.dragEnd=function(){this.needsUpdate=!0},e.prototype.synCtxToWorker=function(t){},e.prototype.setData=function(t){},e}(d["default"]);e["default"]=p,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(130),d=n(h),f=i(11),c=n(f),p=i(8),v=i(28),m=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.initPointsData(e),this.oldfillColor=this.fillColor},e.prototype.initPointsData=function(t){var e=this;t.shapes&&t.shapes.forEach(function(t){var i=new c["default"](t.x,t.y,0,t.EPSGType);i.changeEPSGType(p.Const.EPSGType.EPSGWeb),e.points.push(i)})},e.prototype.isInside=function(t,e){var i=0,n=void 0,r=void 0,a=void 0,o=void 0,s=this.points.length;for(a=this.projectToScreen(this.points[0]),n=1;n<=s;n++)o=this.projectToScreen(this.points[n%s]),t>Math.min(a.x,o.x)&&t<=Math.max(a.x,o.x)&&e<=Math.max(a.y,o.y)&&a.x!=o.x&&(r=(t-a.x)*(o.y-a.y)/(o.x-a.x)+a.y,(a.y==o.y||e<=r)&&i++),a=o;return i%2!=0},e.prototype.changeColor=function(t){this.fillColor="8B1A1A",this.isSelect=!0,this.parent&&(this.parent.needsUpdate=!0)},e.prototype.resetColor=function(){this.fillColor=this.oldfillColor,this.isSelect=!1,this.parent&&(this.parent.needsUpdate=!0)},e.prototype.click=function(t){this.changeColor("#8B1A1A"),this.fireEvent(v.Events.Mesh.Click,this,t),this.map.fireEvent(v.Events.Mesh.Click,this,t)},e.prototype.unClick=function(){this.resetColor(),this.fireEvent(v.Events.Mesh.UnClick,this),this.map.fireEvent(v.Events.Mesh.UnClick,this)},e}(d["default"]);e["default"]=m,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(72),c=n(f),p=i(7),v=n(p),m=i(16),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onAttributeService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.getConfig=function(t,i,n){var r=v["default"].getUUID();this.on(r,i,n);var a={method:m.Const.EventType.MapConfig,action:"get",key:t,applyData:{fn:e.fnName,fnid:r}};this.worker.postMessage(a)},e.prototype.getLayers=function(t,i,n){var r=v["default"].getUUID();this.on(r,i,n);var a={method:m.Const.EventType.MapLayers,action:"get",key:t,applyData:{fn:e.fnName,fnid:r}};this.worker.postMessage(a)},e.prototype.onAttributeService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e.prototype.getPlaceMarker=function(t,i){var n=v["default"].getUUID();this.on(n,t,i);var r={method:m.Const.EventType.PlaceMarker,action:"get",applyData:{fn:e.fnName,fnid:n}};this.worker.postMessage(r)},e.prototype.addPlaceMarker=function(t,i,n){var r=v["default"].getUUID();this.on(r,t,n);var o={key:this.map.userData.key,method:m.Const.EventType.PlaceMarker,action:"add",applyData:{fn:e.fnName,fnid:r}};(0,a["default"])(o,i),this.worker.postMessage(o)},e.prototype.deletePlaceMarker=function(t,i,n){var r=v["default"].getUUID();this.on(r,t,n);var a={method:m.Const.EventType.PlaceMarker,action:"delete",applyData:{fn:e.fnName,fnid:r},key:"id",keyValue:i};this.worker.postMessage(a)},e}(c["default"]);e["default"]=g,g.fnName="AttributeService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(72),d=n(h),f=i(16),c=i(7),p=n(c),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onMarkerService.bind(n)),n.worker.addFn(e.fnSynName,n.onMarkerSynService.bind(n)),n}return(0,l["default"])(e,t),e.prototype.getMarker=function(t,i,n){var r=p["default"].getUUID();this.on(r,i,n);var a={method:f.Const.EventType.Marker,action:"get",json:t,applyData:{fn:e.fnName,fnid:r}};this.worker.postMessage(a)},e.prototype.synMarker=function(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments[4],o=arguments[5],s={method:f.Const.EventType.SynMarker,action:t,userData:{id:i,uuid:n,position:r,size:a,isTogether:o},applyData:{fn:e.fnSynName}};this.worker.postMessage(s,"add"!=t,0)},e.prototype.onMarkerService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e.prototype.onMarkerSynService=function(t){var e=[];t.values.forEach(function(t){var i={};i.id=t.id,i.show=t.show,e.push(i)}),this.fireEvent(t.uuid,e)},e}(d["default"]);e["default"]=v,v.fnName="MarkerService",v.fnSynName="MarkerSynService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(17),a=n(r),o=i(1),s=n(o),u=i(3),l=n(u),h=i(2),d=n(h),f=i(72),c=n(f),p=i(7),v=n(p),m=i(16),g=function(t){function e(i){(0,s["default"])(this,e);var n=(0,l["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onNavigateService.bind(n)),n}return(0,d["default"])(e,t),e.prototype.getFloorNavDatas=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=v["default"].getUUID();this.on(r,t,n);var o={method:m.Const.EventType.NavData,action:"get",key:this.map.userData.key,applyData:{fn:e.fnName,fnid:r}};(0,a["default"])(o,i),this.worker.postMessage(o)},e.prototype.onNavigateService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e}(c["default"]);e["default"]=g,g.fnName="NavigateService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{
"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(72),d=n(h),f=i(7),c=n(f),p=i(16),v=function(t){function e(i){(0,a["default"])(this,e);var n=(0,s["default"])(this,t.call(this,i));return n.worker.addFn(e.fnName,n.onPoiService.bind(n)),n}return(0,l["default"])(e,t),e.prototype.getPois=function(t,i,n,r){var a=c["default"].getUUID();this.on(a,n,r);var o={method:p.Const.EventType.PoiData,action:"get",key:t,value:i,applyData:{fn:e.fnName,fnid:a}};this.worker.postMessage(o)},e.prototype.onPoiService=function(t){var e=t.applyData.fnid;this.fireEvent(e,t),this.off(e)},e}(d["default"]);e["default"]=v,v.fnName="PoiService",t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(3),s=n(o),u=i(2),l=n(u),h=i(16),d=i(72),f=n(d),c=i(11),p=n(c),v=function(t){function e(){return(0,a["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,l["default"])(e,t),e.prototype.synAddRoadWorker=function(t,e){var i={method:h.Const.DrawEventType.WorkerRoadAdd,data:t,uuid:e};this.worker.postMessage(i,!1,0)},e.prototype.synAddHotWorker=function(t,e){var i={method:h.Const.DrawEventType.WorkerHotAdd,data:t,uuid:e};this.worker.postMessage(i,!1,0)},e.prototype.synCtxToWorker=function(t,e,i){var n={method:i,canvas:t,uuid:e};this.worker.postMessage(n,!1,0,[t])},e.prototype.syncDraw=function(t,e){var i=this.map.getControl("ScaleControl"),n=this.map.getControl("ViewControl"),r=n.target,a=new p["default"](r.x,r.y,0,r.EPSGType);a.changeEPSGType("3857");var o={method:e,center:a,scale:i.scale,uuid:t};this.worker.postMessage(o,!1,0)},e.prototype.reSize=function(t,e,i){var n={method:i,data:t,uuid:e};this.worker.postMessage(n,!1,0)},e.prototype.synDelWorker=function(t,e,i){var n={method:i,data:t,uuid:e};this.worker.postMessage(n,!1,0)},e.prototype.setColorPaintWorker=function(t,e){var i={method:h.Const.DrawEventType.WorkerColorAdd,data:t,uuid:e};this.worker.postMessage(i,!1,0)},e}(f["default"]);e["default"]=v,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(97),s=n(o),u=i(8),l=i(25),h=n(l),d=function f(t,e){(0,a["default"])(this,f),this.ScaleList=[1e4],this.RCScale=3779.52,this.CenterPoint=new s["default"],this.TileSize=256,this.LookAt=new s["default"],this.ScaleList=t.Scale_List||this.ScaleList,this.RCScale=t.RC_Scale||this.RCScale,this.DatumPoint=new s["default"]((-20037508.342789),20037508.342789,u.Const.EPSGType.EPSGWeb),t.DatumPoint&&this.DatumPoint.set(t.DatumPoint.x,t.DatumPoint.y,t.DatumPoint.EPSGType),t.CenterPoint&&this.CenterPoint.set(t.CenterPoint.x,t.CenterPoint.y,t.CenterPoint.EPSGType),t.LookAt?this.LookAt.set(t.LookAt.x,t.LookAt.y,t.LookAt.EPSGType):e.LookAt?this.LookAt.set(e.LookAt.x,e.LookAt.y,e.LookAt.EPSGType||u.Const.EPSGType.EPSG84):this.LookAt.set(t.CenterPoint.x,t.CenterPoint.y,t.CenterPoint.EPSGType),h["default"].initConfig(this)};e["default"]=d,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(1),a=n(r),o=i(8),s=i(4),u=n(s),l=i(602),h=n(l),d=i(97),f=n(d),c=function(){function t(){(0,a["default"])(this,t),this.typeList={}}return t.prototype.add=function(t,e,i,n){this.typeList[t]||(this.typeList[t]={}),this.typeList[t][e]={html:i,cls:n}},t.prototype.addType=function(t,e,i){this.typeList[t]={html:e,cls:i}},t.prototype.removeType=function(t,e){e?this.typeList[t]&&delete this.typeList[t][e]:delete this.typeList[t]},t.prototype.show=function(t,e){var i=t.parent.userData.objType,n=t.userData.id,r=this.typeList[i];if(r){var a=r[n],s=r.html,l=r.cls;a&&(s=a.html,l=a.cls);var d=(new f["default"]).copy(e);d.EPSGType=o.Const.EPSGType.EPSGWeb,d.changeEPSGType(o.Const.EPSGType.EPSG84);var c=new u["default"](e.x,e.y,0),p=t.projectToScreen(c);this.menu&&this.menu.dispose(),this.menu=new h["default"](t,d,s,l,this),this.menu.show(p)}},t}();e["default"]=c,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0;var r=i(10),a=n(r),o=i(1),s=n(o),u=i(4),l=n(u),h=i(603),d=n(h),f=i(28),c=function(){function t(e){(0,s["default"])(this,t),this.typeList={},this.displayPops={},this.map=e,this.initEvents()}return t.prototype.add=function(t,e,i,n){var r=this.map.getControl("LayerControl"),a=r.getLayer(t);this.typeList[a.type]||(this.typeList[a.type]={}),this.typeList[a.type][e]={fn:i,cls:n}},t.prototype.addType=function(t,e,i){var n=this.map.getControl("LayerControl"),r=n.getLayer(t);this.typeList[r.type]={fn:e,cls:i}},t.prototype.display=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.map.getControl("LayerControl"),a=r.getLayer(t);this.typeList[a.type]&&this.typeList[a.type][e]&&(this.typeList[a.type][e].display=!0),this.show(i,!0,n)},t.prototype.removeType=function(t,e){var i=this,n=this.map.getControl("LayerControl"),r=n.getLayer(t);e?this.typeList[r.type]&&(delete this.typeList[r.type][e],this.displayPops[r.type+"@"+e]&&(this.displayPops[r.type+"@"+e].dispose(),delete this.displayPops[r.type+"@"+e])):(delete this.typeList[r.type],(0,a["default"])(this.displayPops).map(function(t){t.indexOf(r.type+"")!=-1&&(i.displayPops[t].dispose(),delete i.displayPops[t])})),this.pop&&(this.pop.dispose(),this.pop=null)},t.prototype.initEvents=function(){this.map.on(f.Events.Mouse.Drag,this.synPosition,this),this.map.on(f.Events.Map.Resize,this.synPosition,this),this.map.on(f.Events.Map.CenterChange,this.synPosition,this)},t.prototype.synPosition=function(){this.pop&&this.pop.sysnPop()},t.prototype.show=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.parent.userData.objType,r=t.userData.id,a=this.initPopObj(n,r);if(a&&(i||!this.displayPops[n+"@"+r])){var o=new d["default"](t,a.fn,a.cls,this);e?this.displayPops[n+"@"+r]=o:this.pop&&this.pop.dispose(),this.pop=o,o.show()}},t.prototype.getModelCenter=function(t){var e=t.points,i=[],n=[];e.forEach(function(e){var r=t.projectToScreen(e);i.push(r.x),n.push(r.y)});var r=i.sort(function(t,e){return t-e}),a=n.sort(function(t,e){return t-e}),o=new l["default"]((r[0]+r[r.length-1])/2,a[0],0);return o},t.prototype.initPopObj=function(t,e){var i=this.typeList[t];if(!i)return null;var n=i[e],r=i.fn,a=i.cls;return n&&(r=n.fn,a=n.cls),{fn:r,cls:a}},t}();e["default"]=c,t.exports=e["default"]},function(t,e,i){t.exports={"default":i(632),__esModule:!0}},function(t,e,i){t.exports={"default":i(633),__esModule:!0}},function(t,e,i){t.exports={"default":i(635),__esModule:!0}},function(t,e,i){t.exports={"default":i(636),__esModule:!0}},function(t,e,i){t.exports={"default":i(638),__esModule:!0}},function(t,e,i){t.exports={"default":i(639),__esModule:!0}},function(t,e,i){t.exports={"default":i(640),__esModule:!0}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var r=i(625),a=n(r);e["default"]=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,a["default"])(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()},function(t,e,i){var n=i(29),r=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},function(t,e,i){i(657),t.exports=i(29).Object.assign},function(t,e,i){i(658);var n=i(29).Object;t.exports=function(t,e){return n.create(t,e)}},function(t,e,i){i(659);var n=i(29).Object;t.exports=function(t,e){return n.defineProperties(t,e)}},function(t,e,i){i(660);var n=i(29).Object;t.exports=function(t,e,i){return n.defineProperty(t,e,i)}},function(t,e,i){i(661),t.exports=i(29).Object.getPrototypeOf},function(t,e,i){i(662),t.exports=i(29).Object.keys},function(t,e,i){i(663),t.exports=i(29).Object.setPrototypeOf},function(t,e,i){i(666),i(664),i(667),i(668),t.exports=i(29).Symbol},function(t,e,i){i(665),i(669),t.exports=i(147).f("iterator")},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(){}},function(t,e,i){var n=i(76),r=i(655),a=i(654);t.exports=function(t){return function(e,i,o){var s,u=n(e),l=r(u.length),h=a(o,l);if(t&&i!=i){for(;l>h;)if(s=u[h++],s!=s)return!0}else for(;l>h;h++)if((t||h in u)&&u[h]===i)return t||h||0;return!t&&-1}}},function(t,e,i){var n=i(88),r=i(140),a=i(99);t.exports=function(t){var e=n(t),i=r.f;if(i)for(var o,s=i(t),u=a.f,l=0;s.length>l;)u.call(t,o=s[l++])&&e.push(o);return e}},function(t,e,i){var n=i(54).document;t.exports=n&&n.documentElement},function(t,e,i){var n=i(209);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,i){"use strict";var n=i(139),r=i(100),a=i(141),o={};i(74)(o,i(77)("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(o,{next:r(1,i)}),a(t,e+" Iterator")}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){var n=i(102)("meta"),r=i(75),a=i(62),o=i(63).f,s=0,u=Object.isExtensible||function(){return!0},l=!i(73)(function(){return u(Object.preventExtensions({}))}),h=function(t){o(t,n,{value:{i:"O"+ ++s,w:{}}})},d=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,n)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[n].i},f=function(t,e){if(!a(t,n)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[n].w},c=function(t){return l&&p.NEED&&u(t)&&!a(t,n)&&h(t),t},p=t.exports={KEY:n,NEED:!1,fastKey:d,getWeak:f,onFreeze:c}},function(t,e,i){"use strict";var n=i(88),r=i(140),a=i(99),o=i(101),s=i(213),u=Object.assign;t.exports=!u||i(73)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=u({},t)[i]||Object.keys(u({},e)).join("")!=n})?function(t,e){for(var i=o(t),u=arguments.length,l=1,h=r.f,d=a.f;u>l;)for(var f,c=s(arguments[l++]),p=h?n(c).concat(h(c)):n(c),v=p.length,m=0;v>m;)d.call(c,f=p[m++])&&(i[f]=c[f]);return i}:u},function(t,e,i){var n=i(76),r=i(217).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?s(t):r(n(t))}},function(t,e,i){var n=i(75),r=i(87),a=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=i(210)(Function.call,i(216).f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,i){return a(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:a}},function(t,e,i){var n=i(144),r=i(136);t.exports=function(t){return function(e,i){var a,o,s=String(r(e)),u=n(i),l=s.length;return u<0||u>=l?t?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?t?s.charAt(u):a:t?s.slice(u,u+2):(a-55296<<10)+(o-56320)+65536)}}},function(t,e,i){var n=i(144),r=Math.max,a=Math.min;t.exports=function(t,e){return t=n(t),t<0?r(t+e,0):a(t,e)}},function(t,e,i){var n=i(144),r=Math.min;t.exports=function(t){return t>0?r(n(t),9007199254740991):0}},function(t,e,i){"use strict";var n=i(642),r=i(648),a=i(138),o=i(76);t.exports=i(214)(Array,"Array",function(t,e){this._t=o(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,i):"values"==e?r(0,t[i]):r(0,[i,t[i]])},"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},function(t,e,i){var n=i(53);n(n.S+n.F,"Object",{assign:i(650)})},function(t,e,i){var n=i(53);n(n.S,"Object",{create:i(139)})},function(t,e,i){var n=i(53);n(n.S+n.F*!i(52),"Object",{defineProperties:i(215)})},function(t,e,i){var n=i(53);n(n.S+n.F*!i(52),"Object",{defineProperty:i(63).f})},function(t,e,i){var n=i(101),r=i(218);i(220)("getPrototypeOf",function(){return function(t){return r(n(t))}})},function(t,e,i){var n=i(101),r=i(88);i(220)("keys",function(){return function(t){return r(n(t))}})},function(t,e,i){var n=i(53);n(n.S,"Object",{setPrototypeOf:i(652).set})},function(t,e){},function(t,e,i){"use strict";var n=i(653)(!0);i(214)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},function(t,e,i){"use strict";var n=i(54),r=i(62),a=i(52),o=i(53),s=i(221),u=i(649).KEY,l=i(73),h=i(143),d=i(141),f=i(102),c=i(77),p=i(147),v=i(146),m=i(644),g=i(646),y=i(87),_=i(75),x=i(76),b=i(145),M=i(100),w=i(139),S=i(651),P=i(216),A=i(63),C=i(88),T=P.f,E=A.f,D=S.f,L=n.Symbol,F=n.JSON,k=F&&F.stringify,I="prototype",O=c("_hidden"),N=c("toPrimitive"),R={}.propertyIsEnumerable,U=h("symbol-registry"),B=h("symbols"),j=h("op-symbols"),z=Object[I],G="function"==typeof L,V=n.QObject,W=!V||!V[I]||!V[I].findChild,X=a&&l(function(){return 7!=w(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=T(z,e);n&&delete z[e],E(t,e,i),n&&t!==z&&E(z,e,n)}:E,H=function(t){var e=B[t]=w(L[I]);return e._k=t,e},Y=G&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},q=function(t,e,i){return t===z&&q(j,e,i),y(t),e=b(e,!0),y(i),r(B,e)?(i.enumerable?(r(t,O)&&t[O][e]&&(t[O][e]=!1),i=w(i,{enumerable:M(0,!1)})):(r(t,O)||E(t,O,M(1,{})),t[O][e]=!0),X(t,e,i)):E(t,e,i)},Q=function(t,e){y(t);for(var i,n=m(e=x(e)),r=0,a=n.length;a>r;)q(t,i=n[r++],e[i]);return t},Z=function(t,e){return void 0===e?w(t):Q(w(t),e)},K=function(t){var e=R.call(this,t=b(t,!0));return!(this===z&&r(B,t)&&!r(j,t))&&(!(e||!r(this,t)||!r(B,t)||r(this,O)&&this[O][t])||e)},J=function(t,e){if(t=x(t),e=b(e,!0),t!==z||!r(B,e)||r(j,e)){var i=T(t,e);return!i||!r(B,e)||r(t,O)&&t[O][e]||(i.enumerable=!0),i}},$=function(t){for(var e,i=D(x(t)),n=[],a=0;i.length>a;)r(B,e=i[a++])||e==O||e==u||n.push(e);return n},tt=function(t){for(var e,i=t===z,n=D(i?j:x(t)),a=[],o=0;n.length>o;)!r(B,e=n[o++])||i&&!r(z,e)||a.push(B[e]);return a};G||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(i){this===z&&e.call(j,i),r(this,O)&&r(this[O],t)&&(this[O][t]=!1),X(this,t,M(1,i))};return a&&W&&X(z,t,{configurable:!0,set:e}),H(t)},s(L[I],"toString",function(){return this._k}),P.f=J,A.f=q,i(217).f=S.f=$,i(99).f=K,i(140).f=tt,a&&!i(98)&&s(z,"propertyIsEnumerable",K,!0),p.f=function(t){return H(c(t))}),o(o.G+o.W+o.F*!G,{Symbol:L});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),it=0;et.length>it;)c(et[it++]);for(var nt=C(c.store),rt=0;nt.length>rt;)v(nt[rt++]);o(o.S+o.F*!G,"Symbol",{"for":function(t){return r(U,t+="")?U[t]:U[t]=L(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in U)if(U[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!G,"Object",{create:Z,defineProperty:q,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:$,getOwnPropertySymbols:tt}),F&&o(o.S+o.F*(!G||l(function(){var t=L();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],r=1;arguments.length>r;)n.push(arguments[r++]);if(i=e=n[1],(_(e)||void 0!==t)&&!Y(t))return g(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Y(e))return e}),n[1]=e,k.apply(F,n)}}),L[I][N]||i(74)(L[I],N,L[I].valueOf),d(L,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},function(t,e,i){i(146)("asyncIterator")},function(t,e,i){i(146)("observable")},function(t,e,i){i(656);for(var n=i(54),r=i(74),a=i(138),o=i(77)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l=s[u],h=n[l],d=h&&h.prototype;d&&!d[o]&&r(d,o,l),a[l]=a.Array}},function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function n(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}/*!
	 * Determine if an object is a Buffer
	 *
	 * @author   Feross Aboukhadijeh <https://feross.org>
	 * @license  MIT
	 */
t.exports=function(t){return null!=t&&(i(t)||n(t)||!!t._isBuffer)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=u.assign({level:y,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var i=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==v)throw new Error(h[i]);if(e.header&&s.deflateSetHeader(this.strm,e.header),e.dictionary){var r;if(r="string"==typeof e.dictionary?l.string2buf(e.dictionary):"[object ArrayBuffer]"===f.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=s.deflateSetDictionary(this.strm,r),i!==v)throw new Error(h[i]);this._dict_set=!0}}function r(t,e){var i=new n(e);if(i.push(t,!0),i.err)throw i.msg||h[i.err];return i.result}function a(t,e){return e=e||{},e.raw=!0,r(t,e)}function o(t,e){return e=e||{},e.gzip=!0,r(t,e)}var s=i(673),u=i(55),l=i(222),h=i(149),d=i(226),f=Object.prototype.toString,c=0,p=4,v=0,m=1,g=2,y=-1,_=0,x=8;n.prototype.push=function(t,e){var i,n,r=this.strm,a=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:e===!0?p:c,"string"==typeof t?r.input=l.string2buf(t):"[object ArrayBuffer]"===f.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new u.Buf8(a),r.next_out=0,r.avail_out=a),i=s.deflate(r,n),i!==m&&i!==v)return this.onEnd(i),this.ended=!0,!1;0!==r.avail_out&&(0!==r.avail_in||n!==p&&n!==g)||("string"===this.options.to?this.onData(l.buf2binstring(u.shrinkBuf(r.output,r.next_out))):this.onData(u.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||0===r.avail_out)&&i!==m);return n===p?(i=s.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===v):n!==g||(this.onEnd(v),r.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===v&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=n,e.deflate=r,e.deflateRaw=a,e.gzip=o},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var i=o.inflateInit2(this.strm,e.windowBits);if(i!==l.Z_OK)throw new Error(h[i]);if(this.header=new f,o.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=u.string2buf(e.dictionary):"[object ArrayBuffer]"===c.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=o.inflateSetDictionary(this.strm,e.dictionary),i!==l.Z_OK)))throw new Error(h[i])}function r(t,e){var i=new n(e);if(i.push(t,!0),i.err)throw i.msg||h[i.err];return i.result}function a(t,e){return e=e||{},e.raw=!0,r(t,e)}var o=i(676),s=i(55),u=i(222),l=i(224),h=i(149),d=i(226),f=i(674),c=Object.prototype.toString;n.prototype.push=function(t,e){var i,n,r,a,h,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,v=!1;if(this.ended)return!1;n=e===~~e?e:e===!0?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?d.input=u.binstring2buf(t):"[object ArrayBuffer]"===c.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new s.Buf8(f),d.next_out=0,d.avail_out=f),i=o.inflate(d,l.Z_NO_FLUSH),i===l.Z_NEED_DICT&&p&&(i=o.inflateSetDictionary(this.strm,p)),i===l.Z_BUF_ERROR&&v===!0&&(i=l.Z_OK,v=!1),i!==l.Z_STREAM_END&&i!==l.Z_OK)return this.onEnd(i),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&i!==l.Z_STREAM_END&&(0!==d.avail_in||n!==l.Z_FINISH&&n!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(r=u.utf8border(d.output,d.next_out),a=d.next_out-r,h=u.buf2string(d.output,r),d.next_out=a,d.avail_out=f-a,a&&s.arraySet(d.output,d.output,r,a,0),this.onData(h)):this.onData(s.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(v=!0)}while((d.avail_in>0||0===d.avail_out)&&i!==l.Z_STREAM_END);return i===l.Z_STREAM_END&&(n=l.Z_FINISH),n===l.Z_FINISH?(i=o.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===l.Z_OK):n!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),d.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=n,e.inflate=r,e.inflateRaw=a,e.ungzip=r},function(t,e,i){"use strict";function n(t,e){return t.msg=I[e],e}function r(t){return(t<<1)-(t>4?9:0)}function a(t){for(var e=t.length;--e>=0;)t[e]=0}function o(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(D.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function s(t,e){L._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,o(t.strm)}function u(t,e){t.pending_buf[t.pending++]=e}function l(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function h(t,e,i,n){var r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,D.arraySet(e,t.input,t.next_in,r,i),1===t.state.wrap?t.adler=F(t.adler,e,r,i):2===t.state.wrap&&(t.adler=k(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)}function d(t,e){var i,n,r=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,u=t.strstart>t.w_size-dt?t.strstart-(t.w_size-dt):0,l=t.window,h=t.w_mask,d=t.prev,f=t.strstart+ht,c=l[a+o-1],p=l[a+o];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do if(i=e,l[i+o]===p&&l[i+o-1]===c&&l[i]===l[a]&&l[++i]===l[a+1]){a+=2,i++;do;while(l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&a<f);if(n=ht-(f-a),a=f-ht,n>o){if(t.match_start=e,o=n,n>=s)break;c=l[a+o-1],p=l[a+o]}}while((e=d[e&h])>u&&0!==--r);return o<=t.lookahead?o:t.lookahead}function f(t){var e,i,n,r,a,o=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=o+(o-dt)){D.arraySet(t.window,t.window,o,o,0),t.match_start-=o,t.strstart-=o,t.block_start-=o,i=t.hash_size,e=i;do n=t.head[--e],t.head[e]=n>=o?n-o:0;while(--i);i=o,e=i;do n=t.prev[--e],t.prev[e]=n>=o?n-o:0;while(--i);r+=o}if(0===t.strm.avail_in)break;if(i=h(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=lt)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+lt-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<lt)););}while(t.lookahead<dt&&0!==t.strm.avail_in)}function c(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(f(t),0===t.lookahead&&e===O)return xt;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,s(t,!1),0===t.strm.avail_out))return xt;if(t.strstart-t.block_start>=t.w_size-dt&&(s(t,!1),0===t.strm.avail_out))return xt}return t.insert=0,e===U?(s(t,!0),0===t.strm.avail_out?Mt:wt):t.strstart>t.block_start&&(s(t,!1),0===t.strm.avail_out)?xt:xt}function p(t,e){for(var i,n;;){if(t.lookahead<dt){if(f(t),t.lookahead<dt&&e===O)return xt;if(0===t.lookahead)break}if(i=0,t.lookahead>=lt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-dt&&(t.match_length=d(t,i)),t.match_length>=lt)if(n=L._tr_tally(t,t.strstart-t.match_start,t.match_length-lt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=lt){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=L._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(s(t,!1),0===t.strm.avail_out))return xt}return t.insert=t.strstart<lt-1?t.strstart:lt-1,e===U?(s(t,!0),0===t.strm.avail_out?Mt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?xt:bt}function v(t,e){for(var i,n,r;;){if(t.lookahead<dt){if(f(t),t.lookahead<dt&&e===O)return xt;if(0===t.lookahead)break}if(i=0,t.lookahead>=lt&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=lt-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-dt&&(t.match_length=d(t,i),t.match_length<=5&&(t.strategy===H||t.match_length===lt&&t.strstart-t.match_start>4096)&&(t.match_length=lt-1)),t.prev_length>=lt&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-lt,n=L._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-lt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+lt-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!==--t.prev_length);if(t.match_available=0,t.match_length=lt-1,t.strstart++,n&&(s(t,!1),0===t.strm.avail_out))return xt}else if(t.match_available){if(n=L._tr_tally(t,0,t.window[t.strstart-1]),n&&s(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return xt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=L._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<lt-1?t.strstart:lt-1,e===U?(s(t,!0),0===t.strm.avail_out?Mt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?xt:bt}function m(t,e){for(var i,n,r,a,o=t.window;;){if(t.lookahead<=ht){if(f(t),t.lookahead<=ht&&e===O)return xt;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=lt&&t.strstart>0&&(r=t.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){a=t.strstart+ht;do;while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<a);t.match_length=ht-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=lt?(i=L._tr_tally(t,1,t.match_length-lt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=L._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(s(t,!1),0===t.strm.avail_out))return xt}return t.insert=0,e===U?(s(t,!0),0===t.strm.avail_out?Mt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?xt:bt}function g(t,e){for(var i;;){if(0===t.lookahead&&(f(t),0===t.lookahead)){if(e===O)return xt;break}if(t.match_length=0,i=L._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(s(t,!1),0===t.strm.avail_out))return xt}return t.insert=0,e===U?(s(t,!0),0===t.strm.avail_out?Mt:wt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?xt:bt}function y(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function _(t){t.window_size=2*t.w_size,a(t.head),t.max_lazy_match=E[t.level].max_lazy,t.good_match=E[t.level].good_length,t.nice_match=E[t.level].nice_length,t.max_chain_length=E[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=lt-1,t.match_available=0,t.ins_h=0}function x(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new D.Buf16(2*st),this.dyn_dtree=new D.Buf16(2*(2*at+1)),this.bl_tree=new D.Buf16(2*(2*ot+1)),a(this.dyn_ltree),a(this.dyn_dtree),a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new D.Buf16(ut+1),this.heap=new D.Buf16(2*rt+1),a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new D.Buf16(2*rt+1),a(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function b(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=K,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?ct:yt,t.adler=2===e.wrap?0:1,e.last_flush=O,L._tr_init(e),j):n(t,G)}function M(t){var e=b(t);return e===j&&_(t.state),e}function w(t,e){return t&&t.state?2!==t.state.wrap?G:(t.state.gzhead=e,j):G}function S(t,e,i,r,a,o){if(!t)return G;var s=1;if(e===X&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>$||i!==J||r<8||r>15||e<0||e>9||o<0||o>Q)return n(t,G);8===r&&(r=9);var u=new x;return t.state=u,u.strm=t,u.wrap=s,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=a+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+lt-1)/lt),u.window=new D.Buf8(2*u.w_size),u.head=new D.Buf16(u.hash_size),u.prev=new D.Buf16(u.w_size),u.lit_bufsize=1<<a+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new D.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=o,u.method=i,M(t)}function P(t,e){return S(t,e,J,tt,et,Z)}function A(t,e){var i,s,h,d;if(!t||!t.state||e>B||e<0)return t?n(t,G):G;if(s=t.state,!t.output||!t.input&&0!==t.avail_in||s.status===_t&&e!==U)return n(t,0===t.avail_out?W:G);if(s.strm=t,i=s.last_flush,s.last_flush=e,s.status===ct)if(2===s.wrap)t.adler=0,u(s,31),u(s,139),u(s,8),s.gzhead?(u(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),u(s,255&s.gzhead.time),u(s,s.gzhead.time>>8&255),u(s,s.gzhead.time>>16&255),u(s,s.gzhead.time>>24&255),u(s,9===s.level?2:s.strategy>=Y||s.level<2?4:0),u(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(u(s,255&s.gzhead.extra.length),u(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=k(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=pt):(u(s,0),u(s,0),u(s,0),u(s,0),u(s,0),u(s,9===s.level?2:s.strategy>=Y||s.level<2?4:0),u(s,St),s.status=yt);else{var f=J+(s.w_bits-8<<4)<<8,c=-1;c=s.strategy>=Y||s.level<2?0:s.level<6?1:6===s.level?2:3,f|=c<<6,0!==s.strstart&&(f|=ft),f+=31-f%31,s.status=yt,l(s,f),0!==s.strstart&&(l(s,t.adler>>>16),l(s,65535&t.adler)),t.adler=1}if(s.status===pt)if(s.gzhead.extra){for(h=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>h&&(t.adler=k(t.adler,s.pending_buf,s.pending-h,h)),o(t),h=s.pending,s.pending!==s.pending_buf_size));)u(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>h&&(t.adler=k(t.adler,s.pending_buf,s.pending-h,h)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=vt)}else s.status=vt;if(s.status===vt)if(s.gzhead.name){h=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>h&&(t.adler=k(t.adler,s.pending_buf,s.pending-h,h)),o(t),h=s.pending,s.pending===s.pending_buf_size)){d=1;break}d=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,u(s,d)}while(0!==d);s.gzhead.hcrc&&s.pending>h&&(t.adler=k(t.adler,s.pending_buf,s.pending-h,h)),0===d&&(s.gzindex=0,s.status=mt)}else s.status=mt;if(s.status===mt)if(s.gzhead.comment){h=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>h&&(t.adler=k(t.adler,s.pending_buf,s.pending-h,h)),o(t),h=s.pending,s.pending===s.pending_buf_size)){d=1;break}d=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,u(s,d)}while(0!==d);s.gzhead.hcrc&&s.pending>h&&(t.adler=k(t.adler,s.pending_buf,s.pending-h,h)),0===d&&(s.status=gt)}else s.status=gt;if(s.status===gt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&o(t),s.pending+2<=s.pending_buf_size&&(u(s,255&t.adler),u(s,t.adler>>8&255),t.adler=0,s.status=yt)):s.status=yt),0!==s.pending){if(o(t),0===t.avail_out)return s.last_flush=-1,j}else if(0===t.avail_in&&r(e)<=r(i)&&e!==U)return n(t,W);if(s.status===_t&&0!==t.avail_in)return n(t,W);if(0!==t.avail_in||0!==s.lookahead||e!==O&&s.status!==_t){var p=s.strategy===Y?g(s,e):s.strategy===q?m(s,e):E[s.level].func(s,e);if(p!==Mt&&p!==wt||(s.status=_t),p===xt||p===Mt)return 0===t.avail_out&&(s.last_flush=-1),j;if(p===bt&&(e===N?L._tr_align(s):e!==B&&(L._tr_stored_block(s,0,0,!1),e===R&&(a(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),o(t),0===t.avail_out))return s.last_flush=-1,j}return e!==U?j:s.wrap<=0?z:(2===s.wrap?(u(s,255&t.adler),u(s,t.adler>>8&255),u(s,t.adler>>16&255),u(s,t.adler>>24&255),u(s,255&t.total_in),u(s,t.total_in>>8&255),u(s,t.total_in>>16&255),u(s,t.total_in>>24&255)):(l(s,t.adler>>>16),l(s,65535&t.adler)),o(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?j:z)}function C(t){var e;return t&&t.state?(e=t.state.status,e!==ct&&e!==pt&&e!==vt&&e!==mt&&e!==gt&&e!==yt&&e!==_t?n(t,G):(t.state=null,e===yt?n(t,V):j)):G}function T(t,e){var i,n,r,o,s,u,l,h,d=e.length;if(!t||!t.state)return G;if(i=t.state,o=i.wrap,2===o||1===o&&i.status!==ct||i.lookahead)return G;for(1===o&&(t.adler=F(t.adler,e,d,0)),i.wrap=0,d>=i.w_size&&(0===o&&(a(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new D.Buf8(i.w_size),D.arraySet(h,e,d-i.w_size,i.w_size,0),e=h,d=i.w_size),s=t.avail_in,u=t.next_in,l=t.input,t.avail_in=d,t.next_in=0,t.input=e,f(i);i.lookahead>=lt;){n=i.strstart,r=i.lookahead-(lt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+lt-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--r);i.strstart=n,i.lookahead=lt-1,f(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=lt-1,i.match_available=0,t.next_in=u,t.input=l,t.avail_in=s,i.wrap=o,j}var E,D=i(55),L=i(678),F=i(223),k=i(225),I=i(149),O=0,N=1,R=3,U=4,B=5,j=0,z=1,G=-2,V=-3,W=-5,X=-1,H=1,Y=2,q=3,Q=4,Z=0,K=2,J=8,$=9,tt=15,et=8,it=29,nt=256,rt=nt+1+it,at=30,ot=19,st=2*rt+1,ut=15,lt=3,ht=258,dt=ht+lt+1,ft=32,ct=42,pt=69,vt=73,mt=91,gt=103,yt=113,_t=666,xt=1,bt=2,Mt=3,wt=4,St=3;E=[new y(0,0,0,0,c),new y(4,4,8,4,p),new y(4,5,16,8,p),new y(4,6,32,32,p),new y(4,4,16,16,v),new y(8,16,32,32,v),new y(8,16,128,128,v),new y(8,32,128,256,v),new y(32,128,258,1024,v),new y(32,258,258,4096,v)],e.deflateInit=P,e.deflateInit2=S,e.deflateReset=M,e.deflateResetKeep=b,e.deflateSetHeader=w,e.deflate=A,e.deflateEnd=C,e.deflateSetDictionary=T,e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e){"use strict";function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=i},function(t,e){"use strict";var i=30,n=12;t.exports=function(t,e){var r,a,o,s,u,l,h,d,f,c,p,v,m,g,y,_,x,b,M,w,S,P,A,C,T;r=t.state,a=t.next_in,C=t.input,o=a+(t.avail_in-5),s=t.next_out,T=t.output,u=s-(e-t.avail_out),l=s+(t.avail_out-257),h=r.dmax,d=r.wsize,f=r.whave,c=r.wnext,p=r.window,v=r.hold,m=r.bits,g=r.lencode,y=r.distcode,_=(1<<r.lenbits)-1,x=(1<<r.distbits)-1;t:do{m<15&&(v+=C[a++]<<m,m+=8,v+=C[a++]<<m,m+=8),b=g[v&_];e:for(;;){if(M=b>>>24,v>>>=M,m-=M,M=b>>>16&255,0===M)T[s++]=65535&b;else{if(!(16&M)){if(0===(64&M)){b=g[(65535&b)+(v&(1<<M)-1)];continue e}if(32&M){r.mode=n;break t}t.msg="invalid literal/length code",r.mode=i;break t}w=65535&b,M&=15,M&&(m<M&&(v+=C[a++]<<m,m+=8),w+=v&(1<<M)-1,v>>>=M,m-=M),m<15&&(v+=C[a++]<<m,m+=8,v+=C[a++]<<m,m+=8),b=y[v&x];i:for(;;){if(M=b>>>24,v>>>=M,m-=M,M=b>>>16&255,!(16&M)){if(0===(64&M)){b=y[(65535&b)+(v&(1<<M)-1)];continue i}t.msg="invalid distance code",r.mode=i;break t}if(S=65535&b,M&=15,m<M&&(v+=C[a++]<<m,m+=8,m<M&&(v+=C[a++]<<m,m+=8)),S+=v&(1<<M)-1,S>h){t.msg="invalid distance too far back",r.mode=i;break t}if(v>>>=M,m-=M,M=s-u,S>M){if(M=S-M,M>f&&r.sane){t.msg="invalid distance too far back",r.mode=i;break t}if(P=0,A=p,0===c){if(P+=d-M,M<w){w-=M;do T[s++]=p[P++];while(--M);P=s-S,A=T}}else if(c<M){if(P+=d+c-M,M-=c,M<w){w-=M;do T[s++]=p[P++];while(--M);if(P=0,c<w){M=c,w-=M;do T[s++]=p[P++];while(--M);P=s-S,A=T}}}else if(P+=c-M,M<w){w-=M;do T[s++]=p[P++];while(--M);P=s-S,A=T}for(;w>2;)T[s++]=A[P++],T[s++]=A[P++],T[s++]=A[P++],w-=3;w&&(T[s++]=A[P++],w>1&&(T[s++]=A[P++]))}else{P=s-S;do T[s++]=T[P++],T[s++]=T[P++],T[s++]=T[P++],w-=3;while(w>2);w&&(T[s++]=T[P++],w>1&&(T[s++]=T[P++]))}break}}break}}while(a<o&&s<l);w=m>>3,a-=w,m-=w<<3,v&=(1<<m)-1,t.next_in=a,t.next_out=s,t.avail_in=a<o?5+(o-a):5-(a-o),t.avail_out=s<l?257+(l-s):257-(s-l),r.hold=v,r.bits=m}},function(t,e,i){"use strict";function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=R,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new y.Buf32(vt),e.distcode=e.distdyn=new y.Buf32(mt),e.sane=1,e.back=-1,E):F}function o(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,a(t)):F}function s(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?F:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,o(t))):F}function u(t,e){var i,n;return t?(n=new r,t.state=n,n.window=null,i=s(t,e),i!==E&&(t.state=null),i):F}function l(t){return u(t,yt)}function h(t){if(_t){var e;for(m=new y.Buf32(512),g=new y.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(M(S,t.lens,0,288,m,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;M(P,t.lens,0,32,g,0,t.work,{bits:5}),_t=!1}t.lencode=m,t.lenbits=9,t.distcode=g,t.distbits=5}function d(t,e,i,n){var r,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new y.Buf8(a.wsize)),n>=a.wsize?(y.arraySet(a.window,e,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>n&&(r=n),y.arraySet(a.window,e,i-n,r,a.wnext),n-=r,n?(y.arraySet(a.window,e,i-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}function f(t,e){var i,r,a,o,s,u,l,f,c,p,v,m,g,vt,mt,gt,yt,_t,xt,bt,Mt,wt,St,Pt,At=0,Ct=new y.Buf8(4),Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return F;i=t.state,i.mode===q&&(i.mode=Q),s=t.next_out,a=t.output,l=t.avail_out,o=t.next_in,r=t.input,u=t.avail_in,f=i.hold,c=i.bits,p=u,v=l,wt=E;t:for(;;)switch(i.mode){case R:if(0===i.wrap){i.mode=Q;break}for(;c<16;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(2&i.wrap&&35615===f){i.check=0,Ct[0]=255&f,Ct[1]=f>>>8&255,i.check=x(i.check,Ct,2,0),f=0,c=0,i.mode=U;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&f)<<8)+(f>>8))%31){t.msg="incorrect header check",i.mode=ft;break}if((15&f)!==N){t.msg="unknown compression method",i.mode=ft;break}if(f>>>=4,c-=4,Mt=(15&f)+8,0===i.wbits)i.wbits=Mt;else if(Mt>i.wbits){t.msg="invalid window size",i.mode=ft;break}i.dmax=1<<Mt,t.adler=i.check=1,i.mode=512&f?H:q,f=0,c=0;break;case U:for(;c<16;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(i.flags=f,(255&i.flags)!==N){t.msg="unknown compression method",i.mode=ft;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=ft;break}i.head&&(i.head.text=f>>8&1),512&i.flags&&(Ct[0]=255&f,Ct[1]=f>>>8&255,i.check=x(i.check,Ct,2,0)),f=0,c=0,i.mode=B;case B:for(;c<32;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}i.head&&(i.head.time=f),512&i.flags&&(Ct[0]=255&f,Ct[1]=f>>>8&255,Ct[2]=f>>>16&255,Ct[3]=f>>>24&255,i.check=x(i.check,Ct,4,0)),f=0,c=0,i.mode=j;case j:for(;c<16;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}i.head&&(i.head.xflags=255&f,i.head.os=f>>8),512&i.flags&&(Ct[0]=255&f,Ct[1]=f>>>8&255,i.check=x(i.check,Ct,2,0)),f=0,c=0,i.mode=z;case z:if(1024&i.flags){for(;c<16;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}i.length=f,i.head&&(i.head.extra_len=f),512&i.flags&&(Ct[0]=255&f,Ct[1]=f>>>8&255,i.check=x(i.check,Ct,2,0)),f=0,c=0}else i.head&&(i.head.extra=null);i.mode=G;case G:if(1024&i.flags&&(m=i.length,m>u&&(m=u),m&&(i.head&&(Mt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),y.arraySet(i.head.extra,r,o,m,Mt)),512&i.flags&&(i.check=x(i.check,r,m,o)),u-=m,o+=m,i.length-=m),i.length))break t;i.length=0,i.mode=V;case V:if(2048&i.flags){if(0===u)break t;m=0;do Mt=r[o+m++],i.head&&Mt&&i.length<65536&&(i.head.name+=String.fromCharCode(Mt));while(Mt&&m<u);if(512&i.flags&&(i.check=x(i.check,r,m,o)),u-=m,o+=m,Mt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=W;case W:if(4096&i.flags){if(0===u)break t;m=0;do Mt=r[o+m++],i.head&&Mt&&i.length<65536&&(i.head.comment+=String.fromCharCode(Mt));while(Mt&&m<u);if(512&i.flags&&(i.check=x(i.check,r,m,o)),u-=m,o+=m,Mt)break t}else i.head&&(i.head.comment=null);i.mode=X;case X:if(512&i.flags){for(;c<16;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(f!==(65535&i.check)){t.msg="header crc mismatch",i.mode=ft;break}f=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=q;break;case H:for(;c<32;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}t.adler=i.check=n(f),f=0,c=0,i.mode=Y;case Y:if(0===i.havedict)return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=u,i.hold=f,i.bits=c,L;t.adler=i.check=1,i.mode=q;case q:if(e===C||e===T)break t;case Q:if(i.last){f>>>=7&c,c-=7&c,i.mode=lt;break}for(;c<3;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}switch(i.last=1&f,f>>>=1,c-=1,3&f){case 0:i.mode=Z;break;case 1:if(h(i),i.mode=it,e===T){f>>>=2,c-=2;break t}break;case 2:i.mode=$;break;case 3:t.msg="invalid block type",i.mode=ft}f>>>=2,c-=2;break;case Z:for(f>>>=7&c,c-=7&c;c<32;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if((65535&f)!==(f>>>16^65535)){t.msg="invalid stored block lengths",i.mode=ft;break}if(i.length=65535&f,f=0,c=0,i.mode=K,e===T)break t;case K:i.mode=J;case J:if(m=i.length){if(m>u&&(m=u),m>l&&(m=l),0===m)break t;y.arraySet(a,r,o,m,s),u-=m,o+=m,l-=m,s+=m,i.length-=m;break}i.mode=q;break;case $:for(;c<14;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(i.nlen=(31&f)+257,f>>>=5,c-=5,i.ndist=(31&f)+1,f>>>=5,c-=5,i.ncode=(15&f)+4,f>>>=4,c-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=ft;break}i.have=0,i.mode=tt;case tt:for(;i.have<i.ncode;){for(;c<3;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}i.lens[Tt[i.have++]]=7&f,f>>>=3,c-=3}for(;i.have<19;)i.lens[Tt[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,St={bits:i.lenbits},wt=M(w,i.lens,0,19,i.lencode,0,i.work,St),i.lenbits=St.bits,wt){t.msg="invalid code lengths set",i.mode=ft;break}i.have=0,i.mode=et;case et:for(;i.have<i.nlen+i.ndist;){for(;At=i.lencode[f&(1<<i.lenbits)-1],mt=At>>>24,gt=At>>>16&255,yt=65535&At,!(mt<=c);){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(yt<16)f>>>=mt,c-=mt,i.lens[i.have++]=yt;else{if(16===yt){for(Pt=mt+2;c<Pt;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(f>>>=mt,c-=mt,0===i.have){t.msg="invalid bit length repeat",i.mode=ft;break}Mt=i.lens[i.have-1],m=3+(3&f),f>>>=2,c-=2}else if(17===yt){for(Pt=mt+3;c<Pt;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}f>>>=mt,c-=mt,Mt=0,m=3+(7&f),f>>>=3,c-=3}else{for(Pt=mt+7;c<Pt;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}f>>>=mt,c-=mt,Mt=0,m=11+(127&f),f>>>=7,c-=7}if(i.have+m>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=ft;break}for(;m--;)i.lens[i.have++]=Mt}}if(i.mode===ft)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=ft;break}if(i.lenbits=9,St={bits:i.lenbits},wt=M(S,i.lens,0,i.nlen,i.lencode,0,i.work,St),i.lenbits=St.bits,wt){t.msg="invalid literal/lengths set",i.mode=ft;break}if(i.distbits=6,i.distcode=i.distdyn,St={bits:i.distbits},wt=M(P,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,St),i.distbits=St.bits,wt){t.msg="invalid distances set",i.mode=ft;break}if(i.mode=it,e===T)break t;case it:i.mode=nt;case nt:if(u>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=u,i.hold=f,i.bits=c,b(t,v),s=t.next_out,a=t.output,l=t.avail_out,o=t.next_in,r=t.input,u=t.avail_in,f=i.hold,c=i.bits,i.mode===q&&(i.back=-1);break}for(i.back=0;At=i.lencode[f&(1<<i.lenbits)-1],mt=At>>>24,gt=At>>>16&255,yt=65535&At,!(mt<=c);){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(gt&&0===(240&gt)){for(_t=mt,xt=gt,bt=yt;At=i.lencode[bt+((f&(1<<_t+xt)-1)>>_t)],mt=At>>>24,gt=At>>>16&255,yt=65535&At,!(_t+mt<=c);){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}f>>>=_t,c-=_t,i.back+=_t}if(f>>>=mt,c-=mt,i.back+=mt,i.length=yt,0===gt){i.mode=ut;break}if(32&gt){i.back=-1,i.mode=q;break}if(64&gt){t.msg="invalid literal/length code",i.mode=ft;break}i.extra=15&gt,i.mode=rt;case rt:if(i.extra){for(Pt=i.extra;c<Pt;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}i.length+=f&(1<<i.extra)-1,f>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=at;case at:for(;At=i.distcode[f&(1<<i.distbits)-1],mt=At>>>24,gt=At>>>16&255,yt=65535&At,!(mt<=c);){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(0===(240&gt)){for(_t=mt,xt=gt,bt=yt;At=i.distcode[bt+((f&(1<<_t+xt)-1)>>_t)],mt=At>>>24,gt=At>>>16&255,yt=65535&At,!(_t+mt<=c);){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}f>>>=_t,c-=_t,i.back+=_t}if(f>>>=mt,c-=mt,i.back+=mt,64&gt){t.msg="invalid distance code",i.mode=ft;break}i.offset=yt,i.extra=15&gt,i.mode=ot;case ot:if(i.extra){for(Pt=i.extra;c<Pt;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}i.offset+=f&(1<<i.extra)-1,f>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=ft;break}i.mode=st;case st:if(0===l)break t;if(m=v-l,i.offset>m){if(m=i.offset-m,m>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=ft;break}m>i.wnext?(m-=i.wnext,g=i.wsize-m):g=i.wnext-m,m>i.length&&(m=i.length),vt=i.window}else vt=a,g=s-i.offset,m=i.length;m>l&&(m=l),l-=m,i.length-=m;do a[s++]=vt[g++];while(--m);0===i.length&&(i.mode=nt);break;case ut:if(0===l)break t;a[s++]=i.length,l--,i.mode=nt;break;case lt:if(i.wrap){for(;c<32;){if(0===u)break t;u--,f|=r[o++]<<c,c+=8}if(v-=l,t.total_out+=v,i.total+=v,v&&(t.adler=i.check=i.flags?x(i.check,a,v,s-v):_(i.check,a,v,s-v)),v=l,(i.flags?f:n(f))!==i.check){t.msg="incorrect data check",i.mode=ft;break}f=0,c=0}i.mode=ht;case ht:if(i.wrap&&i.flags){for(;c<32;){if(0===u)break t;u--,f+=r[o++]<<c,c+=8}if(f!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=ft;break}f=0,c=0}i.mode=dt;case dt:wt=D;break t;case ft:wt=k;break t;case ct:return I;case pt:default:return F}return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=u,i.hold=f,i.bits=c,(i.wsize||v!==t.avail_out&&i.mode<ft&&(i.mode<lt||e!==A))&&d(t,t.output,t.next_out,v-t.avail_out)?(i.mode=ct,I):(p-=t.avail_in,v-=t.avail_out,t.total_in+=p,t.total_out+=v,i.total+=v,i.wrap&&v&&(t.adler=i.check=i.flags?x(i.check,a,v,t.next_out-v):_(i.check,a,v,t.next_out-v)),t.data_type=i.bits+(i.last?64:0)+(i.mode===q?128:0)+(i.mode===it||i.mode===K?256:0),
(0===p&&0===v||e===A)&&wt===E&&(wt=O),wt)}function c(t){if(!t||!t.state)return F;var e=t.state;return e.window&&(e.window=null),t.state=null,E}function p(t,e){var i;return t&&t.state?(i=t.state,0===(2&i.wrap)?F:(i.head=e,e.done=!1,E)):F}function v(t,e){var i,n,r,a=e.length;return t&&t.state?(i=t.state,0!==i.wrap&&i.mode!==Y?F:i.mode===Y&&(n=1,n=_(n,e,a,0),n!==i.check)?k:(r=d(t,e,a,a))?(i.mode=ct,I):(i.havedict=1,E)):F}var m,g,y=i(55),_=i(223),x=i(225),b=i(675),M=i(677),w=0,S=1,P=2,A=4,C=5,T=6,E=0,D=1,L=2,F=-2,k=-3,I=-4,O=-5,N=8,R=1,U=2,B=3,j=4,z=5,G=6,V=7,W=8,X=9,H=10,Y=11,q=12,Q=13,Z=14,K=15,J=16,$=17,tt=18,et=19,it=20,nt=21,rt=22,at=23,ot=24,st=25,ut=26,lt=27,ht=28,dt=29,ft=30,ct=31,pt=32,vt=852,mt=592,gt=15,yt=gt,_t=!0;e.inflateReset=o,e.inflateReset2=s,e.inflateResetKeep=a,e.inflateInit=l,e.inflateInit2=u,e.inflate=f,e.inflateEnd=c,e.inflateGetHeader=p,e.inflateSetDictionary=v,e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";var n=i(55),r=15,a=852,o=592,s=0,u=1,l=2,h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,p,v,m,g,y){var _,x,b,M,w,S,P,A,C,T=y.bits,E=0,D=0,L=0,F=0,k=0,I=0,O=0,N=0,R=0,U=0,B=null,j=0,z=new n.Buf16(r+1),G=new n.Buf16(r+1),V=null,W=0;for(E=0;E<=r;E++)z[E]=0;for(D=0;D<p;D++)z[e[i+D]]++;for(k=T,F=r;F>=1&&0===z[F];F--);if(k>F&&(k=F),0===F)return v[m++]=20971520,v[m++]=20971520,y.bits=1,0;for(L=1;L<F&&0===z[L];L++);for(k<L&&(k=L),N=1,E=1;E<=r;E++)if(N<<=1,N-=z[E],N<0)return-1;if(N>0&&(t===s||1!==F))return-1;for(G[1]=0,E=1;E<r;E++)G[E+1]=G[E]+z[E];for(D=0;D<p;D++)0!==e[i+D]&&(g[G[e[i+D]]++]=D);if(t===s?(B=V=g,S=19):t===u?(B=h,j-=257,V=d,W-=257,S=256):(B=f,V=c,S=-1),U=0,D=0,E=L,w=m,I=k,O=0,b=-1,R=1<<k,M=R-1,t===u&&R>a||t===l&&R>o)return 1;for(;;){P=E-O,g[D]<S?(A=0,C=g[D]):g[D]>S?(A=V[W+g[D]],C=B[j+g[D]]):(A=96,C=0),_=1<<E-O,x=1<<I,L=x;do x-=_,v[w+(U>>O)+x]=P<<24|A<<16|C|0;while(0!==x);for(_=1<<E-1;U&_;)_>>=1;if(0!==_?(U&=_-1,U+=_):U=0,D++,0===--z[E]){if(E===F)break;E=e[i+g[D]]}if(E>k&&(U&M)!==b){for(0===O&&(O=k),w+=L,I=E-O,N=1<<I;I+O<F&&(N-=z[I+O],!(N<=0));)I++,N<<=1;if(R+=1<<I,t===u&&R>a||t===l&&R>o)return 1;b=U&M,v[b]=k<<24|I<<16|w-m|0}}return 0!==U&&(v[w+U]=E-O<<24|64<<16|0),y.bits=k,0}},function(t,e,i){"use strict";function n(t){for(var e=t.length;--e>=0;)t[e]=0}function r(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function a(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function o(t){return t<256?ut[t]:ut[256+(t>>>7)]}function s(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function u(t,e,i){t.bi_valid>Q-i?(t.bi_buf|=e<<t.bi_valid&65535,s(t,t.bi_buf),t.bi_buf=e>>Q-t.bi_valid,t.bi_valid+=i-Q):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function l(t,e,i){u(t,i[2*e],i[2*e+1])}function h(t,e){var i=0;do i|=1&t,t>>>=1,i<<=1;while(--e>0);return i>>>1}function d(t){16===t.bi_valid?(s(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function f(t,e){var i,n,r,a,o,s,u=e.dyn_tree,l=e.max_code,h=e.stat_desc.static_tree,d=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,p=e.stat_desc.max_length,v=0;for(a=0;a<=q;a++)t.bl_count[a]=0;for(u[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<Y;i++)n=t.heap[i],a=u[2*u[2*n+1]+1]+1,a>p&&(a=p,v++),u[2*n+1]=a,n>l||(t.bl_count[a]++,o=0,n>=c&&(o=f[n-c]),s=u[2*n],t.opt_len+=s*(a+o),d&&(t.static_len+=s*(h[2*n+1]+o)));if(0!==v){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,v-=2}while(v>0);for(a=p;0!==a;a--)for(n=t.bl_count[a];0!==n;)r=t.heap[--i],r>l||(u[2*r+1]!==a&&(t.opt_len+=(a-u[2*r+1])*u[2*r],u[2*r+1]=a),n--)}}function c(t,e,i){var n,r,a=new Array(q+1),o=0;for(n=1;n<=q;n++)a[n]=o=o+i[n-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=h(a[s]++,s))}}function p(){var t,e,i,n,a,o=new Array(q+1);for(i=0,n=0;n<G-1;n++)for(ht[n]=i,t=0;t<1<<et[n];t++)lt[i++]=n;for(lt[i-1]=n,a=0,n=0;n<16;n++)for(dt[n]=a,t=0;t<1<<it[n];t++)ut[a++]=n;for(a>>=7;n<X;n++)for(dt[n]=a<<7,t=0;t<1<<it[n]-7;t++)ut[256+a++]=n;for(e=0;e<=q;e++)o[e]=0;for(t=0;t<=143;)ot[2*t+1]=8,t++,o[8]++;for(;t<=255;)ot[2*t+1]=9,t++,o[9]++;for(;t<=279;)ot[2*t+1]=7,t++,o[7]++;for(;t<=287;)ot[2*t+1]=8,t++,o[8]++;for(c(ot,W+1,o),t=0;t<X;t++)st[2*t+1]=5,st[2*t]=h(t,5);ft=new r(ot,et,V+1,W,q),ct=new r(st,it,0,X,q),pt=new r(new Array(0),nt,0,H,Z)}function v(t){var e;for(e=0;e<W;e++)t.dyn_ltree[2*e]=0;for(e=0;e<X;e++)t.dyn_dtree[2*e]=0;for(e=0;e<H;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*K]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function m(t){t.bi_valid>8?s(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function g(t,e,i,n){m(t),n&&(s(t,i),s(t,~i)),F.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}function y(t,e,i,n){var r=2*e,a=2*i;return t[r]<t[a]||t[r]===t[a]&&n[e]<=n[i]}function _(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&y(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!y(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function x(t,e,i){var n,r,a,s,h=0;if(0!==t.last_lit)do n=t.pending_buf[t.d_buf+2*h]<<8|t.pending_buf[t.d_buf+2*h+1],r=t.pending_buf[t.l_buf+h],h++,0===n?l(t,r,e):(a=lt[r],l(t,a+V+1,e),s=et[a],0!==s&&(r-=ht[a],u(t,r,s)),n--,a=o(n),l(t,a,i),s=it[a],0!==s&&(n-=dt[a],u(t,n,s)));while(h<t.last_lit);l(t,K,e)}function b(t,e){var i,n,r,a=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,u=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=Y,i=0;i<u;i++)0!==a[2*i]?(t.heap[++t.heap_len]=l=i,t.depth[i]=0):a[2*i+1]=0;for(;t.heap_len<2;)r=t.heap[++t.heap_len]=l<2?++l:0,a[2*r]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=o[2*r+1]);for(e.max_code=l,i=t.heap_len>>1;i>=1;i--)_(t,a,i);r=u;do i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],_(t,a,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,a[2*r]=a[2*i]+a[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,a[2*i+1]=a[2*n+1]=r,t.heap[1]=r++,_(t,a,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],f(t,e),c(a,l,t.bl_count)}function M(t,e,i){var n,r,a=-1,o=e[1],s=0,u=7,l=4;for(0===o&&(u=138,l=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++s<u&&r===o||(s<l?t.bl_tree[2*r]+=s:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[2*J]++):s<=10?t.bl_tree[2*$]++:t.bl_tree[2*tt]++,s=0,a=r,0===o?(u=138,l=3):r===o?(u=6,l=3):(u=7,l=4))}function w(t,e,i){var n,r,a=-1,o=e[1],s=0,h=7,d=4;for(0===o&&(h=138,d=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++s<h&&r===o)){if(s<d){do l(t,r,t.bl_tree);while(0!==--s)}else 0!==r?(r!==a&&(l(t,r,t.bl_tree),s--),l(t,J,t.bl_tree),u(t,s-3,2)):s<=10?(l(t,$,t.bl_tree),u(t,s-3,3)):(l(t,tt,t.bl_tree),u(t,s-11,7));s=0,a=r,0===o?(h=138,d=3):r===o?(h=6,d=3):(h=7,d=4)}}function S(t){var e;for(M(t,t.dyn_ltree,t.l_desc.max_code),M(t,t.dyn_dtree,t.d_desc.max_code),b(t,t.bl_desc),e=H-1;e>=3&&0===t.bl_tree[2*rt[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function P(t,e,i,n){var r;for(u(t,e-257,5),u(t,i-1,5),u(t,n-4,4),r=0;r<n;r++)u(t,t.bl_tree[2*rt[r]+1],3);w(t,t.dyn_ltree,e-1),w(t,t.dyn_dtree,i-1)}function A(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return I;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return O;for(e=32;e<V;e++)if(0!==t.dyn_ltree[2*e])return O;return I}function C(t){vt||(p(),vt=!0),t.l_desc=new a(t.dyn_ltree,ft),t.d_desc=new a(t.dyn_dtree,ct),t.bl_desc=new a(t.bl_tree,pt),t.bi_buf=0,t.bi_valid=0,v(t)}function T(t,e,i,n){u(t,(R<<1)+(n?1:0),3),g(t,e,i,!0)}function E(t){u(t,U<<1,3),l(t,K,ot),d(t)}function D(t,e,i,n){var r,a,o=0;t.level>0?(t.strm.data_type===N&&(t.strm.data_type=A(t)),b(t,t.l_desc),b(t,t.d_desc),o=S(t),r=t.opt_len+3+7>>>3,a=t.static_len+3+7>>>3,a<=r&&(r=a)):r=a=i+5,i+4<=r&&e!==-1?T(t,e,i,n):t.strategy===k||a===r?(u(t,(U<<1)+(n?1:0),3),x(t,ot,st)):(u(t,(B<<1)+(n?1:0),3),P(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),x(t,t.dyn_ltree,t.dyn_dtree)),v(t),n&&m(t)}function L(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(lt[i]+V+1)]++,t.dyn_dtree[2*o(e)]++),t.last_lit===t.lit_bufsize-1}var F=i(55),k=4,I=0,O=1,N=2,R=0,U=1,B=2,j=3,z=258,G=29,V=256,W=V+1+G,X=30,H=19,Y=2*W+1,q=15,Q=16,Z=7,K=256,J=16,$=17,tt=18,et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],it=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],nt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],at=512,ot=new Array(2*(W+2));n(ot);var st=new Array(2*X);n(st);var ut=new Array(at);n(ut);var lt=new Array(z-j+1);n(lt);var ht=new Array(G);n(ht);var dt=new Array(X);n(dt);var ft,ct,pt,vt=!1;e._tr_init=C,e._tr_stored_block=T,e._tr_flush_block=D,e._tr_tally=L,e._tr_align=E},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function a(t){if(d===clearTimeout)return clearTimeout(t);if((d===n||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function o(){v&&c&&(v=!1,c.length?p=c.concat(p):m=-1,p.length&&s())}function s(){if(!v){var t=r(o);v=!0;for(var e=p.length;e;){for(c=p,p=[];++m<e;)c&&c[m].run();m=-1,e=p.length}c=null,v=!1,a(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var h,d,f=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:i}catch(t){h=i}try{d="function"==typeof clearTimeout?clearTimeout:n}catch(t){d=n}}();var c,p=[],v=!1,m=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];p.push(new u(t,e)),1!==p.length||v||r(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,i){function n(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e.oe=function(t){throw console.error(t),t};var n=e(e.s=ENTRY_MODULE);return n["default"]||n}function r(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(t){return!isNaN(1*t)}function o(t,e,n){var o={};o[n]=[];var s=e.toString(),u=s.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return o;for(var d,f=u[1],c=new RegExp("(\\\\n|\\W)"+r(f)+h,"g");d=c.exec(s);)"dll-reference"!==d[3]&&o[n].push(d[3]);for(c=new RegExp("\\("+r(f)+'\\("(dll-reference\\s('+l+'))"\\)\\)'+h,"g");d=c.exec(s);)t[d[2]]||(o[n].push(d[1]),t[d[2]]=i(d[1]).m),o[d[2]]=o[d[2]]||[],o[d[2]].push(d[4]);for(var p=Object.keys(o),v=0;v<p.length;v++)for(var m=0;m<o[p[v]].length;m++)a(o[p[v]][m])&&(o[p[v]][m]=1*o[p[v]][m]);return o}function s(t){var e=Object.keys(t);return e.reduce(function(e,i){return e||t[i].length>0},!1)}function u(t,e){for(var i={main:[e]},n={main:[]},r={main:{}};s(i);)for(var a=Object.keys(i),u=0;u<a.length;u++){var l=a[u],h=i[l],d=h.pop();if(r[l]=r[l]||{},!r[l][d]&&t[l][d]){r[l][d]=!0,n[l]=n[l]||[],n[l].push(d);for(var f=o(t,t[l][d],l),c=Object.keys(f),p=0;p<c.length;p++)i[c[p]]=i[c[p]]||[],i[c[p]]=i[c[p]].concat(f[c[p]])}}return n}var l="[\\.|\\-|\\+|\\w|/|@]+",h="\\((/\\*.*?\\*/)?s?.*?("+l+").*?\\)";t.exports=function(t,e){e=e||{};var r={main:i.m},a=e.all?{main:Object.keys(r.main)}:u(r,t),o="";Object.keys(a).filter(function(t){return"main"!==t}).forEach(function(t){for(var e=0;a[t][e];)e++;a[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+t+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map(function(e){return""+JSON.stringify(e)+": "+r[t][e].toString()}).join(",")+"});\n"}),o=o+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map(function(t){return""+JSON.stringify(t)+": "+r.main[t].toString()}).join(",")+"}))(self);";var s=new window.Blob([o],{type:"text/javascript"});if(e.bare)return s;var l=window.URL||window.webkitURL||window.mozURL||window.msURL,h=l.createObjectURL(s),d=new window.Worker(h);return d.objectURL=h,d}},function(t,e,i,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(n);Object.defineProperty(e,"Api",{enumerable:!0,get:function(){return r(a)["default"]}})}]);